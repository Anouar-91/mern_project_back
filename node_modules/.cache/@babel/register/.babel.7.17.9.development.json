{"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/main.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nvar _server = require(\"./server\");\n\n(0, _server.launch)({\n  host: 'localhost',\n  protocol: 'http',\n  port: 8080\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiaG9zdCIsInByb3RvY29sIiwicG9ydCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFFQSxvQkFBTztBQUNMQSxFQUFBQSxJQUFJLEVBQUUsV0FERDtBQUVMQyxFQUFBQSxRQUFRLEVBQUUsTUFGTDtBQUdMQyxFQUFBQSxJQUFJLEVBQUU7QUFIRCxDQUFQIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbGF1bmNoIH0gZnJvbSAnLi9zZXJ2ZXInO1xuXG5sYXVuY2goe1xuICBob3N0OiAnbG9jYWxob3N0JyxcbiAgcHJvdG9jb2w6ICdodHRwJyxcbiAgcG9ydDogODA4MCxcbn0pO1xuIl19","map":{"version":3,"sources":["main.js"],"names":["host","protocol","port"],"mappings":";;AAAA;;AAEA,oBAAO;AACLA,EAAAA,IAAI,EAAE,WADD;AAELC,EAAAA,QAAQ,EAAE,MAFL;AAGLC,EAAAA,IAAI,EAAE;AAHD,CAAP","sourceRoot":"/Applications/dossier/mern_project_app2/src/","sourcesContent":["import { launch } from './server';\n\nlaunch({\n  host: 'localhost',\n  protocol: 'http',\n  port: 8080,\n});\n"]}},"mtime":1651230875437},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.launch = launch;\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst userRoutes = require('./routes/user.routes');\n\nfunction launch({\n  host,\n  protocol,\n  port\n}) {\n  const application = (0, _express.default)();\n\n  require('./config/db.js');\n\n  application.use(_express.default.json());\n  application.use('/api/user', userRoutes);\n  application.listen(port, () => console.log(`Server started at ${protocol}://${host}:${port}`));\n}\n/* require('dotenv').config({path:'./config/.env'})\n */\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJ1c2VyUm91dGVzIiwicmVxdWlyZSIsImxhdW5jaCIsImhvc3QiLCJwcm90b2NvbCIsInBvcnQiLCJhcHBsaWNhdGlvbiIsInVzZSIsImV4cHJlc3MiLCJqc29uIiwibGlzdGVuIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7O0FBQ0EsTUFBTUEsVUFBVSxHQUFHQyxPQUFPLENBQUMsc0JBQUQsQ0FBMUI7O0FBRU8sU0FBU0MsTUFBVCxDQUFnQjtBQUFFQyxFQUFBQSxJQUFGO0FBQVFDLEVBQUFBLFFBQVI7QUFBa0JDLEVBQUFBO0FBQWxCLENBQWhCLEVBQTBDO0FBQy9DLFFBQU1DLFdBQVcsR0FBRyx1QkFBcEI7O0FBQ0FMLEVBQUFBLE9BQU8sQ0FBQyxnQkFBRCxDQUFQOztBQUNBSyxFQUFBQSxXQUFXLENBQUNDLEdBQVosQ0FBZ0JDLGlCQUFRQyxJQUFSLEVBQWhCO0FBQ0FILEVBQUFBLFdBQVcsQ0FBQ0MsR0FBWixDQUFnQixXQUFoQixFQUE2QlAsVUFBN0I7QUFFQU0sRUFBQUEsV0FBVyxDQUFDSSxNQUFaLENBQ0VMLElBREYsRUFFRSxNQUFNTSxPQUFPLENBQUNDLEdBQVIsQ0FBYSxxQkFBb0JSLFFBQVMsTUFBS0QsSUFBSyxJQUFHRSxJQUFLLEVBQTVELENBRlI7QUFJRDtBQUlEO0FBQ0EiLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcbmNvbnN0IHVzZXJSb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy91c2VyLnJvdXRlcycpXG5cbmV4cG9ydCBmdW5jdGlvbiBsYXVuY2goeyBob3N0LCBwcm90b2NvbCwgcG9ydCB9KSB7XG4gIGNvbnN0IGFwcGxpY2F0aW9uID0gZXhwcmVzcygpO1xuICByZXF1aXJlKCcuL2NvbmZpZy9kYi5qcycpXG4gIGFwcGxpY2F0aW9uLnVzZShleHByZXNzLmpzb24oKSk7XG4gIGFwcGxpY2F0aW9uLnVzZSgnL2FwaS91c2VyJywgdXNlclJvdXRlcyk7XG5cbiAgYXBwbGljYXRpb24ubGlzdGVuKFxuICAgIHBvcnQsXG4gICAgKCkgPT4gY29uc29sZS5sb2coYFNlcnZlciBzdGFydGVkIGF0ICR7cHJvdG9jb2x9Oi8vJHtob3N0fToke3BvcnR9YCksXG4gICk7XG59XG5cblxuXG4vKiByZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoe3BhdGg6Jy4vY29uZmlnLy5lbnYnfSlcbiAqL1xuXG5cblxuIl19","map":{"version":3,"sources":["server.js"],"names":["userRoutes","require","launch","host","protocol","port","application","use","express","json","listen","console","log"],"mappings":";;;;;;;AAAA;;;;AACA,MAAMA,UAAU,GAAGC,OAAO,CAAC,sBAAD,CAA1B;;AAEO,SAASC,MAAT,CAAgB;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,QAAR;AAAkBC,EAAAA;AAAlB,CAAhB,EAA0C;AAC/C,QAAMC,WAAW,GAAG,uBAApB;;AACAL,EAAAA,OAAO,CAAC,gBAAD,CAAP;;AACAK,EAAAA,WAAW,CAACC,GAAZ,CAAgBC,iBAAQC,IAAR,EAAhB;AACAH,EAAAA,WAAW,CAACC,GAAZ,CAAgB,WAAhB,EAA6BP,UAA7B;AAEAM,EAAAA,WAAW,CAACI,MAAZ,CACEL,IADF,EAEE,MAAMM,OAAO,CAACC,GAAR,CAAa,qBAAoBR,QAAS,MAAKD,IAAK,IAAGE,IAAK,EAA5D,CAFR;AAID;AAID;AACA","sourceRoot":"/Applications/dossier/mern_project_app2/src/","sourcesContent":["import express from 'express';\nconst userRoutes = require('./routes/user.routes')\n\nexport function launch({ host, protocol, port }) {\n  const application = express();\n  require('./config/db.js')\n  application.use(express.json());\n  application.use('/api/user', userRoutes);\n\n  application.listen(\n    port,\n    () => console.log(`Server started at ${protocol}://${host}:${port}`),\n  );\n}\n\n\n\n/* require('dotenv').config({path:'./config/.env'})\n */\n\n\n\n"]}},"mtime":1651230883669},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/routes/user.routes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst router = require(\"express\").Router();\n\nconst authController = require('../controllers/auth.controller');\n\nrouter.post('/register', authController.signUp);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIucm91dGVzLmpzIl0sIm5hbWVzIjpbInJvdXRlciIsInJlcXVpcmUiLCJSb3V0ZXIiLCJhdXRoQ29udHJvbGxlciIsInBvc3QiLCJzaWduVXAiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE1BQU0sR0FBR0MsT0FBTyxDQUFDLFNBQUQsQ0FBUCxDQUFtQkMsTUFBbkIsRUFBZjs7QUFDQSxNQUFNQyxjQUFjLEdBQUdGLE9BQU8sQ0FBQyxnQ0FBRCxDQUE5Qjs7QUFFQUQsTUFBTSxDQUFDSSxJQUFQLENBQVksV0FBWixFQUF5QkQsY0FBYyxDQUFDRSxNQUF4QztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJQLE1BQWpCIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvcm91dGVzLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHJvdXRlciA9IHJlcXVpcmUoXCJleHByZXNzXCIpLlJvdXRlcigpO1xuY29uc3QgYXV0aENvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi9jb250cm9sbGVycy9hdXRoLmNvbnRyb2xsZXInKVxuXG5yb3V0ZXIucG9zdCgnL3JlZ2lzdGVyJywgYXV0aENvbnRyb2xsZXIuc2lnblVwKTtcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7Il19","map":{"version":3,"sources":["user.routes.js"],"names":["router","require","Router","authController","post","signUp","module","exports"],"mappings":";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,SAAD,CAAP,CAAmBC,MAAnB,EAAf;;AACA,MAAMC,cAAc,GAAGF,OAAO,CAAC,gCAAD,CAA9B;;AAEAD,MAAM,CAACI,IAAP,CAAY,WAAZ,EAAyBD,cAAc,CAACE,MAAxC;AAEAC,MAAM,CAACC,OAAP,GAAiBP,MAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/src/routes/","sourcesContent":["const router = require(\"express\").Router();\nconst authController = require('../controllers/auth.controller')\n\nrouter.post('/register', authController.signUp);\n\nmodule.exports = router;"]}},"mtime":1651230869021},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/controllers/auth.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.signUp = exports.signIn = exports.logout = void 0;\n\nvar _express = require(\"express\");\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst User = require('../models/user.model');\n\nconst jwt = require('jsonwebtoken'); //equivalent de 3 jours\n\n\nconst maxAge = 3 * 24 * 60 * 60 * 1000; //function qui créer le token en fonction d'une clé de cryptage qu'on aura mis dans variable d'environnemment\n\nconst createToken = id => {\n  return jwt.sign({\n    id\n  }, process.env.TOKEN_SECRET, {\n    expiresIn: maxAge\n  });\n};\n\nconst signUp = async (req, res) => {\n  const {\n    pseudo,\n    email,\n    password\n  } = req.body;\n\n  try {\n    const user = await User.create({\n      pseudo,\n      email,\n      password\n    });\n    res.status(201).send({\n      user: user._id\n    });\n  } catch (err) {\n    const errors = (0, _errors.signUpErrors)(err);\n    return res.status(200).send({\n      errors\n    });\n  }\n};\n\nexports.signUp = signUp;\n\nconst signIn = async (req, res) => {\n  const {\n    email,\n    password\n  } = req.body;\n\n  try {\n    //check user exist and compare email with password\n    const user = await User.login(email, password); //create token\n\n    const token = createToken(user._id); //on retourne le token dans les cookies accessible seulement par le serveur\n\n    res.cookie(\"jwt\", token, {\n      withCredentials: true,\n      httpOnly: true,\n      maxAge: maxAge\n    });\n    res.status(200).json({\n      user: user._id\n    });\n  } catch (err) {\n    console.log(err);\n    const errors = (0, _errors.signInErrors)(err);\n    return res.status(200).send({\n      errors\n    });\n  }\n};\n\nexports.signIn = signIn;\n\nconst logout = async (req, res) => {\n  res.cookie('jwt', '', {\n    maxAge: 1\n  });\n  res.status(200).json({\n    message: \"disconect\"\n  });\n};\n\nexports.logout = logout;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImp3dCIsIm1heEFnZSIsImNyZWF0ZVRva2VuIiwiaWQiLCJzaWduIiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsImV4cGlyZXNJbiIsInNpZ25VcCIsInJlcSIsInJlcyIsInBzZXVkbyIsImVtYWlsIiwicGFzc3dvcmQiLCJib2R5IiwidXNlciIsImNyZWF0ZSIsInN0YXR1cyIsInNlbmQiLCJfaWQiLCJlcnIiLCJlcnJvcnMiLCJzaWduSW4iLCJsb2dpbiIsInRva2VuIiwiY29va2llIiwid2l0aENyZWRlbnRpYWxzIiwiaHR0cE9ubHkiLCJqc29uIiwiY29uc29sZSIsImxvZyIsImxvZ291dCIsIm1lc3NhZ2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFDQSxNQUFNQyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxjQUFELENBQW5CLEMsQ0FFQTs7O0FBQ0EsTUFBTUUsTUFBTSxHQUFHLElBQUksRUFBSixHQUFTLEVBQVQsR0FBYyxFQUFkLEdBQW1CLElBQWxDLEMsQ0FDQTs7QUFDQSxNQUFNQyxXQUFXLEdBQUlDLEVBQUQsSUFBUTtBQUN4QixTQUFPSCxHQUFHLENBQUNJLElBQUosQ0FBUztBQUFFRCxJQUFBQTtBQUFGLEdBQVQsRUFBaUJFLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUE3QixFQUEyQztBQUM5Q0MsSUFBQUEsU0FBUyxFQUFFUDtBQURtQyxHQUEzQyxDQUFQO0FBR0gsQ0FKRDs7QUFPTyxNQUFNUSxNQUFNLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEtBQW9CO0FBQ3RDLFFBQU07QUFBRUMsSUFBQUEsTUFBRjtBQUFVQyxJQUFBQSxLQUFWO0FBQWlCQyxJQUFBQTtBQUFqQixNQUE4QkosR0FBRyxDQUFDSyxJQUF4Qzs7QUFDQSxNQUFJO0FBQ0EsVUFBTUMsSUFBSSxHQUFHLE1BQU1sQixJQUFJLENBQUNtQixNQUFMLENBQVk7QUFBRUwsTUFBQUEsTUFBRjtBQUFVQyxNQUFBQSxLQUFWO0FBQWlCQyxNQUFBQTtBQUFqQixLQUFaLENBQW5CO0FBQ0FILElBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVILE1BQUFBLElBQUksRUFBRUEsSUFBSSxDQUFDSTtBQUFiLEtBQXJCO0FBQ0gsR0FIRCxDQUlBLE9BQU9DLEdBQVAsRUFBWTtBQUNSLFVBQU1DLE1BQU0sR0FBRywwQkFBYUQsR0FBYixDQUFmO0FBQ0EsV0FBT1YsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBRUcsTUFBQUE7QUFBRixLQUFyQixDQUFQO0FBQ0g7QUFDSixDQVZNOzs7O0FBWUEsTUFBTUMsTUFBTSxHQUFHLE9BQU9iLEdBQVAsRUFBWUMsR0FBWixLQUFvQjtBQUN0QyxRQUFNO0FBQUVFLElBQUFBLEtBQUY7QUFBU0MsSUFBQUE7QUFBVCxNQUFzQkosR0FBRyxDQUFDSyxJQUFoQzs7QUFDQSxNQUFJO0FBQ0E7QUFDQSxVQUFNQyxJQUFJLEdBQUcsTUFBTWxCLElBQUksQ0FBQzBCLEtBQUwsQ0FBV1gsS0FBWCxFQUFrQkMsUUFBbEIsQ0FBbkIsQ0FGQSxDQUdBOztBQUNBLFVBQU1XLEtBQUssR0FBR3ZCLFdBQVcsQ0FBQ2MsSUFBSSxDQUFDSSxHQUFOLENBQXpCLENBSkEsQ0FLQTs7QUFDQVQsSUFBQUEsR0FBRyxDQUFDZSxNQUFKLENBQVcsS0FBWCxFQUFrQkQsS0FBbEIsRUFBeUI7QUFDckJFLE1BQUFBLGVBQWUsRUFBRSxJQURJO0FBRXJCQyxNQUFBQSxRQUFRLEVBQUUsSUFGVztBQUdyQjNCLE1BQUFBLE1BQU0sRUFBRUE7QUFIYSxLQUF6QjtBQUtBVSxJQUFBQSxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCVyxJQUFoQixDQUFxQjtBQUFFYixNQUFBQSxJQUFJLEVBQUVBLElBQUksQ0FBQ0k7QUFBYixLQUFyQjtBQUNILEdBWkQsQ0FhQSxPQUFPQyxHQUFQLEVBQVk7QUFDUlMsSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlWLEdBQVo7QUFDQSxVQUFNQyxNQUFNLEdBQUcsMEJBQWFELEdBQWIsQ0FBZjtBQUNBLFdBQU9WLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVHLE1BQUFBO0FBQUYsS0FBckIsQ0FBUDtBQUNIO0FBQ0osQ0FwQk07Ozs7QUFzQkEsTUFBTVUsTUFBTSxHQUFHLE9BQU90QixHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFDdENBLEVBQUFBLEdBQUcsQ0FBQ2UsTUFBSixDQUFXLEtBQVgsRUFBa0IsRUFBbEIsRUFBc0I7QUFBRXpCLElBQUFBLE1BQU0sRUFBRTtBQUFWLEdBQXRCO0FBQ0FVLEVBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JXLElBQWhCLENBQXFCO0FBQUVJLElBQUFBLE9BQU8sRUFBRTtBQUFYLEdBQXJCO0FBQ0gsQ0FITSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc3JjL2NvbnRyb2xsZXJzLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlc3BvbnNlIH0gZnJvbSAnZXhwcmVzcydcbmltcG9ydCB7IHNpZ25VcEVycm9ycywgc2lnbkluRXJyb3JzIH0gZnJvbSAnLi4vdXRpbHMvZXJyb3JzLnV0aWxzJ1xuXG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJylcblxuLy9lcXVpdmFsZW50IGRlIDMgam91cnNcbmNvbnN0IG1heEFnZSA9IDMgKiAyNCAqIDYwICogNjAgKiAxMDAwXG4vL2Z1bmN0aW9uIHF1aSBjcsOpZXIgbGUgdG9rZW4gZW4gZm9uY3Rpb24gZCd1bmUgY2zDqSBkZSBjcnlwdGFnZSBxdSdvbiBhdXJhIG1pcyBkYW5zIHZhcmlhYmxlIGQnZW52aXJvbm5lbW1lbnRcbmNvbnN0IGNyZWF0ZVRva2VuID0gKGlkKSA9PiB7XG4gICAgcmV0dXJuIGp3dC5zaWduKHsgaWQgfSwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVULCB7XG4gICAgICAgIGV4cGlyZXNJbjogbWF4QWdlXG4gICAgfSlcbn1cblxuXG5leHBvcnQgY29uc3Qgc2lnblVwID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBwc2V1ZG8sIGVtYWlsLCBwYXNzd29yZCB9ID0gcmVxLmJvZHlcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5jcmVhdGUoeyBwc2V1ZG8sIGVtYWlsLCBwYXNzd29yZCB9KVxuICAgICAgICByZXMuc3RhdHVzKDIwMSkuc2VuZCh7IHVzZXI6IHVzZXIuX2lkIH0pXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc3QgZXJyb3JzID0gc2lnblVwRXJyb3JzKGVycilcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHsgZXJyb3JzIH0pXG4gICAgfVxufVxuXG5leHBvcnQgY29uc3Qgc2lnbkluID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5XG4gICAgdHJ5IHtcbiAgICAgICAgLy9jaGVjayB1c2VyIGV4aXN0IGFuZCBjb21wYXJlIGVtYWlsIHdpdGggcGFzc3dvcmRcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIubG9naW4oZW1haWwsIHBhc3N3b3JkKVxuICAgICAgICAvL2NyZWF0ZSB0b2tlblxuICAgICAgICBjb25zdCB0b2tlbiA9IGNyZWF0ZVRva2VuKHVzZXIuX2lkKVxuICAgICAgICAvL29uIHJldG91cm5lIGxlIHRva2VuIGRhbnMgbGVzIGNvb2tpZXMgYWNjZXNzaWJsZSBzZXVsZW1lbnQgcGFyIGxlIHNlcnZldXJcbiAgICAgICAgcmVzLmNvb2tpZShcImp3dFwiLCB0b2tlbiwge1xuICAgICAgICAgICAgd2l0aENyZWRlbnRpYWxzOiB0cnVlLFxuICAgICAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgICAgICBtYXhBZ2U6IG1heEFnZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgdXNlcjogdXNlci5faWQgfSlcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIGNvbnN0IGVycm9ycyA9IHNpZ25JbkVycm9ycyhlcnIpXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IGVycm9ycyB9KVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGxvZ291dCA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5jb29raWUoJ2p3dCcsICcnLCB7IG1heEFnZTogMSB9KTtcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6IFwiZGlzY29uZWN0XCIgfSlcbn1cblxuIl19","map":{"version":3,"sources":["auth.controller.js"],"names":["User","require","jwt","maxAge","createToken","id","sign","process","env","TOKEN_SECRET","expiresIn","signUp","req","res","pseudo","email","password","body","user","create","status","send","_id","err","errors","signIn","login","token","cookie","withCredentials","httpOnly","json","console","log","logout","message"],"mappings":";;;;;;;AAAA;;AACA;;AAEA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AACA,MAAMC,GAAG,GAAGD,OAAO,CAAC,cAAD,CAAnB,C,CAEA;;;AACA,MAAME,MAAM,GAAG,IAAI,EAAJ,GAAS,EAAT,GAAc,EAAd,GAAmB,IAAlC,C,CACA;;AACA,MAAMC,WAAW,GAAIC,EAAD,IAAQ;AACxB,SAAOH,GAAG,CAACI,IAAJ,CAAS;AAAED,IAAAA;AAAF,GAAT,EAAiBE,OAAO,CAACC,GAAR,CAAYC,YAA7B,EAA2C;AAC9CC,IAAAA,SAAS,EAAEP;AADmC,GAA3C,CAAP;AAGH,CAJD;;AAOO,MAAMQ,MAAM,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACtC,QAAM;AAAEC,IAAAA,MAAF;AAAUC,IAAAA,KAAV;AAAiBC,IAAAA;AAAjB,MAA8BJ,GAAG,CAACK,IAAxC;;AACA,MAAI;AACA,UAAMC,IAAI,GAAG,MAAMlB,IAAI,CAACmB,MAAL,CAAY;AAAEL,MAAAA,MAAF;AAAUC,MAAAA,KAAV;AAAiBC,MAAAA;AAAjB,KAAZ,CAAnB;AACAH,IAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEH,MAAAA,IAAI,EAAEA,IAAI,CAACI;AAAb,KAArB;AACH,GAHD,CAIA,OAAOC,GAAP,EAAY;AACR,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOV,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEG,MAAAA;AAAF,KAArB,CAAP;AACH;AACJ,CAVM;;;;AAYA,MAAMC,MAAM,GAAG,OAAOb,GAAP,EAAYC,GAAZ,KAAoB;AACtC,QAAM;AAAEE,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAsBJ,GAAG,CAACK,IAAhC;;AACA,MAAI;AACA;AACA,UAAMC,IAAI,GAAG,MAAMlB,IAAI,CAAC0B,KAAL,CAAWX,KAAX,EAAkBC,QAAlB,CAAnB,CAFA,CAGA;;AACA,UAAMW,KAAK,GAAGvB,WAAW,CAACc,IAAI,CAACI,GAAN,CAAzB,CAJA,CAKA;;AACAT,IAAAA,GAAG,CAACe,MAAJ,CAAW,KAAX,EAAkBD,KAAlB,EAAyB;AACrBE,MAAAA,eAAe,EAAE,IADI;AAErBC,MAAAA,QAAQ,EAAE,IAFW;AAGrB3B,MAAAA,MAAM,EAAEA;AAHa,KAAzB;AAKAU,IAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB;AAAEb,MAAAA,IAAI,EAAEA,IAAI,CAACI;AAAb,KAArB;AACH,GAZD,CAaA,OAAOC,GAAP,EAAY;AACRS,IAAAA,OAAO,CAACC,GAAR,CAAYV,GAAZ;AACA,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOV,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEG,MAAAA;AAAF,KAArB,CAAP;AACH;AACJ,CApBM;;;;AAsBA,MAAMU,MAAM,GAAG,OAAOtB,GAAP,EAAYC,GAAZ,KAAoB;AACtCA,EAAAA,GAAG,CAACe,MAAJ,CAAW,KAAX,EAAkB,EAAlB,EAAsB;AAAEzB,IAAAA,MAAM,EAAE;AAAV,GAAtB;AACAU,EAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB;AAAEI,IAAAA,OAAO,EAAE;AAAX,GAArB;AACH,CAHM","sourceRoot":"/Applications/dossier/mern_project_app2/src/controllers/","sourcesContent":["import { response } from 'express'\nimport { signUpErrors, signInErrors } from '../utils/errors.utils'\n\nconst User = require('../models/user.model')\nconst jwt = require('jsonwebtoken')\n\n//equivalent de 3 jours\nconst maxAge = 3 * 24 * 60 * 60 * 1000\n//function qui créer le token en fonction d'une clé de cryptage qu'on aura mis dans variable d'environnemment\nconst createToken = (id) => {\n    return jwt.sign({ id }, process.env.TOKEN_SECRET, {\n        expiresIn: maxAge\n    })\n}\n\n\nexport const signUp = async (req, res) => {\n    const { pseudo, email, password } = req.body\n    try {\n        const user = await User.create({ pseudo, email, password })\n        res.status(201).send({ user: user._id })\n    }\n    catch (err) {\n        const errors = signUpErrors(err)\n        return res.status(200).send({ errors })\n    }\n}\n\nexport const signIn = async (req, res) => {\n    const { email, password } = req.body\n    try {\n        //check user exist and compare email with password\n        const user = await User.login(email, password)\n        //create token\n        const token = createToken(user._id)\n        //on retourne le token dans les cookies accessible seulement par le serveur\n        res.cookie(\"jwt\", token, {\n            withCredentials: true,\n            httpOnly: true,\n            maxAge: maxAge,\n        });\n        res.status(200).json({ user: user._id })\n    }\n    catch (err) {\n        console.log(err)\n        const errors = signInErrors(err)\n        return res.status(200).send({ errors })\n    }\n}\n\nexport const logout = async (req, res) => {\n    res.cookie('jwt', '', { maxAge: 1 });\n    res.status(200).json({ message: \"disconect\" })\n}\n\n"]}},"mtime":1651349889429},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/models/user.models.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nconst {\n  isEmail\n} = require('validator');\n\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  pseudo: {\n    type: String,\n    required: true,\n    minlength: 3,\n    maxlength: 55,\n    unique: true,\n    trim: true\n  },\n  email: {\n    type: String,\n    required: true,\n    validate: [isEmail],\n    lowercase: true,\n    unique: true,\n    trim: true\n  },\n  password: {\n    type: String,\n    required: true,\n    max: 1024,\n    minlength: 6\n  },\n  picture: {\n    type: String,\n    default: \"./uploads/profile/random-user.png\"\n  },\n  bio: {\n    type: String,\n    max: 1024\n  },\n  followers: {\n    type: [String]\n  },\n  following: {\n    type: [String]\n  },\n  likes: {\n    type: [String]\n  }\n}, {\n  timestamps: true\n}); //play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\n\nUserSchema.pre('save', async function (next) {\n  const salt = await bcrypt.genSalt();\n  this.password = await bcrypt.hash(this.password, salt);\n  next();\n}); //c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\n\nUserSchema.statics.login = async function (email, password) {\n  const user = await this.findOne({\n    email: email\n  });\n\n  if (user) {\n    const auth = await bcrypt.compare(password, user.password);\n\n    if (auth) {\n      return user;\n    } else {\n      throw Error('Incorrect password');\n    }\n  }\n\n  throw Error('Incorrect password');\n};\n\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIubW9kZWxzLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsImlzRW1haWwiLCJiY3J5cHQiLCJTY2hlbWEiLCJVc2VyU2NoZW1hIiwicHNldWRvIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwibWlubGVuZ3RoIiwibWF4bGVuZ3RoIiwidW5pcXVlIiwidHJpbSIsImVtYWlsIiwidmFsaWRhdGUiLCJsb3dlcmNhc2UiLCJwYXNzd29yZCIsIm1heCIsInBpY3R1cmUiLCJkZWZhdWx0IiwiYmlvIiwiZm9sbG93ZXJzIiwiZm9sbG93aW5nIiwibGlrZXMiLCJ0aW1lc3RhbXBzIiwicHJlIiwibmV4dCIsInNhbHQiLCJnZW5TYWx0IiwiaGFzaCIsInN0YXRpY3MiLCJsb2dpbiIsInVzZXIiLCJmaW5kT25lIiwiYXV0aCIsImNvbXBhcmUiLCJFcnJvciIsIlVzZXIiLCJtb2RlbCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUF4Qjs7QUFDQSxNQUFNO0FBQUNDLEVBQUFBO0FBQUQsSUFBWUQsT0FBTyxDQUFDLFdBQUQsQ0FBekI7O0FBQ0EsTUFBTUUsTUFBTSxHQUFHRixPQUFPLENBQUMsUUFBRCxDQUF0Qjs7QUFFQSxNQUFNRyxNQUFNLEdBQUdKLFFBQVEsQ0FBQ0ksTUFBeEI7QUFDQSxNQUFNQyxVQUFVLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQzFCRSxFQUFBQSxNQUFNLEVBQUU7QUFDSkMsSUFBQUEsSUFBSSxFQUFFQyxNQURGO0FBRUpDLElBQUFBLFFBQVEsRUFBQyxJQUZMO0FBR0pDLElBQUFBLFNBQVMsRUFBRSxDQUhQO0FBSUpDLElBQUFBLFNBQVMsRUFBQyxFQUpOO0FBS0pDLElBQUFBLE1BQU0sRUFBQyxJQUxIO0FBTUpDLElBQUFBLElBQUksRUFBQztBQU5ELEdBRGtCO0FBUzFCQyxFQUFBQSxLQUFLLEVBQUM7QUFDRlAsSUFBQUEsSUFBSSxFQUFDQyxNQURIO0FBRUZDLElBQUFBLFFBQVEsRUFBQyxJQUZQO0FBR0ZNLElBQUFBLFFBQVEsRUFBQyxDQUFDYixPQUFELENBSFA7QUFJRmMsSUFBQUEsU0FBUyxFQUFDLElBSlI7QUFLRkosSUFBQUEsTUFBTSxFQUFDLElBTEw7QUFNRkMsSUFBQUEsSUFBSSxFQUFDO0FBTkgsR0FUb0I7QUFpQjFCSSxFQUFBQSxRQUFRLEVBQUM7QUFDTFYsSUFBQUEsSUFBSSxFQUFDQyxNQURBO0FBRUxDLElBQUFBLFFBQVEsRUFBQyxJQUZKO0FBR0xTLElBQUFBLEdBQUcsRUFBQyxJQUhDO0FBSUxSLElBQUFBLFNBQVMsRUFBQztBQUpMLEdBakJpQjtBQXVCMUJTLEVBQUFBLE9BQU8sRUFBQztBQUNKWixJQUFBQSxJQUFJLEVBQUNDLE1BREQ7QUFFSlksSUFBQUEsT0FBTyxFQUFDO0FBRkosR0F2QmtCO0FBMkIxQkMsRUFBQUEsR0FBRyxFQUFDO0FBQ0FkLElBQUFBLElBQUksRUFBQ0MsTUFETDtBQUVBVSxJQUFBQSxHQUFHLEVBQUM7QUFGSixHQTNCc0I7QUErQjFCSSxFQUFBQSxTQUFTLEVBQUU7QUFDUGYsSUFBQUEsSUFBSSxFQUFDLENBQUNDLE1BQUQ7QUFERSxHQS9CZTtBQWtDMUJlLEVBQUFBLFNBQVMsRUFBQztBQUNOaEIsSUFBQUEsSUFBSSxFQUFDLENBQUNDLE1BQUQ7QUFEQyxHQWxDZ0I7QUFxQzFCZ0IsRUFBQUEsS0FBSyxFQUFFO0FBQ0hqQixJQUFBQSxJQUFJLEVBQUMsQ0FBQ0MsTUFBRDtBQURGO0FBckNtQixDQUFYLEVBd0NoQjtBQUNDaUIsRUFBQUEsVUFBVSxFQUFDO0FBRFosQ0F4Q2dCLENBQW5CLEMsQ0E2Q0E7QUFDQTs7QUFDQXBCLFVBQVUsQ0FBQ3FCLEdBQVgsQ0FBZSxNQUFmLEVBQXVCLGdCQUFnQkMsSUFBaEIsRUFBcUI7QUFDeEMsUUFBTUMsSUFBSSxHQUFHLE1BQU16QixNQUFNLENBQUMwQixPQUFQLEVBQW5CO0FBQ0EsT0FBS1osUUFBTCxHQUFnQixNQUFNZCxNQUFNLENBQUMyQixJQUFQLENBQVksS0FBS2IsUUFBakIsRUFBMkJXLElBQTNCLENBQXRCO0FBQ0FELEVBQUFBLElBQUk7QUFDUCxDQUpELEUsQ0FNQTs7QUFDQXRCLFVBQVUsQ0FBQzBCLE9BQVgsQ0FBbUJDLEtBQW5CLEdBQTJCLGdCQUFlbEIsS0FBZixFQUFzQkcsUUFBdEIsRUFBK0I7QUFDdEQsUUFBTWdCLElBQUksR0FBRyxNQUFNLEtBQUtDLE9BQUwsQ0FBYTtBQUFDcEIsSUFBQUEsS0FBSyxFQUFFQTtBQUFSLEdBQWIsQ0FBbkI7O0FBQ0EsTUFBR21CLElBQUgsRUFBUTtBQUNKLFVBQU1FLElBQUksR0FBRyxNQUFNaEMsTUFBTSxDQUFDaUMsT0FBUCxDQUFlbkIsUUFBZixFQUF5QmdCLElBQUksQ0FBQ2hCLFFBQTlCLENBQW5COztBQUNBLFFBQUdrQixJQUFILEVBQVE7QUFDSixhQUFPRixJQUFQO0FBQ0gsS0FGRCxNQUdJO0FBQ0EsWUFBTUksS0FBSyxDQUFDLG9CQUFELENBQVg7QUFDSDtBQUNKOztBQUNELFFBQU1BLEtBQUssQ0FBQyxvQkFBRCxDQUFYO0FBQ0gsQ0FaRDs7QUFhQSxJQUFJQyxJQUFJLEdBQUd0QyxRQUFRLENBQUN1QyxLQUFULENBQWUsTUFBZixFQUF1QmxDLFVBQXZCLENBQVg7QUFDQW1DLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsSUFBakIiLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9tb2RlbHMvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuY29uc3Qge2lzRW1haWx9ID0gcmVxdWlyZSgndmFsaWRhdG9yJyk7XG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKTtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgVXNlclNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHBzZXVkbzoge1xuICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXG4gICAgICAgIG1pbmxlbmd0aDogMywgXG4gICAgICAgIG1heGxlbmd0aDo1NSwgXG4gICAgICAgIHVuaXF1ZTp0cnVlLFxuICAgICAgICB0cmltOnRydWVcbiAgICB9LFxuICAgIGVtYWlsOntcbiAgICAgICAgdHlwZTpTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXG4gICAgICAgIHZhbGlkYXRlOltpc0VtYWlsXSxcbiAgICAgICAgbG93ZXJjYXNlOnRydWUsICAgICAgICBcbiAgICAgICAgdW5pcXVlOnRydWUsXG4gICAgICAgIHRyaW06dHJ1ZSxcbiAgICB9LFxuICAgIHBhc3N3b3JkOntcbiAgICAgICAgdHlwZTpTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXG4gICAgICAgIG1heDoxMDI0LFxuICAgICAgICBtaW5sZW5ndGg6NlxuICAgIH0sXG4gICAgcGljdHVyZTp7XG4gICAgICAgIHR5cGU6U3RyaW5nLFxuICAgICAgICBkZWZhdWx0OlwiLi91cGxvYWRzL3Byb2ZpbGUvcmFuZG9tLXVzZXIucG5nXCJcbiAgICB9LFxuICAgIGJpbzp7XG4gICAgICAgIHR5cGU6U3RyaW5nLFxuICAgICAgICBtYXg6MTAyNFxuICAgIH0sXG4gICAgZm9sbG93ZXJzOiB7XG4gICAgICAgIHR5cGU6W1N0cmluZ10sXG4gICAgfSxcbiAgICBmb2xsb3dpbmc6e1xuICAgICAgICB0eXBlOltTdHJpbmddLFxuICAgIH0sXG4gICAgbGlrZXM6IHtcbiAgICAgICAgdHlwZTpbU3RyaW5nXSxcbiAgICB9XG59LCB7XG4gICAgdGltZXN0YW1wczp0cnVlXG59XG4pO1xuXG4vL3BsYXkgZnVuY3Rpb24gYmVmb3JlIHNhdmUgaW50byBkYiB0byBhbGxvdyBjcnlwdCBwYXNzd29yZFxuLy8gbGUgbmV4dCB2ZXV0IGRpcmUgcXVhbmQgdCdhIGZpbmkgcGFzc2Ugw6AgbGEgc3VpdGVcblVzZXJTY2hlbWEucHJlKCdzYXZlJywgYXN5bmMgZnVuY3Rpb24gKG5leHQpe1xuICAgIGNvbnN0IHNhbHQgPSBhd2FpdCBiY3J5cHQuZ2VuU2FsdCgpO1xuICAgIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaCh0aGlzLnBhc3N3b3JkLCBzYWx0KTtcbiAgICBuZXh0KCk7XG59KVxuXG4vL2MnZXN0IGNlIHF1aSB2YSBub3VzIHBlcm1ldHRyZSBkZSBjb21wYXJlciBsZSBwYXNzd29yZCBjcnlwdMOpIGRlIG5vdHJlIHVzZXIgZW4gYmFzZSBkZSBkb25uw6llcyBhdmVjIGNlbHVpIHV0aWxpc2UgcGR0IGxlIGxvZ2luIGQndW4gdXNlclxuVXNlclNjaGVtYS5zdGF0aWNzLmxvZ2luID0gYXN5bmMgZnVuY3Rpb24oZW1haWwsIHBhc3N3b3JkKXtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5maW5kT25lKHtlbWFpbDogZW1haWx9KTtcbiAgICBpZih1c2VyKXtcbiAgICAgICAgY29uc3QgYXV0aCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKVxuICAgICAgICBpZihhdXRoKXtcbiAgICAgICAgICAgIHJldHVybiB1c2VyXG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdJbmNvcnJlY3QgcGFzc3dvcmQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aHJvdyBFcnJvcignSW5jb3JyZWN0IHBhc3N3b3JkJyk7XG59XG5sZXQgVXNlciA9IG1vbmdvb3NlLm1vZGVsKCdVc2VyJywgVXNlclNjaGVtYSk7XG5tb2R1bGUuZXhwb3J0cyA9IFVzZXI7Il19","map":{"version":3,"sources":["user.models.js"],"names":["mongoose","require","isEmail","bcrypt","Schema","UserSchema","pseudo","type","String","required","minlength","maxlength","unique","trim","email","validate","lowercase","password","max","picture","default","bio","followers","following","likes","timestamps","pre","next","salt","genSalt","hash","statics","login","user","findOne","auth","compare","Error","User","model","module","exports"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAM;AAACC,EAAAA;AAAD,IAAYD,OAAO,CAAC,WAAD,CAAzB;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,QAAD,CAAtB;;AAEA,MAAMG,MAAM,GAAGJ,QAAQ,CAACI,MAAxB;AACA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CAAW;AAC1BE,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAEC,MADF;AAEJC,IAAAA,QAAQ,EAAC,IAFL;AAGJC,IAAAA,SAAS,EAAE,CAHP;AAIJC,IAAAA,SAAS,EAAC,EAJN;AAKJC,IAAAA,MAAM,EAAC,IALH;AAMJC,IAAAA,IAAI,EAAC;AAND,GADkB;AAS1BC,EAAAA,KAAK,EAAC;AACFP,IAAAA,IAAI,EAACC,MADH;AAEFC,IAAAA,QAAQ,EAAC,IAFP;AAGFM,IAAAA,QAAQ,EAAC,CAACb,OAAD,CAHP;AAIFc,IAAAA,SAAS,EAAC,IAJR;AAKFJ,IAAAA,MAAM,EAAC,IALL;AAMFC,IAAAA,IAAI,EAAC;AANH,GAToB;AAiB1BI,EAAAA,QAAQ,EAAC;AACLV,IAAAA,IAAI,EAACC,MADA;AAELC,IAAAA,QAAQ,EAAC,IAFJ;AAGLS,IAAAA,GAAG,EAAC,IAHC;AAILR,IAAAA,SAAS,EAAC;AAJL,GAjBiB;AAuB1BS,EAAAA,OAAO,EAAC;AACJZ,IAAAA,IAAI,EAACC,MADD;AAEJY,IAAAA,OAAO,EAAC;AAFJ,GAvBkB;AA2B1BC,EAAAA,GAAG,EAAC;AACAd,IAAAA,IAAI,EAACC,MADL;AAEAU,IAAAA,GAAG,EAAC;AAFJ,GA3BsB;AA+B1BI,EAAAA,SAAS,EAAE;AACPf,IAAAA,IAAI,EAAC,CAACC,MAAD;AADE,GA/Be;AAkC1Be,EAAAA,SAAS,EAAC;AACNhB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADC,GAlCgB;AAqC1BgB,EAAAA,KAAK,EAAE;AACHjB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADF;AArCmB,CAAX,EAwChB;AACCiB,EAAAA,UAAU,EAAC;AADZ,CAxCgB,CAAnB,C,CA6CA;AACA;;AACApB,UAAU,CAACqB,GAAX,CAAe,MAAf,EAAuB,gBAAgBC,IAAhB,EAAqB;AACxC,QAAMC,IAAI,GAAG,MAAMzB,MAAM,CAAC0B,OAAP,EAAnB;AACA,OAAKZ,QAAL,GAAgB,MAAMd,MAAM,CAAC2B,IAAP,CAAY,KAAKb,QAAjB,EAA2BW,IAA3B,CAAtB;AACAD,EAAAA,IAAI;AACP,CAJD,E,CAMA;;AACAtB,UAAU,CAAC0B,OAAX,CAAmBC,KAAnB,GAA2B,gBAAelB,KAAf,EAAsBG,QAAtB,EAA+B;AACtD,QAAMgB,IAAI,GAAG,MAAM,KAAKC,OAAL,CAAa;AAACpB,IAAAA,KAAK,EAAEA;AAAR,GAAb,CAAnB;;AACA,MAAGmB,IAAH,EAAQ;AACJ,UAAME,IAAI,GAAG,MAAMhC,MAAM,CAACiC,OAAP,CAAenB,QAAf,EAAyBgB,IAAI,CAAChB,QAA9B,CAAnB;;AACA,QAAGkB,IAAH,EAAQ;AACJ,aAAOF,IAAP;AACH,KAFD,MAGI;AACA,YAAMI,KAAK,CAAC,oBAAD,CAAX;AACH;AACJ;;AACD,QAAMA,KAAK,CAAC,oBAAD,CAAX;AACH,CAZD;;AAaA,IAAIC,IAAI,GAAGtC,QAAQ,CAACuC,KAAT,CAAe,MAAf,EAAuBlC,UAAvB,CAAX;AACAmC,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/src/models/","sourcesContent":["const mongoose = require('mongoose');\nconst {isEmail} = require('validator');\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n    pseudo: {\n        type: String,\n        required:true,\n        minlength: 3, \n        maxlength:55, \n        unique:true,\n        trim:true\n    },\n    email:{\n        type:String,\n        required:true,\n        validate:[isEmail],\n        lowercase:true,        \n        unique:true,\n        trim:true,\n    },\n    password:{\n        type:String,\n        required:true,\n        max:1024,\n        minlength:6\n    },\n    picture:{\n        type:String,\n        default:\"./uploads/profile/random-user.png\"\n    },\n    bio:{\n        type:String,\n        max:1024\n    },\n    followers: {\n        type:[String],\n    },\n    following:{\n        type:[String],\n    },\n    likes: {\n        type:[String],\n    }\n}, {\n    timestamps:true\n}\n);\n\n//play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\nUserSchema.pre('save', async function (next){\n    const salt = await bcrypt.genSalt();\n    this.password = await bcrypt.hash(this.password, salt);\n    next();\n})\n\n//c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\nUserSchema.statics.login = async function(email, password){\n    const user = await this.findOne({email: email});\n    if(user){\n        const auth = await bcrypt.compare(password, user.password)\n        if(auth){\n            return user\n        }\n        else{\n            throw Error('Incorrect password');\n        }\n    }\n    throw Error('Incorrect password');\n}\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;"]}},"mtime":1651271257003},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.launch = launch;\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _response = _interopRequireDefault(require(\"express/lib/response\"));\n\nvar _routes = _interopRequireDefault(require(\"./routes\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst bodyParser = require('body-parser');\n\nconst cookieParser = require(\"cookie-parser\");\n\nconst {\n  checkUser,\n  requireAuth\n} = require('./middlewares/auth.middleware');\n\nconst cors = require(\"cors\");\n\nfunction launch({\n  host,\n  protocol,\n  port\n}) {\n  const application = (0, _express.default)();\n\n  require('dotenv').config({\n    path: './.env'\n  });\n\n  require('../database.js');\n\n  application.use(cors({\n    origin: process.env.CLIENT_URL,\n    methods: [\"GET\", \"POST\", \"HEAD\", \"PUT\", \"PATCH\", \"DELETE\"],\n    credentials: true\n  }));\n  application.use(cookieParser());\n  application.use(_express.default.json()); // notre middleware de sécurité\n\n  application.get('*', checkUser); //cest ce qui permet de loger un user lorsqu'il arrive sur le site\n\n  application.get('/jwtid', requireAuth, (req, res) => {\n    res.status(200).send(res.locals.user._id);\n  });\n  application.use(_routes.default);\n  application.use(_express.default.static('assets'));\n  application.listen(port, () => console.log(`Server started at ${protocol}://${host}:${port}`));\n}\n/* require('dotenv').config({path:'./config/.env'})\n */\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJib2R5UGFyc2VyIiwicmVxdWlyZSIsImNvb2tpZVBhcnNlciIsImNoZWNrVXNlciIsInJlcXVpcmVBdXRoIiwiY29ycyIsImxhdW5jaCIsImhvc3QiLCJwcm90b2NvbCIsInBvcnQiLCJhcHBsaWNhdGlvbiIsImNvbmZpZyIsInBhdGgiLCJ1c2UiLCJvcmlnaW4iLCJwcm9jZXNzIiwiZW52IiwiQ0xJRU5UX1VSTCIsIm1ldGhvZHMiLCJjcmVkZW50aWFscyIsImV4cHJlc3MiLCJqc29uIiwiZ2V0IiwicmVxIiwicmVzIiwic3RhdHVzIiwic2VuZCIsImxvY2FscyIsInVzZXIiLCJfaWQiLCJEZWZhdWx0Um91dGVyIiwic3RhdGljIiwibGlzdGVuIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7O0FBQ0EsTUFBTUEsVUFBVSxHQUFHQyxPQUFPLENBQUMsYUFBRCxDQUExQjs7QUFFQSxNQUFNQyxZQUFZLEdBQUdELE9BQU8sQ0FBQyxlQUFELENBQTVCOztBQUNBLE1BQU07QUFBRUUsRUFBQUEsU0FBRjtBQUFhQyxFQUFBQTtBQUFiLElBQTZCSCxPQUFPLENBQUMsK0JBQUQsQ0FBMUM7O0FBQ0EsTUFBTUksSUFBSSxHQUFHSixPQUFPLENBQUMsTUFBRCxDQUFwQjs7QUFHTyxTQUFTSyxNQUFULENBQWdCO0FBQUVDLEVBQUFBLElBQUY7QUFBUUMsRUFBQUEsUUFBUjtBQUFrQkMsRUFBQUE7QUFBbEIsQ0FBaEIsRUFBMEM7QUFDL0MsUUFBTUMsV0FBVyxHQUFHLHVCQUFwQjs7QUFDQVQsRUFBQUEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQlUsTUFBbEIsQ0FBeUI7QUFBRUMsSUFBQUEsSUFBSSxFQUFFO0FBQVIsR0FBekI7O0FBQ0FYLEVBQUFBLE9BQU8sQ0FBQyxnQkFBRCxDQUFQOztBQUVBUyxFQUFBQSxXQUFXLENBQUNHLEdBQVosQ0FDRVIsSUFBSSxDQUFDO0FBQ0hTLElBQUFBLE1BQU0sRUFBRUMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBRGpCO0FBRUhDLElBQUFBLE9BQU8sRUFBRSxDQUFDLEtBQUQsRUFBUSxNQUFSLEVBQWdCLE1BQWhCLEVBQXdCLEtBQXhCLEVBQStCLE9BQS9CLEVBQXdDLFFBQXhDLENBRk47QUFHSEMsSUFBQUEsV0FBVyxFQUFFO0FBSFYsR0FBRCxDQUROO0FBT0FULEVBQUFBLFdBQVcsQ0FBQ0csR0FBWixDQUFnQlgsWUFBWSxFQUE1QjtBQUVBUSxFQUFBQSxXQUFXLENBQUNHLEdBQVosQ0FBZ0JPLGlCQUFRQyxJQUFSLEVBQWhCLEVBZCtDLENBZ0IvQzs7QUFDQVgsRUFBQUEsV0FBVyxDQUFDWSxHQUFaLENBQWdCLEdBQWhCLEVBQXFCbkIsU0FBckIsRUFqQitDLENBa0IvQzs7QUFDQU8sRUFBQUEsV0FBVyxDQUFDWSxHQUFaLENBQWdCLFFBQWhCLEVBQTBCbEIsV0FBMUIsRUFBdUMsQ0FBQ21CLEdBQUQsRUFBTUMsR0FBTixLQUFjO0FBQ25EQSxJQUFBQSxHQUFHLENBQUNDLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQkYsR0FBRyxDQUFDRyxNQUFKLENBQVdDLElBQVgsQ0FBZ0JDLEdBQXJDO0FBQ0QsR0FGRDtBQUlBbkIsRUFBQUEsV0FBVyxDQUFDRyxHQUFaLENBQWdCaUIsZUFBaEI7QUFDQXBCLEVBQUFBLFdBQVcsQ0FBQ0csR0FBWixDQUFnQk8saUJBQVFXLE1BQVIsQ0FBZSxRQUFmLENBQWhCO0FBRUFyQixFQUFBQSxXQUFXLENBQUNzQixNQUFaLENBQ0V2QixJQURGLEVBRUUsTUFBTXdCLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLHFCQUFvQjFCLFFBQVMsTUFBS0QsSUFBSyxJQUFHRSxJQUFLLEVBQTVELENBRlI7QUFJRDtBQUlEO0FBQ0EiLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcbmltcG9ydCByZXMgZnJvbSAnZXhwcmVzcy9saWIvcmVzcG9uc2UnO1xuaW1wb3J0IERlZmF1bHRSb3V0ZXIgZnJvbSAnLi9yb3V0ZXMnO1xuY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XG5cbmNvbnN0IGNvb2tpZVBhcnNlciA9IHJlcXVpcmUoXCJjb29raWUtcGFyc2VyXCIpXG5jb25zdCB7IGNoZWNrVXNlciwgcmVxdWlyZUF1dGggfSA9IHJlcXVpcmUoJy4vbWlkZGxld2FyZXMvYXV0aC5taWRkbGV3YXJlJylcbmNvbnN0IGNvcnMgPSByZXF1aXJlKFwiY29yc1wiKVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBsYXVuY2goeyBob3N0LCBwcm90b2NvbCwgcG9ydCB9KSB7XG4gIGNvbnN0IGFwcGxpY2F0aW9uID0gZXhwcmVzcygpO1xuICByZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoeyBwYXRoOiAnLi8uZW52JyB9KVxuICByZXF1aXJlKCcuLi9kYXRhYmFzZS5qcycpXG5cbiAgYXBwbGljYXRpb24udXNlKFxuICAgIGNvcnMoe1xuICAgICAgb3JpZ2luOiBwcm9jZXNzLmVudi5DTElFTlRfVVJMLFxuICAgICAgbWV0aG9kczogW1wiR0VUXCIsIFwiUE9TVFwiLCBcIkhFQURcIiwgXCJQVVRcIiwgXCJQQVRDSFwiLCBcIkRFTEVURVwiXSxcbiAgICAgIGNyZWRlbnRpYWxzOiB0cnVlLFxuICAgIH0pXG4gICk7XG4gIGFwcGxpY2F0aW9uLnVzZShjb29raWVQYXJzZXIoKSk7XG5cbiAgYXBwbGljYXRpb24udXNlKGV4cHJlc3MuanNvbigpKTtcblxuICAvLyBub3RyZSBtaWRkbGV3YXJlIGRlIHPDqWN1cml0w6lcbiAgYXBwbGljYXRpb24uZ2V0KCcqJywgY2hlY2tVc2VyKVxuICAvL2Nlc3QgY2UgcXVpIHBlcm1ldCBkZSBsb2dlciB1biB1c2VyIGxvcnNxdSdpbCBhcnJpdmUgc3VyIGxlIHNpdGVcbiAgYXBwbGljYXRpb24uZ2V0KCcvand0aWQnLCByZXF1aXJlQXV0aCwgKHJlcSwgcmVzKSA9PiB7XG4gICAgcmVzLnN0YXR1cygyMDApLnNlbmQocmVzLmxvY2Fscy51c2VyLl9pZClcbiAgfSlcblxuICBhcHBsaWNhdGlvbi51c2UoRGVmYXVsdFJvdXRlcik7XG4gIGFwcGxpY2F0aW9uLnVzZShleHByZXNzLnN0YXRpYygnYXNzZXRzJykpO1xuXG4gIGFwcGxpY2F0aW9uLmxpc3RlbihcbiAgICBwb3J0LFxuICAgICgpID0+IGNvbnNvbGUubG9nKGBTZXJ2ZXIgc3RhcnRlZCBhdCAke3Byb3RvY29sfTovLyR7aG9zdH06JHtwb3J0fWApLFxuICApO1xufVxuXG5cblxuLyogcmVxdWlyZSgnZG90ZW52JykuY29uZmlnKHtwYXRoOicuL2NvbmZpZy8uZW52J30pXG4gKi9cblxuXG5cbiJdfQ==","map":{"version":3,"sources":["server.js"],"names":["bodyParser","require","cookieParser","checkUser","requireAuth","cors","launch","host","protocol","port","application","config","path","use","origin","process","env","CLIENT_URL","methods","credentials","express","json","get","req","res","status","send","locals","user","_id","DefaultRouter","static","listen","console","log"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,UAAU,GAAGC,OAAO,CAAC,aAAD,CAA1B;;AAEA,MAAMC,YAAY,GAAGD,OAAO,CAAC,eAAD,CAA5B;;AACA,MAAM;AAAEE,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAA6BH,OAAO,CAAC,+BAAD,CAA1C;;AACA,MAAMI,IAAI,GAAGJ,OAAO,CAAC,MAAD,CAApB;;AAGO,SAASK,MAAT,CAAgB;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,QAAR;AAAkBC,EAAAA;AAAlB,CAAhB,EAA0C;AAC/C,QAAMC,WAAW,GAAG,uBAApB;;AACAT,EAAAA,OAAO,CAAC,QAAD,CAAP,CAAkBU,MAAlB,CAAyB;AAAEC,IAAAA,IAAI,EAAE;AAAR,GAAzB;;AACAX,EAAAA,OAAO,CAAC,gBAAD,CAAP;;AAEAS,EAAAA,WAAW,CAACG,GAAZ,CACER,IAAI,CAAC;AACHS,IAAAA,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC,UADjB;AAEHC,IAAAA,OAAO,EAAE,CAAC,KAAD,EAAQ,MAAR,EAAgB,MAAhB,EAAwB,KAAxB,EAA+B,OAA/B,EAAwC,QAAxC,CAFN;AAGHC,IAAAA,WAAW,EAAE;AAHV,GAAD,CADN;AAOAT,EAAAA,WAAW,CAACG,GAAZ,CAAgBX,YAAY,EAA5B;AAEAQ,EAAAA,WAAW,CAACG,GAAZ,CAAgBO,iBAAQC,IAAR,EAAhB,EAd+C,CAgB/C;;AACAX,EAAAA,WAAW,CAACY,GAAZ,CAAgB,GAAhB,EAAqBnB,SAArB,EAjB+C,CAkB/C;;AACAO,EAAAA,WAAW,CAACY,GAAZ,CAAgB,QAAhB,EAA0BlB,WAA1B,EAAuC,CAACmB,GAAD,EAAMC,GAAN,KAAc;AACnDA,IAAAA,GAAG,CAACC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,GAAG,CAACG,MAAJ,CAAWC,IAAX,CAAgBC,GAArC;AACD,GAFD;AAIAnB,EAAAA,WAAW,CAACG,GAAZ,CAAgBiB,eAAhB;AACApB,EAAAA,WAAW,CAACG,GAAZ,CAAgBO,iBAAQW,MAAR,CAAe,QAAf,CAAhB;AAEArB,EAAAA,WAAW,CAACsB,MAAZ,CACEvB,IADF,EAEE,MAAMwB,OAAO,CAACC,GAAR,CAAa,qBAAoB1B,QAAS,MAAKD,IAAK,IAAGE,IAAK,EAA5D,CAFR;AAID;AAID;AACA","sourceRoot":"/Applications/dossier/mern_project_app2/src/","sourcesContent":["import express from 'express';\nimport res from 'express/lib/response';\nimport DefaultRouter from './routes';\nconst bodyParser = require('body-parser');\n\nconst cookieParser = require(\"cookie-parser\")\nconst { checkUser, requireAuth } = require('./middlewares/auth.middleware')\nconst cors = require(\"cors\")\n\n\nexport function launch({ host, protocol, port }) {\n  const application = express();\n  require('dotenv').config({ path: './.env' })\n  require('../database.js')\n\n  application.use(\n    cors({\n      origin: process.env.CLIENT_URL,\n      methods: [\"GET\", \"POST\", \"HEAD\", \"PUT\", \"PATCH\", \"DELETE\"],\n      credentials: true,\n    })\n  );\n  application.use(cookieParser());\n\n  application.use(express.json());\n\n  // notre middleware de sécurité\n  application.get('*', checkUser)\n  //cest ce qui permet de loger un user lorsqu'il arrive sur le site\n  application.get('/jwtid', requireAuth, (req, res) => {\n    res.status(200).send(res.locals.user._id)\n  })\n\n  application.use(DefaultRouter);\n  application.use(express.static('assets'));\n\n  application.listen(\n    port,\n    () => console.log(`Server started at ${protocol}://${host}:${port}`),\n  );\n}\n\n\n\n/* require('dotenv').config({path:'./config/.env'})\n */\n\n\n\n"]}},"mtime":1653046631486},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/db.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nmongoose.connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`).then(() => console.log('Connected to MongoDB')).catch(error => console.log(\"Failed to connect MongoDB\", error));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiREJfVVNFUk5BTUUiLCJEQl9QQVNTV09SRCIsInRoZW4iLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnJvciJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUVBRCxRQUFRLENBQ0hFLE9BREwsQ0FDYyxpQkFBZ0JDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxXQUFZLElBQUdGLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRSxXQUFZLDBDQURqRixFQUVLQyxJQUZMLENBRVUsTUFBTUMsT0FBTyxDQUFDQyxHQUFSLENBQVksc0JBQVosQ0FGaEIsRUFHS0MsS0FITCxDQUdZQyxLQUFELElBQVdILE9BQU8sQ0FBQ0MsR0FBUixDQUFZLDJCQUFaLEVBQXlDRSxLQUF6QyxDQUh0QiIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpXG5cbm1vbmdvb3NlXG4gICAgLmNvbm5lY3QoYG1vbmdvZGIrc3J2Oi8vJHtwcm9jZXNzLmVudi5EQl9VU0VSTkFNRX06JHtwcm9jZXNzLmVudi5EQl9QQVNTV09SRH1AY2x1c3RlcjAuZ2J2eGcubW9uZ29kYi5uZXQvbWVybl9wcm9qZWN0YClcbiAgICAudGhlbigoKSA9PiBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIE1vbmdvREInKSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBjb25uZWN0IE1vbmdvREJcIiwgZXJyb3IpKSJdfQ==","map":{"version":3,"sources":["db.js"],"names":["mongoose","require","connect","process","env","DB_USERNAME","DB_PASSWORD","then","console","log","catch","error"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEAD,QAAQ,CACHE,OADL,CACc,iBAAgBC,OAAO,CAACC,GAAR,CAAYC,WAAY,IAAGF,OAAO,CAACC,GAAR,CAAYE,WAAY,0CADjF,EAEKC,IAFL,CAEU,MAAMC,OAAO,CAACC,GAAR,CAAY,sBAAZ,CAFhB,EAGKC,KAHL,CAGYC,KAAD,IAAWH,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCE,KAAzC,CAHtB","sourceRoot":"/Applications/dossier/mern_project_app2/","sourcesContent":["const mongoose = require('mongoose')\n\nmongoose\n    .connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`)\n    .then(() => console.log('Connected to MongoDB'))\n    .catch((error) => console.log(\"Failed to connect MongoDB\", error))"]}},"mtime":1651231241527},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/routes/user.routes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst router = require(\"express\").Router();\n\nconst authController = require('../controllers/auth.controller');\n\nrouter.post('/register', authController.signUp);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIucm91dGVzLmpzIl0sIm5hbWVzIjpbInJvdXRlciIsInJlcXVpcmUiLCJSb3V0ZXIiLCJhdXRoQ29udHJvbGxlciIsInBvc3QiLCJzaWduVXAiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE1BQU0sR0FBR0MsT0FBTyxDQUFDLFNBQUQsQ0FBUCxDQUFtQkMsTUFBbkIsRUFBZjs7QUFDQSxNQUFNQyxjQUFjLEdBQUdGLE9BQU8sQ0FBQyxnQ0FBRCxDQUE5Qjs7QUFFQUQsTUFBTSxDQUFDSSxJQUFQLENBQVksV0FBWixFQUF5QkQsY0FBYyxDQUFDRSxNQUF4QztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJQLE1BQWpCIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvcm91dGVzLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHJvdXRlciA9IHJlcXVpcmUoXCJleHByZXNzXCIpLlJvdXRlcigpO1xuY29uc3QgYXV0aENvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi9jb250cm9sbGVycy9hdXRoLmNvbnRyb2xsZXInKVxuXG5yb3V0ZXIucG9zdCgnL3JlZ2lzdGVyJywgYXV0aENvbnRyb2xsZXIuc2lnblVwKTtcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7Il19","map":{"version":3,"sources":["user.routes.js"],"names":["router","require","Router","authController","post","signUp","module","exports"],"mappings":";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,SAAD,CAAP,CAAmBC,MAAnB,EAAf;;AACA,MAAMC,cAAc,GAAGF,OAAO,CAAC,gCAAD,CAA9B;;AAEAD,MAAM,CAACI,IAAP,CAAY,WAAZ,EAAyBD,cAAc,CAACE,MAAxC;AAEAC,MAAM,CAACC,OAAP,GAAiBP,MAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/src/routes/","sourcesContent":["const router = require(\"express\").Router();\nconst authController = require('../controllers/auth.controller')\n\nrouter.post('/register', authController.signUp);\n\nmodule.exports = router;"]}},"mtime":1651230869021},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/controllers/auth.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.signUp = exports.signIn = exports.logout = void 0;\n\nvar _express = require(\"express\");\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst User = require('../models/user.model');\n\nconst jwt = require('jsonwebtoken'); //equivalent de 3 jours\n\n\nconst maxAge = 3 * 24 * 60 * 60 * 1000; //function qui créer le token en fonction d'une clé de cryptage qu'on aura mis dans variable d'environnemment\n\nconst createToken = id => {\n  return jwt.sign({\n    id\n  }, process.env.TOKEN_SECRET, {\n    expiresIn: maxAge\n  });\n};\n\nconst signUp = async (req, res) => {\n  const {\n    pseudo,\n    email,\n    password\n  } = req.body;\n\n  try {\n    const user = await User.create({\n      pseudo,\n      email,\n      password\n    });\n    res.status(201).send({\n      user: user._id\n    });\n  } catch (err) {\n    const errors = (0, _errors.signUpErrors)(err);\n    return res.status(200).send({\n      errors\n    });\n  }\n};\n\nexports.signUp = signUp;\n\nconst signIn = async (req, res) => {\n  const {\n    email,\n    password\n  } = req.body;\n\n  try {\n    //check user exist and compare email with password\n    const user = await User.login(email, password); //create token\n\n    const token = createToken(user._id); //on retourne le token dans les cookies accessible seulement par le serveur\n\n    res.cookie(\"jwt\", token, {\n      withCredentials: true,\n      httpOnly: true,\n      maxAge: maxAge\n    });\n    res.status(200).json({\n      user: user._id\n    });\n  } catch (err) {\n    console.log(err);\n    const errors = (0, _errors.signInErrors)(err);\n    return res.status(200).send({\n      errors\n    });\n  }\n};\n\nexports.signIn = signIn;\n\nconst logout = async (req, res) => {\n  res.cookie('jwt', '', {\n    maxAge: 1\n  });\n  res.status(200).json({\n    message: \"disconect\"\n  });\n};\n\nexports.logout = logout;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImp3dCIsIm1heEFnZSIsImNyZWF0ZVRva2VuIiwiaWQiLCJzaWduIiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsImV4cGlyZXNJbiIsInNpZ25VcCIsInJlcSIsInJlcyIsInBzZXVkbyIsImVtYWlsIiwicGFzc3dvcmQiLCJib2R5IiwidXNlciIsImNyZWF0ZSIsInN0YXR1cyIsInNlbmQiLCJfaWQiLCJlcnIiLCJlcnJvcnMiLCJzaWduSW4iLCJsb2dpbiIsInRva2VuIiwiY29va2llIiwid2l0aENyZWRlbnRpYWxzIiwiaHR0cE9ubHkiLCJqc29uIiwiY29uc29sZSIsImxvZyIsImxvZ291dCIsIm1lc3NhZ2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFDQSxNQUFNQyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxjQUFELENBQW5CLEMsQ0FFQTs7O0FBQ0EsTUFBTUUsTUFBTSxHQUFHLElBQUksRUFBSixHQUFTLEVBQVQsR0FBYyxFQUFkLEdBQW1CLElBQWxDLEMsQ0FDQTs7QUFDQSxNQUFNQyxXQUFXLEdBQUlDLEVBQUQsSUFBUTtBQUN4QixTQUFPSCxHQUFHLENBQUNJLElBQUosQ0FBUztBQUFFRCxJQUFBQTtBQUFGLEdBQVQsRUFBaUJFLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUE3QixFQUEyQztBQUM5Q0MsSUFBQUEsU0FBUyxFQUFFUDtBQURtQyxHQUEzQyxDQUFQO0FBR0gsQ0FKRDs7QUFPTyxNQUFNUSxNQUFNLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEtBQW9CO0FBQ3RDLFFBQU07QUFBRUMsSUFBQUEsTUFBRjtBQUFVQyxJQUFBQSxLQUFWO0FBQWlCQyxJQUFBQTtBQUFqQixNQUE4QkosR0FBRyxDQUFDSyxJQUF4Qzs7QUFDQSxNQUFJO0FBQ0EsVUFBTUMsSUFBSSxHQUFHLE1BQU1sQixJQUFJLENBQUNtQixNQUFMLENBQVk7QUFBRUwsTUFBQUEsTUFBRjtBQUFVQyxNQUFBQSxLQUFWO0FBQWlCQyxNQUFBQTtBQUFqQixLQUFaLENBQW5CO0FBQ0FILElBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVILE1BQUFBLElBQUksRUFBRUEsSUFBSSxDQUFDSTtBQUFiLEtBQXJCO0FBQ0gsR0FIRCxDQUlBLE9BQU9DLEdBQVAsRUFBWTtBQUNSLFVBQU1DLE1BQU0sR0FBRywwQkFBYUQsR0FBYixDQUFmO0FBQ0EsV0FBT1YsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBRUcsTUFBQUE7QUFBRixLQUFyQixDQUFQO0FBQ0g7QUFDSixDQVZNOzs7O0FBWUEsTUFBTUMsTUFBTSxHQUFHLE9BQU9iLEdBQVAsRUFBWUMsR0FBWixLQUFvQjtBQUN0QyxRQUFNO0FBQUVFLElBQUFBLEtBQUY7QUFBU0MsSUFBQUE7QUFBVCxNQUFzQkosR0FBRyxDQUFDSyxJQUFoQzs7QUFDQSxNQUFJO0FBQ0E7QUFDQSxVQUFNQyxJQUFJLEdBQUcsTUFBTWxCLElBQUksQ0FBQzBCLEtBQUwsQ0FBV1gsS0FBWCxFQUFrQkMsUUFBbEIsQ0FBbkIsQ0FGQSxDQUdBOztBQUNBLFVBQU1XLEtBQUssR0FBR3ZCLFdBQVcsQ0FBQ2MsSUFBSSxDQUFDSSxHQUFOLENBQXpCLENBSkEsQ0FLQTs7QUFDQVQsSUFBQUEsR0FBRyxDQUFDZSxNQUFKLENBQVcsS0FBWCxFQUFrQkQsS0FBbEIsRUFBeUI7QUFDckJFLE1BQUFBLGVBQWUsRUFBRSxJQURJO0FBRXJCQyxNQUFBQSxRQUFRLEVBQUUsSUFGVztBQUdyQjNCLE1BQUFBLE1BQU0sRUFBRUE7QUFIYSxLQUF6QjtBQUtBVSxJQUFBQSxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCVyxJQUFoQixDQUFxQjtBQUFFYixNQUFBQSxJQUFJLEVBQUVBLElBQUksQ0FBQ0k7QUFBYixLQUFyQjtBQUNILEdBWkQsQ0FhQSxPQUFPQyxHQUFQLEVBQVk7QUFDUlMsSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlWLEdBQVo7QUFDQSxVQUFNQyxNQUFNLEdBQUcsMEJBQWFELEdBQWIsQ0FBZjtBQUNBLFdBQU9WLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVHLE1BQUFBO0FBQUYsS0FBckIsQ0FBUDtBQUNIO0FBQ0osQ0FwQk07Ozs7QUFzQkEsTUFBTVUsTUFBTSxHQUFHLE9BQU90QixHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFDdENBLEVBQUFBLEdBQUcsQ0FBQ2UsTUFBSixDQUFXLEtBQVgsRUFBa0IsRUFBbEIsRUFBc0I7QUFBRXpCLElBQUFBLE1BQU0sRUFBRTtBQUFWLEdBQXRCO0FBQ0FVLEVBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JXLElBQWhCLENBQXFCO0FBQUVJLElBQUFBLE9BQU8sRUFBRTtBQUFYLEdBQXJCO0FBQ0gsQ0FITSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc3JjL2NvbnRyb2xsZXJzLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlc3BvbnNlIH0gZnJvbSAnZXhwcmVzcydcbmltcG9ydCB7IHNpZ25VcEVycm9ycywgc2lnbkluRXJyb3JzIH0gZnJvbSAnLi4vdXRpbHMvZXJyb3JzLnV0aWxzJ1xuXG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJylcblxuLy9lcXVpdmFsZW50IGRlIDMgam91cnNcbmNvbnN0IG1heEFnZSA9IDMgKiAyNCAqIDYwICogNjAgKiAxMDAwXG4vL2Z1bmN0aW9uIHF1aSBjcsOpZXIgbGUgdG9rZW4gZW4gZm9uY3Rpb24gZCd1bmUgY2zDqSBkZSBjcnlwdGFnZSBxdSdvbiBhdXJhIG1pcyBkYW5zIHZhcmlhYmxlIGQnZW52aXJvbm5lbW1lbnRcbmNvbnN0IGNyZWF0ZVRva2VuID0gKGlkKSA9PiB7XG4gICAgcmV0dXJuIGp3dC5zaWduKHsgaWQgfSwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVULCB7XG4gICAgICAgIGV4cGlyZXNJbjogbWF4QWdlXG4gICAgfSlcbn1cblxuXG5leHBvcnQgY29uc3Qgc2lnblVwID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBwc2V1ZG8sIGVtYWlsLCBwYXNzd29yZCB9ID0gcmVxLmJvZHlcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5jcmVhdGUoeyBwc2V1ZG8sIGVtYWlsLCBwYXNzd29yZCB9KVxuICAgICAgICByZXMuc3RhdHVzKDIwMSkuc2VuZCh7IHVzZXI6IHVzZXIuX2lkIH0pXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc3QgZXJyb3JzID0gc2lnblVwRXJyb3JzKGVycilcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHsgZXJyb3JzIH0pXG4gICAgfVxufVxuXG5leHBvcnQgY29uc3Qgc2lnbkluID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5XG4gICAgdHJ5IHtcbiAgICAgICAgLy9jaGVjayB1c2VyIGV4aXN0IGFuZCBjb21wYXJlIGVtYWlsIHdpdGggcGFzc3dvcmRcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIubG9naW4oZW1haWwsIHBhc3N3b3JkKVxuICAgICAgICAvL2NyZWF0ZSB0b2tlblxuICAgICAgICBjb25zdCB0b2tlbiA9IGNyZWF0ZVRva2VuKHVzZXIuX2lkKVxuICAgICAgICAvL29uIHJldG91cm5lIGxlIHRva2VuIGRhbnMgbGVzIGNvb2tpZXMgYWNjZXNzaWJsZSBzZXVsZW1lbnQgcGFyIGxlIHNlcnZldXJcbiAgICAgICAgcmVzLmNvb2tpZShcImp3dFwiLCB0b2tlbiwge1xuICAgICAgICAgICAgd2l0aENyZWRlbnRpYWxzOiB0cnVlLFxuICAgICAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgICAgICBtYXhBZ2U6IG1heEFnZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgdXNlcjogdXNlci5faWQgfSlcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIGNvbnN0IGVycm9ycyA9IHNpZ25JbkVycm9ycyhlcnIpXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IGVycm9ycyB9KVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGxvZ291dCA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5jb29raWUoJ2p3dCcsICcnLCB7IG1heEFnZTogMSB9KTtcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6IFwiZGlzY29uZWN0XCIgfSlcbn1cblxuIl19","map":{"version":3,"sources":["auth.controller.js"],"names":["User","require","jwt","maxAge","createToken","id","sign","process","env","TOKEN_SECRET","expiresIn","signUp","req","res","pseudo","email","password","body","user","create","status","send","_id","err","errors","signIn","login","token","cookie","withCredentials","httpOnly","json","console","log","logout","message"],"mappings":";;;;;;;AAAA;;AACA;;AAEA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AACA,MAAMC,GAAG,GAAGD,OAAO,CAAC,cAAD,CAAnB,C,CAEA;;;AACA,MAAME,MAAM,GAAG,IAAI,EAAJ,GAAS,EAAT,GAAc,EAAd,GAAmB,IAAlC,C,CACA;;AACA,MAAMC,WAAW,GAAIC,EAAD,IAAQ;AACxB,SAAOH,GAAG,CAACI,IAAJ,CAAS;AAAED,IAAAA;AAAF,GAAT,EAAiBE,OAAO,CAACC,GAAR,CAAYC,YAA7B,EAA2C;AAC9CC,IAAAA,SAAS,EAAEP;AADmC,GAA3C,CAAP;AAGH,CAJD;;AAOO,MAAMQ,MAAM,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACtC,QAAM;AAAEC,IAAAA,MAAF;AAAUC,IAAAA,KAAV;AAAiBC,IAAAA;AAAjB,MAA8BJ,GAAG,CAACK,IAAxC;;AACA,MAAI;AACA,UAAMC,IAAI,GAAG,MAAMlB,IAAI,CAACmB,MAAL,CAAY;AAAEL,MAAAA,MAAF;AAAUC,MAAAA,KAAV;AAAiBC,MAAAA;AAAjB,KAAZ,CAAnB;AACAH,IAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEH,MAAAA,IAAI,EAAEA,IAAI,CAACI;AAAb,KAArB;AACH,GAHD,CAIA,OAAOC,GAAP,EAAY;AACR,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOV,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEG,MAAAA;AAAF,KAArB,CAAP;AACH;AACJ,CAVM;;;;AAYA,MAAMC,MAAM,GAAG,OAAOb,GAAP,EAAYC,GAAZ,KAAoB;AACtC,QAAM;AAAEE,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAsBJ,GAAG,CAACK,IAAhC;;AACA,MAAI;AACA;AACA,UAAMC,IAAI,GAAG,MAAMlB,IAAI,CAAC0B,KAAL,CAAWX,KAAX,EAAkBC,QAAlB,CAAnB,CAFA,CAGA;;AACA,UAAMW,KAAK,GAAGvB,WAAW,CAACc,IAAI,CAACI,GAAN,CAAzB,CAJA,CAKA;;AACAT,IAAAA,GAAG,CAACe,MAAJ,CAAW,KAAX,EAAkBD,KAAlB,EAAyB;AACrBE,MAAAA,eAAe,EAAE,IADI;AAErBC,MAAAA,QAAQ,EAAE,IAFW;AAGrB3B,MAAAA,MAAM,EAAEA;AAHa,KAAzB;AAKAU,IAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB;AAAEb,MAAAA,IAAI,EAAEA,IAAI,CAACI;AAAb,KAArB;AACH,GAZD,CAaA,OAAOC,GAAP,EAAY;AACRS,IAAAA,OAAO,CAACC,GAAR,CAAYV,GAAZ;AACA,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOV,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEG,MAAAA;AAAF,KAArB,CAAP;AACH;AACJ,CApBM;;;;AAsBA,MAAMU,MAAM,GAAG,OAAOtB,GAAP,EAAYC,GAAZ,KAAoB;AACtCA,EAAAA,GAAG,CAACe,MAAJ,CAAW,KAAX,EAAkB,EAAlB,EAAsB;AAAEzB,IAAAA,MAAM,EAAE;AAAV,GAAtB;AACAU,EAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB;AAAEI,IAAAA,OAAO,EAAE;AAAX,GAArB;AACH,CAHM","sourceRoot":"/Applications/dossier/mern_project_app2/src/controllers/","sourcesContent":["import { response } from 'express'\nimport { signUpErrors, signInErrors } from '../utils/errors.utils'\n\nconst User = require('../models/user.model')\nconst jwt = require('jsonwebtoken')\n\n//equivalent de 3 jours\nconst maxAge = 3 * 24 * 60 * 60 * 1000\n//function qui créer le token en fonction d'une clé de cryptage qu'on aura mis dans variable d'environnemment\nconst createToken = (id) => {\n    return jwt.sign({ id }, process.env.TOKEN_SECRET, {\n        expiresIn: maxAge\n    })\n}\n\n\nexport const signUp = async (req, res) => {\n    const { pseudo, email, password } = req.body\n    try {\n        const user = await User.create({ pseudo, email, password })\n        res.status(201).send({ user: user._id })\n    }\n    catch (err) {\n        const errors = signUpErrors(err)\n        return res.status(200).send({ errors })\n    }\n}\n\nexport const signIn = async (req, res) => {\n    const { email, password } = req.body\n    try {\n        //check user exist and compare email with password\n        const user = await User.login(email, password)\n        //create token\n        const token = createToken(user._id)\n        //on retourne le token dans les cookies accessible seulement par le serveur\n        res.cookie(\"jwt\", token, {\n            withCredentials: true,\n            httpOnly: true,\n            maxAge: maxAge,\n        });\n        res.status(200).json({ user: user._id })\n    }\n    catch (err) {\n        console.log(err)\n        const errors = signInErrors(err)\n        return res.status(200).send({ errors })\n    }\n}\n\nexport const logout = async (req, res) => {\n    res.cookie('jwt', '', { maxAge: 1 });\n    res.status(200).json({ message: \"disconect\" })\n}\n\n"]}},"mtime":1651349889429},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/models/user.models.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nconst {\n  isEmail\n} = require('validator');\n\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  pseudo: {\n    type: String,\n    required: true,\n    minlength: 3,\n    maxlength: 55,\n    unique: true,\n    trim: true\n  },\n  email: {\n    type: String,\n    required: true,\n    validate: [isEmail],\n    lowercase: true,\n    unique: true,\n    trim: true\n  },\n  password: {\n    type: String,\n    required: true,\n    max: 1024,\n    minlength: 6\n  },\n  picture: {\n    type: String,\n    default: \"./uploads/profile/random-user.png\"\n  },\n  bio: {\n    type: String,\n    max: 1024\n  },\n  followers: {\n    type: [String]\n  },\n  following: {\n    type: [String]\n  },\n  likes: {\n    type: [String]\n  }\n}, {\n  timestamps: true\n}); //play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\n\nUserSchema.pre('save', async function (next) {\n  const salt = await bcrypt.genSalt();\n  this.password = await bcrypt.hash(this.password, salt);\n  next();\n}); //c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\n\nUserSchema.statics.login = async function (email, password) {\n  const user = await this.findOne({\n    email: email\n  });\n\n  if (user) {\n    const auth = await bcrypt.compare(password, user.password);\n\n    if (auth) {\n      return user;\n    } else {\n      throw Error('Incorrect password');\n    }\n  }\n\n  throw Error('Incorrect password');\n};\n\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIubW9kZWxzLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsImlzRW1haWwiLCJiY3J5cHQiLCJTY2hlbWEiLCJVc2VyU2NoZW1hIiwicHNldWRvIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwibWlubGVuZ3RoIiwibWF4bGVuZ3RoIiwidW5pcXVlIiwidHJpbSIsImVtYWlsIiwidmFsaWRhdGUiLCJsb3dlcmNhc2UiLCJwYXNzd29yZCIsIm1heCIsInBpY3R1cmUiLCJkZWZhdWx0IiwiYmlvIiwiZm9sbG93ZXJzIiwiZm9sbG93aW5nIiwibGlrZXMiLCJ0aW1lc3RhbXBzIiwicHJlIiwibmV4dCIsInNhbHQiLCJnZW5TYWx0IiwiaGFzaCIsInN0YXRpY3MiLCJsb2dpbiIsInVzZXIiLCJmaW5kT25lIiwiYXV0aCIsImNvbXBhcmUiLCJFcnJvciIsIlVzZXIiLCJtb2RlbCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUF4Qjs7QUFDQSxNQUFNO0FBQUNDLEVBQUFBO0FBQUQsSUFBWUQsT0FBTyxDQUFDLFdBQUQsQ0FBekI7O0FBQ0EsTUFBTUUsTUFBTSxHQUFHRixPQUFPLENBQUMsUUFBRCxDQUF0Qjs7QUFFQSxNQUFNRyxNQUFNLEdBQUdKLFFBQVEsQ0FBQ0ksTUFBeEI7QUFDQSxNQUFNQyxVQUFVLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQzFCRSxFQUFBQSxNQUFNLEVBQUU7QUFDSkMsSUFBQUEsSUFBSSxFQUFFQyxNQURGO0FBRUpDLElBQUFBLFFBQVEsRUFBQyxJQUZMO0FBR0pDLElBQUFBLFNBQVMsRUFBRSxDQUhQO0FBSUpDLElBQUFBLFNBQVMsRUFBQyxFQUpOO0FBS0pDLElBQUFBLE1BQU0sRUFBQyxJQUxIO0FBTUpDLElBQUFBLElBQUksRUFBQztBQU5ELEdBRGtCO0FBUzFCQyxFQUFBQSxLQUFLLEVBQUM7QUFDRlAsSUFBQUEsSUFBSSxFQUFDQyxNQURIO0FBRUZDLElBQUFBLFFBQVEsRUFBQyxJQUZQO0FBR0ZNLElBQUFBLFFBQVEsRUFBQyxDQUFDYixPQUFELENBSFA7QUFJRmMsSUFBQUEsU0FBUyxFQUFDLElBSlI7QUFLRkosSUFBQUEsTUFBTSxFQUFDLElBTEw7QUFNRkMsSUFBQUEsSUFBSSxFQUFDO0FBTkgsR0FUb0I7QUFpQjFCSSxFQUFBQSxRQUFRLEVBQUM7QUFDTFYsSUFBQUEsSUFBSSxFQUFDQyxNQURBO0FBRUxDLElBQUFBLFFBQVEsRUFBQyxJQUZKO0FBR0xTLElBQUFBLEdBQUcsRUFBQyxJQUhDO0FBSUxSLElBQUFBLFNBQVMsRUFBQztBQUpMLEdBakJpQjtBQXVCMUJTLEVBQUFBLE9BQU8sRUFBQztBQUNKWixJQUFBQSxJQUFJLEVBQUNDLE1BREQ7QUFFSlksSUFBQUEsT0FBTyxFQUFDO0FBRkosR0F2QmtCO0FBMkIxQkMsRUFBQUEsR0FBRyxFQUFDO0FBQ0FkLElBQUFBLElBQUksRUFBQ0MsTUFETDtBQUVBVSxJQUFBQSxHQUFHLEVBQUM7QUFGSixHQTNCc0I7QUErQjFCSSxFQUFBQSxTQUFTLEVBQUU7QUFDUGYsSUFBQUEsSUFBSSxFQUFDLENBQUNDLE1BQUQ7QUFERSxHQS9CZTtBQWtDMUJlLEVBQUFBLFNBQVMsRUFBQztBQUNOaEIsSUFBQUEsSUFBSSxFQUFDLENBQUNDLE1BQUQ7QUFEQyxHQWxDZ0I7QUFxQzFCZ0IsRUFBQUEsS0FBSyxFQUFFO0FBQ0hqQixJQUFBQSxJQUFJLEVBQUMsQ0FBQ0MsTUFBRDtBQURGO0FBckNtQixDQUFYLEVBd0NoQjtBQUNDaUIsRUFBQUEsVUFBVSxFQUFDO0FBRFosQ0F4Q2dCLENBQW5CLEMsQ0E2Q0E7QUFDQTs7QUFDQXBCLFVBQVUsQ0FBQ3FCLEdBQVgsQ0FBZSxNQUFmLEVBQXVCLGdCQUFnQkMsSUFBaEIsRUFBcUI7QUFDeEMsUUFBTUMsSUFBSSxHQUFHLE1BQU16QixNQUFNLENBQUMwQixPQUFQLEVBQW5CO0FBQ0EsT0FBS1osUUFBTCxHQUFnQixNQUFNZCxNQUFNLENBQUMyQixJQUFQLENBQVksS0FBS2IsUUFBakIsRUFBMkJXLElBQTNCLENBQXRCO0FBQ0FELEVBQUFBLElBQUk7QUFDUCxDQUpELEUsQ0FNQTs7QUFDQXRCLFVBQVUsQ0FBQzBCLE9BQVgsQ0FBbUJDLEtBQW5CLEdBQTJCLGdCQUFlbEIsS0FBZixFQUFzQkcsUUFBdEIsRUFBK0I7QUFDdEQsUUFBTWdCLElBQUksR0FBRyxNQUFNLEtBQUtDLE9BQUwsQ0FBYTtBQUFDcEIsSUFBQUEsS0FBSyxFQUFFQTtBQUFSLEdBQWIsQ0FBbkI7O0FBQ0EsTUFBR21CLElBQUgsRUFBUTtBQUNKLFVBQU1FLElBQUksR0FBRyxNQUFNaEMsTUFBTSxDQUFDaUMsT0FBUCxDQUFlbkIsUUFBZixFQUF5QmdCLElBQUksQ0FBQ2hCLFFBQTlCLENBQW5COztBQUNBLFFBQUdrQixJQUFILEVBQVE7QUFDSixhQUFPRixJQUFQO0FBQ0gsS0FGRCxNQUdJO0FBQ0EsWUFBTUksS0FBSyxDQUFDLG9CQUFELENBQVg7QUFDSDtBQUNKOztBQUNELFFBQU1BLEtBQUssQ0FBQyxvQkFBRCxDQUFYO0FBQ0gsQ0FaRDs7QUFhQSxJQUFJQyxJQUFJLEdBQUd0QyxRQUFRLENBQUN1QyxLQUFULENBQWUsTUFBZixFQUF1QmxDLFVBQXZCLENBQVg7QUFDQW1DLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsSUFBakIiLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9tb2RlbHMvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuY29uc3Qge2lzRW1haWx9ID0gcmVxdWlyZSgndmFsaWRhdG9yJyk7XG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKTtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgVXNlclNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHBzZXVkbzoge1xuICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXG4gICAgICAgIG1pbmxlbmd0aDogMywgXG4gICAgICAgIG1heGxlbmd0aDo1NSwgXG4gICAgICAgIHVuaXF1ZTp0cnVlLFxuICAgICAgICB0cmltOnRydWVcbiAgICB9LFxuICAgIGVtYWlsOntcbiAgICAgICAgdHlwZTpTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXG4gICAgICAgIHZhbGlkYXRlOltpc0VtYWlsXSxcbiAgICAgICAgbG93ZXJjYXNlOnRydWUsICAgICAgICBcbiAgICAgICAgdW5pcXVlOnRydWUsXG4gICAgICAgIHRyaW06dHJ1ZSxcbiAgICB9LFxuICAgIHBhc3N3b3JkOntcbiAgICAgICAgdHlwZTpTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXG4gICAgICAgIG1heDoxMDI0LFxuICAgICAgICBtaW5sZW5ndGg6NlxuICAgIH0sXG4gICAgcGljdHVyZTp7XG4gICAgICAgIHR5cGU6U3RyaW5nLFxuICAgICAgICBkZWZhdWx0OlwiLi91cGxvYWRzL3Byb2ZpbGUvcmFuZG9tLXVzZXIucG5nXCJcbiAgICB9LFxuICAgIGJpbzp7XG4gICAgICAgIHR5cGU6U3RyaW5nLFxuICAgICAgICBtYXg6MTAyNFxuICAgIH0sXG4gICAgZm9sbG93ZXJzOiB7XG4gICAgICAgIHR5cGU6W1N0cmluZ10sXG4gICAgfSxcbiAgICBmb2xsb3dpbmc6e1xuICAgICAgICB0eXBlOltTdHJpbmddLFxuICAgIH0sXG4gICAgbGlrZXM6IHtcbiAgICAgICAgdHlwZTpbU3RyaW5nXSxcbiAgICB9XG59LCB7XG4gICAgdGltZXN0YW1wczp0cnVlXG59XG4pO1xuXG4vL3BsYXkgZnVuY3Rpb24gYmVmb3JlIHNhdmUgaW50byBkYiB0byBhbGxvdyBjcnlwdCBwYXNzd29yZFxuLy8gbGUgbmV4dCB2ZXV0IGRpcmUgcXVhbmQgdCdhIGZpbmkgcGFzc2Ugw6AgbGEgc3VpdGVcblVzZXJTY2hlbWEucHJlKCdzYXZlJywgYXN5bmMgZnVuY3Rpb24gKG5leHQpe1xuICAgIGNvbnN0IHNhbHQgPSBhd2FpdCBiY3J5cHQuZ2VuU2FsdCgpO1xuICAgIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaCh0aGlzLnBhc3N3b3JkLCBzYWx0KTtcbiAgICBuZXh0KCk7XG59KVxuXG4vL2MnZXN0IGNlIHF1aSB2YSBub3VzIHBlcm1ldHRyZSBkZSBjb21wYXJlciBsZSBwYXNzd29yZCBjcnlwdMOpIGRlIG5vdHJlIHVzZXIgZW4gYmFzZSBkZSBkb25uw6llcyBhdmVjIGNlbHVpIHV0aWxpc2UgcGR0IGxlIGxvZ2luIGQndW4gdXNlclxuVXNlclNjaGVtYS5zdGF0aWNzLmxvZ2luID0gYXN5bmMgZnVuY3Rpb24oZW1haWwsIHBhc3N3b3JkKXtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5maW5kT25lKHtlbWFpbDogZW1haWx9KTtcbiAgICBpZih1c2VyKXtcbiAgICAgICAgY29uc3QgYXV0aCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKVxuICAgICAgICBpZihhdXRoKXtcbiAgICAgICAgICAgIHJldHVybiB1c2VyXG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdJbmNvcnJlY3QgcGFzc3dvcmQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aHJvdyBFcnJvcignSW5jb3JyZWN0IHBhc3N3b3JkJyk7XG59XG5sZXQgVXNlciA9IG1vbmdvb3NlLm1vZGVsKCdVc2VyJywgVXNlclNjaGVtYSk7XG5tb2R1bGUuZXhwb3J0cyA9IFVzZXI7Il19","map":{"version":3,"sources":["user.models.js"],"names":["mongoose","require","isEmail","bcrypt","Schema","UserSchema","pseudo","type","String","required","minlength","maxlength","unique","trim","email","validate","lowercase","password","max","picture","default","bio","followers","following","likes","timestamps","pre","next","salt","genSalt","hash","statics","login","user","findOne","auth","compare","Error","User","model","module","exports"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAM;AAACC,EAAAA;AAAD,IAAYD,OAAO,CAAC,WAAD,CAAzB;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,QAAD,CAAtB;;AAEA,MAAMG,MAAM,GAAGJ,QAAQ,CAACI,MAAxB;AACA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CAAW;AAC1BE,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAEC,MADF;AAEJC,IAAAA,QAAQ,EAAC,IAFL;AAGJC,IAAAA,SAAS,EAAE,CAHP;AAIJC,IAAAA,SAAS,EAAC,EAJN;AAKJC,IAAAA,MAAM,EAAC,IALH;AAMJC,IAAAA,IAAI,EAAC;AAND,GADkB;AAS1BC,EAAAA,KAAK,EAAC;AACFP,IAAAA,IAAI,EAACC,MADH;AAEFC,IAAAA,QAAQ,EAAC,IAFP;AAGFM,IAAAA,QAAQ,EAAC,CAACb,OAAD,CAHP;AAIFc,IAAAA,SAAS,EAAC,IAJR;AAKFJ,IAAAA,MAAM,EAAC,IALL;AAMFC,IAAAA,IAAI,EAAC;AANH,GAToB;AAiB1BI,EAAAA,QAAQ,EAAC;AACLV,IAAAA,IAAI,EAACC,MADA;AAELC,IAAAA,QAAQ,EAAC,IAFJ;AAGLS,IAAAA,GAAG,EAAC,IAHC;AAILR,IAAAA,SAAS,EAAC;AAJL,GAjBiB;AAuB1BS,EAAAA,OAAO,EAAC;AACJZ,IAAAA,IAAI,EAACC,MADD;AAEJY,IAAAA,OAAO,EAAC;AAFJ,GAvBkB;AA2B1BC,EAAAA,GAAG,EAAC;AACAd,IAAAA,IAAI,EAACC,MADL;AAEAU,IAAAA,GAAG,EAAC;AAFJ,GA3BsB;AA+B1BI,EAAAA,SAAS,EAAE;AACPf,IAAAA,IAAI,EAAC,CAACC,MAAD;AADE,GA/Be;AAkC1Be,EAAAA,SAAS,EAAC;AACNhB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADC,GAlCgB;AAqC1BgB,EAAAA,KAAK,EAAE;AACHjB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADF;AArCmB,CAAX,EAwChB;AACCiB,EAAAA,UAAU,EAAC;AADZ,CAxCgB,CAAnB,C,CA6CA;AACA;;AACApB,UAAU,CAACqB,GAAX,CAAe,MAAf,EAAuB,gBAAgBC,IAAhB,EAAqB;AACxC,QAAMC,IAAI,GAAG,MAAMzB,MAAM,CAAC0B,OAAP,EAAnB;AACA,OAAKZ,QAAL,GAAgB,MAAMd,MAAM,CAAC2B,IAAP,CAAY,KAAKb,QAAjB,EAA2BW,IAA3B,CAAtB;AACAD,EAAAA,IAAI;AACP,CAJD,E,CAMA;;AACAtB,UAAU,CAAC0B,OAAX,CAAmBC,KAAnB,GAA2B,gBAAelB,KAAf,EAAsBG,QAAtB,EAA+B;AACtD,QAAMgB,IAAI,GAAG,MAAM,KAAKC,OAAL,CAAa;AAACpB,IAAAA,KAAK,EAAEA;AAAR,GAAb,CAAnB;;AACA,MAAGmB,IAAH,EAAQ;AACJ,UAAME,IAAI,GAAG,MAAMhC,MAAM,CAACiC,OAAP,CAAenB,QAAf,EAAyBgB,IAAI,CAAChB,QAA9B,CAAnB;;AACA,QAAGkB,IAAH,EAAQ;AACJ,aAAOF,IAAP;AACH,KAFD,MAGI;AACA,YAAMI,KAAK,CAAC,oBAAD,CAAX;AACH;AACJ;;AACD,QAAMA,KAAK,CAAC,oBAAD,CAAX;AACH,CAZD;;AAaA,IAAIC,IAAI,GAAGtC,QAAQ,CAACuC,KAAT,CAAe,MAAf,EAAuBlC,UAAvB,CAAX;AACAmC,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/src/models/","sourcesContent":["const mongoose = require('mongoose');\nconst {isEmail} = require('validator');\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n    pseudo: {\n        type: String,\n        required:true,\n        minlength: 3, \n        maxlength:55, \n        unique:true,\n        trim:true\n    },\n    email:{\n        type:String,\n        required:true,\n        validate:[isEmail],\n        lowercase:true,        \n        unique:true,\n        trim:true,\n    },\n    password:{\n        type:String,\n        required:true,\n        max:1024,\n        minlength:6\n    },\n    picture:{\n        type:String,\n        default:\"./uploads/profile/random-user.png\"\n    },\n    bio:{\n        type:String,\n        max:1024\n    },\n    followers: {\n        type:[String],\n    },\n    following:{\n        type:[String],\n    },\n    likes: {\n        type:[String],\n    }\n}, {\n    timestamps:true\n}\n);\n\n//play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\nUserSchema.pre('save', async function (next){\n    const salt = await bcrypt.genSalt();\n    this.password = await bcrypt.hash(this.password, salt);\n    next();\n})\n\n//c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\nUserSchema.statics.login = async function(email, password){\n    const user = await this.findOne({email: email});\n    if(user){\n        const auth = await bcrypt.compare(password, user.password)\n        if(auth){\n            return user\n        }\n        else{\n            throw Error('Incorrect password');\n        }\n    }\n    throw Error('Incorrect password');\n}\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;"]}},"mtime":1651271257003},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/db.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nmongoose.connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`).then(() => console.log('Connected to MongoDB')).catch(error => console.log(\"Failed to connect MongoDB\", error));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiREJfVVNFUk5BTUUiLCJEQl9QQVNTV09SRCIsInRoZW4iLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnJvciJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUVBRCxRQUFRLENBQ0hFLE9BREwsQ0FDYyxpQkFBZ0JDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxXQUFZLElBQUdGLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRSxXQUFZLDBDQURqRixFQUVLQyxJQUZMLENBRVUsTUFBTUMsT0FBTyxDQUFDQyxHQUFSLENBQVksc0JBQVosQ0FGaEIsRUFHS0MsS0FITCxDQUdZQyxLQUFELElBQVdILE9BQU8sQ0FBQ0MsR0FBUixDQUFZLDJCQUFaLEVBQXlDRSxLQUF6QyxDQUh0QiIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpXG5cbm1vbmdvb3NlXG4gICAgLmNvbm5lY3QoYG1vbmdvZGIrc3J2Oi8vJHtwcm9jZXNzLmVudi5EQl9VU0VSTkFNRX06JHtwcm9jZXNzLmVudi5EQl9QQVNTV09SRH1AY2x1c3RlcjAuZ2J2eGcubW9uZ29kYi5uZXQvbWVybl9wcm9qZWN0YClcbiAgICAudGhlbigoKSA9PiBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIE1vbmdvREInKSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBjb25uZWN0IE1vbmdvREJcIiwgZXJyb3IpKSJdfQ==","map":{"version":3,"sources":["db.js"],"names":["mongoose","require","connect","process","env","DB_USERNAME","DB_PASSWORD","then","console","log","catch","error"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEAD,QAAQ,CACHE,OADL,CACc,iBAAgBC,OAAO,CAACC,GAAR,CAAYC,WAAY,IAAGF,OAAO,CAACC,GAAR,CAAYE,WAAY,0CADjF,EAEKC,IAFL,CAEU,MAAMC,OAAO,CAACC,GAAR,CAAY,sBAAZ,CAFhB,EAGKC,KAHL,CAGYC,KAAD,IAAWH,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCE,KAAzC,CAHtB","sourceRoot":"/Applications/dossier/mern_project_app2/","sourcesContent":["const mongoose = require('mongoose')\n\nmongoose\n    .connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`)\n    .then(() => console.log('Connected to MongoDB'))\n    .catch((error) => console.log(\"Failed to connect MongoDB\", error))"]}},"mtime":1651231241527},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/database.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nmongoose.connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`).then(() => console.log('Connected to MongoDB')).catch(error => console.log(\"Failed to connect MongoDB\", error));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhdGFiYXNlLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiREJfVVNFUk5BTUUiLCJEQl9QQVNTV09SRCIsInRoZW4iLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnJvciJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUVBRCxRQUFRLENBQ0hFLE9BREwsQ0FDYyxpQkFBZ0JDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxXQUFZLElBQUdGLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRSxXQUFZLDBDQURqRixFQUVLQyxJQUZMLENBRVUsTUFBTUMsT0FBTyxDQUFDQyxHQUFSLENBQVksc0JBQVosQ0FGaEIsRUFHS0MsS0FITCxDQUdZQyxLQUFELElBQVdILE9BQU8sQ0FBQ0MsR0FBUixDQUFZLDJCQUFaLEVBQXlDRSxLQUF6QyxDQUh0QiIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpXG5cbm1vbmdvb3NlXG4gICAgLmNvbm5lY3QoYG1vbmdvZGIrc3J2Oi8vJHtwcm9jZXNzLmVudi5EQl9VU0VSTkFNRX06JHtwcm9jZXNzLmVudi5EQl9QQVNTV09SRH1AY2x1c3RlcjAuZ2J2eGcubW9uZ29kYi5uZXQvbWVybl9wcm9qZWN0YClcbiAgICAudGhlbigoKSA9PiBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIE1vbmdvREInKSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBjb25uZWN0IE1vbmdvREJcIiwgZXJyb3IpKSJdfQ==","map":{"version":3,"sources":["database.js"],"names":["mongoose","require","connect","process","env","DB_USERNAME","DB_PASSWORD","then","console","log","catch","error"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEAD,QAAQ,CACHE,OADL,CACc,iBAAgBC,OAAO,CAACC,GAAR,CAAYC,WAAY,IAAGF,OAAO,CAACC,GAAR,CAAYE,WAAY,0CADjF,EAEKC,IAFL,CAEU,MAAMC,OAAO,CAACC,GAAR,CAAY,sBAAZ,CAFhB,EAGKC,KAHL,CAGYC,KAAD,IAAWH,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCE,KAAzC,CAHtB","sourceRoot":"/Applications/dossier/mern_project_app2/","sourcesContent":["const mongoose = require('mongoose')\n\nmongoose\n    .connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`)\n    .then(() => console.log('Connected to MongoDB'))\n    .catch((error) => console.log(\"Failed to connect MongoDB\", error))"]}},"mtime":1651231241527},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/database.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nmongoose.connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`).then(() => console.log('Connected to MongoDB')).catch(error => console.log(\"Failed to connect MongoDB\", error));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhdGFiYXNlLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiREJfVVNFUk5BTUUiLCJEQl9QQVNTV09SRCIsInRoZW4iLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnJvciJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUVBRCxRQUFRLENBQ0hFLE9BREwsQ0FDYyxpQkFBZ0JDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxXQUFZLElBQUdGLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRSxXQUFZLDBDQURqRixFQUVLQyxJQUZMLENBRVUsTUFBTUMsT0FBTyxDQUFDQyxHQUFSLENBQVksc0JBQVosQ0FGaEIsRUFHS0MsS0FITCxDQUdZQyxLQUFELElBQVdILE9BQU8sQ0FBQ0MsR0FBUixDQUFZLDJCQUFaLEVBQXlDRSxLQUF6QyxDQUh0QiIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpXG5cbm1vbmdvb3NlXG4gICAgLmNvbm5lY3QoYG1vbmdvZGIrc3J2Oi8vJHtwcm9jZXNzLmVudi5EQl9VU0VSTkFNRX06JHtwcm9jZXNzLmVudi5EQl9QQVNTV09SRH1AY2x1c3RlcjAuZ2J2eGcubW9uZ29kYi5uZXQvbWVybl9wcm9qZWN0YClcbiAgICAudGhlbigoKSA9PiBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIE1vbmdvREInKSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBjb25uZWN0IE1vbmdvREJcIiwgZXJyb3IpKSJdfQ==","map":{"version":3,"sources":["database.js"],"names":["mongoose","require","connect","process","env","DB_USERNAME","DB_PASSWORD","then","console","log","catch","error"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEAD,QAAQ,CACHE,OADL,CACc,iBAAgBC,OAAO,CAACC,GAAR,CAAYC,WAAY,IAAGF,OAAO,CAACC,GAAR,CAAYE,WAAY,0CADjF,EAEKC,IAFL,CAEU,MAAMC,OAAO,CAACC,GAAR,CAAY,sBAAZ,CAFhB,EAGKC,KAHL,CAGYC,KAAD,IAAWH,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCE,KAAzC,CAHtB","sourceRoot":"/Applications/dossier/mern_project_app2/","sourcesContent":["const mongoose = require('mongoose')\n\nmongoose\n    .connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`)\n    .then(() => console.log('Connected to MongoDB'))\n    .catch((error) => console.log(\"Failed to connect MongoDB\", error))"]}},"mtime":1651231241527},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/routes/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/routes/api/user.routes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst router = require(\"express\").Router();\n\nconst authController = require('../../controllers/auth.controller');\n\nrouter.post('/register', authController.signUp);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIucm91dGVzLmpzIl0sIm5hbWVzIjpbInJvdXRlciIsInJlcXVpcmUiLCJSb3V0ZXIiLCJhdXRoQ29udHJvbGxlciIsInBvc3QiLCJzaWduVXAiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE1BQU0sR0FBR0MsT0FBTyxDQUFDLFNBQUQsQ0FBUCxDQUFtQkMsTUFBbkIsRUFBZjs7QUFDQSxNQUFNQyxjQUFjLEdBQUdGLE9BQU8sQ0FBQyxtQ0FBRCxDQUE5Qjs7QUFFQUQsTUFBTSxDQUFDSSxJQUFQLENBQVksV0FBWixFQUF5QkQsY0FBYyxDQUFDRSxNQUF4QztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJQLE1BQWpCIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvcm91dGVzL2FwaS8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCByb3V0ZXIgPSByZXF1aXJlKFwiZXhwcmVzc1wiKS5Sb3V0ZXIoKTtcbmNvbnN0IGF1dGhDb250cm9sbGVyID0gcmVxdWlyZSgnLi4vLi4vY29udHJvbGxlcnMvYXV0aC5jb250cm9sbGVyJylcblxucm91dGVyLnBvc3QoJy9yZWdpc3RlcicsIGF1dGhDb250cm9sbGVyLnNpZ25VcCk7XG5cbm1vZHVsZS5leHBvcnRzID0gcm91dGVyOyJdfQ==","map":{"version":3,"sources":["user.routes.js"],"names":["router","require","Router","authController","post","signUp","module","exports"],"mappings":";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,SAAD,CAAP,CAAmBC,MAAnB,EAAf;;AACA,MAAMC,cAAc,GAAGF,OAAO,CAAC,mCAAD,CAA9B;;AAEAD,MAAM,CAACI,IAAP,CAAY,WAAZ,EAAyBD,cAAc,CAACE,MAAxC;AAEAC,MAAM,CAACC,OAAP,GAAiBP,MAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/src/routes/api/","sourcesContent":["const router = require(\"express\").Router();\nconst authController = require('../../controllers/auth.controller')\n\nrouter.post('/register', authController.signUp);\n\nmodule.exports = router;"]}},"mtime":1651234921473},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/routes/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/routes/api/user.routes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst router = require(\"express\").Router();\n\nconst authController = require('../../controllers/auth.controller');\n\nrouter.post('/register', authController.signUp);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIucm91dGVzLmpzIl0sIm5hbWVzIjpbInJvdXRlciIsInJlcXVpcmUiLCJSb3V0ZXIiLCJhdXRoQ29udHJvbGxlciIsInBvc3QiLCJzaWduVXAiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE1BQU0sR0FBR0MsT0FBTyxDQUFDLFNBQUQsQ0FBUCxDQUFtQkMsTUFBbkIsRUFBZjs7QUFDQSxNQUFNQyxjQUFjLEdBQUdGLE9BQU8sQ0FBQyxtQ0FBRCxDQUE5Qjs7QUFFQUQsTUFBTSxDQUFDSSxJQUFQLENBQVksV0FBWixFQUF5QkQsY0FBYyxDQUFDRSxNQUF4QztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJQLE1BQWpCIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvcm91dGVzL2FwaS8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCByb3V0ZXIgPSByZXF1aXJlKFwiZXhwcmVzc1wiKS5Sb3V0ZXIoKTtcbmNvbnN0IGF1dGhDb250cm9sbGVyID0gcmVxdWlyZSgnLi4vLi4vY29udHJvbGxlcnMvYXV0aC5jb250cm9sbGVyJylcblxucm91dGVyLnBvc3QoJy9yZWdpc3RlcicsIGF1dGhDb250cm9sbGVyLnNpZ25VcCk7XG5cbm1vZHVsZS5leHBvcnRzID0gcm91dGVyOyJdfQ==","map":{"version":3,"sources":["user.routes.js"],"names":["router","require","Router","authController","post","signUp","module","exports"],"mappings":";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,SAAD,CAAP,CAAmBC,MAAnB,EAAf;;AACA,MAAMC,cAAc,GAAGF,OAAO,CAAC,mCAAD,CAA9B;;AAEAD,MAAM,CAACI,IAAP,CAAY,WAAZ,EAAyBD,cAAc,CAACE,MAAxC;AAEAC,MAAM,CAACC,OAAP,GAAiBP,MAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/src/routes/api/","sourcesContent":["const router = require(\"express\").Router();\nconst authController = require('../../controllers/auth.controller')\n\nrouter.post('/register', authController.signUp);\n\nmodule.exports = router;"]}},"mtime":1651234921473},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/routes/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/routes/api/user.route.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar AuthController = _interopRequireWildcard(require(\"../../controllers/auth.controller\"));\n\nvar UserController = _interopRequireWildcard(require(\"../../controllers/user.controller\"));\n\nvar UploadController = _interopRequireWildcard(require(\"../../controllers/upload.controller\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst multer = require('multer');\n\nconst fileStorageEngine = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, `${__dirname}/../../../client/public/uploads/profil`);\n  },\n  filename: function (req, file, cb) {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    let originalNameFile = file.originalname;\n    let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1);\n    cb(null, file.fieldname + '-' + uniqueSuffix + \".\" + extension);\n  }\n});\nconst upload = multer({\n  storage: fileStorageEngine\n});\nconst api = (0, _express.Router)(); //auth\n\napi.post('/register', AuthController.signUp);\napi.post('/login', AuthController.signIn);\napi.get('/logout', AuthController.logout); //user\n\napi.get('/', UserController.getAllUsers);\napi.get('/:id', UserController.getUserInfo);\napi.put('/:id', UserController.updateUser);\napi.delete('/:id', UserController.deleteUser);\napi.patch('/follow/:id', UserController.follow);\napi.patch('/unfollow/:id', UserController.unfollow); //upload\n//avant de passer à notre controlleur il va check notre file\n\napi.post('/upload', upload.single(\"file\"), UploadController.uploadProfil);\nvar _default = api;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIucm91dGUuanMiXSwibmFtZXMiOlsibXVsdGVyIiwicmVxdWlyZSIsImZpbGVTdG9yYWdlRW5naW5lIiwiZGlza1N0b3JhZ2UiLCJkZXN0aW5hdGlvbiIsInJlcSIsImZpbGUiLCJjYiIsIl9fZGlybmFtZSIsImZpbGVuYW1lIiwidW5pcXVlU3VmZml4IiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm9yaWdpbmFsTmFtZUZpbGUiLCJvcmlnaW5hbG5hbWUiLCJleHRlbnNpb24iLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsImZpZWxkbmFtZSIsInVwbG9hZCIsInN0b3JhZ2UiLCJhcGkiLCJwb3N0IiwiQXV0aENvbnRyb2xsZXIiLCJzaWduVXAiLCJzaWduSW4iLCJnZXQiLCJsb2dvdXQiLCJVc2VyQ29udHJvbGxlciIsImdldEFsbFVzZXJzIiwiZ2V0VXNlckluZm8iLCJwdXQiLCJ1cGRhdGVVc2VyIiwiZGVsZXRlIiwiZGVsZXRlVXNlciIsInBhdGNoIiwiZm9sbG93IiwidW5mb2xsb3ciLCJzaW5nbGUiLCJVcGxvYWRDb250cm9sbGVyIiwidXBsb2FkUHJvZmlsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7OztBQUNBLE1BQU1BLE1BQU0sR0FBSUMsT0FBTyxDQUFDLFFBQUQsQ0FBdkI7O0FBRUEsTUFBTUMsaUJBQWlCLEdBQUdGLE1BQU0sQ0FBQ0csV0FBUCxDQUFtQjtBQUN6Q0MsRUFBQUEsV0FBVyxFQUFDLENBQUNDLEdBQUQsRUFBTUMsSUFBTixFQUFZQyxFQUFaLEtBQW1CO0FBQzNCQSxJQUFBQSxFQUFFLENBQUMsSUFBRCxFQUFRLEdBQUVDLFNBQVUsd0NBQXBCLENBQUY7QUFDSCxHQUh3QztBQUl6Q0MsRUFBQUEsUUFBUSxFQUFFLFVBQVVKLEdBQVYsRUFBZUMsSUFBZixFQUFxQkMsRUFBckIsRUFBeUI7QUFDL0IsVUFBTUcsWUFBWSxHQUFHQyxJQUFJLENBQUNDLEdBQUwsS0FBYSxHQUFiLEdBQW1CQyxJQUFJLENBQUNDLEtBQUwsQ0FBV0QsSUFBSSxDQUFDRSxNQUFMLEtBQWdCLEdBQTNCLENBQXhDO0FBQ0EsUUFBSUMsZ0JBQWdCLEdBQUdWLElBQUksQ0FBQ1csWUFBNUI7QUFDQSxRQUFJQyxTQUFTLEdBQUdGLGdCQUFnQixDQUFDRyxTQUFqQixDQUEyQkgsZ0JBQWdCLENBQUNJLFdBQWpCLENBQTZCLEdBQTdCLElBQW9DLENBQS9ELENBQWhCO0FBQ0FiLElBQUFBLEVBQUUsQ0FBQyxJQUFELEVBQU9ELElBQUksQ0FBQ2UsU0FBTCxHQUFpQixHQUFqQixHQUF1QlgsWUFBdkIsR0FBc0MsR0FBdEMsR0FBMkNRLFNBQWxELENBQUY7QUFDRDtBQVRzQyxDQUFuQixDQUExQjtBQVlBLE1BQU1JLE1BQU0sR0FBR3RCLE1BQU0sQ0FBQztBQUFDdUIsRUFBQUEsT0FBTyxFQUFDckI7QUFBVCxDQUFELENBQXJCO0FBRUEsTUFBTXNCLEdBQUcsR0FBRyxzQkFBWixDLENBRUE7O0FBQ0FBLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLFdBQVQsRUFBc0JDLGNBQWMsQ0FBQ0MsTUFBckM7QUFDQUgsR0FBRyxDQUFDQyxJQUFKLENBQVMsUUFBVCxFQUFtQkMsY0FBYyxDQUFDRSxNQUFsQztBQUNBSixHQUFHLENBQUNLLEdBQUosQ0FBUSxTQUFSLEVBQW1CSCxjQUFjLENBQUNJLE1BQWxDLEUsQ0FFQTs7QUFDQU4sR0FBRyxDQUFDSyxHQUFKLENBQVEsR0FBUixFQUFhRSxjQUFjLENBQUNDLFdBQTVCO0FBQ0FSLEdBQUcsQ0FBQ0ssR0FBSixDQUFRLE1BQVIsRUFBZ0JFLGNBQWMsQ0FBQ0UsV0FBL0I7QUFDQVQsR0FBRyxDQUFDVSxHQUFKLENBQVEsTUFBUixFQUFnQkgsY0FBYyxDQUFDSSxVQUEvQjtBQUNBWCxHQUFHLENBQUNZLE1BQUosQ0FBVyxNQUFYLEVBQW1CTCxjQUFjLENBQUNNLFVBQWxDO0FBQ0FiLEdBQUcsQ0FBQ2MsS0FBSixDQUFVLGFBQVYsRUFBeUJQLGNBQWMsQ0FBQ1EsTUFBeEM7QUFDQWYsR0FBRyxDQUFDYyxLQUFKLENBQVUsZUFBVixFQUEyQlAsY0FBYyxDQUFDUyxRQUExQyxFLENBR0E7QUFDQTs7QUFDQWhCLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLFNBQVQsRUFBb0JILE1BQU0sQ0FBQ21CLE1BQVAsQ0FBYyxNQUFkLENBQXBCLEVBQTRDQyxnQkFBZ0IsQ0FBQ0MsWUFBN0Q7ZUFFZW5CLEciLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9yb3V0ZXMvYXBpLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJvdXRlciB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0ICogYXMgQXV0aENvbnRyb2xsZXIgZnJvbSAnLi4vLi4vY29udHJvbGxlcnMvYXV0aC5jb250cm9sbGVyJztcbmltcG9ydCAqIGFzIFVzZXJDb250cm9sbGVyIGZyb20gJy4uLy4uL2NvbnRyb2xsZXJzL3VzZXIuY29udHJvbGxlcic7XG5pbXBvcnQgKiBhcyBVcGxvYWRDb250cm9sbGVyIGZyb20gJy4uLy4uL2NvbnRyb2xsZXJzL3VwbG9hZC5jb250cm9sbGVyJztcbmNvbnN0IG11bHRlciAgPSByZXF1aXJlKCdtdWx0ZXInKVxuXG5jb25zdCBmaWxlU3RvcmFnZUVuZ2luZSA9IG11bHRlci5kaXNrU3RvcmFnZSh7XG4gICAgZGVzdGluYXRpb246KHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAgICAgY2IobnVsbCwgYCR7X19kaXJuYW1lfS8uLi8uLi8uLi9jbGllbnQvcHVibGljL3VwbG9hZHMvcHJvZmlsYClcbiAgICB9LFxuICAgIGZpbGVuYW1lOiBmdW5jdGlvbiAocmVxLCBmaWxlLCBjYikge1xuICAgICAgICBjb25zdCB1bmlxdWVTdWZmaXggPSBEYXRlLm5vdygpICsgJy0nICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMUU5KVxuICAgICAgICBsZXQgb3JpZ2luYWxOYW1lRmlsZSA9IGZpbGUub3JpZ2luYWxuYW1lO1xuICAgICAgICBsZXQgZXh0ZW5zaW9uID0gb3JpZ2luYWxOYW1lRmlsZS5zdWJzdHJpbmcob3JpZ2luYWxOYW1lRmlsZS5sYXN0SW5kZXhPZignLicpICsgMSk7IFxuICAgICAgICBjYihudWxsLCBmaWxlLmZpZWxkbmFtZSArICctJyArIHVuaXF1ZVN1ZmZpeCArIFwiLlwiKyBleHRlbnNpb24gKVxuICAgICAgfVxufSk7XG5cbmNvbnN0IHVwbG9hZCA9IG11bHRlcih7c3RvcmFnZTpmaWxlU3RvcmFnZUVuZ2luZX0pXG5cbmNvbnN0IGFwaSA9IFJvdXRlcigpO1xuXG4vL2F1dGhcbmFwaS5wb3N0KCcvcmVnaXN0ZXInLCBBdXRoQ29udHJvbGxlci5zaWduVXApO1xuYXBpLnBvc3QoJy9sb2dpbicsIEF1dGhDb250cm9sbGVyLnNpZ25Jbik7XG5hcGkuZ2V0KCcvbG9nb3V0JywgQXV0aENvbnRyb2xsZXIubG9nb3V0KTtcblxuLy91c2VyXG5hcGkuZ2V0KCcvJywgVXNlckNvbnRyb2xsZXIuZ2V0QWxsVXNlcnMpO1xuYXBpLmdldCgnLzppZCcsIFVzZXJDb250cm9sbGVyLmdldFVzZXJJbmZvKTtcbmFwaS5wdXQoJy86aWQnLCBVc2VyQ29udHJvbGxlci51cGRhdGVVc2VyKTtcbmFwaS5kZWxldGUoJy86aWQnLCBVc2VyQ29udHJvbGxlci5kZWxldGVVc2VyKTtcbmFwaS5wYXRjaCgnL2ZvbGxvdy86aWQnLCBVc2VyQ29udHJvbGxlci5mb2xsb3cpO1xuYXBpLnBhdGNoKCcvdW5mb2xsb3cvOmlkJywgVXNlckNvbnRyb2xsZXIudW5mb2xsb3cpO1xuXG5cbi8vdXBsb2FkXG4vL2F2YW50IGRlIHBhc3NlciDDoCBub3RyZSBjb250cm9sbGV1ciBpbCB2YSBjaGVjayBub3RyZSBmaWxlXG5hcGkucG9zdCgnL3VwbG9hZCcsIHVwbG9hZC5zaW5nbGUoXCJmaWxlXCIpLCAgVXBsb2FkQ29udHJvbGxlci51cGxvYWRQcm9maWwpXG5cbmV4cG9ydCBkZWZhdWx0IGFwaTsiXX0=","map":{"version":3,"sources":["user.route.js"],"names":["multer","require","fileStorageEngine","diskStorage","destination","req","file","cb","__dirname","filename","uniqueSuffix","Date","now","Math","round","random","originalNameFile","originalname","extension","substring","lastIndexOf","fieldname","upload","storage","api","post","AuthController","signUp","signIn","get","logout","UserController","getAllUsers","getUserInfo","put","updateUser","delete","deleteUser","patch","follow","unfollow","single","UploadController","uploadProfil"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;AACA,MAAMA,MAAM,GAAIC,OAAO,CAAC,QAAD,CAAvB;;AAEA,MAAMC,iBAAiB,GAAGF,MAAM,CAACG,WAAP,CAAmB;AACzCC,EAAAA,WAAW,EAAC,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,KAAmB;AAC3BA,IAAAA,EAAE,CAAC,IAAD,EAAQ,GAAEC,SAAU,wCAApB,CAAF;AACH,GAHwC;AAIzCC,EAAAA,QAAQ,EAAE,UAAUJ,GAAV,EAAeC,IAAf,EAAqBC,EAArB,EAAyB;AAC/B,UAAMG,YAAY,GAAGC,IAAI,CAACC,GAAL,KAAa,GAAb,GAAmBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAAxC;AACA,QAAIC,gBAAgB,GAAGV,IAAI,CAACW,YAA5B;AACA,QAAIC,SAAS,GAAGF,gBAAgB,CAACG,SAAjB,CAA2BH,gBAAgB,CAACI,WAAjB,CAA6B,GAA7B,IAAoC,CAA/D,CAAhB;AACAb,IAAAA,EAAE,CAAC,IAAD,EAAOD,IAAI,CAACe,SAAL,GAAiB,GAAjB,GAAuBX,YAAvB,GAAsC,GAAtC,GAA2CQ,SAAlD,CAAF;AACD;AATsC,CAAnB,CAA1B;AAYA,MAAMI,MAAM,GAAGtB,MAAM,CAAC;AAACuB,EAAAA,OAAO,EAACrB;AAAT,CAAD,CAArB;AAEA,MAAMsB,GAAG,GAAG,sBAAZ,C,CAEA;;AACAA,GAAG,CAACC,IAAJ,CAAS,WAAT,EAAsBC,cAAc,CAACC,MAArC;AACAH,GAAG,CAACC,IAAJ,CAAS,QAAT,EAAmBC,cAAc,CAACE,MAAlC;AACAJ,GAAG,CAACK,GAAJ,CAAQ,SAAR,EAAmBH,cAAc,CAACI,MAAlC,E,CAEA;;AACAN,GAAG,CAACK,GAAJ,CAAQ,GAAR,EAAaE,cAAc,CAACC,WAA5B;AACAR,GAAG,CAACK,GAAJ,CAAQ,MAAR,EAAgBE,cAAc,CAACE,WAA/B;AACAT,GAAG,CAACU,GAAJ,CAAQ,MAAR,EAAgBH,cAAc,CAACI,UAA/B;AACAX,GAAG,CAACY,MAAJ,CAAW,MAAX,EAAmBL,cAAc,CAACM,UAAlC;AACAb,GAAG,CAACc,KAAJ,CAAU,aAAV,EAAyBP,cAAc,CAACQ,MAAxC;AACAf,GAAG,CAACc,KAAJ,CAAU,eAAV,EAA2BP,cAAc,CAACS,QAA1C,E,CAGA;AACA;;AACAhB,GAAG,CAACC,IAAJ,CAAS,SAAT,EAAoBH,MAAM,CAACmB,MAAP,CAAc,MAAd,CAApB,EAA4CC,gBAAgB,CAACC,YAA7D;eAEenB,G","sourceRoot":"/Applications/dossier/mern_project_app2/src/routes/api/","sourcesContent":["import { Router } from 'express';\nimport * as AuthController from '../../controllers/auth.controller';\nimport * as UserController from '../../controllers/user.controller';\nimport * as UploadController from '../../controllers/upload.controller';\nconst multer  = require('multer')\n\nconst fileStorageEngine = multer.diskStorage({\n    destination:(req, file, cb) => {\n        cb(null, `${__dirname}/../../../client/public/uploads/profil`)\n    },\n    filename: function (req, file, cb) {\n        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)\n        let originalNameFile = file.originalname;\n        let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1); \n        cb(null, file.fieldname + '-' + uniqueSuffix + \".\"+ extension )\n      }\n});\n\nconst upload = multer({storage:fileStorageEngine})\n\nconst api = Router();\n\n//auth\napi.post('/register', AuthController.signUp);\napi.post('/login', AuthController.signIn);\napi.get('/logout', AuthController.logout);\n\n//user\napi.get('/', UserController.getAllUsers);\napi.get('/:id', UserController.getUserInfo);\napi.put('/:id', UserController.updateUser);\napi.delete('/:id', UserController.deleteUser);\napi.patch('/follow/:id', UserController.follow);\napi.patch('/unfollow/:id', UserController.unfollow);\n\n\n//upload\n//avant de passer à notre controlleur il va check notre file\napi.post('/upload', upload.single(\"file\"),  UploadController.uploadProfil)\n\nexport default api;"]}},"mtime":1651289820854},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar _user = _interopRequireDefault(require(\"./api/user.route\"));\n\nvar _post = _interopRequireDefault(require(\"./api/post.route\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst router = (0, _express.Router)();\nrouter.use('/api/user', _user.default);\nrouter.use('/api/post', _post.default);\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJvdXRlciIsInVzZSIsIlVzZXJSb3V0ZXIiLCJQb3N0Um91dGVyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7Ozs7QUFDQSxNQUFNQSxNQUFNLEdBQUcsc0JBQWY7QUFFQUEsTUFBTSxDQUFDQyxHQUFQLENBQVcsV0FBWCxFQUF3QkMsYUFBeEI7QUFDQUYsTUFBTSxDQUFDQyxHQUFQLENBQVcsV0FBWCxFQUF5QkUsYUFBekI7ZUFFZUgsTSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc3JjL3JvdXRlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdleHByZXNzJztcbmltcG9ydCBVc2VyUm91dGVyIGZyb20gJy4vYXBpL3VzZXIucm91dGUnO1xuaW1wb3J0IFBvc3RSb3V0ZXIgZnJvbSAnLi9hcGkvcG9zdC5yb3V0ZSc7XG5jb25zdCByb3V0ZXIgPSBSb3V0ZXIoKTtcblxucm91dGVyLnVzZSgnL2FwaS91c2VyJywgVXNlclJvdXRlcik7XG5yb3V0ZXIudXNlKCcvYXBpL3Bvc3QnLCAgUG9zdFJvdXRlcik7XG5cbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjtcbiJdfQ==","map":{"version":3,"sources":["index.js"],"names":["router","use","UserRouter","PostRouter"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,MAAM,GAAG,sBAAf;AAEAA,MAAM,CAACC,GAAP,CAAW,WAAX,EAAwBC,aAAxB;AACAF,MAAM,CAACC,GAAP,CAAW,WAAX,EAAyBE,aAAzB;eAEeH,M","sourceRoot":"/Applications/dossier/mern_project_app2/src/routes/","sourcesContent":["import { Router } from 'express';\nimport UserRouter from './api/user.route';\nimport PostRouter from './api/post.route';\nconst router = Router();\n\nrouter.use('/api/user', UserRouter);\nrouter.use('/api/post',  PostRouter);\n\nexport default router;\n"]}},"mtime":1651607818943},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar _user = _interopRequireDefault(require(\"./api/user.route\"));\n\nvar _post = _interopRequireDefault(require(\"./api/post.route\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst router = (0, _express.Router)();\nrouter.use('/api/user', _user.default);\nrouter.use('/api/post', _post.default);\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJvdXRlciIsInVzZSIsIlVzZXJSb3V0ZXIiLCJQb3N0Um91dGVyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7Ozs7QUFDQSxNQUFNQSxNQUFNLEdBQUcsc0JBQWY7QUFFQUEsTUFBTSxDQUFDQyxHQUFQLENBQVcsV0FBWCxFQUF3QkMsYUFBeEI7QUFDQUYsTUFBTSxDQUFDQyxHQUFQLENBQVcsV0FBWCxFQUF5QkUsYUFBekI7ZUFFZUgsTSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc3JjL3JvdXRlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdleHByZXNzJztcbmltcG9ydCBVc2VyUm91dGVyIGZyb20gJy4vYXBpL3VzZXIucm91dGUnO1xuaW1wb3J0IFBvc3RSb3V0ZXIgZnJvbSAnLi9hcGkvcG9zdC5yb3V0ZSc7XG5jb25zdCByb3V0ZXIgPSBSb3V0ZXIoKTtcblxucm91dGVyLnVzZSgnL2FwaS91c2VyJywgVXNlclJvdXRlcik7XG5yb3V0ZXIudXNlKCcvYXBpL3Bvc3QnLCAgUG9zdFJvdXRlcik7XG5cbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjtcbiJdfQ==","map":{"version":3,"sources":["index.js"],"names":["router","use","UserRouter","PostRouter"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,MAAM,GAAG,sBAAf;AAEAA,MAAM,CAACC,GAAP,CAAW,WAAX,EAAwBC,aAAxB;AACAF,MAAM,CAACC,GAAP,CAAW,WAAX,EAAyBE,aAAzB;eAEeH,M","sourceRoot":"/Applications/dossier/mern_project_app2/src/routes/","sourcesContent":["import { Router } from 'express';\nimport UserRouter from './api/user.route';\nimport PostRouter from './api/post.route';\nconst router = Router();\n\nrouter.use('/api/user', UserRouter);\nrouter.use('/api/post',  PostRouter);\n\nexport default router;\n"]}},"mtime":1651607818943},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/routes/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/routes/api/user.route.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar AuthController = _interopRequireWildcard(require(\"../../controllers/auth.controller\"));\n\nvar UserController = _interopRequireWildcard(require(\"../../controllers/user.controller\"));\n\nvar UploadController = _interopRequireWildcard(require(\"../../controllers/upload.controller\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst multer = require('multer');\n\nconst fileStorageEngine = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, `${__dirname}/../../../assets/uploads/profils`);\n  },\n  filename: function (req, file, cb) {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    let originalNameFile = file.originalname;\n    let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1);\n    cb(null, file.fieldname + '-' + uniqueSuffix + \".\" + extension);\n  }\n});\nconst upload = multer({\n  storage: fileStorageEngine\n});\nconst api = (0, _express.Router)(); //auth\n\napi.post('/register', AuthController.signUp);\napi.post('/login', AuthController.signIn);\napi.get('/logout', AuthController.logout); //user\n\napi.get('/', UserController.getAllUsers);\napi.get('/:id', UserController.getUserInfo);\napi.put('/:id', UserController.updateUser);\napi.delete('/:id', UserController.deleteUser);\napi.patch('/follow/:id', UserController.follow);\napi.patch('/unfollow/:id', UserController.unfollow); //upload\n//avant de passer à notre controlleur il va check notre file\n\napi.post('/upload', upload.single(\"file\"), UploadController.uploadProfil);\nvar _default = api;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIucm91dGUuanMiXSwibmFtZXMiOlsibXVsdGVyIiwicmVxdWlyZSIsImZpbGVTdG9yYWdlRW5naW5lIiwiZGlza1N0b3JhZ2UiLCJkZXN0aW5hdGlvbiIsInJlcSIsImZpbGUiLCJjYiIsIl9fZGlybmFtZSIsImZpbGVuYW1lIiwidW5pcXVlU3VmZml4IiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm9yaWdpbmFsTmFtZUZpbGUiLCJvcmlnaW5hbG5hbWUiLCJleHRlbnNpb24iLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsImZpZWxkbmFtZSIsInVwbG9hZCIsInN0b3JhZ2UiLCJhcGkiLCJwb3N0IiwiQXV0aENvbnRyb2xsZXIiLCJzaWduVXAiLCJzaWduSW4iLCJnZXQiLCJsb2dvdXQiLCJVc2VyQ29udHJvbGxlciIsImdldEFsbFVzZXJzIiwiZ2V0VXNlckluZm8iLCJwdXQiLCJ1cGRhdGVVc2VyIiwiZGVsZXRlIiwiZGVsZXRlVXNlciIsInBhdGNoIiwiZm9sbG93IiwidW5mb2xsb3ciLCJzaW5nbGUiLCJVcGxvYWRDb250cm9sbGVyIiwidXBsb2FkUHJvZmlsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7OztBQUNBLE1BQU1BLE1BQU0sR0FBSUMsT0FBTyxDQUFDLFFBQUQsQ0FBdkI7O0FBRUEsTUFBTUMsaUJBQWlCLEdBQUdGLE1BQU0sQ0FBQ0csV0FBUCxDQUFtQjtBQUN6Q0MsRUFBQUEsV0FBVyxFQUFDLENBQUNDLEdBQUQsRUFBTUMsSUFBTixFQUFZQyxFQUFaLEtBQW1CO0FBQzNCQSxJQUFBQSxFQUFFLENBQUMsSUFBRCxFQUFRLEdBQUVDLFNBQVUsa0NBQXBCLENBQUY7QUFDSCxHQUh3QztBQUl6Q0MsRUFBQUEsUUFBUSxFQUFFLFVBQVVKLEdBQVYsRUFBZUMsSUFBZixFQUFxQkMsRUFBckIsRUFBeUI7QUFDL0IsVUFBTUcsWUFBWSxHQUFHQyxJQUFJLENBQUNDLEdBQUwsS0FBYSxHQUFiLEdBQW1CQyxJQUFJLENBQUNDLEtBQUwsQ0FBV0QsSUFBSSxDQUFDRSxNQUFMLEtBQWdCLEdBQTNCLENBQXhDO0FBQ0EsUUFBSUMsZ0JBQWdCLEdBQUdWLElBQUksQ0FBQ1csWUFBNUI7QUFDQSxRQUFJQyxTQUFTLEdBQUdGLGdCQUFnQixDQUFDRyxTQUFqQixDQUEyQkgsZ0JBQWdCLENBQUNJLFdBQWpCLENBQTZCLEdBQTdCLElBQW9DLENBQS9ELENBQWhCO0FBQ0FiLElBQUFBLEVBQUUsQ0FBQyxJQUFELEVBQU9ELElBQUksQ0FBQ2UsU0FBTCxHQUFpQixHQUFqQixHQUF1QlgsWUFBdkIsR0FBc0MsR0FBdEMsR0FBMkNRLFNBQWxELENBQUY7QUFDRDtBQVRzQyxDQUFuQixDQUExQjtBQVlBLE1BQU1JLE1BQU0sR0FBR3RCLE1BQU0sQ0FBQztBQUFDdUIsRUFBQUEsT0FBTyxFQUFDckI7QUFBVCxDQUFELENBQXJCO0FBRUEsTUFBTXNCLEdBQUcsR0FBRyxzQkFBWixDLENBRUE7O0FBQ0FBLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLFdBQVQsRUFBc0JDLGNBQWMsQ0FBQ0MsTUFBckM7QUFDQUgsR0FBRyxDQUFDQyxJQUFKLENBQVMsUUFBVCxFQUFtQkMsY0FBYyxDQUFDRSxNQUFsQztBQUNBSixHQUFHLENBQUNLLEdBQUosQ0FBUSxTQUFSLEVBQW1CSCxjQUFjLENBQUNJLE1BQWxDLEUsQ0FFQTs7QUFDQU4sR0FBRyxDQUFDSyxHQUFKLENBQVEsR0FBUixFQUFhRSxjQUFjLENBQUNDLFdBQTVCO0FBQ0FSLEdBQUcsQ0FBQ0ssR0FBSixDQUFRLE1BQVIsRUFBZ0JFLGNBQWMsQ0FBQ0UsV0FBL0I7QUFDQVQsR0FBRyxDQUFDVSxHQUFKLENBQVEsTUFBUixFQUFnQkgsY0FBYyxDQUFDSSxVQUEvQjtBQUNBWCxHQUFHLENBQUNZLE1BQUosQ0FBVyxNQUFYLEVBQW1CTCxjQUFjLENBQUNNLFVBQWxDO0FBQ0FiLEdBQUcsQ0FBQ2MsS0FBSixDQUFVLGFBQVYsRUFBeUJQLGNBQWMsQ0FBQ1EsTUFBeEM7QUFDQWYsR0FBRyxDQUFDYyxLQUFKLENBQVUsZUFBVixFQUEyQlAsY0FBYyxDQUFDUyxRQUExQyxFLENBR0E7QUFDQTs7QUFDQWhCLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLFNBQVQsRUFBb0JILE1BQU0sQ0FBQ21CLE1BQVAsQ0FBYyxNQUFkLENBQXBCLEVBQTRDQyxnQkFBZ0IsQ0FBQ0MsWUFBN0Q7ZUFFZW5CLEciLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9yb3V0ZXMvYXBpLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJvdXRlciB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0ICogYXMgQXV0aENvbnRyb2xsZXIgZnJvbSAnLi4vLi4vY29udHJvbGxlcnMvYXV0aC5jb250cm9sbGVyJztcbmltcG9ydCAqIGFzIFVzZXJDb250cm9sbGVyIGZyb20gJy4uLy4uL2NvbnRyb2xsZXJzL3VzZXIuY29udHJvbGxlcic7XG5pbXBvcnQgKiBhcyBVcGxvYWRDb250cm9sbGVyIGZyb20gJy4uLy4uL2NvbnRyb2xsZXJzL3VwbG9hZC5jb250cm9sbGVyJztcbmNvbnN0IG11bHRlciAgPSByZXF1aXJlKCdtdWx0ZXInKVxuXG5jb25zdCBmaWxlU3RvcmFnZUVuZ2luZSA9IG11bHRlci5kaXNrU3RvcmFnZSh7XG4gICAgZGVzdGluYXRpb246KHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAgICAgY2IobnVsbCwgYCR7X19kaXJuYW1lfS8uLi8uLi8uLi9hc3NldHMvdXBsb2Fkcy9wcm9maWxzYClcbiAgICB9LFxuICAgIGZpbGVuYW1lOiBmdW5jdGlvbiAocmVxLCBmaWxlLCBjYikge1xuICAgICAgICBjb25zdCB1bmlxdWVTdWZmaXggPSBEYXRlLm5vdygpICsgJy0nICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMUU5KVxuICAgICAgICBsZXQgb3JpZ2luYWxOYW1lRmlsZSA9IGZpbGUub3JpZ2luYWxuYW1lO1xuICAgICAgICBsZXQgZXh0ZW5zaW9uID0gb3JpZ2luYWxOYW1lRmlsZS5zdWJzdHJpbmcob3JpZ2luYWxOYW1lRmlsZS5sYXN0SW5kZXhPZignLicpICsgMSk7IFxuICAgICAgICBjYihudWxsLCBmaWxlLmZpZWxkbmFtZSArICctJyArIHVuaXF1ZVN1ZmZpeCArIFwiLlwiKyBleHRlbnNpb24gKVxuICAgICAgfVxufSk7XG5cbmNvbnN0IHVwbG9hZCA9IG11bHRlcih7c3RvcmFnZTpmaWxlU3RvcmFnZUVuZ2luZX0pXG5cbmNvbnN0IGFwaSA9IFJvdXRlcigpO1xuXG4vL2F1dGhcbmFwaS5wb3N0KCcvcmVnaXN0ZXInLCBBdXRoQ29udHJvbGxlci5zaWduVXApO1xuYXBpLnBvc3QoJy9sb2dpbicsIEF1dGhDb250cm9sbGVyLnNpZ25Jbik7XG5hcGkuZ2V0KCcvbG9nb3V0JywgQXV0aENvbnRyb2xsZXIubG9nb3V0KTtcblxuLy91c2VyXG5hcGkuZ2V0KCcvJywgVXNlckNvbnRyb2xsZXIuZ2V0QWxsVXNlcnMpO1xuYXBpLmdldCgnLzppZCcsIFVzZXJDb250cm9sbGVyLmdldFVzZXJJbmZvKTtcbmFwaS5wdXQoJy86aWQnLCBVc2VyQ29udHJvbGxlci51cGRhdGVVc2VyKTtcbmFwaS5kZWxldGUoJy86aWQnLCBVc2VyQ29udHJvbGxlci5kZWxldGVVc2VyKTtcbmFwaS5wYXRjaCgnL2ZvbGxvdy86aWQnLCBVc2VyQ29udHJvbGxlci5mb2xsb3cpO1xuYXBpLnBhdGNoKCcvdW5mb2xsb3cvOmlkJywgVXNlckNvbnRyb2xsZXIudW5mb2xsb3cpO1xuXG5cbi8vdXBsb2FkXG4vL2F2YW50IGRlIHBhc3NlciDDoCBub3RyZSBjb250cm9sbGV1ciBpbCB2YSBjaGVjayBub3RyZSBmaWxlXG5hcGkucG9zdCgnL3VwbG9hZCcsIHVwbG9hZC5zaW5nbGUoXCJmaWxlXCIpLCAgVXBsb2FkQ29udHJvbGxlci51cGxvYWRQcm9maWwpXG5cbmV4cG9ydCBkZWZhdWx0IGFwaTsiXX0=","map":{"version":3,"sources":["user.route.js"],"names":["multer","require","fileStorageEngine","diskStorage","destination","req","file","cb","__dirname","filename","uniqueSuffix","Date","now","Math","round","random","originalNameFile","originalname","extension","substring","lastIndexOf","fieldname","upload","storage","api","post","AuthController","signUp","signIn","get","logout","UserController","getAllUsers","getUserInfo","put","updateUser","delete","deleteUser","patch","follow","unfollow","single","UploadController","uploadProfil"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;AACA,MAAMA,MAAM,GAAIC,OAAO,CAAC,QAAD,CAAvB;;AAEA,MAAMC,iBAAiB,GAAGF,MAAM,CAACG,WAAP,CAAmB;AACzCC,EAAAA,WAAW,EAAC,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,KAAmB;AAC3BA,IAAAA,EAAE,CAAC,IAAD,EAAQ,GAAEC,SAAU,kCAApB,CAAF;AACH,GAHwC;AAIzCC,EAAAA,QAAQ,EAAE,UAAUJ,GAAV,EAAeC,IAAf,EAAqBC,EAArB,EAAyB;AAC/B,UAAMG,YAAY,GAAGC,IAAI,CAACC,GAAL,KAAa,GAAb,GAAmBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAAxC;AACA,QAAIC,gBAAgB,GAAGV,IAAI,CAACW,YAA5B;AACA,QAAIC,SAAS,GAAGF,gBAAgB,CAACG,SAAjB,CAA2BH,gBAAgB,CAACI,WAAjB,CAA6B,GAA7B,IAAoC,CAA/D,CAAhB;AACAb,IAAAA,EAAE,CAAC,IAAD,EAAOD,IAAI,CAACe,SAAL,GAAiB,GAAjB,GAAuBX,YAAvB,GAAsC,GAAtC,GAA2CQ,SAAlD,CAAF;AACD;AATsC,CAAnB,CAA1B;AAYA,MAAMI,MAAM,GAAGtB,MAAM,CAAC;AAACuB,EAAAA,OAAO,EAACrB;AAAT,CAAD,CAArB;AAEA,MAAMsB,GAAG,GAAG,sBAAZ,C,CAEA;;AACAA,GAAG,CAACC,IAAJ,CAAS,WAAT,EAAsBC,cAAc,CAACC,MAArC;AACAH,GAAG,CAACC,IAAJ,CAAS,QAAT,EAAmBC,cAAc,CAACE,MAAlC;AACAJ,GAAG,CAACK,GAAJ,CAAQ,SAAR,EAAmBH,cAAc,CAACI,MAAlC,E,CAEA;;AACAN,GAAG,CAACK,GAAJ,CAAQ,GAAR,EAAaE,cAAc,CAACC,WAA5B;AACAR,GAAG,CAACK,GAAJ,CAAQ,MAAR,EAAgBE,cAAc,CAACE,WAA/B;AACAT,GAAG,CAACU,GAAJ,CAAQ,MAAR,EAAgBH,cAAc,CAACI,UAA/B;AACAX,GAAG,CAACY,MAAJ,CAAW,MAAX,EAAmBL,cAAc,CAACM,UAAlC;AACAb,GAAG,CAACc,KAAJ,CAAU,aAAV,EAAyBP,cAAc,CAACQ,MAAxC;AACAf,GAAG,CAACc,KAAJ,CAAU,eAAV,EAA2BP,cAAc,CAACS,QAA1C,E,CAGA;AACA;;AACAhB,GAAG,CAACC,IAAJ,CAAS,SAAT,EAAoBH,MAAM,CAACmB,MAAP,CAAc,MAAd,CAApB,EAA4CC,gBAAgB,CAACC,YAA7D;eAEenB,G","sourceRoot":"/Applications/dossier/mern_project_app2/src/routes/api/","sourcesContent":["import { Router } from 'express';\nimport * as AuthController from '../../controllers/auth.controller';\nimport * as UserController from '../../controllers/user.controller';\nimport * as UploadController from '../../controllers/upload.controller';\nconst multer  = require('multer')\n\nconst fileStorageEngine = multer.diskStorage({\n    destination:(req, file, cb) => {\n        cb(null, `${__dirname}/../../../assets/uploads/profils`)\n    },\n    filename: function (req, file, cb) {\n        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)\n        let originalNameFile = file.originalname;\n        let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1); \n        cb(null, file.fieldname + '-' + uniqueSuffix + \".\"+ extension )\n      }\n});\n\nconst upload = multer({storage:fileStorageEngine})\n\nconst api = Router();\n\n//auth\napi.post('/register', AuthController.signUp);\napi.post('/login', AuthController.signIn);\napi.get('/logout', AuthController.logout);\n\n//user\napi.get('/', UserController.getAllUsers);\napi.get('/:id', UserController.getUserInfo);\napi.put('/:id', UserController.updateUser);\napi.delete('/:id', UserController.deleteUser);\napi.patch('/follow/:id', UserController.follow);\napi.patch('/unfollow/:id', UserController.unfollow);\n\n\n//upload\n//avant de passer à notre controlleur il va check notre file\napi.post('/upload', upload.single(\"file\"),  UploadController.uploadProfil)\n\nexport default api;"]}},"mtime":1653046975386},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/controllers/user.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updateUser = exports.unfollow = exports.getUserInfo = exports.getAllUsers = exports.follow = exports.deleteUser = void 0;\n\nconst User = require('../models/user.model');\n\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\nconst getAllUsers = async (req, res) => {\n  //allow to receive all users without password\n  const users = await User.find().select('-password');\n  res.status(200).json(users);\n};\n\nexports.getAllUsers = getAllUsers;\n\nconst getUserInfo = async (req, res) => {\n  //if id exist in databse\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.findById(req.params.id).select('-password').then(user => {\n    res.status(200).json(user);\n  }).catch(err => {\n    console.log(err);\n  });\n};\n\nexports.getUserInfo = getUserInfo;\n\nconst updateUser = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.findOneAndUpdate({\n    _id: req.params.id\n  }, {\n    $set: {\n      bio: req.body.bio\n    }\n  }, {\n    new: true,\n    upsert: true,\n    setDefaultsOnInsert: true\n  }).select('-password').then(user => {\n    res.status(200).json(user);\n  }).catch(err => {\n    res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.updateUser = updateUser;\n\nconst deleteUser = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.remove({\n    _id: req.params.id\n  }).exec().then(() => {\n    res.status(200).json({\n      message: 'Successfully deleted !'\n    });\n  }).catch(err => {\n    res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.deleteUser = deleteUser;\n\nconst follow = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  if (!ObjectID.isValid(req.body.idToFollow)) {\n    return res.status(400).send(`Id unknown : ${req.body.idToFollow}`);\n  } //add to the follower list\n\n\n  await User.findByIdAndUpdate(req.params.id, {\n    $addToSet: {\n      following: req.body.idToFollow\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {\n    res.status(201).json(user);\n  }).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  }); //add to the following list\n\n  await User.findByIdAndUpdate(req.body.idToFollow, {\n    $addToSet: {\n      followers: req.params.id\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {}).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.follow = follow;\n\nconst unfollow = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  if (!ObjectID.isValid(req.body.idToUnFollow)) {\n    return res.status(400).send(`Id unknown : ${req.body.idToUnFollow}`);\n  } //delete to the follower list\n\n\n  await User.findByIdAndUpdate(req.params.id, {\n    $pull: {\n      following: req.body.idToUnFollow\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {\n    res.status(201).json(user);\n  }).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  }); //delete to the following list\n\n  await User.findByIdAndUpdate(req.body.idToUnFollow, {\n    $pull: {\n      followers: req.params.id\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {}).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.unfollow = unfollow;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsIk9iamVjdElEIiwiVHlwZXMiLCJPYmplY3RJZCIsImdldEFsbFVzZXJzIiwicmVxIiwicmVzIiwidXNlcnMiLCJmaW5kIiwic2VsZWN0Iiwic3RhdHVzIiwianNvbiIsImdldFVzZXJJbmZvIiwiaXNWYWxpZCIsInBhcmFtcyIsImlkIiwic2VuZCIsImZpbmRCeUlkIiwidGhlbiIsInVzZXIiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVVc2VyIiwiZmluZE9uZUFuZFVwZGF0ZSIsIl9pZCIsIiRzZXQiLCJiaW8iLCJib2R5IiwibmV3IiwidXBzZXJ0Iiwic2V0RGVmYXVsdHNPbkluc2VydCIsIm1lc3NhZ2UiLCJkZWxldGVVc2VyIiwicmVtb3ZlIiwiZXhlYyIsImZvbGxvdyIsImlkVG9Gb2xsb3ciLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIiRhZGRUb1NldCIsImZvbGxvd2luZyIsImZvbGxvd2VycyIsInVuZm9sbG93IiwiaWRUb1VuRm9sbG93IiwiJHB1bGwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFDQSxNQUFNQyxRQUFRLEdBQUdELE9BQU8sQ0FBQyxVQUFELENBQVAsQ0FBb0JFLEtBQXBCLENBQTBCQyxRQUEzQzs7QUFHTyxNQUFNQyxXQUFXLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEtBQW9CO0FBQzNDO0FBQ0EsUUFBTUMsS0FBSyxHQUFHLE1BQU1SLElBQUksQ0FBQ1MsSUFBTCxHQUFZQyxNQUFaLENBQW1CLFdBQW5CLENBQXBCO0FBQ0FILEVBQUFBLEdBQUcsQ0FDRUksTUFETCxDQUNZLEdBRFosRUFFS0MsSUFGTCxDQUVVSixLQUZWO0FBR0gsQ0FOTTs7OztBQVFBLE1BQU1LLFdBQVcsR0FBRyxPQUFPUCxHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFD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QyxDQUFOO0FBVUgsQ0E1Qk0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9jb250cm9sbGVycy8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuY29uc3QgT2JqZWN0SUQgPSByZXF1aXJlKFwibW9uZ29vc2VcIikuVHlwZXMuT2JqZWN0SWQ7XG5cblxuZXhwb3J0IGNvbnN0IGdldEFsbFVzZXJzID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgLy9hbGxvdyB0byByZWNlaXZlIGFsbCB1c2VycyB3aXRob3V0IHBhc3N3b3JkXG4gICAgY29uc3QgdXNlcnMgPSBhd2FpdCBVc2VyLmZpbmQoKS5zZWxlY3QoJy1wYXNzd29yZCcpO1xuICAgIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24odXNlcnMpXG59XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VySW5mbyA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIC8vaWYgaWQgZXhpc3QgaW4gZGF0YWJzZVxuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgYXdhaXQgVXNlci5maW5kQnlJZChyZXEucGFyYW1zLmlkKS5zZWxlY3QoJy1wYXNzd29yZCcpXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih1c2VyKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICB9KVxufVxuXG5leHBvcnQgY29uc3QgdXBkYXRlVXNlciA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgYXdhaXQgVXNlci5maW5kT25lQW5kVXBkYXRlKFxuICAgICAgICB7IF9pZDogcmVxLnBhcmFtcy5pZCB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAkc2V0OiB7XG4gICAgICAgICAgICAgICAgYmlvOiByZXEuYm9keS5iaW9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmV3OiB0cnVlLFxuICAgICAgICAgICAgdXBzZXJ0OiB0cnVlLFxuICAgICAgICAgICAgc2V0RGVmYXVsdHNPbkluc2VydDogdHJ1ZVxuICAgICAgICB9KS5zZWxlY3QoJy1wYXNzd29yZCcpLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHVzZXIpXG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyIH0pXG4gICAgICAgIH0pXG59XG5cbmV4cG9ydCBjb25zdCBkZWxldGVVc2VyID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cbiAgICBhd2FpdCBVc2VyLnJlbW92ZSh7XG4gICAgICAgIF9pZDogcmVxLnBhcmFtcy5pZFxuICAgIH0pLmV4ZWMoKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe21lc3NhZ2U6ICdTdWNjZXNzZnVsbHkgZGVsZXRlZCAhJ30pXG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7bWVzc2FnZTplcnJ9KVxuICAgIH0pXG59XG5leHBvcnQgY29uc3QgZm9sbG93ID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpICkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5ib2R5LmlkVG9Gb2xsb3cpICkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5ib2R5LmlkVG9Gb2xsb3d9YClcbiAgICB9XG4gICAgLy9hZGQgdG8gdGhlIGZvbGxvd2VyIGxpc3RcbiAgICBhd2FpdCBVc2VyLmZpbmRCeUlkQW5kVXBkYXRlKHJlcS5wYXJhbXMuaWQsIFxuICAgICAgICB7ICRhZGRUb1NldCA6IHsgZm9sbG93aW5nOiByZXEuYm9keS5pZFRvRm9sbG93fX0sXG4gICAgICAgIHtuZXcgOiB0cnVlLCB1cHNlcnQ6dHJ1ZX0pXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih1c2VyKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHttZXNzYWdlOmVycn0pXG4gICAgICAgIH0pXG4gICAgLy9hZGQgdG8gdGhlIGZvbGxvd2luZyBsaXN0XG4gICAgYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShyZXEuYm9keS5pZFRvRm9sbG93LFxuICAgICAgICB7ICRhZGRUb1NldCA6IHsgZm9sbG93ZXJzOiByZXEucGFyYW1zLmlkfX0sXG4gICAgICAgIHtuZXcgOiB0cnVlLCB1cHNlcnQ6dHJ1ZX0pXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG5cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7bWVzc2FnZTplcnJ9KVxuICAgICAgICB9KVxuXG59XG5leHBvcnQgY29uc3QgdW5mb2xsb3cgPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkgKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLmJvZHkuaWRUb1VuRm9sbG93KSApIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEuYm9keS5pZFRvVW5Gb2xsb3d9YClcbiAgICB9XG4gICAgIC8vZGVsZXRlIHRvIHRoZSBmb2xsb3dlciBsaXN0XG4gICAgIGF3YWl0IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUocmVxLnBhcmFtcy5pZCwgXG4gICAgICAgIHsgJHB1bGwgOiB7IGZvbGxvd2luZzogcmVxLmJvZHkuaWRUb1VuRm9sbG93fX0sXG4gICAgICAgIHtuZXcgOiB0cnVlLCB1cHNlcnQ6dHJ1ZX0pXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih1c2VyKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHttZXNzYWdlOmVycn0pXG4gICAgICAgIH0pXG4gICAgLy9kZWxldGUgdG8gdGhlIGZvbGxvd2luZyBsaXN0XG4gICAgYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShyZXEuYm9keS5pZFRvVW5Gb2xsb3csXG4gICAgICAgIHsgJHB1bGwgOiB7IGZvbGxvd2VyczogcmVxLnBhcmFtcy5pZH19LFxuICAgICAgICB7bmV3IDogdHJ1ZSwgdXBzZXJ0OnRydWV9KVxuICAgICAgICAudGhlbigodXNlcikgPT4ge1xuXG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe21lc3NhZ2U6ZXJyfSlcbiAgICAgICAgfSlcblxufSJdfQ==","map":{"version":3,"sources":["user.controller.js"],"names":["User","require","ObjectID","Types","ObjectId","getAllUsers","req","res","users","find","select","status","json","getUserInfo","isValid","params","id","send","findById","then","user","catch","err","console","log","updateUser","findOneAndUpdate","_id","$set","bio","body","new","upsert","setDefaultsOnInsert","message","deleteUser","remove","exec","follow","idToFollow","findByIdAndUpdate","$addToSet","following","followers","unfollow","idToUnFollow","$pull"],"mappings":"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","sourceRoot":"/Applications/dossier/mern_project_app2/src/controllers/","sourcesContent":["const User = require('../models/user.model')\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\n\nexport const getAllUsers = async (req, res) => {\n    //allow to receive all users without password\n    const users = await User.find().select('-password');\n    res\n        .status(200)\n        .json(users)\n}\n\nexport const getUserInfo = async (req, res) => {\n    //if id exist in databse\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.findById(req.params.id).select('-password')\n        .then((user) => {\n            res.status(200).json(user)\n        })\n        .catch((err) => {\n            console.log(err)\n        })\n}\n\nexport const updateUser = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.findOneAndUpdate(\n        { _id: req.params.id },\n        {\n            $set: {\n                bio: req.body.bio\n            }\n        },\n        {\n            new: true,\n            upsert: true,\n            setDefaultsOnInsert: true\n        }).select('-password').then((user) => {\n            res.status(200).json(user)\n        }).catch((err) => {\n            res.status(500).json({ message: err })\n        })\n}\n\nexport const deleteUser = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.remove({\n        _id: req.params.id\n    }).exec()\n    .then(() => {\n        res.status(200).json({message: 'Successfully deleted !'})\n    })\n    .catch((err) => {\n        res.status(500).json({message:err})\n    })\n}\nexport const follow = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id) ) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    if (!ObjectID.isValid(req.body.idToFollow) ) {\n        return res.status(400).send(`Id unknown : ${req.body.idToFollow}`)\n    }\n    //add to the follower list\n    await User.findByIdAndUpdate(req.params.id, \n        { $addToSet : { following: req.body.idToFollow}},\n        {new : true, upsert:true})\n        .then((user) => {\n            res.status(201).json(user)\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n    //add to the following list\n    await User.findByIdAndUpdate(req.body.idToFollow,\n        { $addToSet : { followers: req.params.id}},\n        {new : true, upsert:true})\n        .then((user) => {\n\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n\n}\nexport const unfollow = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id) ) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    if (!ObjectID.isValid(req.body.idToUnFollow) ) {\n        return res.status(400).send(`Id unknown : ${req.body.idToUnFollow}`)\n    }\n     //delete to the follower list\n     await User.findByIdAndUpdate(req.params.id, \n        { $pull : { following: req.body.idToUnFollow}},\n        {new : true, upsert:true})\n        .then((user) => {\n            res.status(201).json(user)\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n    //delete to the following list\n    await User.findByIdAndUpdate(req.body.idToUnFollow,\n        { $pull : { followers: req.params.id}},\n        {new : true, upsert:true})\n        .then((user) => {\n\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n\n}"]}},"mtime":1651585436195},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/controllers/user.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updateUser = exports.unfollow = exports.getUserInfo = exports.getAllUsers = exports.follow = exports.deleteUser = void 0;\n\nconst User = require('../models/user.model');\n\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\nconst getAllUsers = async (req, res) => {\n  //allow to receive all users without password\n  const users = await User.find().select('-password');\n  res.status(200).json(users);\n};\n\nexports.getAllUsers = getAllUsers;\n\nconst getUserInfo = async (req, res) => {\n  //if id exist in databse\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.findById(req.params.id).select('-password').then(user => {\n    res.status(200).json(user);\n  }).catch(err => {\n    console.log(err);\n  });\n};\n\nexports.getUserInfo = getUserInfo;\n\nconst updateUser = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.findOneAndUpdate({\n    _id: req.params.id\n  }, {\n    $set: {\n      bio: req.body.bio\n    }\n  }, {\n    new: true,\n    upsert: true,\n    setDefaultsOnInsert: true\n  }).select('-password').then(user => {\n    res.status(200).json(user);\n  }).catch(err => {\n    res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.updateUser = updateUser;\n\nconst deleteUser = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.remove({\n    _id: req.params.id\n  }).exec().then(() => {\n    res.status(200).json({\n      message: 'Successfully deleted !'\n    });\n  }).catch(err => {\n    res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.deleteUser = deleteUser;\n\nconst follow = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  if (!ObjectID.isValid(req.body.idToFollow)) {\n    return res.status(400).send(`Id unknown : ${req.body.idToFollow}`);\n  } //add to the follower list\n\n\n  await User.findByIdAndUpdate(req.params.id, {\n    $addToSet: {\n      following: req.body.idToFollow\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {\n    res.status(201).json(user);\n  }).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  }); //add to the following list\n\n  await User.findByIdAndUpdate(req.body.idToFollow, {\n    $addToSet: {\n      followers: req.params.id\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {}).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.follow = follow;\n\nconst unfollow = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  if (!ObjectID.isValid(req.body.idToUnFollow)) {\n    return res.status(400).send(`Id unknown : ${req.body.idToUnFollow}`);\n  } //delete to the follower list\n\n\n  await User.findByIdAndUpdate(req.params.id, {\n    $pull: {\n      following: req.body.idToUnFollow\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {\n    res.status(201).json(user);\n  }).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  }); //delete to the following list\n\n  await User.findByIdAndUpdate(req.body.idToUnFollow, {\n    $pull: {\n      followers: req.params.id\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {}).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.unfollow = unfollow;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsIk9iamVjdElEIiwiVHlwZXMiLCJPYmplY3RJZCIsImdldEFsbFVzZXJzIiwicmVxIiwicmVzIiwidXNlcnMiLCJmaW5kIiwic2VsZWN0Iiwic3RhdHVzIiwianNvbiIsImdldFVzZXJJbmZvIiwiaXNWYWxpZCIsInBhcmFtcyIsImlkIiwic2VuZCIsImZpbmRCeUlkIiwidGhlbiIsInVzZXIiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVVc2VyIiwiZmluZE9uZUFuZFVwZGF0ZSIsIl9pZCIsIiRzZXQiLCJiaW8iLCJib2R5IiwibmV3IiwidXBzZXJ0Iiwic2V0RGVmYXVsdHNPbkluc2VydCIsIm1lc3NhZ2UiLCJkZWxldGVVc2VyIiwicmVtb3ZlIiwiZXhlYyIsImZvbGxvdyIsImlkVG9Gb2xsb3ciLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIiRhZGRUb1NldCIsImZvbGxvd2luZyIsImZvbGxvd2VycyIsInVuZm9sbG93IiwiaWRUb1VuRm9sbG93IiwiJHB1bGwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFDQSxNQUFNQyxRQUFRLEdBQUdELE9BQU8sQ0FBQyxVQUFELENBQVAsQ0FBb0JFLEtBQXBCLENBQTBCQyxRQUEzQzs7QUFHTyxNQUFNQyxXQUFXLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEtBQW9CO0FBQzNDO0FBQ0EsUUFBTUMsS0FBSyxHQUFHLE1BQU1SLElBQUksQ0FBQ1MsSUFBTCxHQUFZQyxNQUFaLENBQW1CLFdBQW5CLENBQXBCO0FBQ0FILEVBQUFBLEdBQUcsQ0FDRUksTUFETCxDQUNZLEdBRFosRUFFS0MsSUFGTCxDQUVVSixLQUZWO0FBR0gsQ0FOTTs7OztBQVFBLE1BQU1LLFdBQVcsR0FBRyxPQUFPUCxHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFD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QyxDQUFOO0FBVUgsQ0E1Qk0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9jb250cm9sbGVycy8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuY29uc3QgT2JqZWN0SUQgPSByZXF1aXJlKFwibW9uZ29vc2VcIikuVHlwZXMuT2JqZWN0SWQ7XG5cblxuZXhwb3J0IGNvbnN0IGdldEFsbFVzZXJzID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgLy9hbGxvdyB0byByZWNlaXZlIGFsbCB1c2VycyB3aXRob3V0IHBhc3N3b3JkXG4gICAgY29uc3QgdXNlcnMgPSBhd2FpdCBVc2VyLmZpbmQoKS5zZWxlY3QoJy1wYXNzd29yZCcpO1xuICAgIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24odXNlcnMpXG59XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VySW5mbyA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIC8vaWYgaWQgZXhpc3QgaW4gZGF0YWJzZVxuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgYXdhaXQgVXNlci5maW5kQnlJZChyZXEucGFyYW1zLmlkKS5zZWxlY3QoJy1wYXNzd29yZCcpXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih1c2VyKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICB9KVxufVxuXG5leHBvcnQgY29uc3QgdXBkYXRlVXNlciA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgYXdhaXQgVXNlci5maW5kT25lQW5kVXBkYXRlKFxuICAgICAgICB7IF9pZDogcmVxLnBhcmFtcy5pZCB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAkc2V0OiB7XG4gICAgICAgICAgICAgICAgYmlvOiByZXEuYm9keS5iaW9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmV3OiB0cnVlLFxuICAgICAgICAgICAgdXBzZXJ0OiB0cnVlLFxuICAgICAgICAgICAgc2V0RGVmYXVsdHNPbkluc2VydDogdHJ1ZVxuICAgICAgICB9KS5zZWxlY3QoJy1wYXNzd29yZCcpLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHVzZXIpXG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyIH0pXG4gICAgICAgIH0pXG59XG5cbmV4cG9ydCBjb25zdCBkZWxldGVVc2VyID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cbiAgICBhd2FpdCBVc2VyLnJlbW92ZSh7XG4gICAgICAgIF9pZDogcmVxLnBhcmFtcy5pZFxuICAgIH0pLmV4ZWMoKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe21lc3NhZ2U6ICdTdWNjZXNzZnVsbHkgZGVsZXRlZCAhJ30pXG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7bWVzc2FnZTplcnJ9KVxuICAgIH0pXG59XG5leHBvcnQgY29uc3QgZm9sbG93ID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpICkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5ib2R5LmlkVG9Gb2xsb3cpICkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5ib2R5LmlkVG9Gb2xsb3d9YClcbiAgICB9XG4gICAgLy9hZGQgdG8gdGhlIGZvbGxvd2VyIGxpc3RcbiAgICBhd2FpdCBVc2VyLmZpbmRCeUlkQW5kVXBkYXRlKHJlcS5wYXJhbXMuaWQsIFxuICAgICAgICB7ICRhZGRUb1NldCA6IHsgZm9sbG93aW5nOiByZXEuYm9keS5pZFRvRm9sbG93fX0sXG4gICAgICAgIHtuZXcgOiB0cnVlLCB1cHNlcnQ6dHJ1ZX0pXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih1c2VyKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHttZXNzYWdlOmVycn0pXG4gICAgICAgIH0pXG4gICAgLy9hZGQgdG8gdGhlIGZvbGxvd2luZyBsaXN0XG4gICAgYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShyZXEuYm9keS5pZFRvRm9sbG93LFxuICAgICAgICB7ICRhZGRUb1NldCA6IHsgZm9sbG93ZXJzOiByZXEucGFyYW1zLmlkfX0sXG4gICAgICAgIHtuZXcgOiB0cnVlLCB1cHNlcnQ6dHJ1ZX0pXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG5cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7bWVzc2FnZTplcnJ9KVxuICAgICAgICB9KVxuXG59XG5leHBvcnQgY29uc3QgdW5mb2xsb3cgPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkgKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLmJvZHkuaWRUb1VuRm9sbG93KSApIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEuYm9keS5pZFRvVW5Gb2xsb3d9YClcbiAgICB9XG4gICAgIC8vZGVsZXRlIHRvIHRoZSBmb2xsb3dlciBsaXN0XG4gICAgIGF3YWl0IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUocmVxLnBhcmFtcy5pZCwgXG4gICAgICAgIHsgJHB1bGwgOiB7IGZvbGxvd2luZzogcmVxLmJvZHkuaWRUb1VuRm9sbG93fX0sXG4gICAgICAgIHtuZXcgOiB0cnVlLCB1cHNlcnQ6dHJ1ZX0pXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih1c2VyKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHttZXNzYWdlOmVycn0pXG4gICAgICAgIH0pXG4gICAgLy9kZWxldGUgdG8gdGhlIGZvbGxvd2luZyBsaXN0XG4gICAgYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShyZXEuYm9keS5pZFRvVW5Gb2xsb3csXG4gICAgICAgIHsgJHB1bGwgOiB7IGZvbGxvd2VyczogcmVxLnBhcmFtcy5pZH19LFxuICAgICAgICB7bmV3IDogdHJ1ZSwgdXBzZXJ0OnRydWV9KVxuICAgICAgICAudGhlbigodXNlcikgPT4ge1xuXG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe21lc3NhZ2U6ZXJyfSlcbiAgICAgICAgfSlcblxufSJdfQ==","map":{"version":3,"sources":["user.controller.js"],"names":["User","require","ObjectID","Types","ObjectId","getAllUsers","req","res","users","find","select","status","json","getUserInfo","isValid","params","id","send","findById","then","user","catch","err","console","log","updateUser","findOneAndUpdate","_id","$set","bio","body","new","upsert","setDefaultsOnInsert","message","deleteUser","remove","exec","follow","idToFollow","findByIdAndUpdate","$addToSet","following","followers","unfollow","idToUnFollow","$pull"],"mappings":"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","sourceRoot":"/Applications/dossier/mern_project_app2/src/controllers/","sourcesContent":["const User = require('../models/user.model')\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\n\nexport const getAllUsers = async (req, res) => {\n    //allow to receive all users without password\n    const users = await User.find().select('-password');\n    res\n        .status(200)\n        .json(users)\n}\n\nexport const getUserInfo = async (req, res) => {\n    //if id exist in databse\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.findById(req.params.id).select('-password')\n        .then((user) => {\n            res.status(200).json(user)\n        })\n        .catch((err) => {\n            console.log(err)\n        })\n}\n\nexport const updateUser = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.findOneAndUpdate(\n        { _id: req.params.id },\n        {\n            $set: {\n                bio: req.body.bio\n            }\n        },\n        {\n            new: true,\n            upsert: true,\n            setDefaultsOnInsert: true\n        }).select('-password').then((user) => {\n            res.status(200).json(user)\n        }).catch((err) => {\n            res.status(500).json({ message: err })\n        })\n}\n\nexport const deleteUser = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.remove({\n        _id: req.params.id\n    }).exec()\n    .then(() => {\n        res.status(200).json({message: 'Successfully deleted !'})\n    })\n    .catch((err) => {\n        res.status(500).json({message:err})\n    })\n}\nexport const follow = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id) ) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    if (!ObjectID.isValid(req.body.idToFollow) ) {\n        return res.status(400).send(`Id unknown : ${req.body.idToFollow}`)\n    }\n    //add to the follower list\n    await User.findByIdAndUpdate(req.params.id, \n        { $addToSet : { following: req.body.idToFollow}},\n        {new : true, upsert:true})\n        .then((user) => {\n            res.status(201).json(user)\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n    //add to the following list\n    await User.findByIdAndUpdate(req.body.idToFollow,\n        { $addToSet : { followers: req.params.id}},\n        {new : true, upsert:true})\n        .then((user) => {\n\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n\n}\nexport const unfollow = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id) ) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    if (!ObjectID.isValid(req.body.idToUnFollow) ) {\n        return res.status(400).send(`Id unknown : ${req.body.idToUnFollow}`)\n    }\n     //delete to the follower list\n     await User.findByIdAndUpdate(req.params.id, \n        { $pull : { following: req.body.idToUnFollow}},\n        {new : true, upsert:true})\n        .then((user) => {\n            res.status(201).json(user)\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n    //delete to the following list\n    await User.findByIdAndUpdate(req.body.idToUnFollow,\n        { $pull : { followers: req.params.id}},\n        {new : true, upsert:true})\n        .then((user) => {\n\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n\n}"]}},"mtime":1651585436195},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/middlewares/auth.middleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.requireAuth = exports.checkUser = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _HttpException = require(\"../errors/HttpException.error\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst User = require('../models/user.model');\n\nconst checkUser = (req, res, next) => {\n  const token = req.cookies.jwt;\n\n  if (token) {\n    _jsonwebtoken.default.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        res.locals.user = null; // res.cookie(\"jwt\", '', { maxAge: 1 })\n\n        next();\n      } else {\n        let user = await User.findById(decodedToken.id);\n\n        if (!user) {\n          return next(new _HttpException.HttpException('Unauthorized', _HttpException.HttpStatus.UNAUTHORIZED));\n        }\n\n        res.locals.user = user;\n        next();\n      }\n    });\n  } else {\n    res.locals.user = null;\n    next();\n  }\n};\n\nexports.checkUser = checkUser;\n\nconst requireAuth = (req, res, next) => {\n  const token = req.cookies.jwt;\n\n  if (token) {\n    _jsonwebtoken.default.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        console.log(err);\n      } else {\n        console.log(decodedToken.id);\n        next();\n      }\n    });\n  } else {\n    console.log('no token');\n  }\n};\n\nexports.requireAuth = requireAuth;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgubWlkZGxld2FyZS5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImNoZWNrVXNlciIsInJlcSIsInJlcyIsIm5leHQiLCJ0b2tlbiIsImNvb2tpZXMiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiVE9LRU5fU0VDUkVUIiwiZXJyIiwiZGVjb2RlZFRva2VuIiwibG9jYWxzIiwidXNlciIsImZpbmRCeUlkIiwiaWQiLCJIdHRwRXhjZXB0aW9uIiwiSHR0cFN0YXR1cyIsIlVOQVVUSE9SSVpFRCIsInJlcXVpcmVBdXRoIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUVBOzs7O0FBREEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsc0JBQUQsQ0FBcEI7O0FBSU8sTUFBTUMsU0FBUyxHQUFHLENBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFXQyxJQUFYLEtBQW9CO0FBQzNDLFFBQU1DLEtBQUssR0FBR0gsR0FBRyxDQUFDSSxPQUFKLENBQVlDLEdBQTFCOztBQUNBLE1BQUlGLEtBQUosRUFBVztBQUVURSwwQkFBSUMsTUFBSixDQUFXSCxLQUFYLEVBQWtCSSxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsWUFBOUIsRUFBNEMsT0FBT0MsR0FBUCxFQUFZQyxZQUFaLEtBQTZCO0FBQ3ZFLFVBQUlELEdBQUosRUFBUztBQUNQVCxRQUFBQSxHQUFHLENBQUNXLE1BQUosQ0FBV0MsSUFBWCxHQUFrQixJQUFsQixDQURPLENBRVI7O0FBQ0NYLFFBQUFBLElBQUk7QUFDTCxPQUpELE1BSU87QUFDTCxZQUFJVyxJQUFJLEdBQUcsTUFBTWhCLElBQUksQ0FBQ2lCLFFBQUwsQ0FBY0gsWUFBWSxDQUFDSSxFQUEzQixDQUFqQjs7QUFDQSxZQUFJLENBQUNGLElBQUwsRUFBVztBQUNULGlCQUFPWCxJQUFJLENBQUMsSUFBSWMsNEJBQUosQ0FBa0IsY0FBbEIsRUFBa0NDLDBCQUFXQyxZQUE3QyxDQUFELENBQVg7QUFDRDs7QUFDRGpCLFFBQUFBLEdBQUcsQ0FBQ1csTUFBSixDQUFXQyxJQUFYLEdBQWtCQSxJQUFsQjtBQUNBWCxRQUFBQSxJQUFJO0FBQ0w7QUFDRixLQWJEO0FBY0QsR0FoQkQsTUFpQks7QUFDSEQsSUFBQUEsR0FBRyxDQUFDVyxNQUFKLENBQVdDLElBQVgsR0FBa0IsSUFBbEI7QUFDQVgsSUFBQUEsSUFBSTtBQUNMO0FBQ0YsQ0F2Qk07Ozs7QUF5QkEsTUFBTWlCLFdBQVcsR0FBRyxDQUFDbkIsR0FBRCxFQUFNQyxHQUFOLEVBQVdDLElBQVgsS0FBb0I7QUFDN0MsUUFBTUMsS0FBSyxHQUFHSCxHQUFHLENBQUNJLE9BQUosQ0FBWUMsR0FBMUI7O0FBQ0EsTUFBSUYsS0FBSixFQUFXO0FBQ1RFLDBCQUFJQyxNQUFKLENBQVdILEtBQVgsRUFBa0JJLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUE5QixFQUE0QyxPQUFPQyxHQUFQLEVBQVlDLFlBQVosS0FBNkI7QUFDdkUsVUFBR0QsR0FBSCxFQUFPO0FBQ0xVLFFBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZWCxHQUFaO0FBQ0QsT0FGRCxNQUVLO0FBQ0hVLFFBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZVixZQUFZLENBQUNJLEVBQXpCO0FBQ0FiLFFBQUFBLElBQUk7QUFDTDtBQUNGLEtBUEQ7QUFRRCxHQVRELE1BU0s7QUFDSGtCLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLFVBQVo7QUFDRDtBQUNGLENBZE0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbic7XG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuaW1wb3J0IHsgSHR0cEV4Y2VwdGlvbiwgSHR0cFN0YXR1cyB9IGZyb20gJy4uL2Vycm9ycy9IdHRwRXhjZXB0aW9uLmVycm9yJztcblxuXG5leHBvcnQgY29uc3QgY2hlY2tVc2VyID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHRva2VuID0gcmVxLmNvb2tpZXMuand0O1xuICBpZiAodG9rZW4pIHtcbiBcbiAgICBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5UT0tFTl9TRUNSRVQsIGFzeW5jIChlcnIsIGRlY29kZWRUb2tlbikgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZXMubG9jYWxzLnVzZXIgPSBudWxsO1xuICAgICAgIC8vIHJlcy5jb29raWUoXCJqd3RcIiwgJycsIHsgbWF4QWdlOiAxIH0pXG4gICAgICAgIG5leHQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChkZWNvZGVkVG9rZW4uaWQpO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICByZXR1cm4gbmV4dChuZXcgSHR0cEV4Y2VwdGlvbignVW5hdXRob3JpemVkJywgSHR0cFN0YXR1cy5VTkFVVEhPUklaRUQpKTtcbiAgICAgICAgfVxuICAgICAgICByZXMubG9jYWxzLnVzZXIgPSB1c2VyO1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9XG4gICAgfSlcbiAgfVxuICBlbHNlIHtcbiAgICByZXMubG9jYWxzLnVzZXIgPSBudWxsO1xuICAgIG5leHQoKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcmVxdWlyZUF1dGggPSAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgY29uc3QgdG9rZW4gPSByZXEuY29va2llcy5qd3RcbiAgaWYgKHRva2VuKSB7XG4gICAgand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVULCBhc3luYyAoZXJyLCBkZWNvZGVkVG9rZW4pID0+IHtcbiAgICAgIGlmKGVycil7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgY29uc29sZS5sb2coZGVjb2RlZFRva2VuLmlkKVxuICAgICAgICBuZXh0KCk7XG4gICAgICB9XG4gICAgfSlcbiAgfWVsc2V7XG4gICAgY29uc29sZS5sb2coJ25vIHRva2VuJylcbiAgfVxufVxuIl19","map":{"version":3,"sources":["auth.middleware.js"],"names":["User","require","checkUser","req","res","next","token","cookies","jwt","verify","process","env","TOKEN_SECRET","err","decodedToken","locals","user","findById","id","HttpException","HttpStatus","UNAUTHORIZED","requireAuth","console","log"],"mappings":";;;;;;;AAAA;;AAEA;;;;AADA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AAIO,MAAMC,SAAS,GAAG,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC3C,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,GAA1B;;AACA,MAAIF,KAAJ,EAAW;AAETE,0BAAIC,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,EAA4C,OAAOC,GAAP,EAAYC,YAAZ,KAA6B;AACvE,UAAID,GAAJ,EAAS;AACPT,QAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkB,IAAlB,CADO,CAER;;AACCX,QAAAA,IAAI;AACL,OAJD,MAIO;AACL,YAAIW,IAAI,GAAG,MAAMhB,IAAI,CAACiB,QAAL,CAAcH,YAAY,CAACI,EAA3B,CAAjB;;AACA,YAAI,CAACF,IAAL,EAAW;AACT,iBAAOX,IAAI,CAAC,IAAIc,4BAAJ,CAAkB,cAAlB,EAAkCC,0BAAWC,YAA7C,CAAD,CAAX;AACD;;AACDjB,QAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkBA,IAAlB;AACAX,QAAAA,IAAI;AACL;AACF,KAbD;AAcD,GAhBD,MAiBK;AACHD,IAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkB,IAAlB;AACAX,IAAAA,IAAI;AACL;AACF,CAvBM;;;;AAyBA,MAAMiB,WAAW,GAAG,CAACnB,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC7C,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,GAA1B;;AACA,MAAIF,KAAJ,EAAW;AACTE,0BAAIC,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,EAA4C,OAAOC,GAAP,EAAYC,YAAZ,KAA6B;AACvE,UAAGD,GAAH,EAAO;AACLU,QAAAA,OAAO,CAACC,GAAR,CAAYX,GAAZ;AACD,OAFD,MAEK;AACHU,QAAAA,OAAO,CAACC,GAAR,CAAYV,YAAY,CAACI,EAAzB;AACAb,QAAAA,IAAI;AACL;AACF,KAPD;AAQD,GATD,MASK;AACHkB,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACD;AACF,CAdM","sourceRoot":"/Applications/dossier/mern_project_app2/src/middlewares/","sourcesContent":["import jwt from 'jsonwebtoken';\nconst User = require('../models/user.model')\nimport { HttpException, HttpStatus } from '../errors/HttpException.error';\n\n\nexport const checkUser = (req, res, next) => {\n  const token = req.cookies.jwt;\n  if (token) {\n \n    jwt.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        res.locals.user = null;\n       // res.cookie(\"jwt\", '', { maxAge: 1 })\n        next();\n      } else {\n        let user = await User.findById(decodedToken.id);\n        if (!user) {\n          return next(new HttpException('Unauthorized', HttpStatus.UNAUTHORIZED));\n        }\n        res.locals.user = user;\n        next();\n      }\n    })\n  }\n  else {\n    res.locals.user = null;\n    next();\n  }\n}\n\nexport const requireAuth = (req, res, next) => {\n  const token = req.cookies.jwt\n  if (token) {\n    jwt.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if(err){\n        console.log(err);\n      }else{\n        console.log(decodedToken.id)\n        next();\n      }\n    })\n  }else{\n    console.log('no token')\n  }\n}\n"]}},"mtime":1651607963929},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/middlewares/auth.middleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.requireAuth = exports.checkUser = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _HttpException = require(\"../errors/HttpException.error\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst User = require('../models/user.model');\n\nconst checkUser = (req, res, next) => {\n  const token = req.cookies.jwt;\n\n  if (token) {\n    _jsonwebtoken.default.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        res.locals.user = null; // res.cookie(\"jwt\", '', { maxAge: 1 })\n\n        next();\n      } else {\n        let user = await User.findById(decodedToken.id);\n\n        if (!user) {\n          return next(new _HttpException.HttpException('Unauthorized', _HttpException.HttpStatus.UNAUTHORIZED));\n        }\n\n        res.locals.user = user;\n        next();\n      }\n    });\n  } else {\n    res.locals.user = null;\n    next();\n  }\n};\n\nexports.checkUser = checkUser;\n\nconst requireAuth = (req, res, next) => {\n  const token = req.cookies.jwt;\n\n  if (token) {\n    _jsonwebtoken.default.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        console.log(err);\n      } else {\n        console.log(decodedToken.id);\n        next();\n      }\n    });\n  } else {\n    console.log('no token');\n  }\n};\n\nexports.requireAuth = requireAuth;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgubWlkZGxld2FyZS5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImNoZWNrVXNlciIsInJlcSIsInJlcyIsIm5leHQiLCJ0b2tlbiIsImNvb2tpZXMiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiVE9LRU5fU0VDUkVUIiwiZXJyIiwiZGVjb2RlZFRva2VuIiwibG9jYWxzIiwidXNlciIsImZpbmRCeUlkIiwiaWQiLCJIdHRwRXhjZXB0aW9uIiwiSHR0cFN0YXR1cyIsIlVOQVVUSE9SSVpFRCIsInJlcXVpcmVBdXRoIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUVBOzs7O0FBREEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsc0JBQUQsQ0FBcEI7O0FBSU8sTUFBTUMsU0FBUyxHQUFHLENBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFXQyxJQUFYLEtBQW9CO0FBQzNDLFFBQU1DLEtBQUssR0FBR0gsR0FBRyxDQUFDSSxPQUFKLENBQVlDLEdBQTFCOztBQUNBLE1BQUlGLEtBQUosRUFBVztBQUVURSwwQkFBSUMsTUFBSixDQUFXSCxLQUFYLEVBQWtCSSxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsWUFBOUIsRUFBNEMsT0FBT0MsR0FBUCxFQUFZQyxZQUFaLEtBQTZCO0FBQ3ZFLFVBQUlELEdBQUosRUFBUztBQUNQVCxRQUFBQSxHQUFHLENBQUNXLE1BQUosQ0FBV0MsSUFBWCxHQUFrQixJQUFsQixDQURPLENBRVI7O0FBQ0NYLFFBQUFBLElBQUk7QUFDTCxPQUpELE1BSU87QUFDTCxZQUFJVyxJQUFJLEdBQUcsTUFBTWhCLElBQUksQ0FBQ2lCLFFBQUwsQ0FBY0gsWUFBWSxDQUFDSSxFQUEzQixDQUFqQjs7QUFDQSxZQUFJLENBQUNGLElBQUwsRUFBVztBQUNULGlCQUFPWCxJQUFJLENBQUMsSUFBSWMsNEJBQUosQ0FBa0IsY0FBbEIsRUFBa0NDLDBCQUFXQyxZQUE3QyxDQUFELENBQVg7QUFDRDs7QUFDRGpCLFFBQUFBLEdBQUcsQ0FBQ1csTUFBSixDQUFXQyxJQUFYLEdBQWtCQSxJQUFsQjtBQUNBWCxRQUFBQSxJQUFJO0FBQ0w7QUFDRixLQWJEO0FBY0QsR0FoQkQsTUFpQks7QUFDSEQsSUFBQUEsR0FBRyxDQUFDVyxNQUFKLENBQVdDLElBQVgsR0FBa0IsSUFBbEI7QUFDQVgsSUFBQUEsSUFBSTtBQUNMO0FBQ0YsQ0F2Qk07Ozs7QUF5QkEsTUFBTWlCLFdBQVcsR0FBRyxDQUFDbkIsR0FBRCxFQUFNQyxHQUFOLEVBQVdDLElBQVgsS0FBb0I7QUFDN0MsUUFBTUMsS0FBSyxHQUFHSCxHQUFHLENBQUNJLE9BQUosQ0FBWUMsR0FBMUI7O0FBQ0EsTUFBSUYsS0FBSixFQUFXO0FBQ1RFLDBCQUFJQyxNQUFKLENBQVdILEtBQVgsRUFBa0JJLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUE5QixFQUE0QyxPQUFPQyxHQUFQLEVBQVlDLFlBQVosS0FBNkI7QUFDdkUsVUFBR0QsR0FBSCxFQUFPO0FBQ0xVLFFBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZWCxHQUFaO0FBQ0QsT0FGRCxNQUVLO0FBQ0hVLFFBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZVixZQUFZLENBQUNJLEVBQXpCO0FBQ0FiLFFBQUFBLElBQUk7QUFDTDtBQUNGLEtBUEQ7QUFRRCxHQVRELE1BU0s7QUFDSGtCLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLFVBQVo7QUFDRDtBQUNGLENBZE0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbic7XG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuaW1wb3J0IHsgSHR0cEV4Y2VwdGlvbiwgSHR0cFN0YXR1cyB9IGZyb20gJy4uL2Vycm9ycy9IdHRwRXhjZXB0aW9uLmVycm9yJztcblxuXG5leHBvcnQgY29uc3QgY2hlY2tVc2VyID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHRva2VuID0gcmVxLmNvb2tpZXMuand0O1xuICBpZiAodG9rZW4pIHtcbiBcbiAgICBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5UT0tFTl9TRUNSRVQsIGFzeW5jIChlcnIsIGRlY29kZWRUb2tlbikgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZXMubG9jYWxzLnVzZXIgPSBudWxsO1xuICAgICAgIC8vIHJlcy5jb29raWUoXCJqd3RcIiwgJycsIHsgbWF4QWdlOiAxIH0pXG4gICAgICAgIG5leHQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChkZWNvZGVkVG9rZW4uaWQpO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICByZXR1cm4gbmV4dChuZXcgSHR0cEV4Y2VwdGlvbignVW5hdXRob3JpemVkJywgSHR0cFN0YXR1cy5VTkFVVEhPUklaRUQpKTtcbiAgICAgICAgfVxuICAgICAgICByZXMubG9jYWxzLnVzZXIgPSB1c2VyO1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9XG4gICAgfSlcbiAgfVxuICBlbHNlIHtcbiAgICByZXMubG9jYWxzLnVzZXIgPSBudWxsO1xuICAgIG5leHQoKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcmVxdWlyZUF1dGggPSAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgY29uc3QgdG9rZW4gPSByZXEuY29va2llcy5qd3RcbiAgaWYgKHRva2VuKSB7XG4gICAgand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVULCBhc3luYyAoZXJyLCBkZWNvZGVkVG9rZW4pID0+IHtcbiAgICAgIGlmKGVycil7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgY29uc29sZS5sb2coZGVjb2RlZFRva2VuLmlkKVxuICAgICAgICBuZXh0KCk7XG4gICAgICB9XG4gICAgfSlcbiAgfWVsc2V7XG4gICAgY29uc29sZS5sb2coJ25vIHRva2VuJylcbiAgfVxufVxuIl19","map":{"version":3,"sources":["auth.middleware.js"],"names":["User","require","checkUser","req","res","next","token","cookies","jwt","verify","process","env","TOKEN_SECRET","err","decodedToken","locals","user","findById","id","HttpException","HttpStatus","UNAUTHORIZED","requireAuth","console","log"],"mappings":";;;;;;;AAAA;;AAEA;;;;AADA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AAIO,MAAMC,SAAS,GAAG,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC3C,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,GAA1B;;AACA,MAAIF,KAAJ,EAAW;AAETE,0BAAIC,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,EAA4C,OAAOC,GAAP,EAAYC,YAAZ,KAA6B;AACvE,UAAID,GAAJ,EAAS;AACPT,QAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkB,IAAlB,CADO,CAER;;AACCX,QAAAA,IAAI;AACL,OAJD,MAIO;AACL,YAAIW,IAAI,GAAG,MAAMhB,IAAI,CAACiB,QAAL,CAAcH,YAAY,CAACI,EAA3B,CAAjB;;AACA,YAAI,CAACF,IAAL,EAAW;AACT,iBAAOX,IAAI,CAAC,IAAIc,4BAAJ,CAAkB,cAAlB,EAAkCC,0BAAWC,YAA7C,CAAD,CAAX;AACD;;AACDjB,QAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkBA,IAAlB;AACAX,QAAAA,IAAI;AACL;AACF,KAbD;AAcD,GAhBD,MAiBK;AACHD,IAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkB,IAAlB;AACAX,IAAAA,IAAI;AACL;AACF,CAvBM;;;;AAyBA,MAAMiB,WAAW,GAAG,CAACnB,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC7C,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,GAA1B;;AACA,MAAIF,KAAJ,EAAW;AACTE,0BAAIC,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,EAA4C,OAAOC,GAAP,EAAYC,YAAZ,KAA6B;AACvE,UAAGD,GAAH,EAAO;AACLU,QAAAA,OAAO,CAACC,GAAR,CAAYX,GAAZ;AACD,OAFD,MAEK;AACHU,QAAAA,OAAO,CAACC,GAAR,CAAYV,YAAY,CAACI,EAAzB;AACAb,QAAAA,IAAI;AACL;AACF,KAPD;AAQD,GATD,MASK;AACHkB,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACD;AACF,CAdM","sourceRoot":"/Applications/dossier/mern_project_app2/src/middlewares/","sourcesContent":["import jwt from 'jsonwebtoken';\nconst User = require('../models/user.model')\nimport { HttpException, HttpStatus } from '../errors/HttpException.error';\n\n\nexport const checkUser = (req, res, next) => {\n  const token = req.cookies.jwt;\n  if (token) {\n \n    jwt.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        res.locals.user = null;\n       // res.cookie(\"jwt\", '', { maxAge: 1 })\n        next();\n      } else {\n        let user = await User.findById(decodedToken.id);\n        if (!user) {\n          return next(new HttpException('Unauthorized', HttpStatus.UNAUTHORIZED));\n        }\n        res.locals.user = user;\n        next();\n      }\n    })\n  }\n  else {\n    res.locals.user = null;\n    next();\n  }\n}\n\nexport const requireAuth = (req, res, next) => {\n  const token = req.cookies.jwt\n  if (token) {\n    jwt.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if(err){\n        console.log(err);\n      }else{\n        console.log(decodedToken.id)\n        next();\n      }\n    })\n  }else{\n    console.log('no token')\n  }\n}\n"]}},"mtime":1651607963929},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/middlewares/jwt.middleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.jwtMiddleware = void 0;\n\nvar _express = require(\"express\");\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _HttpException = require(\"../errors/HttpException.error\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst User = require('../models/user.model');\n\nconst jwtMiddleware = (req, res, next) => {\n  async (req, _res, next) => {\n    console.log('jwtMiddleware');\n    const token = req.cookies.jwt;\n\n    if (token) {\n      const {\n        id\n      } = _jsonwebtoken.default.verify(token, process.env.TOKEN_SECRET);\n\n      let user = await User.findById(id);\n\n      if (!user) {\n        return next(new _HttpException.HttpException('Unauthorized', _HttpException.HttpStatus.UNAUTHORIZED));\n      }\n\n      _express.request.user = user;\n      next();\n    } else {\n      next(new _HttpException.HttpException('Unauthorized', _HttpException.HttpStatus.UNAUTHORIZED));\n    }\n  };\n};\n\nexports.jwtMiddleware = jwtMiddleware;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImp3dC5taWRkbGV3YXJlLmpzIl0sIm5hbWVzIjpbIlVzZXIiLCJyZXF1aXJlIiwiand0TWlkZGxld2FyZSIsInJlcSIsInJlcyIsIm5leHQiLCJfcmVzIiwiY29uc29sZSIsImxvZyIsInRva2VuIiwiY29va2llcyIsImp3dCIsImlkIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsInVzZXIiLCJmaW5kQnlJZCIsIkh0dHBFeGNlcHRpb24iLCJIdHRwU3RhdHVzIiwiVU5BVVRIT1JJWkVEIiwicmVxdWVzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7O0FBQ0EsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsc0JBQUQsQ0FBcEI7O0FBRU8sTUFBTUMsYUFBYSxHQUFHLENBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFXQyxJQUFYLEtBQW9CO0FBQy9DLFNBQU9GLEdBQVAsRUFBWUcsSUFBWixFQUFrQkQsSUFBbEIsS0FBMkI7QUFDM0JFLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGVBQVo7QUFDQSxVQUFNQyxLQUFLLEdBQUdOLEdBQUcsQ0FBQ08sT0FBSixDQUFZQyxHQUExQjs7QUFDQSxRQUFJRixLQUFKLEVBQVc7QUFDVCxZQUFNO0FBQUVHLFFBQUFBO0FBQUYsVUFBU0Qsc0JBQUlFLE1BQUosQ0FBV0osS0FBWCxFQUFrQkssT0FBTyxDQUFDQyxHQUFSLENBQVlDLFlBQTlCLENBQWY7O0FBQ0EsVUFBSUMsSUFBSSxHQUFHLE1BQU1qQixJQUFJLENBQUNrQixRQUFMLENBQWNOLEVBQWQsQ0FBakI7O0FBQ0EsVUFBSSxDQUFDSyxJQUFMLEVBQVc7QUFDVCxlQUFPWixJQUFJLENBQUMsSUFBSWMsNEJBQUosQ0FBa0IsY0FBbEIsRUFBa0NDLDBCQUFXQyxZQUE3QyxDQUFELENBQVg7QUFDRDs7QUFDREMsdUJBQVFMLElBQVIsR0FBZUEsSUFBZjtBQUNBWixNQUFBQSxJQUFJO0FBQ0wsS0FSRCxNQVFLO0FBQ0hBLE1BQUFBLElBQUksQ0FBQyxJQUFJYyw0QkFBSixDQUFrQixjQUFsQixFQUFrQ0MsMEJBQVdDLFlBQTdDLENBQUQsQ0FBSjtBQUNEO0FBQ0YsR0FkQztBQWVDLENBaEJJIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuaW1wb3J0IHsgSHR0cEV4Y2VwdGlvbiwgSHR0cFN0YXR1cyB9IGZyb20gJy4uL2Vycm9ycy9IdHRwRXhjZXB0aW9uLmVycm9yJztcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbHMvdXNlci5tb2RlbCcpXG5cbmV4cG9ydCBjb25zdCBqd3RNaWRkbGV3YXJlID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGFzeW5jIChyZXEsIF9yZXMsIG5leHQpID0+IHtcbiAgY29uc29sZS5sb2coJ2p3dE1pZGRsZXdhcmUnKVxuICBjb25zdCB0b2tlbiA9IHJlcS5jb29raWVzLmp3dDtcbiAgaWYgKHRva2VuKSB7XG4gICAgY29uc3QgeyBpZCB9ID0gand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVUKVxuICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChpZCk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gbmV4dChuZXcgSHR0cEV4Y2VwdGlvbignVW5hdXRob3JpemVkJywgSHR0cFN0YXR1cy5VTkFVVEhPUklaRUQpKTtcbiAgICB9XG4gICAgcmVxdWVzdC51c2VyID0gdXNlcjtcbiAgICBuZXh0KCk7XG4gIH1lbHNle1xuICAgIG5leHQobmV3IEh0dHBFeGNlcHRpb24oJ1VuYXV0aG9yaXplZCcsIEh0dHBTdGF0dXMuVU5BVVRIT1JJWkVEKSk7XG4gIH1cbn1cbiAgfVxuXG4iXX0=","map":{"version":3,"sources":["jwt.middleware.js"],"names":["User","require","jwtMiddleware","req","res","next","_res","console","log","token","cookies","jwt","id","verify","process","env","TOKEN_SECRET","user","findById","HttpException","HttpStatus","UNAUTHORIZED","request"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AAEO,MAAMC,aAAa,GAAG,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC/C,SAAOF,GAAP,EAAYG,IAAZ,EAAkBD,IAAlB,KAA2B;AAC3BE,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACA,UAAMC,KAAK,GAAGN,GAAG,CAACO,OAAJ,CAAYC,GAA1B;;AACA,QAAIF,KAAJ,EAAW;AACT,YAAM;AAAEG,QAAAA;AAAF,UAASD,sBAAIE,MAAJ,CAAWJ,KAAX,EAAkBK,OAAO,CAACC,GAAR,CAAYC,YAA9B,CAAf;;AACA,UAAIC,IAAI,GAAG,MAAMjB,IAAI,CAACkB,QAAL,CAAcN,EAAd,CAAjB;;AACA,UAAI,CAACK,IAAL,EAAW;AACT,eAAOZ,IAAI,CAAC,IAAIc,4BAAJ,CAAkB,cAAlB,EAAkCC,0BAAWC,YAA7C,CAAD,CAAX;AACD;;AACDC,uBAAQL,IAAR,GAAeA,IAAf;AACAZ,MAAAA,IAAI;AACL,KARD,MAQK;AACHA,MAAAA,IAAI,CAAC,IAAIc,4BAAJ,CAAkB,cAAlB,EAAkCC,0BAAWC,YAA7C,CAAD,CAAJ;AACD;AACF,GAdC;AAeC,CAhBI","sourceRoot":"/Applications/dossier/mern_project_app2/src/middlewares/","sourcesContent":["import { request } from 'express';\nimport jwt from 'jsonwebtoken';\nimport { HttpException, HttpStatus } from '../errors/HttpException.error';\nconst User = require('../models/user.model')\n\nexport const jwtMiddleware = (req, res, next) => {\n  async (req, _res, next) => {\n  console.log('jwtMiddleware')\n  const token = req.cookies.jwt;\n  if (token) {\n    const { id } = jwt.verify(token, process.env.TOKEN_SECRET)\n    let user = await User.findById(id);\n    if (!user) {\n      return next(new HttpException('Unauthorized', HttpStatus.UNAUTHORIZED));\n    }\n    request.user = user;\n    next();\n  }else{\n    next(new HttpException('Unauthorized', HttpStatus.UNAUTHORIZED));\n  }\n}\n  }\n\n"]}},"mtime":1651272395940},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/errors/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/errors/HttpException.error.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HttpStatus = exports.HttpException = void 0;\nconst HttpStatus = {\n  UNAUTHORIZED: 401,\n  NOT_FOUND: 404\n};\nexports.HttpStatus = HttpStatus;\n\nclass HttpException extends Error {\n  constructor(message, statusCode) {\n    super(message);\n    this.statusCode = statusCode;\n  }\n\n}\n\nexports.HttpException = HttpException;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkh0dHBFeGNlcHRpb24uZXJyb3IuanMiXSwibmFtZXMiOlsiSHR0cFN0YXR1cyIsIlVOQVVUSE9SSVpFRCIsIk5PVF9GT1VORCIsIkh0dHBFeGNlcHRpb24iLCJFcnJvciIsImNvbnN0cnVjdG9yIiwibWVzc2FnZSIsInN0YXR1c0NvZGUiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFPLE1BQU1BLFVBQVUsR0FBRztBQUN4QkMsRUFBQUEsWUFBWSxFQUFFLEdBRFU7QUFFeEJDLEVBQUFBLFNBQVMsRUFBRTtBQUZhLENBQW5COzs7QUFLQSxNQUFNQyxhQUFOLFNBQTRCQyxLQUE1QixDQUFrQztBQUN2Q0MsRUFBQUEsV0FBVyxDQUFDQyxPQUFELEVBQVVDLFVBQVYsRUFBc0I7QUFDL0IsVUFBTUQsT0FBTjtBQUVBLFNBQUtDLFVBQUwsR0FBa0JBLFVBQWxCO0FBQ0Q7O0FBTHNDIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvZXJyb3JzLyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBIdHRwU3RhdHVzID0ge1xuICBVTkFVVEhPUklaRUQ6IDQwMSxcbiAgTk9UX0ZPVU5EOiA0MDQsXG59XG5cbmV4cG9ydCBjbGFzcyBIdHRwRXhjZXB0aW9uIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlLCBzdGF0dXNDb2RlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG5cbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xuICB9XG59XG4iXX0=","map":{"version":3,"sources":["HttpException.error.js"],"names":["HttpStatus","UNAUTHORIZED","NOT_FOUND","HttpException","Error","constructor","message","statusCode"],"mappings":";;;;;;AAAO,MAAMA,UAAU,GAAG;AACxBC,EAAAA,YAAY,EAAE,GADU;AAExBC,EAAAA,SAAS,EAAE;AAFa,CAAnB;;;AAKA,MAAMC,aAAN,SAA4BC,KAA5B,CAAkC;AACvCC,EAAAA,WAAW,CAACC,OAAD,EAAUC,UAAV,EAAsB;AAC/B,UAAMD,OAAN;AAEA,SAAKC,UAAL,GAAkBA,UAAlB;AACD;;AALsC","sourceRoot":"/Applications/dossier/mern_project_app2/src/errors/","sourcesContent":["export const HttpStatus = {\n  UNAUTHORIZED: 401,\n  NOT_FOUND: 404,\n}\n\nexport class HttpException extends Error {\n  constructor(message, statusCode) {\n    super(message);\n\n    this.statusCode = statusCode;\n  }\n}\n"]}},"mtime":1651253219660},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/middlewares/jwt.middleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.jwtMiddleware = void 0;\n\nvar _express = require(\"express\");\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _HttpException = require(\"../errors/HttpException.error\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst User = require('../models/user.model');\n\nconst jwtMiddleware = (req, res, next) => {\n  async (req, _res, next) => {\n    console.log('jwtMiddleware');\n    const token = req.cookies.jwt;\n\n    if (token) {\n      const {\n        id\n      } = _jsonwebtoken.default.verify(token, process.env.TOKEN_SECRET);\n\n      let user = await User.findById(id);\n\n      if (!user) {\n        return next(new _HttpException.HttpException('Unauthorized', _HttpException.HttpStatus.UNAUTHORIZED));\n      }\n\n      _express.request.user = user;\n      next();\n    } else {\n      next(new _HttpException.HttpException('Unauthorized', _HttpException.HttpStatus.UNAUTHORIZED));\n    }\n  };\n};\n\nexports.jwtMiddleware = jwtMiddleware;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImp3dC5taWRkbGV3YXJlLmpzIl0sIm5hbWVzIjpbIlVzZXIiLCJyZXF1aXJlIiwiand0TWlkZGxld2FyZSIsInJlcSIsInJlcyIsIm5leHQiLCJfcmVzIiwiY29uc29sZSIsImxvZyIsInRva2VuIiwiY29va2llcyIsImp3dCIsImlkIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsInVzZXIiLCJmaW5kQnlJZCIsIkh0dHBFeGNlcHRpb24iLCJIdHRwU3RhdHVzIiwiVU5BVVRIT1JJWkVEIiwicmVxdWVzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7O0FBQ0EsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsc0JBQUQsQ0FBcEI7O0FBRU8sTUFBTUMsYUFBYSxHQUFHLENBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFXQyxJQUFYLEtBQW9CO0FBQy9DLFNBQU9GLEdBQVAsRUFBWUcsSUFBWixFQUFrQkQsSUFBbEIsS0FBMkI7QUFDM0JFLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGVBQVo7QUFDQSxVQUFNQyxLQUFLLEdBQUdOLEdBQUcsQ0FBQ08sT0FBSixDQUFZQyxHQUExQjs7QUFDQSxRQUFJRixLQUFKLEVBQVc7QUFDVCxZQUFNO0FBQUVHLFFBQUFBO0FBQUYsVUFBU0Qsc0JBQUlFLE1BQUosQ0FBV0osS0FBWCxFQUFrQkssT0FBTyxDQUFDQyxHQUFSLENBQVlDLFlBQTlCLENBQWY7O0FBQ0EsVUFBSUMsSUFBSSxHQUFHLE1BQU1qQixJQUFJLENBQUNrQixRQUFMLENBQWNOLEVBQWQsQ0FBakI7O0FBQ0EsVUFBSSxDQUFDSyxJQUFMLEVBQVc7QUFDVCxlQUFPWixJQUFJLENBQUMsSUFBSWMsNEJBQUosQ0FBa0IsY0FBbEIsRUFBa0NDLDBCQUFXQyxZQUE3QyxDQUFELENBQVg7QUFDRDs7QUFDREMsdUJBQVFMLElBQVIsR0FBZUEsSUFBZjtBQUNBWixNQUFBQSxJQUFJO0FBQ0wsS0FSRCxNQVFLO0FBQ0hBLE1BQUFBLElBQUksQ0FBQyxJQUFJYyw0QkFBSixDQUFrQixjQUFsQixFQUFrQ0MsMEJBQVdDLFlBQTdDLENBQUQsQ0FBSjtBQUNEO0FBQ0YsR0FkQztBQWVDLENBaEJJIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuaW1wb3J0IHsgSHR0cEV4Y2VwdGlvbiwgSHR0cFN0YXR1cyB9IGZyb20gJy4uL2Vycm9ycy9IdHRwRXhjZXB0aW9uLmVycm9yJztcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbHMvdXNlci5tb2RlbCcpXG5cbmV4cG9ydCBjb25zdCBqd3RNaWRkbGV3YXJlID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGFzeW5jIChyZXEsIF9yZXMsIG5leHQpID0+IHtcbiAgY29uc29sZS5sb2coJ2p3dE1pZGRsZXdhcmUnKVxuICBjb25zdCB0b2tlbiA9IHJlcS5jb29raWVzLmp3dDtcbiAgaWYgKHRva2VuKSB7XG4gICAgY29uc3QgeyBpZCB9ID0gand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVUKVxuICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChpZCk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gbmV4dChuZXcgSHR0cEV4Y2VwdGlvbignVW5hdXRob3JpemVkJywgSHR0cFN0YXR1cy5VTkFVVEhPUklaRUQpKTtcbiAgICB9XG4gICAgcmVxdWVzdC51c2VyID0gdXNlcjtcbiAgICBuZXh0KCk7XG4gIH1lbHNle1xuICAgIG5leHQobmV3IEh0dHBFeGNlcHRpb24oJ1VuYXV0aG9yaXplZCcsIEh0dHBTdGF0dXMuVU5BVVRIT1JJWkVEKSk7XG4gIH1cbn1cbiAgfVxuXG4iXX0=","map":{"version":3,"sources":["jwt.middleware.js"],"names":["User","require","jwtMiddleware","req","res","next","_res","console","log","token","cookies","jwt","id","verify","process","env","TOKEN_SECRET","user","findById","HttpException","HttpStatus","UNAUTHORIZED","request"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AAEO,MAAMC,aAAa,GAAG,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC/C,SAAOF,GAAP,EAAYG,IAAZ,EAAkBD,IAAlB,KAA2B;AAC3BE,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACA,UAAMC,KAAK,GAAGN,GAAG,CAACO,OAAJ,CAAYC,GAA1B;;AACA,QAAIF,KAAJ,EAAW;AACT,YAAM;AAAEG,QAAAA;AAAF,UAASD,sBAAIE,MAAJ,CAAWJ,KAAX,EAAkBK,OAAO,CAACC,GAAR,CAAYC,YAA9B,CAAf;;AACA,UAAIC,IAAI,GAAG,MAAMjB,IAAI,CAACkB,QAAL,CAAcN,EAAd,CAAjB;;AACA,UAAI,CAACK,IAAL,EAAW;AACT,eAAOZ,IAAI,CAAC,IAAIc,4BAAJ,CAAkB,cAAlB,EAAkCC,0BAAWC,YAA7C,CAAD,CAAX;AACD;;AACDC,uBAAQL,IAAR,GAAeA,IAAf;AACAZ,MAAAA,IAAI;AACL,KARD,MAQK;AACHA,MAAAA,IAAI,CAAC,IAAIc,4BAAJ,CAAkB,cAAlB,EAAkCC,0BAAWC,YAA7C,CAAD,CAAJ;AACD;AACF,GAdC;AAeC,CAhBI","sourceRoot":"/Applications/dossier/mern_project_app2/src/middlewares/","sourcesContent":["import { request } from 'express';\nimport jwt from 'jsonwebtoken';\nimport { HttpException, HttpStatus } from '../errors/HttpException.error';\nconst User = require('../models/user.model')\n\nexport const jwtMiddleware = (req, res, next) => {\n  async (req, _res, next) => {\n  console.log('jwtMiddleware')\n  const token = req.cookies.jwt;\n  if (token) {\n    const { id } = jwt.verify(token, process.env.TOKEN_SECRET)\n    let user = await User.findById(id);\n    if (!user) {\n      return next(new HttpException('Unauthorized', HttpStatus.UNAUTHORIZED));\n    }\n    request.user = user;\n    next();\n  }else{\n    next(new HttpException('Unauthorized', HttpStatus.UNAUTHORIZED));\n  }\n}\n  }\n\n"]}},"mtime":1651272395940},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/errors/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/errors/HttpException.error.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HttpStatus = exports.HttpException = void 0;\nconst HttpStatus = {\n  UNAUTHORIZED: 401,\n  NOT_FOUND: 404\n};\nexports.HttpStatus = HttpStatus;\n\nclass HttpException extends Error {\n  constructor(message, statusCode) {\n    super(message);\n    this.statusCode = statusCode;\n  }\n\n}\n\nexports.HttpException = HttpException;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkh0dHBFeGNlcHRpb24uZXJyb3IuanMiXSwibmFtZXMiOlsiSHR0cFN0YXR1cyIsIlVOQVVUSE9SSVpFRCIsIk5PVF9GT1VORCIsIkh0dHBFeGNlcHRpb24iLCJFcnJvciIsImNvbnN0cnVjdG9yIiwibWVzc2FnZSIsInN0YXR1c0NvZGUiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFPLE1BQU1BLFVBQVUsR0FBRztBQUN4QkMsRUFBQUEsWUFBWSxFQUFFLEdBRFU7QUFFeEJDLEVBQUFBLFNBQVMsRUFBRTtBQUZhLENBQW5COzs7QUFLQSxNQUFNQyxhQUFOLFNBQTRCQyxLQUE1QixDQUFrQztBQUN2Q0MsRUFBQUEsV0FBVyxDQUFDQyxPQUFELEVBQVVDLFVBQVYsRUFBc0I7QUFDL0IsVUFBTUQsT0FBTjtBQUVBLFNBQUtDLFVBQUwsR0FBa0JBLFVBQWxCO0FBQ0Q7O0FBTHNDIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvZXJyb3JzLyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBIdHRwU3RhdHVzID0ge1xuICBVTkFVVEhPUklaRUQ6IDQwMSxcbiAgTk9UX0ZPVU5EOiA0MDQsXG59XG5cbmV4cG9ydCBjbGFzcyBIdHRwRXhjZXB0aW9uIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlLCBzdGF0dXNDb2RlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG5cbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xuICB9XG59XG4iXX0=","map":{"version":3,"sources":["HttpException.error.js"],"names":["HttpStatus","UNAUTHORIZED","NOT_FOUND","HttpException","Error","constructor","message","statusCode"],"mappings":";;;;;;AAAO,MAAMA,UAAU,GAAG;AACxBC,EAAAA,YAAY,EAAE,GADU;AAExBC,EAAAA,SAAS,EAAE;AAFa,CAAnB;;;AAKA,MAAMC,aAAN,SAA4BC,KAA5B,CAAkC;AACvCC,EAAAA,WAAW,CAACC,OAAD,EAAUC,UAAV,EAAsB;AAC/B,UAAMD,OAAN;AAEA,SAAKC,UAAL,GAAkBA,UAAlB;AACD;;AALsC","sourceRoot":"/Applications/dossier/mern_project_app2/src/errors/","sourcesContent":["export const HttpStatus = {\n  UNAUTHORIZED: 401,\n  NOT_FOUND: 404,\n}\n\nexport class HttpException extends Error {\n  constructor(message, statusCode) {\n    super(message);\n\n    this.statusCode = statusCode;\n  }\n}\n"]}},"mtime":1651253219660},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/utils/errors.utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.uploadErrors = exports.signUpErrors = exports.signInErrors = void 0;\n\nconst signUpErrors = err => {\n  let errors = {\n    pseudo: '',\n    email: '',\n    password: ''\n  };\n\n  if (err.message.includes('pseudo')) {\n    errors.pseudo = \"Pseudo incorrect\";\n  }\n\n  if (err.message.includes('email')) {\n    errors.email = \"Email incorrect\";\n  }\n\n  if (err.message.includes('password')) {\n    errors.password = \"Password incorrect ! Password must be at least 6 characters\";\n  }\n\n  if (err.code === 11000 && Object.keys(err.keyValue)[0].includes('pseudo')) {\n    errors.pseudo = \"Pseudo already use\";\n  }\n\n  if (err.code === 11000 && Object.keys(err.keyValue)[0].includes('email')) {\n    errors.email = \"Email already use\";\n  }\n\n  return errors;\n};\n\nexports.signUpErrors = signUpErrors;\n\nconst signInErrors = err => {\n  let errors = {\n    email: '',\n    password: ''\n  };\n\n  if (err.message.includes('email')) {\n    errors.email = \"Email inconnu\";\n  }\n\n  if (err.message.includes('password')) {\n    errors.password = \"Vos identifiants sont incorrects !\";\n  }\n\n  return errors;\n};\n\nexports.signInErrors = signInErrors;\n\nconst uploadErrors = err => {\n  let errors = {\n    format: '',\n    maxSize: ''\n  };\n\n  if (err.message.includes('invalid file')) {\n    errors.format = \"format incompatible\";\n  }\n\n  if (err.message.includes('max size')) {\n    errors.maxSize = \"Le fichier dépasse 500ko\";\n  }\n\n  return errors;\n};\n\nexports.uploadErrors = uploadErrors;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9ycy51dGlscy5qcyJdLCJuYW1lcyI6WyJzaWduVXBFcnJvcnMiLCJlcnIiLCJlcnJvcnMiLCJwc2V1ZG8iLCJlbWFpbCIsInBhc3N3b3JkIiwibWVzc2FnZSIsImluY2x1ZGVzIiwiY29kZSIsIk9iamVjdCIsImtleXMiLCJrZXlWYWx1ZSIsInNpZ25JbkVycm9ycyIsInVwbG9hZEVycm9ycyIsImZvcm1hdCIsIm1heFNpemUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBTyxNQUFNQSxZQUFZLEdBQUlDLEdBQUQsSUFBUztBQUNqQyxNQUFJQyxNQUFNLEdBQUc7QUFBQ0MsSUFBQUEsTUFBTSxFQUFFLEVBQVQ7QUFBYUMsSUFBQUEsS0FBSyxFQUFFLEVBQXBCO0FBQXdCQyxJQUFBQSxRQUFRLEVBQUU7QUFBbEMsR0FBYjs7QUFFQSxNQUFHSixHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixRQUFyQixDQUFILEVBQWtDO0FBQzlCTCxJQUFBQSxNQUFNLENBQUNDLE1BQVAsR0FBZ0Isa0JBQWhCO0FBQ0g7O0FBQ0QsTUFBR0YsR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsT0FBckIsQ0FBSCxFQUFpQztBQUM3QkwsSUFBQUEsTUFBTSxDQUFDRSxLQUFQLEdBQWUsaUJBQWY7QUFDSDs7QUFDRCxNQUFHSCxHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixVQUFyQixDQUFILEVBQW9DO0FBQ2hDTCxJQUFBQSxNQUFNLENBQUNHLFFBQVAsR0FBa0IsNkRBQWxCO0FBQ0g7O0FBQ0QsTUFBR0osR0FBRyxDQUFDTyxJQUFKLEtBQWEsS0FBYixJQUFzQkMsTUFBTSxDQUFDQyxJQUFQLENBQVlULEdBQUcsQ0FBQ1UsUUFBaEIsRUFBMEIsQ0FBMUIsRUFBNkJKLFFBQTdCLENBQXNDLFFBQXRDLENBQXpCLEVBQXlFO0FBQ3JFTCxJQUFBQSxNQUFNLENBQUNDLE1BQVAsR0FBZ0Isb0JBQWhCO0FBQ0g7O0FBQ0QsTUFBR0YsR0FBRyxDQUFDTyxJQUFKLEtBQWEsS0FBYixJQUFzQkMsTUFBTSxDQUFDQyxJQUFQLENBQVlULEdBQUcsQ0FBQ1UsUUFBaEIsRUFBMEIsQ0FBMUIsRUFBNkJKLFFBQTdCLENBQXNDLE9BQXRDLENBQXpCLEVBQXdFO0FBQ3BFTCxJQUFBQSxNQUFNLENBQUNFLEtBQVAsR0FBZSxtQkFBZjtBQUNIOztBQUVELFNBQU9GLE1BQVA7QUFDSCxDQXBCTTs7OztBQXNCQSxNQUFNVSxZQUFZLEdBQUlYLEdBQUQsSUFBUztBQUNqQyxNQUFJQyxNQUFNLEdBQUc7QUFBRUUsSUFBQUEsS0FBSyxFQUFFLEVBQVQ7QUFBYUMsSUFBQUEsUUFBUSxFQUFFO0FBQXZCLEdBQWI7O0FBQ0EsTUFBR0osR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsT0FBckIsQ0FBSCxFQUFpQztBQUM3QkwsSUFBQUEsTUFBTSxDQUFDRSxLQUFQLEdBQWUsZUFBZjtBQUNIOztBQUNELE1BQUdILEdBQUcsQ0FBQ0ssT0FBSixDQUFZQyxRQUFaLENBQXFCLFVBQXJCLENBQUgsRUFBb0M7QUFDaENMLElBQUFBLE1BQU0sQ0FBQ0csUUFBUCxHQUFrQixvQ0FBbEI7QUFDSDs7QUFDRCxTQUFPSCxNQUFQO0FBQ0gsQ0FUTTs7OztBQVdBLE1BQU1XLFlBQVksR0FBSVosR0FBRCxJQUFTO0FBQ2pDLE1BQUlDLE1BQU0sR0FBRztBQUFDWSxJQUFBQSxNQUFNLEVBQUUsRUFBVDtBQUFhQyxJQUFBQSxPQUFPLEVBQUM7QUFBckIsR0FBYjs7QUFFQSxNQUFHZCxHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixjQUFyQixDQUFILEVBQXdDO0FBQ3BDTCxJQUFBQSxNQUFNLENBQUNZLE1BQVAsR0FBZ0IscUJBQWhCO0FBQ0g7O0FBRUQsTUFBR2IsR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsVUFBckIsQ0FBSCxFQUFvQztBQUNoQ0wsSUFBQUEsTUFBTSxDQUFDYSxPQUFQLEdBQWlCLDBCQUFqQjtBQUNIOztBQUNELFNBQU9iLE1BQVA7QUFDSCxDQVhNIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvdXRpbHMvIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNpZ25VcEVycm9ycyA9IChlcnIpID0+IHtcbiAgICBsZXQgZXJyb3JzID0ge3BzZXVkbzogJycsIGVtYWlsOiAnJywgcGFzc3dvcmQ6ICcnfVxuICAgIFxuICAgIGlmKGVyci5tZXNzYWdlLmluY2x1ZGVzKCdwc2V1ZG8nKSl7XG4gICAgICAgIGVycm9ycy5wc2V1ZG8gPSBcIlBzZXVkbyBpbmNvcnJlY3RcIlxuICAgIH1cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygnZW1haWwnKSl7XG4gICAgICAgIGVycm9ycy5lbWFpbCA9IFwiRW1haWwgaW5jb3JyZWN0XCJcbiAgICB9XG4gICAgaWYoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ3Bhc3N3b3JkJykpe1xuICAgICAgICBlcnJvcnMucGFzc3dvcmQgPSBcIlBhc3N3b3JkIGluY29ycmVjdCAhIFBhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgNiBjaGFyYWN0ZXJzXCJcbiAgICB9XG4gICAgaWYoZXJyLmNvZGUgPT09IDExMDAwICYmIE9iamVjdC5rZXlzKGVyci5rZXlWYWx1ZSlbMF0uaW5jbHVkZXMoJ3BzZXVkbycpKXtcbiAgICAgICAgZXJyb3JzLnBzZXVkbyA9IFwiUHNldWRvIGFscmVhZHkgdXNlXCJcbiAgICB9XG4gICAgaWYoZXJyLmNvZGUgPT09IDExMDAwICYmIE9iamVjdC5rZXlzKGVyci5rZXlWYWx1ZSlbMF0uaW5jbHVkZXMoJ2VtYWlsJykpe1xuICAgICAgICBlcnJvcnMuZW1haWwgPSBcIkVtYWlsIGFscmVhZHkgdXNlXCJcbiAgICB9XG5cbiAgICByZXR1cm4gZXJyb3JzXG59XG5cbmV4cG9ydCBjb25zdCBzaWduSW5FcnJvcnMgPSAoZXJyKSA9PiB7XG4gICAgbGV0IGVycm9ycyA9IHsgZW1haWw6ICcnLCBwYXNzd29yZDogJyd9XG4gICAgaWYoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ2VtYWlsJykpe1xuICAgICAgICBlcnJvcnMuZW1haWwgPSBcIkVtYWlsIGluY29ubnVcIlxuICAgIH1cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygncGFzc3dvcmQnKSl7XG4gICAgICAgIGVycm9ycy5wYXNzd29yZCA9IFwiVm9zIGlkZW50aWZpYW50cyBzb250IGluY29ycmVjdHMgIVwiXG4gICAgfVxuICAgIHJldHVybiBlcnJvcnNcbn1cblxuZXhwb3J0IGNvbnN0IHVwbG9hZEVycm9ycyA9IChlcnIpID0+IHtcbiAgICBsZXQgZXJyb3JzID0ge2Zvcm1hdDogJycsIG1heFNpemU6Jyd9XG5cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygnaW52YWxpZCBmaWxlJykpe1xuICAgICAgICBlcnJvcnMuZm9ybWF0ID0gXCJmb3JtYXQgaW5jb21wYXRpYmxlXCJcbiAgICB9XG5cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygnbWF4IHNpemUnKSl7XG4gICAgICAgIGVycm9ycy5tYXhTaXplID0gXCJMZSBmaWNoaWVyIGTDqXBhc3NlIDUwMGtvXCJcbiAgICB9XG4gICAgcmV0dXJuIGVycm9ycztcbn0iXX0=","map":{"version":3,"sources":["errors.utils.js"],"names":["signUpErrors","err","errors","pseudo","email","password","message","includes","code","Object","keys","keyValue","signInErrors","uploadErrors","format","maxSize"],"mappings":";;;;;;;AAAO,MAAMA,YAAY,GAAIC,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAACC,IAAAA,MAAM,EAAE,EAAT;AAAaC,IAAAA,KAAK,EAAE,EAApB;AAAwBC,IAAAA,QAAQ,EAAE;AAAlC,GAAb;;AAEA,MAAGJ,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,QAArB,CAAH,EAAkC;AAC9BL,IAAAA,MAAM,CAACC,MAAP,GAAgB,kBAAhB;AACH;;AACD,MAAGF,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,OAArB,CAAH,EAAiC;AAC7BL,IAAAA,MAAM,CAACE,KAAP,GAAe,iBAAf;AACH;;AACD,MAAGH,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACG,QAAP,GAAkB,6DAAlB;AACH;;AACD,MAAGJ,GAAG,CAACO,IAAJ,KAAa,KAAb,IAAsBC,MAAM,CAACC,IAAP,CAAYT,GAAG,CAACU,QAAhB,EAA0B,CAA1B,EAA6BJ,QAA7B,CAAsC,QAAtC,CAAzB,EAAyE;AACrEL,IAAAA,MAAM,CAACC,MAAP,GAAgB,oBAAhB;AACH;;AACD,MAAGF,GAAG,CAACO,IAAJ,KAAa,KAAb,IAAsBC,MAAM,CAACC,IAAP,CAAYT,GAAG,CAACU,QAAhB,EAA0B,CAA1B,EAA6BJ,QAA7B,CAAsC,OAAtC,CAAzB,EAAwE;AACpEL,IAAAA,MAAM,CAACE,KAAP,GAAe,mBAAf;AACH;;AAED,SAAOF,MAAP;AACH,CApBM;;;;AAsBA,MAAMU,YAAY,GAAIX,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAAEE,IAAAA,KAAK,EAAE,EAAT;AAAaC,IAAAA,QAAQ,EAAE;AAAvB,GAAb;;AACA,MAAGJ,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,OAArB,CAAH,EAAiC;AAC7BL,IAAAA,MAAM,CAACE,KAAP,GAAe,eAAf;AACH;;AACD,MAAGH,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACG,QAAP,GAAkB,oCAAlB;AACH;;AACD,SAAOH,MAAP;AACH,CATM;;;;AAWA,MAAMW,YAAY,GAAIZ,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAACY,IAAAA,MAAM,EAAE,EAAT;AAAaC,IAAAA,OAAO,EAAC;AAArB,GAAb;;AAEA,MAAGd,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,cAArB,CAAH,EAAwC;AACpCL,IAAAA,MAAM,CAACY,MAAP,GAAgB,qBAAhB;AACH;;AAED,MAAGb,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACa,OAAP,GAAiB,0BAAjB;AACH;;AACD,SAAOb,MAAP;AACH,CAXM","sourceRoot":"/Applications/dossier/mern_project_app2/src/utils/","sourcesContent":["export const signUpErrors = (err) => {\n    let errors = {pseudo: '', email: '', password: ''}\n    \n    if(err.message.includes('pseudo')){\n        errors.pseudo = \"Pseudo incorrect\"\n    }\n    if(err.message.includes('email')){\n        errors.email = \"Email incorrect\"\n    }\n    if(err.message.includes('password')){\n        errors.password = \"Password incorrect ! Password must be at least 6 characters\"\n    }\n    if(err.code === 11000 && Object.keys(err.keyValue)[0].includes('pseudo')){\n        errors.pseudo = \"Pseudo already use\"\n    }\n    if(err.code === 11000 && Object.keys(err.keyValue)[0].includes('email')){\n        errors.email = \"Email already use\"\n    }\n\n    return errors\n}\n\nexport const signInErrors = (err) => {\n    let errors = { email: '', password: ''}\n    if(err.message.includes('email')){\n        errors.email = \"Email inconnu\"\n    }\n    if(err.message.includes('password')){\n        errors.password = \"Vos identifiants sont incorrects !\"\n    }\n    return errors\n}\n\nexport const uploadErrors = (err) => {\n    let errors = {format: '', maxSize:''}\n\n    if(err.message.includes('invalid file')){\n        errors.format = \"format incompatible\"\n    }\n\n    if(err.message.includes('max size')){\n        errors.maxSize = \"Le fichier dépasse 500ko\"\n    }\n    return errors;\n}"]}},"mtime":1651327729166},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/utils/errors.utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.uploadErrors = exports.signUpErrors = exports.signInErrors = void 0;\n\nconst signUpErrors = err => {\n  let errors = {\n    pseudo: '',\n    email: '',\n    password: ''\n  };\n\n  if (err.message.includes('pseudo')) {\n    errors.pseudo = \"Pseudo incorrect\";\n  }\n\n  if (err.message.includes('email')) {\n    errors.email = \"Email incorrect\";\n  }\n\n  if (err.message.includes('password')) {\n    errors.password = \"Password incorrect ! Password must be at least 6 characters\";\n  }\n\n  if (err.code === 11000 && Object.keys(err.keyValue)[0].includes('pseudo')) {\n    errors.pseudo = \"Pseudo already use\";\n  }\n\n  if (err.code === 11000 && Object.keys(err.keyValue)[0].includes('email')) {\n    errors.email = \"Email already use\";\n  }\n\n  return errors;\n};\n\nexports.signUpErrors = signUpErrors;\n\nconst signInErrors = err => {\n  let errors = {\n    email: '',\n    password: ''\n  };\n\n  if (err.message.includes('email')) {\n    errors.email = \"Email inconnu\";\n  }\n\n  if (err.message.includes('password')) {\n    errors.password = \"Vos identifiants sont incorrects !\";\n  }\n\n  return errors;\n};\n\nexports.signInErrors = signInErrors;\n\nconst uploadErrors = err => {\n  let errors = {\n    format: '',\n    maxSize: ''\n  };\n\n  if (err.message.includes('invalid file')) {\n    errors.format = \"format incompatible\";\n  }\n\n  if (err.message.includes('max size')) {\n    errors.maxSize = \"Le fichier dépasse 500ko\";\n  }\n\n  return errors;\n};\n\nexports.uploadErrors = uploadErrors;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9ycy51dGlscy5qcyJdLCJuYW1lcyI6WyJzaWduVXBFcnJvcnMiLCJlcnIiLCJlcnJvcnMiLCJwc2V1ZG8iLCJlbWFpbCIsInBhc3N3b3JkIiwibWVzc2FnZSIsImluY2x1ZGVzIiwiY29kZSIsIk9iamVjdCIsImtleXMiLCJrZXlWYWx1ZSIsInNpZ25JbkVycm9ycyIsInVwbG9hZEVycm9ycyIsImZvcm1hdCIsIm1heFNpemUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBTyxNQUFNQSxZQUFZLEdBQUlDLEdBQUQsSUFBUztBQUNqQyxNQUFJQyxNQUFNLEdBQUc7QUFBQ0MsSUFBQUEsTUFBTSxFQUFFLEVBQVQ7QUFBYUMsSUFBQUEsS0FBSyxFQUFFLEVBQXBCO0FBQXdCQyxJQUFBQSxRQUFRLEVBQUU7QUFBbEMsR0FBYjs7QUFFQSxNQUFHSixHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixRQUFyQixDQUFILEVBQWtDO0FBQzlCTCxJQUFBQSxNQUFNLENBQUNDLE1BQVAsR0FBZ0Isa0JBQWhCO0FBQ0g7O0FBQ0QsTUFBR0YsR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsT0FBckIsQ0FBSCxFQUFpQztBQUM3QkwsSUFBQUEsTUFBTSxDQUFDRSxLQUFQLEdBQWUsaUJBQWY7QUFDSDs7QUFDRCxNQUFHSCxHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixVQUFyQixDQUFILEVBQW9DO0FBQ2hDTCxJQUFBQSxNQUFNLENBQUNHLFFBQVAsR0FBa0IsNkRBQWxCO0FBQ0g7O0FBQ0QsTUFBR0osR0FBRyxDQUFDTyxJQUFKLEtBQWEsS0FBYixJQUFzQkMsTUFBTSxDQUFDQyxJQUFQLENBQVlULEdBQUcsQ0FBQ1UsUUFBaEIsRUFBMEIsQ0FBMUIsRUFBNkJKLFFBQTdCLENBQXNDLFFBQXRDLENBQXpCLEVBQXlFO0FBQ3JFTCxJQUFBQSxNQUFNLENBQUNDLE1BQVAsR0FBZ0Isb0JBQWhCO0FBQ0g7O0FBQ0QsTUFBR0YsR0FBRyxDQUFDTyxJQUFKLEtBQWEsS0FBYixJQUFzQkMsTUFBTSxDQUFDQyxJQUFQLENBQVlULEdBQUcsQ0FBQ1UsUUFBaEIsRUFBMEIsQ0FBMUIsRUFBNkJKLFFBQTdCLENBQXNDLE9BQXRDLENBQXpCLEVBQXdFO0FBQ3BFTCxJQUFBQSxNQUFNLENBQUNFLEtBQVAsR0FBZSxtQkFBZjtBQUNIOztBQUVELFNBQU9GLE1BQVA7QUFDSCxDQXBCTTs7OztBQXNCQSxNQUFNVSxZQUFZLEdBQUlYLEdBQUQsSUFBUztBQUNqQyxNQUFJQyxNQUFNLEdBQUc7QUFBRUUsSUFBQUEsS0FBSyxFQUFFLEVBQVQ7QUFBYUMsSUFBQUEsUUFBUSxFQUFFO0FBQXZCLEdBQWI7O0FBQ0EsTUFBR0osR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsT0FBckIsQ0FBSCxFQUFpQztBQUM3QkwsSUFBQUEsTUFBTSxDQUFDRSxLQUFQLEdBQWUsZUFBZjtBQUNIOztBQUNELE1BQUdILEdBQUcsQ0FBQ0ssT0FBSixDQUFZQyxRQUFaLENBQXFCLFVBQXJCLENBQUgsRUFBb0M7QUFDaENMLElBQUFBLE1BQU0sQ0FBQ0csUUFBUCxHQUFrQixvQ0FBbEI7QUFDSDs7QUFDRCxTQUFPSCxNQUFQO0FBQ0gsQ0FUTTs7OztBQVdBLE1BQU1XLFlBQVksR0FBSVosR0FBRCxJQUFTO0FBQ2pDLE1BQUlDLE1BQU0sR0FBRztBQUFDWSxJQUFBQSxNQUFNLEVBQUUsRUFBVDtBQUFhQyxJQUFBQSxPQUFPLEVBQUM7QUFBckIsR0FBYjs7QUFFQSxNQUFHZCxHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixjQUFyQixDQUFILEVBQXdDO0FBQ3BDTCxJQUFBQSxNQUFNLENBQUNZLE1BQVAsR0FBZ0IscUJBQWhCO0FBQ0g7O0FBRUQsTUFBR2IsR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsVUFBckIsQ0FBSCxFQUFvQztBQUNoQ0wsSUFBQUEsTUFBTSxDQUFDYSxPQUFQLEdBQWlCLDBCQUFqQjtBQUNIOztBQUNELFNBQU9iLE1BQVA7QUFDSCxDQVhNIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zcmMvdXRpbHMvIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNpZ25VcEVycm9ycyA9IChlcnIpID0+IHtcbiAgICBsZXQgZXJyb3JzID0ge3BzZXVkbzogJycsIGVtYWlsOiAnJywgcGFzc3dvcmQ6ICcnfVxuICAgIFxuICAgIGlmKGVyci5tZXNzYWdlLmluY2x1ZGVzKCdwc2V1ZG8nKSl7XG4gICAgICAgIGVycm9ycy5wc2V1ZG8gPSBcIlBzZXVkbyBpbmNvcnJlY3RcIlxuICAgIH1cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygnZW1haWwnKSl7XG4gICAgICAgIGVycm9ycy5lbWFpbCA9IFwiRW1haWwgaW5jb3JyZWN0XCJcbiAgICB9XG4gICAgaWYoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ3Bhc3N3b3JkJykpe1xuICAgICAgICBlcnJvcnMucGFzc3dvcmQgPSBcIlBhc3N3b3JkIGluY29ycmVjdCAhIFBhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgNiBjaGFyYWN0ZXJzXCJcbiAgICB9XG4gICAgaWYoZXJyLmNvZGUgPT09IDExMDAwICYmIE9iamVjdC5rZXlzKGVyci5rZXlWYWx1ZSlbMF0uaW5jbHVkZXMoJ3BzZXVkbycpKXtcbiAgICAgICAgZXJyb3JzLnBzZXVkbyA9IFwiUHNldWRvIGFscmVhZHkgdXNlXCJcbiAgICB9XG4gICAgaWYoZXJyLmNvZGUgPT09IDExMDAwICYmIE9iamVjdC5rZXlzKGVyci5rZXlWYWx1ZSlbMF0uaW5jbHVkZXMoJ2VtYWlsJykpe1xuICAgICAgICBlcnJvcnMuZW1haWwgPSBcIkVtYWlsIGFscmVhZHkgdXNlXCJcbiAgICB9XG5cbiAgICByZXR1cm4gZXJyb3JzXG59XG5cbmV4cG9ydCBjb25zdCBzaWduSW5FcnJvcnMgPSAoZXJyKSA9PiB7XG4gICAgbGV0IGVycm9ycyA9IHsgZW1haWw6ICcnLCBwYXNzd29yZDogJyd9XG4gICAgaWYoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ2VtYWlsJykpe1xuICAgICAgICBlcnJvcnMuZW1haWwgPSBcIkVtYWlsIGluY29ubnVcIlxuICAgIH1cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygncGFzc3dvcmQnKSl7XG4gICAgICAgIGVycm9ycy5wYXNzd29yZCA9IFwiVm9zIGlkZW50aWZpYW50cyBzb250IGluY29ycmVjdHMgIVwiXG4gICAgfVxuICAgIHJldHVybiBlcnJvcnNcbn1cblxuZXhwb3J0IGNvbnN0IHVwbG9hZEVycm9ycyA9IChlcnIpID0+IHtcbiAgICBsZXQgZXJyb3JzID0ge2Zvcm1hdDogJycsIG1heFNpemU6Jyd9XG5cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygnaW52YWxpZCBmaWxlJykpe1xuICAgICAgICBlcnJvcnMuZm9ybWF0ID0gXCJmb3JtYXQgaW5jb21wYXRpYmxlXCJcbiAgICB9XG5cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygnbWF4IHNpemUnKSl7XG4gICAgICAgIGVycm9ycy5tYXhTaXplID0gXCJMZSBmaWNoaWVyIGTDqXBhc3NlIDUwMGtvXCJcbiAgICB9XG4gICAgcmV0dXJuIGVycm9ycztcbn0iXX0=","map":{"version":3,"sources":["errors.utils.js"],"names":["signUpErrors","err","errors","pseudo","email","password","message","includes","code","Object","keys","keyValue","signInErrors","uploadErrors","format","maxSize"],"mappings":";;;;;;;AAAO,MAAMA,YAAY,GAAIC,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAACC,IAAAA,MAAM,EAAE,EAAT;AAAaC,IAAAA,KAAK,EAAE,EAApB;AAAwBC,IAAAA,QAAQ,EAAE;AAAlC,GAAb;;AAEA,MAAGJ,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,QAArB,CAAH,EAAkC;AAC9BL,IAAAA,MAAM,CAACC,MAAP,GAAgB,kBAAhB;AACH;;AACD,MAAGF,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,OAArB,CAAH,EAAiC;AAC7BL,IAAAA,MAAM,CAACE,KAAP,GAAe,iBAAf;AACH;;AACD,MAAGH,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACG,QAAP,GAAkB,6DAAlB;AACH;;AACD,MAAGJ,GAAG,CAACO,IAAJ,KAAa,KAAb,IAAsBC,MAAM,CAACC,IAAP,CAAYT,GAAG,CAACU,QAAhB,EAA0B,CAA1B,EAA6BJ,QAA7B,CAAsC,QAAtC,CAAzB,EAAyE;AACrEL,IAAAA,MAAM,CAACC,MAAP,GAAgB,oBAAhB;AACH;;AACD,MAAGF,GAAG,CAACO,IAAJ,KAAa,KAAb,IAAsBC,MAAM,CAACC,IAAP,CAAYT,GAAG,CAACU,QAAhB,EAA0B,CAA1B,EAA6BJ,QAA7B,CAAsC,OAAtC,CAAzB,EAAwE;AACpEL,IAAAA,MAAM,CAACE,KAAP,GAAe,mBAAf;AACH;;AAED,SAAOF,MAAP;AACH,CApBM;;;;AAsBA,MAAMU,YAAY,GAAIX,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAAEE,IAAAA,KAAK,EAAE,EAAT;AAAaC,IAAAA,QAAQ,EAAE;AAAvB,GAAb;;AACA,MAAGJ,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,OAArB,CAAH,EAAiC;AAC7BL,IAAAA,MAAM,CAACE,KAAP,GAAe,eAAf;AACH;;AACD,MAAGH,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACG,QAAP,GAAkB,oCAAlB;AACH;;AACD,SAAOH,MAAP;AACH,CATM;;;;AAWA,MAAMW,YAAY,GAAIZ,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAACY,IAAAA,MAAM,EAAE,EAAT;AAAaC,IAAAA,OAAO,EAAC;AAArB,GAAb;;AAEA,MAAGd,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,cAArB,CAAH,EAAwC;AACpCL,IAAAA,MAAM,CAACY,MAAP,GAAgB,qBAAhB;AACH;;AAED,MAAGb,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACa,OAAP,GAAiB,0BAAjB;AACH;;AACD,SAAOb,MAAP;AACH,CAXM","sourceRoot":"/Applications/dossier/mern_project_app2/src/utils/","sourcesContent":["export const signUpErrors = (err) => {\n    let errors = {pseudo: '', email: '', password: ''}\n    \n    if(err.message.includes('pseudo')){\n        errors.pseudo = \"Pseudo incorrect\"\n    }\n    if(err.message.includes('email')){\n        errors.email = \"Email incorrect\"\n    }\n    if(err.message.includes('password')){\n        errors.password = \"Password incorrect ! Password must be at least 6 characters\"\n    }\n    if(err.code === 11000 && Object.keys(err.keyValue)[0].includes('pseudo')){\n        errors.pseudo = \"Pseudo already use\"\n    }\n    if(err.code === 11000 && Object.keys(err.keyValue)[0].includes('email')){\n        errors.email = \"Email already use\"\n    }\n\n    return errors\n}\n\nexport const signInErrors = (err) => {\n    let errors = { email: '', password: ''}\n    if(err.message.includes('email')){\n        errors.email = \"Email inconnu\"\n    }\n    if(err.message.includes('password')){\n        errors.password = \"Vos identifiants sont incorrects !\"\n    }\n    return errors\n}\n\nexport const uploadErrors = (err) => {\n    let errors = {format: '', maxSize:''}\n\n    if(err.message.includes('invalid file')){\n        errors.format = \"format incompatible\"\n    }\n\n    if(err.message.includes('max size')){\n        errors.maxSize = \"Le fichier dépasse 500ko\"\n    }\n    return errors;\n}"]}},"mtime":1651327729166},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/routes/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/routes/api/post.route.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar PostController = _interopRequireWildcard(require(\"../../controllers/post.controller\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst multer = require('multer');\n\nconst fileStorageEngine = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, `${__dirname}/../../../assets/uploads/posts`);\n  },\n  filename: function (req, file, cb) {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    let originalNameFile = file.originalname;\n    let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1);\n    cb(null, file.fieldname + '-' + uniqueSuffix + \".\" + extension);\n  }\n});\nconst upload = multer({\n  storage: fileStorageEngine\n});\nconst api = (0, _express.Router)();\napi.get('/', PostController.readPost);\napi.post('/', upload.single('file'), PostController.createPost);\napi.put('/:id', PostController.updatePost);\napi.delete('/:id', PostController.deletePost);\napi.patch('/like-post/:id', PostController.likePost);\napi.patch('/unlike-post/:id', PostController.unlikePost); //comments\n\napi.patch('/comment-post/:id', PostController.commentPost);\napi.patch('/edit-comment-post/:id', PostController.editCommentPost);\napi.patch('/delete-comment-post/:id', PostController.deleteCommentPost);\nvar _default = api;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3Qucm91dGUuanMiXSwibmFtZXMiOlsibXVsdGVyIiwicmVxdWlyZSIsImZpbGVTdG9yYWdlRW5naW5lIiwiZGlza1N0b3JhZ2UiLCJkZXN0aW5hdGlvbiIsInJlcSIsImZpbGUiLCJjYiIsIl9fZGlybmFtZSIsImZpbGVuYW1lIiwidW5pcXVlU3VmZml4IiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm9yaWdpbmFsTmFtZUZpbGUiLCJvcmlnaW5hbG5hbWUiLCJleHRlbnNpb24iLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsImZpZWxkbmFtZSIsInVwbG9hZCIsInN0b3JhZ2UiLCJhcGkiLCJnZXQiLCJQb3N0Q29udHJvbGxlciIsInJlYWRQb3N0IiwicG9zdCIsInNpbmdsZSIsImNyZWF0ZVBvc3QiLCJwdXQiLCJ1cGRhdGVQb3N0IiwiZGVsZXRlIiwiZGVsZXRlUG9zdCIsInBhdGNoIiwibGlrZVBvc3QiLCJ1bmxpa2VQb3N0IiwiY29tbWVudFBvc3QiLCJlZGl0Q29tbWVudFBvc3QiLCJkZWxldGVDb21tZW50UG9zdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOzs7Ozs7QUFDQSxNQUFNQSxNQUFNLEdBQUlDLE9BQU8sQ0FBQyxRQUFELENBQXZCOztBQUVBLE1BQU1DLGlCQUFpQixHQUFHRixNQUFNLENBQUNHLFdBQVAsQ0FBbUI7QUFDekNDLEVBQUFBLFdBQVcsRUFBQyxDQUFDQyxHQUFELEVBQU1DLElBQU4sRUFBWUMsRUFBWixLQUFtQjtBQUMzQkEsSUFBQUEsRUFBRSxDQUFDLElBQUQsRUFBUSxHQUFFQyxTQUFVLGdDQUFwQixDQUFGO0FBQ0gsR0FId0M7QUFJekNDLEVBQUFBLFFBQVEsRUFBRSxVQUFVSixHQUFWLEVBQWVDLElBQWYsRUFBcUJDLEVBQXJCLEVBQXlCO0FBQy9CLFVBQU1HLFlBQVksR0FBR0MsSUFBSSxDQUFDQyxHQUFMLEtBQWEsR0FBYixHQUFtQkMsSUFBSSxDQUFDQyxLQUFMLENBQVdELElBQUksQ0FBQ0UsTUFBTCxLQUFnQixHQUEzQixDQUF4QztBQUNBLFFBQUlDLGdCQUFnQixHQUFHVixJQUFJLENBQUNXLFlBQTVCO0FBQ0EsUUFBSUMsU0FBUyxHQUFHRixnQkFBZ0IsQ0FBQ0csU0FBakIsQ0FBMkJILGdCQUFnQixDQUFDSSxXQUFqQixDQUE2QixHQUE3QixJQUFvQyxDQUEvRCxDQUFoQjtBQUNBYixJQUFBQSxFQUFFLENBQUMsSUFBRCxFQUFPRCxJQUFJLENBQUNlLFNBQUwsR0FBaUIsR0FBakIsR0FBdUJYLFlBQXZCLEdBQXNDLEdBQXRDLEdBQTJDUSxTQUFsRCxDQUFGO0FBQ0Q7QUFUc0MsQ0FBbkIsQ0FBMUI7QUFZQSxNQUFNSSxNQUFNLEdBQUd0QixNQUFNLENBQUM7QUFBQ3VCLEVBQUFBLE9BQU8sRUFBQ3JCO0FBQVQsQ0FBRCxDQUFyQjtBQUVBLE1BQU1zQixHQUFHLEdBQUcsc0JBQVo7QUFHQUEsR0FBRyxDQUFDQyxHQUFKLENBQVEsR0FBUixFQUFhQyxjQUFjLENBQUNDLFFBQTVCO0FBQ0FILEdBQUcsQ0FBQ0ksSUFBSixDQUFTLEdBQVQsRUFBYU4sTUFBTSxDQUFDTyxNQUFQLENBQWMsTUFBZCxDQUFiLEVBQXFDSCxjQUFjLENBQUNJLFVBQXBEO0FBQ0FOLEdBQUcsQ0FBQ08sR0FBSixDQUFRLE1BQVIsRUFBZ0JMLGNBQWMsQ0FBQ00sVUFBL0I7QUFDQVIsR0FBRyxDQUFDUyxNQUFKLENBQVcsTUFBWCxFQUFtQlAsY0FBYyxDQUFDUSxVQUFsQztBQUNBVixHQUFHLENBQUNXLEtBQUosQ0FBVSxnQkFBVixFQUE0QlQsY0FBYyxDQUFDVSxRQUEzQztBQUNBWixHQUFHLENBQUNXLEtBQUosQ0FBVSxrQkFBVixFQUE4QlQsY0FBYyxDQUFDVyxVQUE3QyxFLENBRUE7O0FBQ0FiLEdBQUcsQ0FBQ1csS0FBSixDQUFVLG1CQUFWLEVBQStCVCxjQUFjLENBQUNZLFdBQTlDO0FBQ0FkLEdBQUcsQ0FBQ1csS0FBSixDQUFVLHdCQUFWLEVBQW9DVCxjQUFjLENBQUNhLGVBQW5EO0FBQ0FmLEdBQUcsQ0FBQ1csS0FBSixDQUFVLDBCQUFWLEVBQXNDVCxjQUFjLENBQUNjLGlCQUFyRDtlQUllaEIsRyIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc3JjL3JvdXRlcy9hcGkvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgKiBhcyBQb3N0Q29udHJvbGxlciBmcm9tICcuLi8uLi9jb250cm9sbGVycy9wb3N0LmNvbnRyb2xsZXInO1xuY29uc3QgbXVsdGVyICA9IHJlcXVpcmUoJ211bHRlcicpXG5cbmNvbnN0IGZpbGVTdG9yYWdlRW5naW5lID0gbXVsdGVyLmRpc2tTdG9yYWdlKHtcbiAgICBkZXN0aW5hdGlvbjoocmVxLCBmaWxlLCBjYikgPT4ge1xuICAgICAgICBjYihudWxsLCBgJHtfX2Rpcm5hbWV9Ly4uLy4uLy4uL2Fzc2V0cy91cGxvYWRzL3Bvc3RzYClcbiAgICB9LFxuICAgIGZpbGVuYW1lOiBmdW5jdGlvbiAocmVxLCBmaWxlLCBjYikge1xuICAgICAgICBjb25zdCB1bmlxdWVTdWZmaXggPSBEYXRlLm5vdygpICsgJy0nICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMUU5KVxuICAgICAgICBsZXQgb3JpZ2luYWxOYW1lRmlsZSA9IGZpbGUub3JpZ2luYWxuYW1lO1xuICAgICAgICBsZXQgZXh0ZW5zaW9uID0gb3JpZ2luYWxOYW1lRmlsZS5zdWJzdHJpbmcob3JpZ2luYWxOYW1lRmlsZS5sYXN0SW5kZXhPZignLicpICsgMSk7IFxuICAgICAgICBjYihudWxsLCBmaWxlLmZpZWxkbmFtZSArICctJyArIHVuaXF1ZVN1ZmZpeCArIFwiLlwiKyBleHRlbnNpb24gKVxuICAgICAgfVxufSk7XG5cbmNvbnN0IHVwbG9hZCA9IG11bHRlcih7c3RvcmFnZTpmaWxlU3RvcmFnZUVuZ2luZX0pXG5cbmNvbnN0IGFwaSA9IFJvdXRlcigpO1xuXG5cbmFwaS5nZXQoJy8nLCBQb3N0Q29udHJvbGxlci5yZWFkUG9zdCk7XG5hcGkucG9zdCgnLycsdXBsb2FkLnNpbmdsZSgnZmlsZScpLCAgUG9zdENvbnRyb2xsZXIuY3JlYXRlUG9zdCk7XG5hcGkucHV0KCcvOmlkJywgUG9zdENvbnRyb2xsZXIudXBkYXRlUG9zdCk7XG5hcGkuZGVsZXRlKCcvOmlkJywgUG9zdENvbnRyb2xsZXIuZGVsZXRlUG9zdCk7XG5hcGkucGF0Y2goJy9saWtlLXBvc3QvOmlkJywgUG9zdENvbnRyb2xsZXIubGlrZVBvc3QpO1xuYXBpLnBhdGNoKCcvdW5saWtlLXBvc3QvOmlkJywgUG9zdENvbnRyb2xsZXIudW5saWtlUG9zdCk7XG5cbi8vY29tbWVudHNcbmFwaS5wYXRjaCgnL2NvbW1lbnQtcG9zdC86aWQnLCBQb3N0Q29udHJvbGxlci5jb21tZW50UG9zdClcbmFwaS5wYXRjaCgnL2VkaXQtY29tbWVudC1wb3N0LzppZCcsIFBvc3RDb250cm9sbGVyLmVkaXRDb21tZW50UG9zdClcbmFwaS5wYXRjaCgnL2RlbGV0ZS1jb21tZW50LXBvc3QvOmlkJywgUG9zdENvbnRyb2xsZXIuZGVsZXRlQ29tbWVudFBvc3QpXG5cblxuXG5leHBvcnQgZGVmYXVsdCBhcGk7Il19","map":{"version":3,"sources":["post.route.js"],"names":["multer","require","fileStorageEngine","diskStorage","destination","req","file","cb","__dirname","filename","uniqueSuffix","Date","now","Math","round","random","originalNameFile","originalname","extension","substring","lastIndexOf","fieldname","upload","storage","api","get","PostController","readPost","post","single","createPost","put","updatePost","delete","deletePost","patch","likePost","unlikePost","commentPost","editCommentPost","deleteCommentPost"],"mappings":";;;;;;;AAAA;;AACA;;;;;;AACA,MAAMA,MAAM,GAAIC,OAAO,CAAC,QAAD,CAAvB;;AAEA,MAAMC,iBAAiB,GAAGF,MAAM,CAACG,WAAP,CAAmB;AACzCC,EAAAA,WAAW,EAAC,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,KAAmB;AAC3BA,IAAAA,EAAE,CAAC,IAAD,EAAQ,GAAEC,SAAU,gCAApB,CAAF;AACH,GAHwC;AAIzCC,EAAAA,QAAQ,EAAE,UAAUJ,GAAV,EAAeC,IAAf,EAAqBC,EAArB,EAAyB;AAC/B,UAAMG,YAAY,GAAGC,IAAI,CAACC,GAAL,KAAa,GAAb,GAAmBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAAxC;AACA,QAAIC,gBAAgB,GAAGV,IAAI,CAACW,YAA5B;AACA,QAAIC,SAAS,GAAGF,gBAAgB,CAACG,SAAjB,CAA2BH,gBAAgB,CAACI,WAAjB,CAA6B,GAA7B,IAAoC,CAA/D,CAAhB;AACAb,IAAAA,EAAE,CAAC,IAAD,EAAOD,IAAI,CAACe,SAAL,GAAiB,GAAjB,GAAuBX,YAAvB,GAAsC,GAAtC,GAA2CQ,SAAlD,CAAF;AACD;AATsC,CAAnB,CAA1B;AAYA,MAAMI,MAAM,GAAGtB,MAAM,CAAC;AAACuB,EAAAA,OAAO,EAACrB;AAAT,CAAD,CAArB;AAEA,MAAMsB,GAAG,GAAG,sBAAZ;AAGAA,GAAG,CAACC,GAAJ,CAAQ,GAAR,EAAaC,cAAc,CAACC,QAA5B;AACAH,GAAG,CAACI,IAAJ,CAAS,GAAT,EAAaN,MAAM,CAACO,MAAP,CAAc,MAAd,CAAb,EAAqCH,cAAc,CAACI,UAApD;AACAN,GAAG,CAACO,GAAJ,CAAQ,MAAR,EAAgBL,cAAc,CAACM,UAA/B;AACAR,GAAG,CAACS,MAAJ,CAAW,MAAX,EAAmBP,cAAc,CAACQ,UAAlC;AACAV,GAAG,CAACW,KAAJ,CAAU,gBAAV,EAA4BT,cAAc,CAACU,QAA3C;AACAZ,GAAG,CAACW,KAAJ,CAAU,kBAAV,EAA8BT,cAAc,CAACW,UAA7C,E,CAEA;;AACAb,GAAG,CAACW,KAAJ,CAAU,mBAAV,EAA+BT,cAAc,CAACY,WAA9C;AACAd,GAAG,CAACW,KAAJ,CAAU,wBAAV,EAAoCT,cAAc,CAACa,eAAnD;AACAf,GAAG,CAACW,KAAJ,CAAU,0BAAV,EAAsCT,cAAc,CAACc,iBAArD;eAIehB,G","sourceRoot":"/Applications/dossier/mern_project_app2/src/routes/api/","sourcesContent":["import { Router } from 'express';\nimport * as PostController from '../../controllers/post.controller';\nconst multer  = require('multer')\n\nconst fileStorageEngine = multer.diskStorage({\n    destination:(req, file, cb) => {\n        cb(null, `${__dirname}/../../../assets/uploads/posts`)\n    },\n    filename: function (req, file, cb) {\n        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)\n        let originalNameFile = file.originalname;\n        let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1); \n        cb(null, file.fieldname + '-' + uniqueSuffix + \".\"+ extension )\n      }\n});\n\nconst upload = multer({storage:fileStorageEngine})\n\nconst api = Router();\n\n\napi.get('/', PostController.readPost);\napi.post('/',upload.single('file'),  PostController.createPost);\napi.put('/:id', PostController.updatePost);\napi.delete('/:id', PostController.deletePost);\napi.patch('/like-post/:id', PostController.likePost);\napi.patch('/unlike-post/:id', PostController.unlikePost);\n\n//comments\napi.patch('/comment-post/:id', PostController.commentPost)\napi.patch('/edit-comment-post/:id', PostController.editCommentPost)\napi.patch('/delete-comment-post/:id', PostController.deleteCommentPost)\n\n\n\nexport default api;"]}},"mtime":1653046946274},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/routes/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/routes/api/post.route.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar PostController = _interopRequireWildcard(require(\"../../controllers/post.controller\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst multer = require('multer');\n\nconst fileStorageEngine = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, `${__dirname}/../../../assets/uploads/posts`);\n  },\n  filename: function (req, file, cb) {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    let originalNameFile = file.originalname;\n    let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1);\n    cb(null, file.fieldname + '-' + uniqueSuffix + \".\" + extension);\n  }\n});\nconst upload = multer({\n  storage: fileStorageEngine\n});\nconst api = (0, _express.Router)();\napi.get('/', PostController.readPost);\napi.post('/', upload.single('file'), PostController.createPost);\napi.put('/:id', PostController.updatePost);\napi.delete('/:id', PostController.deletePost);\napi.patch('/like-post/:id', PostController.likePost);\napi.patch('/unlike-post/:id', PostController.unlikePost); //comments\n\napi.patch('/comment-post/:id', PostController.commentPost);\napi.patch('/edit-comment-post/:id', PostController.editCommentPost);\napi.patch('/delete-comment-post/:id', PostController.deleteCommentPost);\nvar _default = api;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3Qucm91dGUuanMiXSwibmFtZXMiOlsibXVsdGVyIiwicmVxdWlyZSIsImZpbGVTdG9yYWdlRW5naW5lIiwiZGlza1N0b3JhZ2UiLCJkZXN0aW5hdGlvbiIsInJlcSIsImZpbGUiLCJjYiIsIl9fZGlybmFtZSIsImZpbGVuYW1lIiwidW5pcXVlU3VmZml4IiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm9yaWdpbmFsTmFtZUZpbGUiLCJvcmlnaW5hbG5hbWUiLCJleHRlbnNpb24iLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsImZpZWxkbmFtZSIsInVwbG9hZCIsInN0b3JhZ2UiLCJhcGkiLCJnZXQiLCJQb3N0Q29udHJvbGxlciIsInJlYWRQb3N0IiwicG9zdCIsInNpbmdsZSIsImNyZWF0ZVBvc3QiLCJwdXQiLCJ1cGRhdGVQb3N0IiwiZGVsZXRlIiwiZGVsZXRlUG9zdCIsInBhdGNoIiwibGlrZVBvc3QiLCJ1bmxpa2VQb3N0IiwiY29tbWVudFBvc3QiLCJlZGl0Q29tbWVudFBvc3QiLCJkZWxldGVDb21tZW50UG9zdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOzs7Ozs7QUFDQSxNQUFNQSxNQUFNLEdBQUlDLE9BQU8sQ0FBQyxRQUFELENBQXZCOztBQUVBLE1BQU1DLGlCQUFpQixHQUFHRixNQUFNLENBQUNHLFdBQVAsQ0FBbUI7QUFDekNDLEVBQUFBLFdBQVcsRUFBQyxDQUFDQyxHQUFELEVBQU1DLElBQU4sRUFBWUMsRUFBWixLQUFtQjtBQUMzQkEsSUFBQUEsRUFBRSxDQUFDLElBQUQsRUFBUSxHQUFFQyxTQUFVLGdDQUFwQixDQUFGO0FBQ0gsR0FId0M7QUFJekNDLEVBQUFBLFFBQVEsRUFBRSxVQUFVSixHQUFWLEVBQWVDLElBQWYsRUFBcUJDLEVBQXJCLEVBQXlCO0FBQy9CLFVBQU1HLFlBQVksR0FBR0MsSUFBSSxDQUFDQyxHQUFMLEtBQWEsR0FBYixHQUFtQkMsSUFBSSxDQUFDQyxLQUFMLENBQVdELElBQUksQ0FBQ0UsTUFBTCxLQUFnQixHQUEzQixDQUF4QztBQUNBLFFBQUlDLGdCQUFnQixHQUFHVixJQUFJLENBQUNXLFlBQTVCO0FBQ0EsUUFBSUMsU0FBUyxHQUFHRixnQkFBZ0IsQ0FBQ0csU0FBakIsQ0FBMkJILGdCQUFnQixDQUFDSSxXQUFqQixDQUE2QixHQUE3QixJQUFvQyxDQUEvRCxDQUFoQjtBQUNBYixJQUFBQSxFQUFFLENBQUMsSUFBRCxFQUFPRCxJQUFJLENBQUNlLFNBQUwsR0FBaUIsR0FBakIsR0FBdUJYLFlBQXZCLEdBQXNDLEdBQXRDLEdBQTJDUSxTQUFsRCxDQUFGO0FBQ0Q7QUFUc0MsQ0FBbkIsQ0FBMUI7QUFZQSxNQUFNSSxNQUFNLEdBQUd0QixNQUFNLENBQUM7QUFBQ3VCLEVBQUFBLE9BQU8sRUFBQ3JCO0FBQVQsQ0FBRCxDQUFyQjtBQUVBLE1BQU1zQixHQUFHLEdBQUcsc0JBQVo7QUFHQUEsR0FBRyxDQUFDQyxHQUFKLENBQVEsR0FBUixFQUFhQyxjQUFjLENBQUNDLFFBQTVCO0FBQ0FILEdBQUcsQ0FBQ0ksSUFBSixDQUFTLEdBQVQsRUFBYU4sTUFBTSxDQUFDTyxNQUFQLENBQWMsTUFBZCxDQUFiLEVBQXFDSCxjQUFjLENBQUNJLFVBQXBEO0FBQ0FOLEdBQUcsQ0FBQ08sR0FBSixDQUFRLE1BQVIsRUFBZ0JMLGNBQWMsQ0FBQ00sVUFBL0I7QUFDQVIsR0FBRyxDQUFDUyxNQUFKLENBQVcsTUFBWCxFQUFtQlAsY0FBYyxDQUFDUSxVQUFsQztBQUNBVixHQUFHLENBQUNXLEtBQUosQ0FBVSxnQkFBVixFQUE0QlQsY0FBYyxDQUFDVSxRQUEzQztBQUNBWixHQUFHLENBQUNXLEtBQUosQ0FBVSxrQkFBVixFQUE4QlQsY0FBYyxDQUFDVyxVQUE3QyxFLENBRUE7O0FBQ0FiLEdBQUcsQ0FBQ1csS0FBSixDQUFVLG1CQUFWLEVBQStCVCxjQUFjLENBQUNZLFdBQTlDO0FBQ0FkLEdBQUcsQ0FBQ1csS0FBSixDQUFVLHdCQUFWLEVBQW9DVCxjQUFjLENBQUNhLGVBQW5EO0FBQ0FmLEdBQUcsQ0FBQ1csS0FBSixDQUFVLDBCQUFWLEVBQXNDVCxjQUFjLENBQUNjLGlCQUFyRDtlQUllaEIsRyIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc3JjL3JvdXRlcy9hcGkvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgKiBhcyBQb3N0Q29udHJvbGxlciBmcm9tICcuLi8uLi9jb250cm9sbGVycy9wb3N0LmNvbnRyb2xsZXInO1xuY29uc3QgbXVsdGVyICA9IHJlcXVpcmUoJ211bHRlcicpXG5cbmNvbnN0IGZpbGVTdG9yYWdlRW5naW5lID0gbXVsdGVyLmRpc2tTdG9yYWdlKHtcbiAgICBkZXN0aW5hdGlvbjoocmVxLCBmaWxlLCBjYikgPT4ge1xuICAgICAgICBjYihudWxsLCBgJHtfX2Rpcm5hbWV9Ly4uLy4uLy4uL2Fzc2V0cy91cGxvYWRzL3Bvc3RzYClcbiAgICB9LFxuICAgIGZpbGVuYW1lOiBmdW5jdGlvbiAocmVxLCBmaWxlLCBjYikge1xuICAgICAgICBjb25zdCB1bmlxdWVTdWZmaXggPSBEYXRlLm5vdygpICsgJy0nICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMUU5KVxuICAgICAgICBsZXQgb3JpZ2luYWxOYW1lRmlsZSA9IGZpbGUub3JpZ2luYWxuYW1lO1xuICAgICAgICBsZXQgZXh0ZW5zaW9uID0gb3JpZ2luYWxOYW1lRmlsZS5zdWJzdHJpbmcob3JpZ2luYWxOYW1lRmlsZS5sYXN0SW5kZXhPZignLicpICsgMSk7IFxuICAgICAgICBjYihudWxsLCBmaWxlLmZpZWxkbmFtZSArICctJyArIHVuaXF1ZVN1ZmZpeCArIFwiLlwiKyBleHRlbnNpb24gKVxuICAgICAgfVxufSk7XG5cbmNvbnN0IHVwbG9hZCA9IG11bHRlcih7c3RvcmFnZTpmaWxlU3RvcmFnZUVuZ2luZX0pXG5cbmNvbnN0IGFwaSA9IFJvdXRlcigpO1xuXG5cbmFwaS5nZXQoJy8nLCBQb3N0Q29udHJvbGxlci5yZWFkUG9zdCk7XG5hcGkucG9zdCgnLycsdXBsb2FkLnNpbmdsZSgnZmlsZScpLCAgUG9zdENvbnRyb2xsZXIuY3JlYXRlUG9zdCk7XG5hcGkucHV0KCcvOmlkJywgUG9zdENvbnRyb2xsZXIudXBkYXRlUG9zdCk7XG5hcGkuZGVsZXRlKCcvOmlkJywgUG9zdENvbnRyb2xsZXIuZGVsZXRlUG9zdCk7XG5hcGkucGF0Y2goJy9saWtlLXBvc3QvOmlkJywgUG9zdENvbnRyb2xsZXIubGlrZVBvc3QpO1xuYXBpLnBhdGNoKCcvdW5saWtlLXBvc3QvOmlkJywgUG9zdENvbnRyb2xsZXIudW5saWtlUG9zdCk7XG5cbi8vY29tbWVudHNcbmFwaS5wYXRjaCgnL2NvbW1lbnQtcG9zdC86aWQnLCBQb3N0Q29udHJvbGxlci5jb21tZW50UG9zdClcbmFwaS5wYXRjaCgnL2VkaXQtY29tbWVudC1wb3N0LzppZCcsIFBvc3RDb250cm9sbGVyLmVkaXRDb21tZW50UG9zdClcbmFwaS5wYXRjaCgnL2RlbGV0ZS1jb21tZW50LXBvc3QvOmlkJywgUG9zdENvbnRyb2xsZXIuZGVsZXRlQ29tbWVudFBvc3QpXG5cblxuXG5leHBvcnQgZGVmYXVsdCBhcGk7Il19","map":{"version":3,"sources":["post.route.js"],"names":["multer","require","fileStorageEngine","diskStorage","destination","req","file","cb","__dirname","filename","uniqueSuffix","Date","now","Math","round","random","originalNameFile","originalname","extension","substring","lastIndexOf","fieldname","upload","storage","api","get","PostController","readPost","post","single","createPost","put","updatePost","delete","deletePost","patch","likePost","unlikePost","commentPost","editCommentPost","deleteCommentPost"],"mappings":";;;;;;;AAAA;;AACA;;;;;;AACA,MAAMA,MAAM,GAAIC,OAAO,CAAC,QAAD,CAAvB;;AAEA,MAAMC,iBAAiB,GAAGF,MAAM,CAACG,WAAP,CAAmB;AACzCC,EAAAA,WAAW,EAAC,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,KAAmB;AAC3BA,IAAAA,EAAE,CAAC,IAAD,EAAQ,GAAEC,SAAU,gCAApB,CAAF;AACH,GAHwC;AAIzCC,EAAAA,QAAQ,EAAE,UAAUJ,GAAV,EAAeC,IAAf,EAAqBC,EAArB,EAAyB;AAC/B,UAAMG,YAAY,GAAGC,IAAI,CAACC,GAAL,KAAa,GAAb,GAAmBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAAxC;AACA,QAAIC,gBAAgB,GAAGV,IAAI,CAACW,YAA5B;AACA,QAAIC,SAAS,GAAGF,gBAAgB,CAACG,SAAjB,CAA2BH,gBAAgB,CAACI,WAAjB,CAA6B,GAA7B,IAAoC,CAA/D,CAAhB;AACAb,IAAAA,EAAE,CAAC,IAAD,EAAOD,IAAI,CAACe,SAAL,GAAiB,GAAjB,GAAuBX,YAAvB,GAAsC,GAAtC,GAA2CQ,SAAlD,CAAF;AACD;AATsC,CAAnB,CAA1B;AAYA,MAAMI,MAAM,GAAGtB,MAAM,CAAC;AAACuB,EAAAA,OAAO,EAACrB;AAAT,CAAD,CAArB;AAEA,MAAMsB,GAAG,GAAG,sBAAZ;AAGAA,GAAG,CAACC,GAAJ,CAAQ,GAAR,EAAaC,cAAc,CAACC,QAA5B;AACAH,GAAG,CAACI,IAAJ,CAAS,GAAT,EAAaN,MAAM,CAACO,MAAP,CAAc,MAAd,CAAb,EAAqCH,cAAc,CAACI,UAApD;AACAN,GAAG,CAACO,GAAJ,CAAQ,MAAR,EAAgBL,cAAc,CAACM,UAA/B;AACAR,GAAG,CAACS,MAAJ,CAAW,MAAX,EAAmBP,cAAc,CAACQ,UAAlC;AACAV,GAAG,CAACW,KAAJ,CAAU,gBAAV,EAA4BT,cAAc,CAACU,QAA3C;AACAZ,GAAG,CAACW,KAAJ,CAAU,kBAAV,EAA8BT,cAAc,CAACW,UAA7C,E,CAEA;;AACAb,GAAG,CAACW,KAAJ,CAAU,mBAAV,EAA+BT,cAAc,CAACY,WAA9C;AACAd,GAAG,CAACW,KAAJ,CAAU,wBAAV,EAAoCT,cAAc,CAACa,eAAnD;AACAf,GAAG,CAACW,KAAJ,CAAU,0BAAV,EAAsCT,cAAc,CAACc,iBAArD;eAIehB,G","sourceRoot":"/Applications/dossier/mern_project_app2/src/routes/api/","sourcesContent":["import { Router } from 'express';\nimport * as PostController from '../../controllers/post.controller';\nconst multer  = require('multer')\n\nconst fileStorageEngine = multer.diskStorage({\n    destination:(req, file, cb) => {\n        cb(null, `${__dirname}/../../../assets/uploads/posts`)\n    },\n    filename: function (req, file, cb) {\n        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)\n        let originalNameFile = file.originalname;\n        let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1); \n        cb(null, file.fieldname + '-' + uniqueSuffix + \".\"+ extension )\n      }\n});\n\nconst upload = multer({storage:fileStorageEngine})\n\nconst api = Router();\n\n\napi.get('/', PostController.readPost);\napi.post('/',upload.single('file'),  PostController.createPost);\napi.put('/:id', PostController.updatePost);\napi.delete('/:id', PostController.deletePost);\napi.patch('/like-post/:id', PostController.likePost);\napi.patch('/unlike-post/:id', PostController.unlikePost);\n\n//comments\napi.patch('/comment-post/:id', PostController.commentPost)\napi.patch('/edit-comment-post/:id', PostController.editCommentPost)\napi.patch('/delete-comment-post/:id', PostController.deleteCommentPost)\n\n\n\nexport default api;"]}},"mtime":1653046946274},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/controllers/post.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updatePost = exports.unlikePost = exports.readPost = exports.likePost = exports.editCommentPost = exports.deletePost = exports.deleteCommentPost = exports.createPost = exports.commentPost = void 0;\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst Post = require('../models/post.model');\n\nconst User = require('../models/user.model');\n\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\nconst readPost = async (req, res, next) => {\n  try {\n    const posts = await Post.find().sort({\n      createdAt: -1\n    });\n    res.status(200).json(posts);\n  } catch (err) {\n    res.status(200).json(err);\n  }\n};\n\nexports.readPost = readPost;\n\nconst createPost = async (req, res, next) => {\n  if (req.file != null) {\n    console.log(req.file);\n\n    try {\n      if (req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\") {\n        throw new Error('invalid file');\n      }\n\n      if (req.file.size > 500000) {\n        throw new Error('max size');\n      }\n    } catch (err) {\n      const errors = (0, _errors.uploadErrors)(err);\n      return res.status(201).json({\n        errors\n      });\n    }\n  }\n\n  const newPost = new Post({\n    posterId: req.body.posterId,\n    message: req.body.message,\n    picture: req.file != null ? `http://localhost:8080/uploads/posts/${req.file.filename}` : \"\",\n    video: req.body.video,\n    likers: [],\n    comments: []\n  });\n\n  try {\n    const post = await newPost.save();\n    return res.status(201).json(post);\n  } catch (err) {\n    return res.status(400).json(err);\n  }\n};\n\nexports.createPost = createPost;\n\nconst updatePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const updatedRecord = {\n      message: req.body.message\n    };\n    const newPost = await Post.findByIdAndUpdate(req.params.id, {\n      $set: updatedRecord\n    }, {\n      new: true\n    });\n    res.status(200).send(newPost);\n  } catch (err) {\n    res.status(400).json(err);\n  }\n};\n\nexports.updatePost = updatePost;\n\nconst deletePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    await Post.remove({\n      _id: req.params.id\n    }).exec();\n    res.status(200).json({\n      message: 'Successfully deleted !'\n    });\n  } catch (err) {\n    res.status(500).json({\n      message: err\n    });\n  }\n};\n\nexports.deletePost = deletePost;\n\nconst likePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $addToSet: {\n        likers: req.body.id\n      }\n    }, {\n      new: true\n    });\n    const user = await User.findByIdAndUpdate(req.body.id, {\n      $addToSet: {\n        likes: req.params.id\n      }\n    }, {\n      new: true\n    });\n    res.status(200).send(post);\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.likePost = likePost;\n\nconst unlikePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $pull: {\n        likers: req.body.id\n      }\n    }, {\n      new: true\n    });\n    const user = await User.findByIdAndUpdate(req.body.id, {\n      $pull: {\n        likes: req.params.id\n      }\n    }, {\n      new: true\n    });\n    res.status(200).send(user);\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.unlikePost = unlikePost;\n\nconst commentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $push: {\n        comments: {\n          commenterId: req.body.commenterId,\n          commenterPseudo: req.body.commenterPseudo,\n          text: req.body.text,\n          timestamp: new Date().getTime()\n        }\n      }\n    }, {\n      new: true\n    }).then(data => res.send(data)).catch(err => res.status(500).send({\n      message: err\n    }));\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.commentPost = commentPost;\n\nconst editCommentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    //on récupère le post concerné\n    const post = await Post.findById(req.params.id); //on récupère le commentaire concerné\n\n    const theComment = await post.comments.find(comment => {\n      return comment._id.equals(req.body.commentId);\n    });\n    console.log(theComment); //on change le text\n\n    theComment.text = req.body.text; // on save les changements\n\n    await post.save(); //on send le post concerné\n\n    return res.send(post);\n  } catch (err) {\n    return res.status(400).send(err);\n  }\n};\n\nexports.editCommentPost = editCommentPost;\n\nconst deleteCommentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $pull: {\n        comments: {\n          _id: req.body.commentId\n        }\n      }\n    }, {\n      new: true\n    }).then(newPost => {\n      res.send(newPost);\n    }).catch(err => {\n      return res.status(400).send(err);\n    });\n  } catch (err) {\n    return res.status(400).send(err);\n  }\n};\n\nexports.deleteCommentPost = deleteCommentPost;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJQb3N0IiwicmVxdWlyZSIsIlVzZXIiLCJPYmplY3RJRCIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWFkUG9zdCIsInJlcSIsInJlcyIsIm5leHQiLCJwb3N0cyIsImZpbmQiLCJzb3J0IiwiY3JlYXRlZEF0Iiwic3RhdHVzIiwianNvbiIsImVyciIsImNyZWF0ZVBvc3QiLCJmaWxlIiwiY29uc29sZSIsImxvZyIsIm1pbWV0eXBlIiwiRXJyb3IiLCJzaXplIiwiZXJyb3JzIiwibmV3UG9zdCIsInBvc3RlcklkIiwiYm9keSIsIm1lc3NhZ2UiLCJwaWN0dXJlIiwiZmlsZW5hbWUiLCJ2aWRlbyIsImxpa2VycyIsImNvbW1lbnRzIiwicG9zdCIsInNhdmUiLCJ1cGRhdGVQb3N0IiwiaXNWYWxpZCIsInBhcmFtcyIsImlkIiwic2VuZCIsInVwZGF0ZWRSZWNvcmQiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIiRzZXQiLCJuZXciLCJkZWxldGVQb3N0IiwicmVtb3ZlIiwiX2lkIiwiZXhlYyIsImxpa2VQb3N0IiwiJGFkZFRvU2V0IiwidXNlciIsImxpa2VzIiwidW5saWtlUG9zdCIsIiRwdWxsIiwiY29tbWVudFBvc3QiLCIkcHVzaCIsImNvbW1lbnRlcklkIiwiY29tbWVudGVyUHNldWRvIiwidGV4dCIsInRpbWVzdGFtcCIsIkRhdGUiLCJnZXRUaW1lIiwidGhlbiIsImRhdGEiLCJjYXRjaCIsImVkaXRDb21tZW50UG9zdCIsImZpbmRCeUlkIiwidGhlQ29tbWVudCIsImNvbW1lbnQiLCJlcXVhbHMiLCJjb21tZW50SWQiLCJkZWxldGVDb21tZW50UG9zdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUdBOztBQUhBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLHNCQUFELENBQXBCOztBQUNBLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLHNCQUFELENBQXBCOztBQUNBLE1BQU1FLFFBQVEsR0FBR0YsT0FB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QUFDSCxLQVprQixFQVloQndDLEtBWmdCLENBWVRqRCxHQUFELElBQVM7QUFDZCxhQUFPUixHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCMEIsSUFBaEIsQ0FBcUJ4QixHQUFyQixDQUFQO0FBQ0gsS0Fka0IsQ0FBbkI7QUFlSCxHQWhCRCxDQWlCQSxPQUFPQSxHQUFQLEVBQVk7QUFDUixXQUFPUixHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCMEIsSUFBaEIsQ0FBcUJ4QixHQUFyQixDQUFQO0FBQ0g7QUFDSixDQXhCTSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc3JjL2NvbnRyb2xsZXJzLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFBvc3QgPSByZXF1aXJlKCcuLi9tb2RlbHMvcG9zdC5tb2RlbCcpXG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuY29uc3QgT2JqZWN0SUQgPSByZXF1aXJlKFwibW9uZ29vc2VcIikuVHlwZXMuT2JqZWN0SWQ7XG5pbXBvcnQgeyB1cGxvYWRFcnJvcnN9IGZyb20gJy4uL3V0aWxzL2Vycm9ycy51dGlscydcblxuXG5leHBvcnQgY29uc3QgcmVhZFBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3N0cyA9IGF3YWl0IFBvc3QuZmluZCgpLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHBvc3RzKVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGVycilcbiAgICB9XG59XG5leHBvcnQgY29uc3QgY3JlYXRlUG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmKHJlcS5maWxlICE9IG51bGwpe1xuICAgICAgICBjb25zb2xlLmxvZyhyZXEuZmlsZSApXG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIGlmKHJlcS5maWxlLm1pbWV0eXBlICE9IFwiaW1hZ2UvanBnXCIgJiYgcmVxLmZpbGUubWltZXR5cGUgIT0gXCJpbWFnZS9wbmdcIiAmJiByZXEuZmlsZS5taW1ldHlwZSAhPSBcImltYWdlL2pwZWdcIil7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGZpbGUnKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYocmVxLmZpbGUuc2l6ZSA+IDUwMDAwMCl7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdtYXggc2l6ZScpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2goZXJyKXtcbiAgICAgICAgICAgIGNvbnN0IGVycm9ycyA9IHVwbG9hZEVycm9ycyhlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtlcnJvcnN9KVxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IG5ld1Bvc3QgPSBuZXcgUG9zdCh7XG4gICAgICAgIHBvc3RlcklkOiByZXEuYm9keS5wb3N0ZXJJZCxcbiAgICAgICAgbWVzc2FnZTogcmVxLmJvZHkubWVzc2FnZSxcbiAgICAgICAgcGljdHVyZTogcmVxLmZpbGUgIT0gbnVsbCA/IGBodHRwOi8vbG9jYWxob3N0OjgwODAvdXBsb2Fkcy9wb3N0cy8ke3JlcS5maWxlLmZpbGVuYW1lfWAgOiBcIlwiLFxuICAgICAgICB2aWRlbzogcmVxLmJvZHkudmlkZW8sXG4gICAgICAgIGxpa2VyczogW10sXG4gICAgICAgIGNvbW1lbnRzOiBbXSxcbiAgICB9KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3N0ID0gYXdhaXQgbmV3UG9zdC5zYXZlKCk7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMSkuanNvbihwb3N0KVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbihlcnIpXG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IHVwZGF0ZVBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcblxuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXBkYXRlZFJlY29yZCA9IHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IHJlcS5ib2R5Lm1lc3NhZ2VcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuZXdQb3N0ID0gYXdhaXQgUG9zdC5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5wYXJhbXMuaWQsXG4gICAgICAgICAgICB7ICRzZXQ6IHVwZGF0ZWRSZWNvcmQgfSxcbiAgICAgICAgICAgIHsgbmV3OiB0cnVlIH1cbiAgICAgICAgKVxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChuZXdQb3N0KVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKGVycilcbiAgICB9XG5cblxuXG59XG5leHBvcnQgY29uc3QgZGVsZXRlUG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgUG9zdC5yZW1vdmUoe1xuICAgICAgICAgICAgX2lkOiByZXEucGFyYW1zLmlkXG4gICAgICAgIH0pLmV4ZWMoKVxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6ICdTdWNjZXNzZnVsbHkgZGVsZXRlZCAhJyB9KVxuXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnIgfSlcbiAgICB9XG59XG5leHBvcnQgY29uc3QgbGlrZVBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEucGFyYW1zLmlkfWApXG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBvc3QgPSBhd2FpdCBQb3N0LmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgICAgICAgcmVxLnBhcmFtcy5pZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkYWRkVG9TZXQ6IHsgbGlrZXJzOiByZXEuYm9keS5pZCB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5ldzogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgICAgICAgcmVxLmJvZHkuaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJGFkZFRvU2V0OiB7IGxpa2VzOiByZXEucGFyYW1zLmlkIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmV3OiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHBvc3QpXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBlcnIgfSlcbiAgICB9XG59XG5leHBvcnQgY29uc3QgdW5saWtlUG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICByZXEucGFyYW1zLmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRwdWxsOiB7IGxpa2VyczogcmVxLmJvZHkuaWQgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuZXc6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5ib2R5LmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRwdWxsOiB7IGxpa2VzOiByZXEucGFyYW1zLmlkIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmV3OiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHVzZXIpXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBlcnIgfSlcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBjb21tZW50UG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICByZXEucGFyYW1zLmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRwdXNoOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50ZXJJZDogcmVxLmJvZHkuY29tbWVudGVySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50ZXJQc2V1ZG86IHJlcS5ib2R5LmNvbW1lbnRlclBzZXVkbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHJlcS5ib2R5LnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyBuZXc6IHRydWUgfVxuICAgICAgICApLnRoZW4oKGRhdGEpID0+IHJlcy5zZW5kKGRhdGEpKVxuICAgICAgICAuY2F0Y2goKGVycikgPT4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBtZXNzYWdlOiBlcnIgfSkpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgZXJyIH0pXG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgZWRpdENvbW1lbnRQb3N0ID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAgIC8vb24gcsOpY3Vww6hyZSBsZSBwb3N0IGNvbmNlcm7DqVxuICAgICAgICBjb25zdCBwb3N0ID0gYXdhaXQgUG9zdC5maW5kQnlJZChyZXEucGFyYW1zLmlkKVxuICAgICBcbiAgICAgICAgLy9vbiByw6ljdXDDqHJlIGxlIGNvbW1lbnRhaXJlIGNvbmNlcm7DqVxuICAgICAgICBjb25zdCB0aGVDb21tZW50ID0gYXdhaXQgcG9zdC5jb21tZW50cy5maW5kKChjb21tZW50KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gY29tbWVudC5faWQuZXF1YWxzKHJlcS5ib2R5LmNvbW1lbnRJZClcbiAgICAgICAgfSlcbiAgICAgICAgY29uc29sZS5sb2codGhlQ29tbWVudClcbiAgICAgICAgLy9vbiBjaGFuZ2UgbGUgdGV4dFxuICAgICAgICB0aGVDb21tZW50LnRleHQgPSByZXEuYm9keS50ZXh0XG4gICAgICAgIC8vIG9uIHNhdmUgbGVzIGNoYW5nZW1lbnRzXG4gICAgICAgIGF3YWl0IHBvc3Quc2F2ZSgpO1xuICAgICAgICAvL29uIHNlbmQgbGUgcG9zdCBjb25jZXJuw6lcbiAgICAgICAgcmV0dXJuIHJlcy5zZW5kKHBvc3QpXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGVycilcbiAgICB9XG59XG5cblxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNvbW1lbnRQb3N0ID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3N0ID0gYXdhaXQgUG9zdC5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5wYXJhbXMuaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJHB1bGw6IHtcbiAgICAgICAgICAgICAgICAgICAgY29tbWVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogcmVxLmJvZHkuY29tbWVudElkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyBuZXc6IHRydWUgfVxuICAgICAgICApLnRoZW4oKG5ld1Bvc3QpID0+IHtcbiAgICAgICAgICAgIHJlcy5zZW5kKG5ld1Bvc3QpXG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnIpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnIpXG4gICAgfVxufSJdfQ==","map":{"version":3,"sources":["post.controller.js"],"names":["Post","require","User","ObjectID","Types","ObjectId","readPost","req","res","next","posts","find","sort","createdAt","status","json","err","createPost","file","console","log","mimetype","Error","size","errors","newPost","posterId","body","message","picture","filename","video","likers","comments","post","save","updatePost","isValid","params","id","send","updatedRecord","findByIdAndUpdate","$set","new","deletePost","remove","_id","exec","likePost","$addToSet","user","likes","unlikePost","$pull","commentPost","$push","commenterId","commenterPseudo","text","timestamp","Date","getTime","then","data","catch","editCommentPost","findById","theComment","comment","equals","commentId","deleteCommentPost"],"mappings":"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","sourceRoot":"/Applications/dossier/mern_project_app2/src/controllers/","sourcesContent":["const Post = require('../models/post.model')\nconst User = require('../models/user.model')\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\nimport { uploadErrors} from '../utils/errors.utils'\n\n\nexport const readPost = async (req, res, next) => {\n    try {\n        const posts = await Post.find().sort({ createdAt: -1 })\n        res.status(200).json(posts)\n    }\n    catch (err) {\n        res.status(200).json(err)\n    }\n}\nexport const createPost = async (req, res, next) => {\n    if(req.file != null){\n        console.log(req.file )\n        try{\n            if(req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\"){\n                throw new Error('invalid file')\n            }\n            if(req.file.size > 500000){\n                throw new Error('max size')\n            }\n        }\n        catch(err){\n            const errors = uploadErrors(err);\n            return res.status(201).json({errors})\n        }\n    }\n    const newPost = new Post({\n        posterId: req.body.posterId,\n        message: req.body.message,\n        picture: req.file != null ? `http://localhost:8080/uploads/posts/${req.file.filename}` : \"\",\n        video: req.body.video,\n        likers: [],\n        comments: [],\n    });\n    try {\n        const post = await newPost.save();\n        return res.status(201).json(post)\n    }\n    catch (err) {\n        return res.status(400).json(err)\n    }\n}\nexport const updatePost = async (req, res, next) => {\n\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    \n    try {\n        const updatedRecord = {\n            message: req.body.message\n        }\n        const newPost = await Post.findByIdAndUpdate(\n            req.params.id,\n            { $set: updatedRecord },\n            { new: true }\n        )\n        res.status(200).send(newPost)\n    }\n    catch (err) {\n        res.status(400).json(err)\n    }\n\n\n\n}\nexport const deletePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        await Post.remove({\n            _id: req.params.id\n        }).exec()\n        res.status(200).json({ message: 'Successfully deleted !' })\n\n    }\n    catch (err) {\n        res.status(500).json({ message: err })\n    }\n}\nexport const likePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $addToSet: { likers: req.body.id }\n            },\n            {\n                new: true\n            }\n        )\n        const user = await User.findByIdAndUpdate(\n            req.body.id,\n            {\n                $addToSet: { likes: req.params.id }\n            },\n            {\n                new: true\n            }\n        );\n        res.status(200).send(post)\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\nexport const unlikePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $pull: { likers: req.body.id }\n            },\n            {\n                new: true\n            }\n        )\n        const user = await User.findByIdAndUpdate(\n            req.body.id,\n            {\n                $pull: { likes: req.params.id }\n            },\n            {\n                new: true\n            }\n        );\n        res.status(200).send(user)\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\n\nexport const commentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $push: {\n                    comments: {\n                        commenterId: req.body.commenterId,\n                        commenterPseudo: req.body.commenterPseudo,\n                        text: req.body.text,\n                        timestamp: new Date().getTime()\n                    }\n                }\n            },\n            { new: true }\n        ).then((data) => res.send(data))\n        .catch((err) => res.status(500).send({ message: err }));\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\n\nexport const editCommentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n\n    try {\n        //on récupère le post concerné\n        const post = await Post.findById(req.params.id)\n     \n        //on récupère le commentaire concerné\n        const theComment = await post.comments.find((comment) => {\n            return comment._id.equals(req.body.commentId)\n        })\n        console.log(theComment)\n        //on change le text\n        theComment.text = req.body.text\n        // on save les changements\n        await post.save();\n        //on send le post concerné\n        return res.send(post)\n    }\n    catch (err) {\n        return res.status(400).send(err)\n    }\n}\n\n\nexport const deleteCommentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $pull: {\n                    comments: {\n                        _id: req.body.commentId\n                    }\n                }\n            },\n            { new: true }\n        ).then((newPost) => {\n            res.send(newPost)\n        }).catch((err) => {\n            return res.status(400).send(err)\n        });\n    }\n    catch (err) {\n        return res.status(400).send(err)\n    }\n}"]}},"mtime":1653047124737},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/models/post.model.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nconst PostSchema = new mongoose.Schema({\n  posterId: {\n    type: String,\n    required: true\n  },\n  message: {\n    type: String,\n    trim: true,\n    maxlength: 500\n  },\n  picture: {\n    type: String\n  },\n  video: {\n    type: String\n  },\n  likers: {\n    type: [String],\n    required: true\n  },\n  //la partie commentaire est une sous base de données\n  comments: {\n    type: [{\n      commenterId: String,\n      commenterPseudo: String,\n      text: String,\n      timestamp: Number\n    }],\n    required: true\n  }\n}, {\n  timestamps: true\n});\nlet Post = mongoose.model('post', PostSchema);\nmodule.exports = Post;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QubW9kZWwuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiUG9zdFNjaGVtYSIsIlNjaGVtYSIsInBvc3RlcklkIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwibWVzc2FnZSIsInRyaW0iLCJtYXhsZW5ndGgiLCJwaWN0dXJlIiwidmlkZW8iLCJsaWtlcnMiLCJjb21tZW50cyIsImNvbW1lbnRlcklkIiwiY29tbWVudGVyUHNldWRvIiwidGV4dCIsInRpbWVzdGFtcCIsIk51bWJlciIsInRpbWVzdGFtcHMiLCJQb3N0IiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBRUEsTUFBTUMsVUFBVSxHQUFHLElBQUlGLFFBQVEsQ0FBQ0csTUFBYixDQUNmO0FBQ0lDLEVBQUFBLFFBQVEsRUFBRTtBQUNOQyxJQUFBQSxJQUFJLEVBQUVDLE1BREE7QUFFTkMsSUFBQUEsUUFBUSxFQUFFO0FBRkosR0FEZDtBQUtJQyxFQUFBQSxPQUFPLEVBQUU7QUFDTEgsSUFBQUEsSUFBSSxFQUFFQyxNQUREO0FBRUxHLElBQUFBLElBQUksRUFBRSxJQUZEO0FBR0xDLElBQUFBLFNBQVMsRUFBRTtBQUhOLEdBTGI7QUFVSUMsRUFBQUEsT0FBTyxFQUFFO0FBQ0xOLElBQUFBLElBQUksRUFBRUM7QUFERCxHQVZiO0FBYUlNLEVBQUFBLEtBQUssRUFBRTtBQUNIUCxJQUFBQSxJQUFJLEVBQUVDO0FBREgsR0FiWDtBQWdCSU8sRUFBQUEsTUFBTSxFQUFFO0FBQ0pSLElBQUFBLElBQUksRUFBRSxDQUFDQyxNQUFELENBREY7QUFFSkMsSUFBQUEsUUFBUSxFQUFFO0FBRk4sR0FoQlo7QUFvQkk7QUFDQU8sRUFBQUEsUUFBUSxFQUFFO0FBQ05ULElBQUFBLElBQUksRUFBRSxDQUNGO0FBQ0lVLE1BQUFBLFdBQVcsRUFBRVQsTUFEakI7QUFFSVUsTUFBQUEsZUFBZSxFQUFFVixNQUZyQjtBQUdJVyxNQUFBQSxJQUFJLEVBQUVYLE1BSFY7QUFJSVksTUFBQUEsU0FBUyxFQUFFQztBQUpmLEtBREUsQ0FEQTtBQVNOWixJQUFBQSxRQUFRLEVBQUU7QUFUSjtBQXJCZCxDQURlLEVBa0NmO0FBQ0lhLEVBQUFBLFVBQVUsRUFBRTtBQURoQixDQWxDZSxDQUFuQjtBQXVDQSxJQUFJQyxJQUFJLEdBQUdyQixRQUFRLENBQUNzQixLQUFULENBQWUsTUFBZixFQUF1QnBCLFVBQXZCLENBQVg7QUFDQXFCLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsSUFBakIiLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9tb2RlbHMvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuXG5jb25zdCBQb3N0U2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYShcbiAgICB7XG4gICAgICAgIHBvc3RlcklkOiB7XG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgICAgICAgdHJpbTogdHJ1ZSxcbiAgICAgICAgICAgIG1heGxlbmd0aDogNTAwXG4gICAgICAgIH0sXG4gICAgICAgIHBpY3R1cmU6IHtcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZ1xuICAgICAgICB9LFxuICAgICAgICB2aWRlbzoge1xuICAgICAgICAgICAgdHlwZTogU3RyaW5nXG4gICAgICAgIH0sXG4gICAgICAgIGxpa2Vyczoge1xuICAgICAgICAgICAgdHlwZTogW1N0cmluZ10sXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgLy9sYSBwYXJ0aWUgY29tbWVudGFpcmUgZXN0IHVuZSBzb3VzIGJhc2UgZGUgZG9ubsOpZXNcbiAgICAgICAgY29tbWVudHM6IHtcbiAgICAgICAgICAgIHR5cGU6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRlcklkOiBTdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRlclBzZXVkbzogU3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBTdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogTnVtYmVyXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIHRpbWVzdGFtcHM6IHRydWVcbiAgICB9XG4pO1xuXG5sZXQgUG9zdCA9IG1vbmdvb3NlLm1vZGVsKCdwb3N0JywgUG9zdFNjaGVtYSlcbm1vZHVsZS5leHBvcnRzID0gUG9zdDsiXX0=","map":{"version":3,"sources":["post.model.js"],"names":["mongoose","require","PostSchema","Schema","posterId","type","String","required","message","trim","maxlength","picture","video","likers","comments","commenterId","commenterPseudo","text","timestamp","Number","timestamps","Post","model","module","exports"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,MAAMC,UAAU,GAAG,IAAIF,QAAQ,CAACG,MAAb,CACf;AACIC,EAAAA,QAAQ,EAAE;AACNC,IAAAA,IAAI,EAAEC,MADA;AAENC,IAAAA,QAAQ,EAAE;AAFJ,GADd;AAKIC,EAAAA,OAAO,EAAE;AACLH,IAAAA,IAAI,EAAEC,MADD;AAELG,IAAAA,IAAI,EAAE,IAFD;AAGLC,IAAAA,SAAS,EAAE;AAHN,GALb;AAUIC,EAAAA,OAAO,EAAE;AACLN,IAAAA,IAAI,EAAEC;AADD,GAVb;AAaIM,EAAAA,KAAK,EAAE;AACHP,IAAAA,IAAI,EAAEC;AADH,GAbX;AAgBIO,EAAAA,MAAM,EAAE;AACJR,IAAAA,IAAI,EAAE,CAACC,MAAD,CADF;AAEJC,IAAAA,QAAQ,EAAE;AAFN,GAhBZ;AAoBI;AACAO,EAAAA,QAAQ,EAAE;AACNT,IAAAA,IAAI,EAAE,CACF;AACIU,MAAAA,WAAW,EAAET,MADjB;AAEIU,MAAAA,eAAe,EAAEV,MAFrB;AAGIW,MAAAA,IAAI,EAAEX,MAHV;AAIIY,MAAAA,SAAS,EAAEC;AAJf,KADE,CADA;AASNZ,IAAAA,QAAQ,EAAE;AATJ;AArBd,CADe,EAkCf;AACIa,EAAAA,UAAU,EAAE;AADhB,CAlCe,CAAnB;AAuCA,IAAIC,IAAI,GAAGrB,QAAQ,CAACsB,KAAT,CAAe,MAAf,EAAuBpB,UAAvB,CAAX;AACAqB,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/src/models/","sourcesContent":["const mongoose = require('mongoose');\n\nconst PostSchema = new mongoose.Schema(\n    {\n        posterId: {\n            type: String,\n            required: true,\n        },\n        message: {\n            type: String,\n            trim: true,\n            maxlength: 500\n        },\n        picture: {\n            type: String\n        },\n        video: {\n            type: String\n        },\n        likers: {\n            type: [String],\n            required: true,\n        },\n        //la partie commentaire est une sous base de données\n        comments: {\n            type: [\n                {\n                    commenterId: String,\n                    commenterPseudo: String,\n                    text: String,\n                    timestamp: Number\n                }\n            ],\n            required: true,\n        }\n    },\n    {\n        timestamps: true\n    }\n);\n\nlet Post = mongoose.model('post', PostSchema)\nmodule.exports = Post;"]}},"mtime":1651276586978},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/models/user.model.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nconst {\n  isEmail\n} = require('validator');\n\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  pseudo: {\n    type: String,\n    required: true,\n    minlength: 3,\n    maxlength: 55,\n    unique: true,\n    trim: true\n  },\n  email: {\n    type: String,\n    required: true,\n    validate: [isEmail],\n    lowercase: true,\n    unique: true,\n    trim: true\n  },\n  password: {\n    type: String,\n    required: true,\n    max: 1024,\n    minlength: 6\n  },\n  picture: {\n    type: String,\n    default: \"./uploads/profil/random-user.png\"\n  },\n  bio: {\n    type: String,\n    max: 1024\n  },\n  followers: {\n    type: [String]\n  },\n  following: {\n    type: [String]\n  },\n  likes: {\n    type: [String]\n  }\n}, {\n  timestamps: true\n}); //play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\n\nUserSchema.pre('save', async function (next) {\n  const salt = await bcrypt.genSalt();\n  this.password = await bcrypt.hash(this.password, salt);\n  next();\n}); //c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\n\nUserSchema.statics.login = async function (email, password) {\n  const user = await this.findOne({\n    email: email\n  });\n\n  if (user) {\n    const auth = await bcrypt.compare(password, user.password);\n\n    if (auth) {\n      return user;\n    } else {\n      throw Error('Incorrect password');\n    }\n  }\n\n  throw Error('Incorrect password');\n};\n\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIubW9kZWwuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiaXNFbWFpbCIsImJjcnlwdCIsIlNjaGVtYSIsIlVzZXJTY2hlbWEiLCJwc2V1ZG8iLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJtaW5sZW5ndGgiLCJtYXhsZW5ndGgiLCJ1bmlxdWUiLCJ0cmltIiwiZW1haWwiLCJ2YWxpZGF0ZSIsImxvd2VyY2FzZSIsInBhc3N3b3JkIiwibWF4IiwicGljdHVyZSIsImRlZmF1bHQiLCJiaW8iLCJmb2xsb3dlcnMiLCJmb2xsb3dpbmciLCJsaWtlcyIsInRpbWVzdGFtcHMiLCJwcmUiLCJuZXh0Iiwic2FsdCIsImdlblNhbHQiLCJoYXNoIiwic3RhdGljcyIsImxvZ2luIiwidXNlciIsImZpbmRPbmUiLCJhdXRoIiwiY29tcGFyZSIsIkVycm9yIiwiVXNlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUNBLE1BQU07QUFBQ0MsRUFBQUE7QUFBRCxJQUFZRCxPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFDQSxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxRQUFELENBQXRCOztBQUVBLE1BQU1HLE1BQU0sR0FBR0osUUFBUSxDQUFDSSxNQUF4QjtBQUNBLE1BQU1DLFVBQVUsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDMUJFLEVBQUFBLE1BQU0sRUFBRTtBQUNKQyxJQUFBQSxJQUFJLEVBQUVDLE1BREY7QUFFSkMsSUFBQUEsUUFBUSxFQUFDLElBRkw7QUFHSkMsSUFBQUEsU0FBUyxFQUFFLENBSFA7QUFJSkMsSUFBQUEsU0FBUyxFQUFDLEVBSk47QUFLSkMsSUFBQUEsTUFBTSxFQUFDLElBTEg7QUFNSkMsSUFBQUEsSUFBSSxFQUFDO0FBTkQsR0FEa0I7QUFTMUJDLEVBQUFBLEtBQUssRUFBQztBQUNGUCxJQUFBQSxJQUFJLEVBQUNDLE1BREg7QUFFRkMsSUFBQUEsUUFBUSxFQUFDLElBRlA7QUFHRk0sSUFBQUEsUUFBUSxFQUFDLENBQUNiLE9BQUQsQ0FIUDtBQUlGYyxJQUFBQSxTQUFTLEVBQUMsSUFKUjtBQUtGSixJQUFBQSxNQUFNLEVBQUMsSUFMTDtBQU1GQyxJQUFBQSxJQUFJLEVBQUM7QUFOSCxHQVRvQjtBQWlCMUJJLEVBQUFBLFFBQVEsRUFBQztBQUNMVixJQUFBQSxJQUFJLEVBQUNDLE1BREE7QUFFTEMsSUFBQUEsUUFBUSxFQUFDLElBRko7QUFHTFMsSUFBQUEsR0FBRyxFQUFDLElBSEM7QUFJTFIsSUFBQUEsU0FBUyxFQUFDO0FBSkwsR0FqQmlCO0FBdUIxQlMsRUFBQUEsT0FBTyxFQUFDO0FBQ0paLElBQUFBLElBQUksRUFBQ0MsTUFERDtBQUVKWSxJQUFBQSxPQUFPLEVBQUM7QUFGSixHQXZCa0I7QUEyQjFCQyxFQUFBQSxHQUFHLEVBQUM7QUFDQWQsSUFBQUEsSUFBSSxFQUFDQyxNQURMO0FBRUFVLElBQUFBLEdBQUcsRUFBQztBQUZKLEdBM0JzQjtBQStCMUJJLEVBQUFBLFNBQVMsRUFBRTtBQUNQZixJQUFBQSxJQUFJLEVBQUMsQ0FBQ0MsTUFBRDtBQURFLEdBL0JlO0FBa0MxQmUsRUFBQUEsU0FBUyxFQUFDO0FBQ05oQixJQUFBQSxJQUFJLEVBQUMsQ0FBQ0MsTUFBRDtBQURDLEdBbENnQjtBQXFDMUJnQixFQUFBQSxLQUFLLEVBQUU7QUFDSGpCLElBQUFBLElBQUksRUFBQyxDQUFDQyxNQUFEO0FBREY7QUFyQ21CLENBQVgsRUF3Q2hCO0FBQ0NpQixFQUFBQSxVQUFVLEVBQUM7QUFEWixDQXhDZ0IsQ0FBbkIsQyxDQTZDQTtBQUNBOztBQUNBcEIsVUFBVSxDQUFDcUIsR0FBWCxDQUFlLE1BQWYsRUFBdUIsZ0JBQWdCQyxJQUFoQixFQUFxQjtBQUN4QyxRQUFNQyxJQUFJLEdBQUcsTUFBTXpCLE1BQU0sQ0FBQzBCLE9BQVAsRUFBbkI7QUFDQSxPQUFLWixRQUFMLEdBQWdCLE1BQU1kLE1BQU0sQ0FBQzJCLElBQVAsQ0FBWSxLQUFLYixRQUFqQixFQUEyQlcsSUFBM0IsQ0FBdEI7QUFDQUQsRUFBQUEsSUFBSTtBQUNQLENBSkQsRSxDQU1BOztBQUNBdEIsVUFBVSxDQUFDMEIsT0FBWCxDQUFtQkMsS0FBbkIsR0FBMkIsZ0JBQWVsQixLQUFmLEVBQXNCRyxRQUF0QixFQUErQjtBQUN0RCxRQUFNZ0IsSUFBSSxHQUFHLE1BQU0sS0FBS0MsT0FBTCxDQUFhO0FBQUNwQixJQUFBQSxLQUFLLEVBQUVBO0FBQVIsR0FBYixDQUFuQjs7QUFDQSxNQUFHbUIsSUFBSCxFQUFRO0FBQ0osVUFBTUUsSUFBSSxHQUFHLE1BQU1oQyxNQUFNLENBQUNpQyxPQUFQLENBQWVuQixRQUFmLEVBQXlCZ0IsSUFBSSxDQUFDaEIsUUFBOUIsQ0FBbkI7O0FBQ0EsUUFBR2tCLElBQUgsRUFBUTtBQUNKLGFBQU9GLElBQVA7QUFDSCxLQUZELE1BR0k7QUFDQSxZQUFNSSxLQUFLLENBQUMsb0JBQUQsQ0FBWDtBQUNIO0FBQ0o7O0FBQ0QsUUFBTUEsS0FBSyxDQUFDLG9CQUFELENBQVg7QUFDSCxDQVpEOztBQWFBLElBQUlDLElBQUksR0FBR3RDLFFBQVEsQ0FBQ3VDLEtBQVQsQ0FBZSxNQUFmLEVBQXVCbEMsVUFBdkIsQ0FBWDtBQUNBbUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCSCxJQUFqQiIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc3JjL21vZGVscy8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XG5jb25zdCB7aXNFbWFpbH0gPSByZXF1aXJlKCd2YWxpZGF0b3InKTtcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gICAgcHNldWRvOiB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgcmVxdWlyZWQ6dHJ1ZSxcbiAgICAgICAgbWlubGVuZ3RoOiAzLCBcbiAgICAgICAgbWF4bGVuZ3RoOjU1LCBcbiAgICAgICAgdW5pcXVlOnRydWUsXG4gICAgICAgIHRyaW06dHJ1ZVxuICAgIH0sXG4gICAgZW1haWw6e1xuICAgICAgICB0eXBlOlN0cmluZyxcbiAgICAgICAgcmVxdWlyZWQ6dHJ1ZSxcbiAgICAgICAgdmFsaWRhdGU6W2lzRW1haWxdLFxuICAgICAgICBsb3dlcmNhc2U6dHJ1ZSwgICAgICAgIFxuICAgICAgICB1bmlxdWU6dHJ1ZSxcbiAgICAgICAgdHJpbTp0cnVlLFxuICAgIH0sXG4gICAgcGFzc3dvcmQ6e1xuICAgICAgICB0eXBlOlN0cmluZyxcbiAgICAgICAgcmVxdWlyZWQ6dHJ1ZSxcbiAgICAgICAgbWF4OjEwMjQsXG4gICAgICAgIG1pbmxlbmd0aDo2XG4gICAgfSxcbiAgICBwaWN0dXJlOntcbiAgICAgICAgdHlwZTpTdHJpbmcsXG4gICAgICAgIGRlZmF1bHQ6XCIuL3VwbG9hZHMvcHJvZmlsL3JhbmRvbS11c2VyLnBuZ1wiXG4gICAgfSxcbiAgICBiaW86e1xuICAgICAgICB0eXBlOlN0cmluZyxcbiAgICAgICAgbWF4OjEwMjRcbiAgICB9LFxuICAgIGZvbGxvd2Vyczoge1xuICAgICAgICB0eXBlOltTdHJpbmddLFxuICAgIH0sXG4gICAgZm9sbG93aW5nOntcbiAgICAgICAgdHlwZTpbU3RyaW5nXSxcbiAgICB9LFxuICAgIGxpa2VzOiB7XG4gICAgICAgIHR5cGU6W1N0cmluZ10sXG4gICAgfVxufSwge1xuICAgIHRpbWVzdGFtcHM6dHJ1ZVxufVxuKTtcblxuLy9wbGF5IGZ1bmN0aW9uIGJlZm9yZSBzYXZlIGludG8gZGIgdG8gYWxsb3cgY3J5cHQgcGFzc3dvcmRcbi8vIGxlIG5leHQgdmV1dCBkaXJlIHF1YW5kIHQnYSBmaW5pIHBhc3NlIMOgIGxhIHN1aXRlXG5Vc2VyU2NoZW1hLnByZSgnc2F2ZScsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KXtcbiAgICBjb25zdCBzYWx0ID0gYXdhaXQgYmNyeXB0LmdlblNhbHQoKTtcbiAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgc2FsdCk7XG4gICAgbmV4dCgpO1xufSlcblxuLy9jJ2VzdCBjZSBxdWkgdmEgbm91cyBwZXJtZXR0cmUgZGUgY29tcGFyZXIgbGUgcGFzc3dvcmQgY3J5cHTDqSBkZSBub3RyZSB1c2VyIGVuIGJhc2UgZGUgZG9ubsOpZXMgYXZlYyBjZWx1aSB1dGlsaXNlIHBkdCBsZSBsb2dpbiBkJ3VuIHVzZXJcblVzZXJTY2hlbWEuc3RhdGljcy5sb2dpbiA9IGFzeW5jIGZ1bmN0aW9uKGVtYWlsLCBwYXNzd29yZCl7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXMuZmluZE9uZSh7ZW1haWw6IGVtYWlsfSk7XG4gICAgaWYodXNlcil7XG4gICAgICAgIGNvbnN0IGF1dGggPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgdXNlci5wYXNzd29yZClcbiAgICAgICAgaWYoYXV0aCl7XG4gICAgICAgICAgICByZXR1cm4gdXNlclxuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignSW5jb3JyZWN0IHBhc3N3b3JkJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGhyb3cgRXJyb3IoJ0luY29ycmVjdCBwYXNzd29yZCcpO1xufVxubGV0IFVzZXIgPSBtb25nb29zZS5tb2RlbCgnVXNlcicsIFVzZXJTY2hlbWEpO1xubW9kdWxlLmV4cG9ydHMgPSBVc2VyOyJdfQ==","map":{"version":3,"sources":["user.model.js"],"names":["mongoose","require","isEmail","bcrypt","Schema","UserSchema","pseudo","type","String","required","minlength","maxlength","unique","trim","email","validate","lowercase","password","max","picture","default","bio","followers","following","likes","timestamps","pre","next","salt","genSalt","hash","statics","login","user","findOne","auth","compare","Error","User","model","module","exports"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAM;AAACC,EAAAA;AAAD,IAAYD,OAAO,CAAC,WAAD,CAAzB;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,QAAD,CAAtB;;AAEA,MAAMG,MAAM,GAAGJ,QAAQ,CAACI,MAAxB;AACA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CAAW;AAC1BE,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAEC,MADF;AAEJC,IAAAA,QAAQ,EAAC,IAFL;AAGJC,IAAAA,SAAS,EAAE,CAHP;AAIJC,IAAAA,SAAS,EAAC,EAJN;AAKJC,IAAAA,MAAM,EAAC,IALH;AAMJC,IAAAA,IAAI,EAAC;AAND,GADkB;AAS1BC,EAAAA,KAAK,EAAC;AACFP,IAAAA,IAAI,EAACC,MADH;AAEFC,IAAAA,QAAQ,EAAC,IAFP;AAGFM,IAAAA,QAAQ,EAAC,CAACb,OAAD,CAHP;AAIFc,IAAAA,SAAS,EAAC,IAJR;AAKFJ,IAAAA,MAAM,EAAC,IALL;AAMFC,IAAAA,IAAI,EAAC;AANH,GAToB;AAiB1BI,EAAAA,QAAQ,EAAC;AACLV,IAAAA,IAAI,EAACC,MADA;AAELC,IAAAA,QAAQ,EAAC,IAFJ;AAGLS,IAAAA,GAAG,EAAC,IAHC;AAILR,IAAAA,SAAS,EAAC;AAJL,GAjBiB;AAuB1BS,EAAAA,OAAO,EAAC;AACJZ,IAAAA,IAAI,EAACC,MADD;AAEJY,IAAAA,OAAO,EAAC;AAFJ,GAvBkB;AA2B1BC,EAAAA,GAAG,EAAC;AACAd,IAAAA,IAAI,EAACC,MADL;AAEAU,IAAAA,GAAG,EAAC;AAFJ,GA3BsB;AA+B1BI,EAAAA,SAAS,EAAE;AACPf,IAAAA,IAAI,EAAC,CAACC,MAAD;AADE,GA/Be;AAkC1Be,EAAAA,SAAS,EAAC;AACNhB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADC,GAlCgB;AAqC1BgB,EAAAA,KAAK,EAAE;AACHjB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADF;AArCmB,CAAX,EAwChB;AACCiB,EAAAA,UAAU,EAAC;AADZ,CAxCgB,CAAnB,C,CA6CA;AACA;;AACApB,UAAU,CAACqB,GAAX,CAAe,MAAf,EAAuB,gBAAgBC,IAAhB,EAAqB;AACxC,QAAMC,IAAI,GAAG,MAAMzB,MAAM,CAAC0B,OAAP,EAAnB;AACA,OAAKZ,QAAL,GAAgB,MAAMd,MAAM,CAAC2B,IAAP,CAAY,KAAKb,QAAjB,EAA2BW,IAA3B,CAAtB;AACAD,EAAAA,IAAI;AACP,CAJD,E,CAMA;;AACAtB,UAAU,CAAC0B,OAAX,CAAmBC,KAAnB,GAA2B,gBAAelB,KAAf,EAAsBG,QAAtB,EAA+B;AACtD,QAAMgB,IAAI,GAAG,MAAM,KAAKC,OAAL,CAAa;AAACpB,IAAAA,KAAK,EAAEA;AAAR,GAAb,CAAnB;;AACA,MAAGmB,IAAH,EAAQ;AACJ,UAAME,IAAI,GAAG,MAAMhC,MAAM,CAACiC,OAAP,CAAenB,QAAf,EAAyBgB,IAAI,CAAChB,QAA9B,CAAnB;;AACA,QAAGkB,IAAH,EAAQ;AACJ,aAAOF,IAAP;AACH,KAFD,MAGI;AACA,YAAMI,KAAK,CAAC,oBAAD,CAAX;AACH;AACJ;;AACD,QAAMA,KAAK,CAAC,oBAAD,CAAX;AACH,CAZD;;AAaA,IAAIC,IAAI,GAAGtC,QAAQ,CAACuC,KAAT,CAAe,MAAf,EAAuBlC,UAAvB,CAAX;AACAmC,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/src/models/","sourcesContent":["const mongoose = require('mongoose');\nconst {isEmail} = require('validator');\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n    pseudo: {\n        type: String,\n        required:true,\n        minlength: 3, \n        maxlength:55, \n        unique:true,\n        trim:true\n    },\n    email:{\n        type:String,\n        required:true,\n        validate:[isEmail],\n        lowercase:true,        \n        unique:true,\n        trim:true,\n    },\n    password:{\n        type:String,\n        required:true,\n        max:1024,\n        minlength:6\n    },\n    picture:{\n        type:String,\n        default:\"./uploads/profil/random-user.png\"\n    },\n    bio:{\n        type:String,\n        max:1024\n    },\n    followers: {\n        type:[String],\n    },\n    following:{\n        type:[String],\n    },\n    likes: {\n        type:[String],\n    }\n}, {\n    timestamps:true\n}\n);\n\n//play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\nUserSchema.pre('save', async function (next){\n    const salt = await bcrypt.genSalt();\n    this.password = await bcrypt.hash(this.password, salt);\n    next();\n})\n\n//c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\nUserSchema.statics.login = async function(email, password){\n    const user = await this.findOne({email: email});\n    if(user){\n        const auth = await bcrypt.compare(password, user.password)\n        if(auth){\n            return user\n        }\n        else{\n            throw Error('Incorrect password');\n        }\n    }\n    throw Error('Incorrect password');\n}\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;"]}},"mtime":1651374997096},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/models/user.model.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nconst {\n  isEmail\n} = require('validator');\n\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  pseudo: {\n    type: String,\n    required: true,\n    minlength: 3,\n    maxlength: 55,\n    unique: true,\n    trim: true\n  },\n  email: {\n    type: String,\n    required: true,\n    validate: [isEmail],\n    lowercase: true,\n    unique: true,\n    trim: true\n  },\n  password: {\n    type: String,\n    required: true,\n    max: 1024,\n    minlength: 6\n  },\n  picture: {\n    type: String,\n    default: \"./uploads/profil/random-user.png\"\n  },\n  bio: {\n    type: String,\n    max: 1024\n  },\n  followers: {\n    type: [String]\n  },\n  following: {\n    type: [String]\n  },\n  likes: {\n    type: [String]\n  }\n}, {\n  timestamps: true\n}); //play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\n\nUserSchema.pre('save', async function (next) {\n  const salt = await bcrypt.genSalt();\n  this.password = await bcrypt.hash(this.password, salt);\n  next();\n}); //c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\n\nUserSchema.statics.login = async function (email, password) {\n  const user = await this.findOne({\n    email: email\n  });\n\n  if (user) {\n    const auth = await bcrypt.compare(password, user.password);\n\n    if (auth) {\n      return user;\n    } else {\n      throw Error('Incorrect password');\n    }\n  }\n\n  throw Error('Incorrect password');\n};\n\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIubW9kZWwuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiaXNFbWFpbCIsImJjcnlwdCIsIlNjaGVtYSIsIlVzZXJTY2hlbWEiLCJwc2V1ZG8iLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJtaW5sZW5ndGgiLCJtYXhsZW5ndGgiLCJ1bmlxdWUiLCJ0cmltIiwiZW1haWwiLCJ2YWxpZGF0ZSIsImxvd2VyY2FzZSIsInBhc3N3b3JkIiwibWF4IiwicGljdHVyZSIsImRlZmF1bHQiLCJiaW8iLCJmb2xsb3dlcnMiLCJmb2xsb3dpbmciLCJsaWtlcyIsInRpbWVzdGFtcHMiLCJwcmUiLCJuZXh0Iiwic2FsdCIsImdlblNhbHQiLCJoYXNoIiwic3RhdGljcyIsImxvZ2luIiwidXNlciIsImZpbmRPbmUiLCJhdXRoIiwiY29tcGFyZSIsIkVycm9yIiwiVXNlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUNBLE1BQU07QUFBQ0MsRUFBQUE7QUFBRCxJQUFZRCxPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFDQSxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxRQUFELENBQXRCOztBQUVBLE1BQU1HLE1BQU0sR0FBR0osUUFBUSxDQUFDSSxNQUF4QjtBQUNBLE1BQU1DLFVBQVUsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDMUJFLEVBQUFBLE1BQU0sRUFBRTtBQUNKQyxJQUFBQSxJQUFJLEVBQUVDLE1BREY7QUFFSkMsSUFBQUEsUUFBUSxFQUFDLElBRkw7QUFHSkMsSUFBQUEsU0FBUyxFQUFFLENBSFA7QUFJSkMsSUFBQUEsU0FBUyxFQUFDLEVBSk47QUFLSkMsSUFBQUEsTUFBTSxFQUFDLElBTEg7QUFNSkMsSUFBQUEsSUFBSSxFQUFDO0FBTkQsR0FEa0I7QUFTMUJDLEVBQUFBLEtBQUssRUFBQztBQUNGUCxJQUFBQSxJQUFJLEVBQUNDLE1BREg7QUFFRkMsSUFBQUEsUUFBUSxFQUFDLElBRlA7QUFHRk0sSUFBQUEsUUFBUSxFQUFDLENBQUNiLE9BQUQsQ0FIUDtBQUlGYyxJQUFBQSxTQUFTLEVBQUMsSUFKUjtBQUtGSixJQUFBQSxNQUFNLEVBQUMsSUFMTDtBQU1GQyxJQUFBQSxJQUFJLEVBQUM7QUFOSCxHQVRvQjtBQWlCMUJJLEVBQUFBLFFBQVEsRUFBQztBQUNMVixJQUFBQSxJQUFJLEVBQUNDLE1BREE7QUFFTEMsSUFBQUEsUUFBUSxFQUFDLElBRko7QUFHTFMsSUFBQUEsR0FBRyxFQUFDLElBSEM7QUFJTFIsSUFBQUEsU0FBUyxFQUFDO0FBSkwsR0FqQmlCO0FBdUIxQlMsRUFBQUEsT0FBTyxFQUFDO0FBQ0paLElBQUFBLElBQUksRUFBQ0MsTUFERDtBQUVKWSxJQUFBQSxPQUFPLEVBQUM7QUFGSixHQXZCa0I7QUEyQjFCQyxFQUFBQSxHQUFHLEVBQUM7QUFDQWQsSUFBQUEsSUFBSSxFQUFDQyxNQURMO0FBRUFVLElBQUFBLEdBQUcsRUFBQztBQUZKLEdBM0JzQjtBQStCMUJJLEVBQUFBLFNBQVMsRUFBRTtBQUNQZixJQUFBQSxJQUFJLEVBQUMsQ0FBQ0MsTUFBRDtBQURFLEdBL0JlO0FBa0MxQmUsRUFBQUEsU0FBUyxFQUFDO0FBQ05oQixJQUFBQSxJQUFJLEVBQUMsQ0FBQ0MsTUFBRDtBQURDLEdBbENnQjtBQXFDMUJnQixFQUFBQSxLQUFLLEVBQUU7QUFDSGpCLElBQUFBLElBQUksRUFBQyxDQUFDQyxNQUFEO0FBREY7QUFyQ21CLENBQVgsRUF3Q2hCO0FBQ0NpQixFQUFBQSxVQUFVLEVBQUM7QUFEWixDQXhDZ0IsQ0FBbkIsQyxDQTZDQTtBQUNBOztBQUNBcEIsVUFBVSxDQUFDcUIsR0FBWCxDQUFlLE1BQWYsRUFBdUIsZ0JBQWdCQyxJQUFoQixFQUFxQjtBQUN4QyxRQUFNQyxJQUFJLEdBQUcsTUFBTXpCLE1BQU0sQ0FBQzBCLE9BQVAsRUFBbkI7QUFDQSxPQUFLWixRQUFMLEdBQWdCLE1BQU1kLE1BQU0sQ0FBQzJCLElBQVAsQ0FBWSxLQUFLYixRQUFqQixFQUEyQlcsSUFBM0IsQ0FBdEI7QUFDQUQsRUFBQUEsSUFBSTtBQUNQLENBSkQsRSxDQU1BOztBQUNBdEIsVUFBVSxDQUFDMEIsT0FBWCxDQUFtQkMsS0FBbkIsR0FBMkIsZ0JBQWVsQixLQUFmLEVBQXNCRyxRQUF0QixFQUErQjtBQUN0RCxRQUFNZ0IsSUFBSSxHQUFHLE1BQU0sS0FBS0MsT0FBTCxDQUFhO0FBQUNwQixJQUFBQSxLQUFLLEVBQUVBO0FBQVIsR0FBYixDQUFuQjs7QUFDQSxNQUFHbUIsSUFBSCxFQUFRO0FBQ0osVUFBTUUsSUFBSSxHQUFHLE1BQU1oQyxNQUFNLENBQUNpQyxPQUFQLENBQWVuQixRQUFmLEVBQXlCZ0IsSUFBSSxDQUFDaEIsUUFBOUIsQ0FBbkI7O0FBQ0EsUUFBR2tCLElBQUgsRUFBUTtBQUNKLGFBQU9GLElBQVA7QUFDSCxLQUZELE1BR0k7QUFDQSxZQUFNSSxLQUFLLENBQUMsb0JBQUQsQ0FBWDtBQUNIO0FBQ0o7O0FBQ0QsUUFBTUEsS0FBSyxDQUFDLG9CQUFELENBQVg7QUFDSCxDQVpEOztBQWFBLElBQUlDLElBQUksR0FBR3RDLFFBQVEsQ0FBQ3VDLEtBQVQsQ0FBZSxNQUFmLEVBQXVCbEMsVUFBdkIsQ0FBWDtBQUNBbUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCSCxJQUFqQiIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc3JjL21vZGVscy8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XG5jb25zdCB7aXNFbWFpbH0gPSByZXF1aXJlKCd2YWxpZGF0b3InKTtcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gICAgcHNldWRvOiB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgcmVxdWlyZWQ6dHJ1ZSxcbiAgICAgICAgbWlubGVuZ3RoOiAzLCBcbiAgICAgICAgbWF4bGVuZ3RoOjU1LCBcbiAgICAgICAgdW5pcXVlOnRydWUsXG4gICAgICAgIHRyaW06dHJ1ZVxuICAgIH0sXG4gICAgZW1haWw6e1xuICAgICAgICB0eXBlOlN0cmluZyxcbiAgICAgICAgcmVxdWlyZWQ6dHJ1ZSxcbiAgICAgICAgdmFsaWRhdGU6W2lzRW1haWxdLFxuICAgICAgICBsb3dlcmNhc2U6dHJ1ZSwgICAgICAgIFxuICAgICAgICB1bmlxdWU6dHJ1ZSxcbiAgICAgICAgdHJpbTp0cnVlLFxuICAgIH0sXG4gICAgcGFzc3dvcmQ6e1xuICAgICAgICB0eXBlOlN0cmluZyxcbiAgICAgICAgcmVxdWlyZWQ6dHJ1ZSxcbiAgICAgICAgbWF4OjEwMjQsXG4gICAgICAgIG1pbmxlbmd0aDo2XG4gICAgfSxcbiAgICBwaWN0dXJlOntcbiAgICAgICAgdHlwZTpTdHJpbmcsXG4gICAgICAgIGRlZmF1bHQ6XCIuL3VwbG9hZHMvcHJvZmlsL3JhbmRvbS11c2VyLnBuZ1wiXG4gICAgfSxcbiAgICBiaW86e1xuICAgICAgICB0eXBlOlN0cmluZyxcbiAgICAgICAgbWF4OjEwMjRcbiAgICB9LFxuICAgIGZvbGxvd2Vyczoge1xuICAgICAgICB0eXBlOltTdHJpbmddLFxuICAgIH0sXG4gICAgZm9sbG93aW5nOntcbiAgICAgICAgdHlwZTpbU3RyaW5nXSxcbiAgICB9LFxuICAgIGxpa2VzOiB7XG4gICAgICAgIHR5cGU6W1N0cmluZ10sXG4gICAgfVxufSwge1xuICAgIHRpbWVzdGFtcHM6dHJ1ZVxufVxuKTtcblxuLy9wbGF5IGZ1bmN0aW9uIGJlZm9yZSBzYXZlIGludG8gZGIgdG8gYWxsb3cgY3J5cHQgcGFzc3dvcmRcbi8vIGxlIG5leHQgdmV1dCBkaXJlIHF1YW5kIHQnYSBmaW5pIHBhc3NlIMOgIGxhIHN1aXRlXG5Vc2VyU2NoZW1hLnByZSgnc2F2ZScsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KXtcbiAgICBjb25zdCBzYWx0ID0gYXdhaXQgYmNyeXB0LmdlblNhbHQoKTtcbiAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgc2FsdCk7XG4gICAgbmV4dCgpO1xufSlcblxuLy9jJ2VzdCBjZSBxdWkgdmEgbm91cyBwZXJtZXR0cmUgZGUgY29tcGFyZXIgbGUgcGFzc3dvcmQgY3J5cHTDqSBkZSBub3RyZSB1c2VyIGVuIGJhc2UgZGUgZG9ubsOpZXMgYXZlYyBjZWx1aSB1dGlsaXNlIHBkdCBsZSBsb2dpbiBkJ3VuIHVzZXJcblVzZXJTY2hlbWEuc3RhdGljcy5sb2dpbiA9IGFzeW5jIGZ1bmN0aW9uKGVtYWlsLCBwYXNzd29yZCl7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXMuZmluZE9uZSh7ZW1haWw6IGVtYWlsfSk7XG4gICAgaWYodXNlcil7XG4gICAgICAgIGNvbnN0IGF1dGggPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgdXNlci5wYXNzd29yZClcbiAgICAgICAgaWYoYXV0aCl7XG4gICAgICAgICAgICByZXR1cm4gdXNlclxuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignSW5jb3JyZWN0IHBhc3N3b3JkJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGhyb3cgRXJyb3IoJ0luY29ycmVjdCBwYXNzd29yZCcpO1xufVxubGV0IFVzZXIgPSBtb25nb29zZS5tb2RlbCgnVXNlcicsIFVzZXJTY2hlbWEpO1xubW9kdWxlLmV4cG9ydHMgPSBVc2VyOyJdfQ==","map":{"version":3,"sources":["user.model.js"],"names":["mongoose","require","isEmail","bcrypt","Schema","UserSchema","pseudo","type","String","required","minlength","maxlength","unique","trim","email","validate","lowercase","password","max","picture","default","bio","followers","following","likes","timestamps","pre","next","salt","genSalt","hash","statics","login","user","findOne","auth","compare","Error","User","model","module","exports"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAM;AAACC,EAAAA;AAAD,IAAYD,OAAO,CAAC,WAAD,CAAzB;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,QAAD,CAAtB;;AAEA,MAAMG,MAAM,GAAGJ,QAAQ,CAACI,MAAxB;AACA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CAAW;AAC1BE,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAEC,MADF;AAEJC,IAAAA,QAAQ,EAAC,IAFL;AAGJC,IAAAA,SAAS,EAAE,CAHP;AAIJC,IAAAA,SAAS,EAAC,EAJN;AAKJC,IAAAA,MAAM,EAAC,IALH;AAMJC,IAAAA,IAAI,EAAC;AAND,GADkB;AAS1BC,EAAAA,KAAK,EAAC;AACFP,IAAAA,IAAI,EAACC,MADH;AAEFC,IAAAA,QAAQ,EAAC,IAFP;AAGFM,IAAAA,QAAQ,EAAC,CAACb,OAAD,CAHP;AAIFc,IAAAA,SAAS,EAAC,IAJR;AAKFJ,IAAAA,MAAM,EAAC,IALL;AAMFC,IAAAA,IAAI,EAAC;AANH,GAToB;AAiB1BI,EAAAA,QAAQ,EAAC;AACLV,IAAAA,IAAI,EAACC,MADA;AAELC,IAAAA,QAAQ,EAAC,IAFJ;AAGLS,IAAAA,GAAG,EAAC,IAHC;AAILR,IAAAA,SAAS,EAAC;AAJL,GAjBiB;AAuB1BS,EAAAA,OAAO,EAAC;AACJZ,IAAAA,IAAI,EAACC,MADD;AAEJY,IAAAA,OAAO,EAAC;AAFJ,GAvBkB;AA2B1BC,EAAAA,GAAG,EAAC;AACAd,IAAAA,IAAI,EAACC,MADL;AAEAU,IAAAA,GAAG,EAAC;AAFJ,GA3BsB;AA+B1BI,EAAAA,SAAS,EAAE;AACPf,IAAAA,IAAI,EAAC,CAACC,MAAD;AADE,GA/Be;AAkC1Be,EAAAA,SAAS,EAAC;AACNhB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADC,GAlCgB;AAqC1BgB,EAAAA,KAAK,EAAE;AACHjB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADF;AArCmB,CAAX,EAwChB;AACCiB,EAAAA,UAAU,EAAC;AADZ,CAxCgB,CAAnB,C,CA6CA;AACA;;AACApB,UAAU,CAACqB,GAAX,CAAe,MAAf,EAAuB,gBAAgBC,IAAhB,EAAqB;AACxC,QAAMC,IAAI,GAAG,MAAMzB,MAAM,CAAC0B,OAAP,EAAnB;AACA,OAAKZ,QAAL,GAAgB,MAAMd,MAAM,CAAC2B,IAAP,CAAY,KAAKb,QAAjB,EAA2BW,IAA3B,CAAtB;AACAD,EAAAA,IAAI;AACP,CAJD,E,CAMA;;AACAtB,UAAU,CAAC0B,OAAX,CAAmBC,KAAnB,GAA2B,gBAAelB,KAAf,EAAsBG,QAAtB,EAA+B;AACtD,QAAMgB,IAAI,GAAG,MAAM,KAAKC,OAAL,CAAa;AAACpB,IAAAA,KAAK,EAAEA;AAAR,GAAb,CAAnB;;AACA,MAAGmB,IAAH,EAAQ;AACJ,UAAME,IAAI,GAAG,MAAMhC,MAAM,CAACiC,OAAP,CAAenB,QAAf,EAAyBgB,IAAI,CAAChB,QAA9B,CAAnB;;AACA,QAAGkB,IAAH,EAAQ;AACJ,aAAOF,IAAP;AACH,KAFD,MAGI;AACA,YAAMI,KAAK,CAAC,oBAAD,CAAX;AACH;AACJ;;AACD,QAAMA,KAAK,CAAC,oBAAD,CAAX;AACH,CAZD;;AAaA,IAAIC,IAAI,GAAGtC,QAAQ,CAACuC,KAAT,CAAe,MAAf,EAAuBlC,UAAvB,CAAX;AACAmC,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/src/models/","sourcesContent":["const mongoose = require('mongoose');\nconst {isEmail} = require('validator');\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n    pseudo: {\n        type: String,\n        required:true,\n        minlength: 3, \n        maxlength:55, \n        unique:true,\n        trim:true\n    },\n    email:{\n        type:String,\n        required:true,\n        validate:[isEmail],\n        lowercase:true,        \n        unique:true,\n        trim:true,\n    },\n    password:{\n        type:String,\n        required:true,\n        max:1024,\n        minlength:6\n    },\n    picture:{\n        type:String,\n        default:\"./uploads/profil/random-user.png\"\n    },\n    bio:{\n        type:String,\n        max:1024\n    },\n    followers: {\n        type:[String],\n    },\n    following:{\n        type:[String],\n    },\n    likes: {\n        type:[String],\n    }\n}, {\n    timestamps:true\n}\n);\n\n//play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\nUserSchema.pre('save', async function (next){\n    const salt = await bcrypt.genSalt();\n    this.password = await bcrypt.hash(this.password, salt);\n    next();\n})\n\n//c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\nUserSchema.statics.login = async function(email, password){\n    const user = await this.findOne({email: email});\n    if(user){\n        const auth = await bcrypt.compare(password, user.password)\n        if(auth){\n            return user\n        }\n        else{\n            throw Error('Incorrect password');\n        }\n    }\n    throw Error('Incorrect password');\n}\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;"]}},"mtime":1651374997096},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/controllers/post.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updatePost = exports.unlikePost = exports.readPost = exports.likePost = exports.editCommentPost = exports.deletePost = exports.deleteCommentPost = exports.createPost = exports.commentPost = void 0;\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst Post = require('../models/post.model');\n\nconst User = require('../models/user.model');\n\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\nconst readPost = async (req, res, next) => {\n  try {\n    const posts = await Post.find().sort({\n      createdAt: -1\n    });\n    res.status(200).json(posts);\n  } catch (err) {\n    res.status(200).json(err);\n  }\n};\n\nexports.readPost = readPost;\n\nconst createPost = async (req, res, next) => {\n  if (req.file != null) {\n    console.log(req.file);\n\n    try {\n      if (req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\") {\n        throw new Error('invalid file');\n      }\n\n      if (req.file.size > 500000) {\n        throw new Error('max size');\n      }\n    } catch (err) {\n      const errors = (0, _errors.uploadErrors)(err);\n      return res.status(201).json({\n        errors\n      });\n    }\n  }\n\n  const newPost = new Post({\n    posterId: req.body.posterId,\n    message: req.body.message,\n    picture: req.file != null ? `http://localhost:8080/uploads/posts/${req.file.filename}` : \"\",\n    video: req.body.video,\n    likers: [],\n    comments: []\n  });\n\n  try {\n    const post = await newPost.save();\n    return res.status(201).json(post);\n  } catch (err) {\n    return res.status(400).json(err);\n  }\n};\n\nexports.createPost = createPost;\n\nconst updatePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const updatedRecord = {\n      message: req.body.message\n    };\n    const newPost = await Post.findByIdAndUpdate(req.params.id, {\n      $set: updatedRecord\n    }, {\n      new: true\n    });\n    res.status(200).send(newPost);\n  } catch (err) {\n    res.status(400).json(err);\n  }\n};\n\nexports.updatePost = updatePost;\n\nconst deletePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    await Post.remove({\n      _id: req.params.id\n    }).exec();\n    res.status(200).json({\n      message: 'Successfully deleted !'\n    });\n  } catch (err) {\n    res.status(500).json({\n      message: err\n    });\n  }\n};\n\nexports.deletePost = deletePost;\n\nconst likePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $addToSet: {\n        likers: req.body.id\n      }\n    }, {\n      new: true\n    });\n    const user = await User.findByIdAndUpdate(req.body.id, {\n      $addToSet: {\n        likes: req.params.id\n      }\n    }, {\n      new: true\n    });\n    res.status(200).send(post);\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.likePost = likePost;\n\nconst unlikePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $pull: {\n        likers: req.body.id\n      }\n    }, {\n      new: true\n    });\n    const user = await User.findByIdAndUpdate(req.body.id, {\n      $pull: {\n        likes: req.params.id\n      }\n    }, {\n      new: true\n    });\n    res.status(200).send(user);\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.unlikePost = unlikePost;\n\nconst commentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $push: {\n        comments: {\n          commenterId: req.body.commenterId,\n          commenterPseudo: req.body.commenterPseudo,\n          text: req.body.text,\n          timestamp: new Date().getTime()\n        }\n      }\n    }, {\n      new: true\n    }).then(data => res.send(data)).catch(err => res.status(500).send({\n      message: err\n    }));\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.commentPost = commentPost;\n\nconst editCommentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    //on récupère le post concerné\n    const post = await Post.findById(req.params.id); //on récupère le commentaire concerné\n\n    const theComment = await post.comments.find(comment => {\n      return comment._id.equals(req.body.commentId);\n    });\n    console.log(theComment); //on change le text\n\n    theComment.text = req.body.text; // on save les changements\n\n    await post.save(); //on send le post concerné\n\n    return res.send(post);\n  } catch (err) {\n    return res.status(400).send(err);\n  }\n};\n\nexports.editCommentPost = editCommentPost;\n\nconst deleteCommentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $pull: {\n        comments: {\n          _id: req.body.commentId\n        }\n      }\n    }, {\n      new: true\n    }).then(newPost => {\n      res.send(newPost);\n    }).catch(err => {\n      return res.status(400).send(err);\n    });\n  } catch (err) {\n    return res.status(400).send(err);\n  }\n};\n\nexports.deleteCommentPost = deleteCommentPost;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJQb3N0IiwicmVxdWlyZSIsIlVzZXIiLCJPYmplY3RJRCIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWFkUG9zdCIsInJlcSIsInJlcyIsIm5leHQiLCJwb3N0cyIsImZpbmQiLCJzb3J0IiwiY3JlYXRlZEF0Iiwic3RhdHVzIiwianNvbiIsImVyciIsImNyZWF0ZVBvc3QiLCJmaWxlIiwiY29uc29sZSIsImxvZyIsIm1pbWV0eXBlIiwiRXJyb3IiLCJzaXplIiwiZXJyb3JzIiwibmV3UG9zdCIsInBvc3RlcklkIiwiYm9keSIsIm1lc3NhZ2UiLCJwaWN0dXJlIiwiZmlsZW5hbWUiLCJ2aWRlbyIsImxpa2VycyIsImNvbW1lbnRzIiwicG9zdCIsInNhdmUiLCJ1cGRhdGVQb3N0IiwiaXNWYWxpZCIsInBhcmFtcyIsImlkIiwic2VuZCIsInVwZGF0ZWRSZWNvcmQiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIiRzZXQiLCJuZXciLCJkZWxldGVQb3N0IiwicmVtb3ZlIiwiX2lkIiwiZXhlYyIsImxpa2VQb3N0IiwiJGFkZFRvU2V0IiwidXNlciIsImxpa2VzIiwidW5saWtlUG9zdCIsIiRwdWxsIiwiY29tbWVudFBvc3QiLCIkcHVzaCIsImNvbW1lbnRlcklkIiwiY29tbWVudGVyUHNldWRvIiwidGV4dCIsInRpbWVzdGFtcCIsIkRhdGUiLCJnZXRUaW1lIiwidGhlbiIsImRhdGEiLCJjYXRjaCIsImVkaXRDb21tZW50UG9zdCIsImZpbmRCeUlkIiwidGhlQ29tbWVudCIsImNvbW1lbnQiLCJlcXVhbHMiLCJjb21tZW50SWQiLCJkZWxldGVDb21tZW50UG9zdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUdBOztBQUhBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLHNCQUFELENBQXBCOztBQUNBLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLHNCQUFELENBQXBCOztBQUNBLE1BQU1FLFFBQVEsR0FBR0YsT0FB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QUFDSCxLQVprQixFQVloQndDLEtBWmdCLENBWVRqRCxHQUFELElBQVM7QUFDZCxhQUFPUixHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCMEIsSUFBaEIsQ0FBcUJ4QixHQUFyQixDQUFQO0FBQ0gsS0Fka0IsQ0FBbkI7QUFlSCxHQWhCRCxDQWlCQSxPQUFPQSxHQUFQLEVBQVk7QUFDUixXQUFPUixHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCMEIsSUFBaEIsQ0FBcUJ4QixHQUFyQixDQUFQO0FBQ0g7QUFDSixDQXhCTSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc3JjL2NvbnRyb2xsZXJzLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFBvc3QgPSByZXF1aXJlKCcuLi9tb2RlbHMvcG9zdC5tb2RlbCcpXG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuY29uc3QgT2JqZWN0SUQgPSByZXF1aXJlKFwibW9uZ29vc2VcIikuVHlwZXMuT2JqZWN0SWQ7XG5pbXBvcnQgeyB1cGxvYWRFcnJvcnN9IGZyb20gJy4uL3V0aWxzL2Vycm9ycy51dGlscydcblxuXG5leHBvcnQgY29uc3QgcmVhZFBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3N0cyA9IGF3YWl0IFBvc3QuZmluZCgpLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHBvc3RzKVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGVycilcbiAgICB9XG59XG5leHBvcnQgY29uc3QgY3JlYXRlUG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmKHJlcS5maWxlICE9IG51bGwpe1xuICAgICAgICBjb25zb2xlLmxvZyhyZXEuZmlsZSApXG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIGlmKHJlcS5maWxlLm1pbWV0eXBlICE9IFwiaW1hZ2UvanBnXCIgJiYgcmVxLmZpbGUubWltZXR5cGUgIT0gXCJpbWFnZS9wbmdcIiAmJiByZXEuZmlsZS5taW1ldHlwZSAhPSBcImltYWdlL2pwZWdcIil7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGZpbGUnKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYocmVxLmZpbGUuc2l6ZSA+IDUwMDAwMCl7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdtYXggc2l6ZScpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2goZXJyKXtcbiAgICAgICAgICAgIGNvbnN0IGVycm9ycyA9IHVwbG9hZEVycm9ycyhlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtlcnJvcnN9KVxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IG5ld1Bvc3QgPSBuZXcgUG9zdCh7XG4gICAgICAgIHBvc3RlcklkOiByZXEuYm9keS5wb3N0ZXJJZCxcbiAgICAgICAgbWVzc2FnZTogcmVxLmJvZHkubWVzc2FnZSxcbiAgICAgICAgcGljdHVyZTogcmVxLmZpbGUgIT0gbnVsbCA/IGBodHRwOi8vbG9jYWxob3N0OjgwODAvdXBsb2Fkcy9wb3N0cy8ke3JlcS5maWxlLmZpbGVuYW1lfWAgOiBcIlwiLFxuICAgICAgICB2aWRlbzogcmVxLmJvZHkudmlkZW8sXG4gICAgICAgIGxpa2VyczogW10sXG4gICAgICAgIGNvbW1lbnRzOiBbXSxcbiAgICB9KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3N0ID0gYXdhaXQgbmV3UG9zdC5zYXZlKCk7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMSkuanNvbihwb3N0KVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbihlcnIpXG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IHVwZGF0ZVBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcblxuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXBkYXRlZFJlY29yZCA9IHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IHJlcS5ib2R5Lm1lc3NhZ2VcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuZXdQb3N0ID0gYXdhaXQgUG9zdC5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5wYXJhbXMuaWQsXG4gICAgICAgICAgICB7ICRzZXQ6IHVwZGF0ZWRSZWNvcmQgfSxcbiAgICAgICAgICAgIHsgbmV3OiB0cnVlIH1cbiAgICAgICAgKVxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChuZXdQb3N0KVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKGVycilcbiAgICB9XG5cblxuXG59XG5leHBvcnQgY29uc3QgZGVsZXRlUG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgUG9zdC5yZW1vdmUoe1xuICAgICAgICAgICAgX2lkOiByZXEucGFyYW1zLmlkXG4gICAgICAgIH0pLmV4ZWMoKVxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6ICdTdWNjZXNzZnVsbHkgZGVsZXRlZCAhJyB9KVxuXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnIgfSlcbiAgICB9XG59XG5leHBvcnQgY29uc3QgbGlrZVBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEucGFyYW1zLmlkfWApXG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBvc3QgPSBhd2FpdCBQb3N0LmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgICAgICAgcmVxLnBhcmFtcy5pZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkYWRkVG9TZXQ6IHsgbGlrZXJzOiByZXEuYm9keS5pZCB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5ldzogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgICAgICAgcmVxLmJvZHkuaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJGFkZFRvU2V0OiB7IGxpa2VzOiByZXEucGFyYW1zLmlkIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmV3OiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHBvc3QpXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBlcnIgfSlcbiAgICB9XG59XG5leHBvcnQgY29uc3QgdW5saWtlUG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICByZXEucGFyYW1zLmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRwdWxsOiB7IGxpa2VyczogcmVxLmJvZHkuaWQgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuZXc6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5ib2R5LmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRwdWxsOiB7IGxpa2VzOiByZXEucGFyYW1zLmlkIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmV3OiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHVzZXIpXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBlcnIgfSlcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBjb21tZW50UG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICByZXEucGFyYW1zLmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRwdXNoOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50ZXJJZDogcmVxLmJvZHkuY29tbWVudGVySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50ZXJQc2V1ZG86IHJlcS5ib2R5LmNvbW1lbnRlclBzZXVkbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHJlcS5ib2R5LnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyBuZXc6IHRydWUgfVxuICAgICAgICApLnRoZW4oKGRhdGEpID0+IHJlcy5zZW5kKGRhdGEpKVxuICAgICAgICAuY2F0Y2goKGVycikgPT4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBtZXNzYWdlOiBlcnIgfSkpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgZXJyIH0pXG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgZWRpdENvbW1lbnRQb3N0ID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAgIC8vb24gcsOpY3Vww6hyZSBsZSBwb3N0IGNvbmNlcm7DqVxuICAgICAgICBjb25zdCBwb3N0ID0gYXdhaXQgUG9zdC5maW5kQnlJZChyZXEucGFyYW1zLmlkKVxuICAgICBcbiAgICAgICAgLy9vbiByw6ljdXDDqHJlIGxlIGNvbW1lbnRhaXJlIGNvbmNlcm7DqVxuICAgICAgICBjb25zdCB0aGVDb21tZW50ID0gYXdhaXQgcG9zdC5jb21tZW50cy5maW5kKChjb21tZW50KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gY29tbWVudC5faWQuZXF1YWxzKHJlcS5ib2R5LmNvbW1lbnRJZClcbiAgICAgICAgfSlcbiAgICAgICAgY29uc29sZS5sb2codGhlQ29tbWVudClcbiAgICAgICAgLy9vbiBjaGFuZ2UgbGUgdGV4dFxuICAgICAgICB0aGVDb21tZW50LnRleHQgPSByZXEuYm9keS50ZXh0XG4gICAgICAgIC8vIG9uIHNhdmUgbGVzIGNoYW5nZW1lbnRzXG4gICAgICAgIGF3YWl0IHBvc3Quc2F2ZSgpO1xuICAgICAgICAvL29uIHNlbmQgbGUgcG9zdCBjb25jZXJuw6lcbiAgICAgICAgcmV0dXJuIHJlcy5zZW5kKHBvc3QpXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGVycilcbiAgICB9XG59XG5cblxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNvbW1lbnRQb3N0ID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3N0ID0gYXdhaXQgUG9zdC5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5wYXJhbXMuaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJHB1bGw6IHtcbiAgICAgICAgICAgICAgICAgICAgY29tbWVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogcmVxLmJvZHkuY29tbWVudElkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyBuZXc6IHRydWUgfVxuICAgICAgICApLnRoZW4oKG5ld1Bvc3QpID0+IHtcbiAgICAgICAgICAgIHJlcy5zZW5kKG5ld1Bvc3QpXG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnIpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnIpXG4gICAgfVxufSJdfQ==","map":{"version":3,"sources":["post.controller.js"],"names":["Post","require","User","ObjectID","Types","ObjectId","readPost","req","res","next","posts","find","sort","createdAt","status","json","err","createPost","file","console","log","mimetype","Error","size","errors","newPost","posterId","body","message","picture","filename","video","likers","comments","post","save","updatePost","isValid","params","id","send","updatedRecord","findByIdAndUpdate","$set","new","deletePost","remove","_id","exec","likePost","$addToSet","user","likes","unlikePost","$pull","commentPost","$push","commenterId","commenterPseudo","text","timestamp","Date","getTime","then","data","catch","editCommentPost","findById","theComment","comment","equals","commentId","deleteCommentPost"],"mappings":"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","sourceRoot":"/Applications/dossier/mern_project_app2/src/controllers/","sourcesContent":["const Post = require('../models/post.model')\nconst User = require('../models/user.model')\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\nimport { uploadErrors} from '../utils/errors.utils'\n\n\nexport const readPost = async (req, res, next) => {\n    try {\n        const posts = await Post.find().sort({ createdAt: -1 })\n        res.status(200).json(posts)\n    }\n    catch (err) {\n        res.status(200).json(err)\n    }\n}\nexport const createPost = async (req, res, next) => {\n    if(req.file != null){\n        console.log(req.file )\n        try{\n            if(req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\"){\n                throw new Error('invalid file')\n            }\n            if(req.file.size > 500000){\n                throw new Error('max size')\n            }\n        }\n        catch(err){\n            const errors = uploadErrors(err);\n            return res.status(201).json({errors})\n        }\n    }\n    const newPost = new Post({\n        posterId: req.body.posterId,\n        message: req.body.message,\n        picture: req.file != null ? `http://localhost:8080/uploads/posts/${req.file.filename}` : \"\",\n        video: req.body.video,\n        likers: [],\n        comments: [],\n    });\n    try {\n        const post = await newPost.save();\n        return res.status(201).json(post)\n    }\n    catch (err) {\n        return res.status(400).json(err)\n    }\n}\nexport const updatePost = async (req, res, next) => {\n\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    \n    try {\n        const updatedRecord = {\n            message: req.body.message\n        }\n        const newPost = await Post.findByIdAndUpdate(\n            req.params.id,\n            { $set: updatedRecord },\n            { new: true }\n        )\n        res.status(200).send(newPost)\n    }\n    catch (err) {\n        res.status(400).json(err)\n    }\n\n\n\n}\nexport const deletePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        await Post.remove({\n            _id: req.params.id\n        }).exec()\n        res.status(200).json({ message: 'Successfully deleted !' })\n\n    }\n    catch (err) {\n        res.status(500).json({ message: err })\n    }\n}\nexport const likePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $addToSet: { likers: req.body.id }\n            },\n            {\n                new: true\n            }\n        )\n        const user = await User.findByIdAndUpdate(\n            req.body.id,\n            {\n                $addToSet: { likes: req.params.id }\n            },\n            {\n                new: true\n            }\n        );\n        res.status(200).send(post)\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\nexport const unlikePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $pull: { likers: req.body.id }\n            },\n            {\n                new: true\n            }\n        )\n        const user = await User.findByIdAndUpdate(\n            req.body.id,\n            {\n                $pull: { likes: req.params.id }\n            },\n            {\n                new: true\n            }\n        );\n        res.status(200).send(user)\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\n\nexport const commentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $push: {\n                    comments: {\n                        commenterId: req.body.commenterId,\n                        commenterPseudo: req.body.commenterPseudo,\n                        text: req.body.text,\n                        timestamp: new Date().getTime()\n                    }\n                }\n            },\n            { new: true }\n        ).then((data) => res.send(data))\n        .catch((err) => res.status(500).send({ message: err }));\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\n\nexport const editCommentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n\n    try {\n        //on récupère le post concerné\n        const post = await Post.findById(req.params.id)\n     \n        //on récupère le commentaire concerné\n        const theComment = await post.comments.find((comment) => {\n            return comment._id.equals(req.body.commentId)\n        })\n        console.log(theComment)\n        //on change le text\n        theComment.text = req.body.text\n        // on save les changements\n        await post.save();\n        //on send le post concerné\n        return res.send(post)\n    }\n    catch (err) {\n        return res.status(400).send(err)\n    }\n}\n\n\nexport const deleteCommentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $pull: {\n                    comments: {\n                        _id: req.body.commentId\n                    }\n                }\n            },\n            { new: true }\n        ).then((newPost) => {\n            res.send(newPost)\n        }).catch((err) => {\n            return res.status(400).send(err)\n        });\n    }\n    catch (err) {\n        return res.status(400).send(err)\n    }\n}"]}},"mtime":1653047124737},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/models/post.model.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nconst PostSchema = new mongoose.Schema({\n  posterId: {\n    type: String,\n    required: true\n  },\n  message: {\n    type: String,\n    trim: true,\n    maxlength: 500\n  },\n  picture: {\n    type: String\n  },\n  video: {\n    type: String\n  },\n  likers: {\n    type: [String],\n    required: true\n  },\n  //la partie commentaire est une sous base de données\n  comments: {\n    type: [{\n      commenterId: String,\n      commenterPseudo: String,\n      text: String,\n      timestamp: Number\n    }],\n    required: true\n  }\n}, {\n  timestamps: true\n});\nlet Post = mongoose.model('post', PostSchema);\nmodule.exports = Post;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QubW9kZWwuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiUG9zdFNjaGVtYSIsIlNjaGVtYSIsInBvc3RlcklkIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwibWVzc2FnZSIsInRyaW0iLCJtYXhsZW5ndGgiLCJwaWN0dXJlIiwidmlkZW8iLCJsaWtlcnMiLCJjb21tZW50cyIsImNvbW1lbnRlcklkIiwiY29tbWVudGVyUHNldWRvIiwidGV4dCIsInRpbWVzdGFtcCIsIk51bWJlciIsInRpbWVzdGFtcHMiLCJQb3N0IiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBRUEsTUFBTUMsVUFBVSxHQUFHLElBQUlGLFFBQVEsQ0FBQ0csTUFBYixDQUNmO0FBQ0lDLEVBQUFBLFFBQVEsRUFBRTtBQUNOQyxJQUFBQSxJQUFJLEVBQUVDLE1BREE7QUFFTkMsSUFBQUEsUUFBUSxFQUFFO0FBRkosR0FEZDtBQUtJQyxFQUFBQSxPQUFPLEVBQUU7QUFDTEgsSUFBQUEsSUFBSSxFQUFFQyxNQUREO0FBRUxHLElBQUFBLElBQUksRUFBRSxJQUZEO0FBR0xDLElBQUFBLFNBQVMsRUFBRTtBQUhOLEdBTGI7QUFVSUMsRUFBQUEsT0FBTyxFQUFFO0FBQ0xOLElBQUFBLElBQUksRUFBRUM7QUFERCxHQVZiO0FBYUlNLEVBQUFBLEtBQUssRUFBRTtBQUNIUCxJQUFBQSxJQUFJLEVBQUVDO0FBREgsR0FiWDtBQWdCSU8sRUFBQUEsTUFBTSxFQUFFO0FBQ0pSLElBQUFBLElBQUksRUFBRSxDQUFDQyxNQUFELENBREY7QUFFSkMsSUFBQUEsUUFBUSxFQUFFO0FBRk4sR0FoQlo7QUFvQkk7QUFDQU8sRUFBQUEsUUFBUSxFQUFFO0FBQ05ULElBQUFBLElBQUksRUFBRSxDQUNGO0FBQ0lVLE1BQUFBLFdBQVcsRUFBRVQsTUFEakI7QUFFSVUsTUFBQUEsZUFBZSxFQUFFVixNQUZyQjtBQUdJVyxNQUFBQSxJQUFJLEVBQUVYLE1BSFY7QUFJSVksTUFBQUEsU0FBUyxFQUFFQztBQUpmLEtBREUsQ0FEQTtBQVNOWixJQUFBQSxRQUFRLEVBQUU7QUFUSjtBQXJCZCxDQURlLEVBa0NmO0FBQ0lhLEVBQUFBLFVBQVUsRUFBRTtBQURoQixDQWxDZSxDQUFuQjtBQXVDQSxJQUFJQyxJQUFJLEdBQUdyQixRQUFRLENBQUNzQixLQUFULENBQWUsTUFBZixFQUF1QnBCLFVBQXZCLENBQVg7QUFDQXFCLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsSUFBakIiLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9tb2RlbHMvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuXG5jb25zdCBQb3N0U2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYShcbiAgICB7XG4gICAgICAgIHBvc3RlcklkOiB7XG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgICAgICAgdHJpbTogdHJ1ZSxcbiAgICAgICAgICAgIG1heGxlbmd0aDogNTAwXG4gICAgICAgIH0sXG4gICAgICAgIHBpY3R1cmU6IHtcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZ1xuICAgICAgICB9LFxuICAgICAgICB2aWRlbzoge1xuICAgICAgICAgICAgdHlwZTogU3RyaW5nXG4gICAgICAgIH0sXG4gICAgICAgIGxpa2Vyczoge1xuICAgICAgICAgICAgdHlwZTogW1N0cmluZ10sXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgLy9sYSBwYXJ0aWUgY29tbWVudGFpcmUgZXN0IHVuZSBzb3VzIGJhc2UgZGUgZG9ubsOpZXNcbiAgICAgICAgY29tbWVudHM6IHtcbiAgICAgICAgICAgIHR5cGU6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRlcklkOiBTdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRlclBzZXVkbzogU3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBTdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogTnVtYmVyXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIHRpbWVzdGFtcHM6IHRydWVcbiAgICB9XG4pO1xuXG5sZXQgUG9zdCA9IG1vbmdvb3NlLm1vZGVsKCdwb3N0JywgUG9zdFNjaGVtYSlcbm1vZHVsZS5leHBvcnRzID0gUG9zdDsiXX0=","map":{"version":3,"sources":["post.model.js"],"names":["mongoose","require","PostSchema","Schema","posterId","type","String","required","message","trim","maxlength","picture","video","likers","comments","commenterId","commenterPseudo","text","timestamp","Number","timestamps","Post","model","module","exports"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,MAAMC,UAAU,GAAG,IAAIF,QAAQ,CAACG,MAAb,CACf;AACIC,EAAAA,QAAQ,EAAE;AACNC,IAAAA,IAAI,EAAEC,MADA;AAENC,IAAAA,QAAQ,EAAE;AAFJ,GADd;AAKIC,EAAAA,OAAO,EAAE;AACLH,IAAAA,IAAI,EAAEC,MADD;AAELG,IAAAA,IAAI,EAAE,IAFD;AAGLC,IAAAA,SAAS,EAAE;AAHN,GALb;AAUIC,EAAAA,OAAO,EAAE;AACLN,IAAAA,IAAI,EAAEC;AADD,GAVb;AAaIM,EAAAA,KAAK,EAAE;AACHP,IAAAA,IAAI,EAAEC;AADH,GAbX;AAgBIO,EAAAA,MAAM,EAAE;AACJR,IAAAA,IAAI,EAAE,CAACC,MAAD,CADF;AAEJC,IAAAA,QAAQ,EAAE;AAFN,GAhBZ;AAoBI;AACAO,EAAAA,QAAQ,EAAE;AACNT,IAAAA,IAAI,EAAE,CACF;AACIU,MAAAA,WAAW,EAAET,MADjB;AAEIU,MAAAA,eAAe,EAAEV,MAFrB;AAGIW,MAAAA,IAAI,EAAEX,MAHV;AAIIY,MAAAA,SAAS,EAAEC;AAJf,KADE,CADA;AASNZ,IAAAA,QAAQ,EAAE;AATJ;AArBd,CADe,EAkCf;AACIa,EAAAA,UAAU,EAAE;AADhB,CAlCe,CAAnB;AAuCA,IAAIC,IAAI,GAAGrB,QAAQ,CAACsB,KAAT,CAAe,MAAf,EAAuBpB,UAAvB,CAAX;AACAqB,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/src/models/","sourcesContent":["const mongoose = require('mongoose');\n\nconst PostSchema = new mongoose.Schema(\n    {\n        posterId: {\n            type: String,\n            required: true,\n        },\n        message: {\n            type: String,\n            trim: true,\n            maxlength: 500\n        },\n        picture: {\n            type: String\n        },\n        video: {\n            type: String\n        },\n        likers: {\n            type: [String],\n            required: true,\n        },\n        //la partie commentaire est une sous base de données\n        comments: {\n            type: [\n                {\n                    commenterId: String,\n                    commenterPseudo: String,\n                    text: String,\n                    timestamp: Number\n                }\n            ],\n            required: true,\n        }\n    },\n    {\n        timestamps: true\n    }\n);\n\nlet Post = mongoose.model('post', PostSchema)\nmodule.exports = Post;"]}},"mtime":1651276586978},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/controllers/upload.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.uploadProfil = void 0;\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst User = require('../models/user.model');\n\nconst uploadProfil = async (req, res) => {\n  try {\n    if (req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\") {\n      throw new Error('invalid file');\n    }\n\n    if (req.file.size > 5000000) {\n      throw new Error('max size');\n    }\n  } catch (err) {\n    const errors = (0, _errors.uploadErrors)(err);\n    return res.status(201).json({\n      errors\n    });\n  }\n\n  try {\n    await User.findByIdAndUpdate(req.body.userId, {\n      $set: {\n        picture: `./uploads/profil/${req.file.filename}`\n      }\n    }, {\n      new: true,\n      upsert: true,\n      setDefaultsOnInsert: true\n    }).then(user => {\n      return res.send(user);\n    }).catch(err => {\n      return res.status(500).send(err);\n    });\n  } catch (err) {\n    return res.status(500).send(err);\n  }\n};\n\nexports.uploadProfil = uploadProfil;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwbG9hZC5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlVzZXIiLCJyZXF1aXJlIiwidXBsb2FkUHJvZmlsIiwicmVxIiwicmVzIiwiZmlsZSIsIm1pbWV0eXBlIiwiRXJyb3IiLCJzaXplIiwiZXJyIiwiZXJyb3JzIiwic3RhdHVzIiwianNvbiIsImZpbmRCeUlkQW5kVXBkYXRlIiwiYm9keSIsInVzZXJJZCIsIiRzZXQiLCJwaWN0dXJlIiwiZmlsZW5hbWUiLCJuZXciLCJ1cHNlcnQiLCJzZXREZWZhdWx0c09uSW5zZXJ0IiwidGhlbiIsInVzZXIiLCJzZW5kIiwiY2F0Y2giXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7QUFEQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFHTyxNQUFNQyxZQUFZLEdBQUcsT0FBTUMsR0FBTixFQUFXQyxHQUFYLEtBQW1CO0FBQzNDLE1BQUc7QUFDQyxRQUFHRCxHQUFHLENBQUNFLElBQUosQ0FBU0MsUUFBVCxJQUFxQixXQUFyQixJQUFvQ0gsR0FBRyxDQUFDRSxJQUFKLENBQVNDLFFBQVQsSUFBcUIsV0FBekQsSUFBd0VILEdBQUcsQ0FBQ0UsSUFBSixDQUFTQyxRQUFULElBQXFCLFlBQWhHLEVBQTZHO0FBQ3pHLFlBQU0sSUFBSUMsS0FBSixDQUFVLGNBQVYsQ0FBTjtBQUNIOztBQUNELFFBQUdKLEdBQUcsQ0FBQ0UsSUFBSixDQUFTRyxJQUFULEdBQWdCLE9BQW5CLEVBQTJCO0FBQ3ZCLFlBQU0sSUFBSUQsS0FBSixDQUFVLFVBQVYsQ0FBTjtBQUNIO0FBQ0osR0FQRCxDQVFBLE9BQU1FLEdBQU4sRUFBVTtBQUNOLFVBQU1DLE1BQU0sR0FBRywwQkFBYUQsR0FBYixDQUFmO0FBQ0EsV0FBT0wsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBQ0YsTUFBQUE7QUFBRCxLQUFyQixDQUFQO0FBQ0g7O0FBQ0QsTUFBRztBQUNNLFVBQU1WLElBQUksQ0FBQ2EsaUJBQUwsQ0FDUFYsR0FBRyxDQUFDVyxJQUFKLENBQVNDLE1BREYsRUFFUDtBQUNJQyxNQUFBQSxJQUFJLEVBQUc7QUFBRUMsUUFBQUEsT0FBTyxFQUFHLG9CQUFtQmQsR0FBRyxDQUFDRSxJQUFKLENBQVNhLFFBQVM7QUFBakQ7QUFEWCxLQUZPLEVBS1A7QUFBQ0MsTUFBQUEsR0FBRyxFQUFDLElBQUw7QUFBV0MsTUFBQUEsTUFBTSxFQUFDLElBQWxCO0FBQXdCQyxNQUFBQSxtQkFBbUIsRUFBQztBQUE1QyxLQUxPLEVBTUxDLElBTkssQ0FNQ0MsSUFBRCxJQUFVO0FBQ2IsYUFBT25CLEdBQUcsQ0FBQ29CLElBQUosQ0FBU0QsSUFBVCxDQUFQO0FBQ0gsS0FSTSxFQVFKRSxLQVJJLENBUUdoQixHQUFELElBQVM7QUFDZCxhQUFPTCxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCYSxJQUFoQixDQUFxQmYsR0FBckIsQ0FBUDtBQUNILEtBVk0sQ0FBTjtBQVdSLEdBWkQsQ0FhQSxPQUFNQSxHQUFOLEVBQVU7QUFDTixXQUFPTCxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCYSxJQUFoQixDQUFxQmYsR0FBckIsQ0FBUDtBQUNIO0FBRUosQ0E5Qk0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9jb250cm9sbGVycy8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuaW1wb3J0IHsgdXBsb2FkRXJyb3JzfSBmcm9tICcuLi91dGlscy9lcnJvcnMudXRpbHMnXG5cbmV4cG9ydCBjb25zdCB1cGxvYWRQcm9maWwgPSBhc3luYyhyZXEsIHJlcykgPT4ge1xuICAgIHRyeXtcbiAgICAgICAgaWYocmVxLmZpbGUubWltZXR5cGUgIT0gXCJpbWFnZS9qcGdcIiAmJiByZXEuZmlsZS5taW1ldHlwZSAhPSBcImltYWdlL3BuZ1wiICYmIHJlcS5maWxlLm1pbWV0eXBlICE9IFwiaW1hZ2UvanBlZ1wiKXtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBmaWxlJylcbiAgICAgICAgfVxuICAgICAgICBpZihyZXEuZmlsZS5zaXplID4gNTAwMDAwMCl7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ21heCBzaXplJylcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaChlcnIpe1xuICAgICAgICBjb25zdCBlcnJvcnMgPSB1cGxvYWRFcnJvcnMoZXJyKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtlcnJvcnN9KVxuICAgIH1cbiAgICB0cnl7XG4gICAgICAgICAgICAgYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5ib2R5LnVzZXJJZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkc2V0IDogeyBwaWN0dXJlOiBgLi91cGxvYWRzL3Byb2ZpbC8ke3JlcS5maWxlLmZpbGVuYW1lfWAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtuZXc6dHJ1ZSwgdXBzZXJ0OnRydWUsIHNldERlZmF1bHRzT25JbnNlcnQ6dHJ1ZX1cbiAgICAgICAgICAgICkudGhlbigodXNlcikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZCh1c2VyKVxuICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZChlcnIpXG4gICAgICAgICAgICB9KVxuICAgIH1cbiAgICBjYXRjaChlcnIpe1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoZXJyKVxuICAgIH1cbiAgICBcbn1cblxuIl19","map":{"version":3,"sources":["upload.controller.js"],"names":["User","require","uploadProfil","req","res","file","mimetype","Error","size","err","errors","status","json","findByIdAndUpdate","body","userId","$set","picture","filename","new","upsert","setDefaultsOnInsert","then","user","send","catch"],"mappings":";;;;;;;AACA;;AADA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AAGO,MAAMC,YAAY,GAAG,OAAMC,GAAN,EAAWC,GAAX,KAAmB;AAC3C,MAAG;AACC,QAAGD,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,WAArB,IAAoCH,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,WAAzD,IAAwEH,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,YAAhG,EAA6G;AACzG,YAAM,IAAIC,KAAJ,CAAU,cAAV,CAAN;AACH;;AACD,QAAGJ,GAAG,CAACE,IAAJ,CAASG,IAAT,GAAgB,OAAnB,EAA2B;AACvB,YAAM,IAAID,KAAJ,CAAU,UAAV,CAAN;AACH;AACJ,GAPD,CAQA,OAAME,GAAN,EAAU;AACN,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACF,MAAAA;AAAD,KAArB,CAAP;AACH;;AACD,MAAG;AACM,UAAMV,IAAI,CAACa,iBAAL,CACPV,GAAG,CAACW,IAAJ,CAASC,MADF,EAEP;AACIC,MAAAA,IAAI,EAAG;AAAEC,QAAAA,OAAO,EAAG,oBAAmBd,GAAG,CAACE,IAAJ,CAASa,QAAS;AAAjD;AADX,KAFO,EAKP;AAACC,MAAAA,GAAG,EAAC,IAAL;AAAWC,MAAAA,MAAM,EAAC,IAAlB;AAAwBC,MAAAA,mBAAmB,EAAC;AAA5C,KALO,EAMLC,IANK,CAMCC,IAAD,IAAU;AACb,aAAOnB,GAAG,CAACoB,IAAJ,CAASD,IAAT,CAAP;AACH,KARM,EAQJE,KARI,CAQGhB,GAAD,IAAS;AACd,aAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBa,IAAhB,CAAqBf,GAArB,CAAP;AACH,KAVM,CAAN;AAWR,GAZD,CAaA,OAAMA,GAAN,EAAU;AACN,WAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBa,IAAhB,CAAqBf,GAArB,CAAP;AACH;AAEJ,CA9BM","sourceRoot":"/Applications/dossier/mern_project_app2/src/controllers/","sourcesContent":["const User = require('../models/user.model')\nimport { uploadErrors} from '../utils/errors.utils'\n\nexport const uploadProfil = async(req, res) => {\n    try{\n        if(req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\"){\n            throw new Error('invalid file')\n        }\n        if(req.file.size > 5000000){\n            throw new Error('max size')\n        }\n    }\n    catch(err){\n        const errors = uploadErrors(err);\n        return res.status(201).json({errors})\n    }\n    try{\n             await User.findByIdAndUpdate(\n            req.body.userId,\n            {\n                $set : { picture: `./uploads/profil/${req.file.filename}` }\n            },\n            {new:true, upsert:true, setDefaultsOnInsert:true}\n            ).then((user) => {\n                return res.send(user)\n            }).catch((err) => {\n                return res.status(500).send(err)\n            })\n    }\n    catch(err){\n        return res.status(500).send(err)\n    }\n    \n}\n\n"]}},"mtime":1651708724018},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2\",\"filename\":\"/Applications/dossier/mern_project_app2/src/controllers/upload.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.uploadProfil = void 0;\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst User = require('../models/user.model');\n\nconst uploadProfil = async (req, res) => {\n  try {\n    if (req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\") {\n      throw new Error('invalid file');\n    }\n\n    if (req.file.size > 5000000) {\n      throw new Error('max size');\n    }\n  } catch (err) {\n    const errors = (0, _errors.uploadErrors)(err);\n    return res.status(201).json({\n      errors\n    });\n  }\n\n  try {\n    await User.findByIdAndUpdate(req.body.userId, {\n      $set: {\n        picture: `http://localhost:8080/uploads/profils/${req.file.filename}`\n      }\n    }, {\n      new: true,\n      upsert: true,\n      setDefaultsOnInsert: true\n    }).then(user => {\n      return res.send(user);\n    }).catch(err => {\n      return res.status(500).send(err);\n    });\n  } catch (err) {\n    return res.status(500).send(err);\n  }\n};\n\nexports.uploadProfil = uploadProfil;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwbG9hZC5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlVzZXIiLCJyZXF1aXJlIiwidXBsb2FkUHJvZmlsIiwicmVxIiwicmVzIiwiZmlsZSIsIm1pbWV0eXBlIiwiRXJyb3IiLCJzaXplIiwiZXJyIiwiZXJyb3JzIiwic3RhdHVzIiwianNvbiIsImZpbmRCeUlkQW5kVXBkYXRlIiwiYm9keSIsInVzZXJJZCIsIiRzZXQiLCJwaWN0dXJlIiwiZmlsZW5hbWUiLCJuZXciLCJ1cHNlcnQiLCJzZXREZWZhdWx0c09uSW5zZXJ0IiwidGhlbiIsInVzZXIiLCJzZW5kIiwiY2F0Y2giXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7QUFEQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFHTyxNQUFNQyxZQUFZLEdBQUcsT0FBTUMsR0FBTixFQUFXQyxHQUFYLEtBQW1CO0FBQzNDLE1BQUc7QUFDQyxRQUFHRCxHQUFHLENBQUNFLElBQUosQ0FBU0MsUUFBVCxJQUFxQixXQUFyQixJQUFvQ0gsR0FBRyxDQUFDRSxJQUFKLENBQVNDLFFBQVQsSUFBcUIsV0FBekQsSUFBd0VILEdBQUcsQ0FBQ0UsSUFBSixDQUFTQyxRQUFULElBQXFCLFlBQWhHLEVBQTZHO0FBQ3pHLFlBQU0sSUFBSUMsS0FBSixDQUFVLGNBQVYsQ0FBTjtBQUNIOztBQUNELFFBQUdKLEdBQUcsQ0FBQ0UsSUFBSixDQUFTRyxJQUFULEdBQWdCLE9BQW5CLEVBQTJCO0FBQ3ZCLFlBQU0sSUFBSUQsS0FBSixDQUFVLFVBQVYsQ0FBTjtBQUNIO0FBQ0osR0FQRCxDQVFBLE9BQU1FLEdBQU4sRUFBVTtBQUNOLFVBQU1DLE1BQU0sR0FBRywwQkFBYUQsR0FBYixDQUFmO0FBQ0EsV0FBT0wsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBQ0YsTUFBQUE7QUFBRCxLQUFyQixDQUFQO0FBQ0g7O0FBQ0QsTUFBRztBQUNNLFVBQU1WLElBQUksQ0FBQ2EsaUJBQUwsQ0FDUFYsR0FBRyxDQUFDVyxJQUFKLENBQVNDLE1BREYsRUFFUDtBQUNJQyxNQUFBQSxJQUFJLEVBQUc7QUFBRUMsUUFBQUEsT0FBTyxFQUFHLHlDQUF3Q2QsR0FBRyxDQUFDRSxJQUFKLENBQVNhLFFBQVM7QUFBdEU7QUFEWCxLQUZPLEVBS1A7QUFBQ0MsTUFBQUEsR0FBRyxFQUFDLElBQUw7QUFBV0MsTUFBQUEsTUFBTSxFQUFDLElBQWxCO0FBQXdCQyxNQUFBQSxtQkFBbUIsRUFBQztBQUE1QyxLQUxPLEVBTUxDLElBTkssQ0FNQ0MsSUFBRCxJQUFVO0FBQ2IsYUFBT25CLEdBQUcsQ0FBQ29CLElBQUosQ0FBU0QsSUFBVCxDQUFQO0FBQ0gsS0FSTSxFQVFKRSxLQVJJLENBUUdoQixHQUFELElBQVM7QUFDZCxhQUFPTCxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCYSxJQUFoQixDQUFxQmYsR0FBckIsQ0FBUDtBQUNILEtBVk0sQ0FBTjtBQVdSLEdBWkQsQ0FhQSxPQUFNQSxHQUFOLEVBQVU7QUFDTixXQUFPTCxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCYSxJQUFoQixDQUFxQmYsR0FBckIsQ0FBUDtBQUNIO0FBRUosQ0E5Qk0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NyYy9jb250cm9sbGVycy8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuaW1wb3J0IHsgdXBsb2FkRXJyb3JzfSBmcm9tICcuLi91dGlscy9lcnJvcnMudXRpbHMnXG5cbmV4cG9ydCBjb25zdCB1cGxvYWRQcm9maWwgPSBhc3luYyhyZXEsIHJlcykgPT4ge1xuICAgIHRyeXtcbiAgICAgICAgaWYocmVxLmZpbGUubWltZXR5cGUgIT0gXCJpbWFnZS9qcGdcIiAmJiByZXEuZmlsZS5taW1ldHlwZSAhPSBcImltYWdlL3BuZ1wiICYmIHJlcS5maWxlLm1pbWV0eXBlICE9IFwiaW1hZ2UvanBlZ1wiKXtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBmaWxlJylcbiAgICAgICAgfVxuICAgICAgICBpZihyZXEuZmlsZS5zaXplID4gNTAwMDAwMCl7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ21heCBzaXplJylcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaChlcnIpe1xuICAgICAgICBjb25zdCBlcnJvcnMgPSB1cGxvYWRFcnJvcnMoZXJyKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtlcnJvcnN9KVxuICAgIH1cbiAgICB0cnl7XG4gICAgICAgICAgICAgYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5ib2R5LnVzZXJJZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkc2V0IDogeyBwaWN0dXJlOiBgaHR0cDovL2xvY2FsaG9zdDo4MDgwL3VwbG9hZHMvcHJvZmlscy8ke3JlcS5maWxlLmZpbGVuYW1lfWAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtuZXc6dHJ1ZSwgdXBzZXJ0OnRydWUsIHNldERlZmF1bHRzT25JbnNlcnQ6dHJ1ZX1cbiAgICAgICAgICAgICkudGhlbigodXNlcikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZCh1c2VyKVxuICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZChlcnIpXG4gICAgICAgICAgICB9KVxuICAgIH1cbiAgICBjYXRjaChlcnIpe1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoZXJyKVxuICAgIH1cbiAgICBcbn1cblxuIl19","map":{"version":3,"sources":["upload.controller.js"],"names":["User","require","uploadProfil","req","res","file","mimetype","Error","size","err","errors","status","json","findByIdAndUpdate","body","userId","$set","picture","filename","new","upsert","setDefaultsOnInsert","then","user","send","catch"],"mappings":";;;;;;;AACA;;AADA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AAGO,MAAMC,YAAY,GAAG,OAAMC,GAAN,EAAWC,GAAX,KAAmB;AAC3C,MAAG;AACC,QAAGD,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,WAArB,IAAoCH,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,WAAzD,IAAwEH,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,YAAhG,EAA6G;AACzG,YAAM,IAAIC,KAAJ,CAAU,cAAV,CAAN;AACH;;AACD,QAAGJ,GAAG,CAACE,IAAJ,CAASG,IAAT,GAAgB,OAAnB,EAA2B;AACvB,YAAM,IAAID,KAAJ,CAAU,UAAV,CAAN;AACH;AACJ,GAPD,CAQA,OAAME,GAAN,EAAU;AACN,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACF,MAAAA;AAAD,KAArB,CAAP;AACH;;AACD,MAAG;AACM,UAAMV,IAAI,CAACa,iBAAL,CACPV,GAAG,CAACW,IAAJ,CAASC,MADF,EAEP;AACIC,MAAAA,IAAI,EAAG;AAAEC,QAAAA,OAAO,EAAG,yCAAwCd,GAAG,CAACE,IAAJ,CAASa,QAAS;AAAtE;AADX,KAFO,EAKP;AAACC,MAAAA,GAAG,EAAC,IAAL;AAAWC,MAAAA,MAAM,EAAC,IAAlB;AAAwBC,MAAAA,mBAAmB,EAAC;AAA5C,KALO,EAMLC,IANK,CAMCC,IAAD,IAAU;AACb,aAAOnB,GAAG,CAACoB,IAAJ,CAASD,IAAT,CAAP;AACH,KARM,EAQJE,KARI,CAQGhB,GAAD,IAAS;AACd,aAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBa,IAAhB,CAAqBf,GAArB,CAAP;AACH,KAVM,CAAN;AAWR,GAZD,CAaA,OAAMA,GAAN,EAAU;AACN,WAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBa,IAAhB,CAAqBf,GAArB,CAAP;AACH;AAEJ,CA9BM","sourceRoot":"/Applications/dossier/mern_project_app2/src/controllers/","sourcesContent":["const User = require('../models/user.model')\nimport { uploadErrors} from '../utils/errors.utils'\n\nexport const uploadProfil = async(req, res) => {\n    try{\n        if(req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\"){\n            throw new Error('invalid file')\n        }\n        if(req.file.size > 5000000){\n            throw new Error('max size')\n        }\n    }\n    catch(err){\n        const errors = uploadErrors(err);\n        return res.status(201).json({errors})\n    }\n    try{\n             await User.findByIdAndUpdate(\n            req.body.userId,\n            {\n                $set : { picture: `http://localhost:8080/uploads/profils/${req.file.filename}` }\n            },\n            {new:true, upsert:true, setDefaultsOnInsert:true}\n            ).then((user) => {\n                return res.send(user)\n            }).catch((err) => {\n                return res.status(500).send(err)\n            })\n    }\n    catch(err){\n        return res.status(500).send(err)\n    }\n    \n}\n\n"]}},"mtime":1653058542236},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/main.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nvar _server = require(\"./server\");\n\n(0, _server.launch)({\n  host: 'localhost',\n  protocol: 'http',\n  port: 8080\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiaG9zdCIsInByb3RvY29sIiwicG9ydCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFFQSxvQkFBTztBQUNMQSxFQUFBQSxJQUFJLEVBQUUsV0FERDtBQUVMQyxFQUFBQSxRQUFRLEVBQUUsTUFGTDtBQUdMQyxFQUFBQSxJQUFJLEVBQUU7QUFIRCxDQUFQIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zZXJ2ZXIvc3JjLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxhdW5jaCB9IGZyb20gJy4vc2VydmVyJztcblxubGF1bmNoKHtcbiAgaG9zdDogJ2xvY2FsaG9zdCcsXG4gIHByb3RvY29sOiAnaHR0cCcsXG4gIHBvcnQ6IDgwODAsXG59KTtcbiJdfQ==","map":{"version":3,"sources":["main.js"],"names":["host","protocol","port"],"mappings":";;AAAA;;AAEA,oBAAO;AACLA,EAAAA,IAAI,EAAE,WADD;AAELC,EAAAA,QAAQ,EAAE,MAFL;AAGLC,EAAAA,IAAI,EAAE;AAHD,CAAP","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/","sourcesContent":["import { launch } from './server';\n\nlaunch({\n  host: 'localhost',\n  protocol: 'http',\n  port: 8080,\n});\n"]}},"mtime":1651230875437},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.launch = launch;\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _response = _interopRequireDefault(require(\"express/lib/response\"));\n\nvar _routes = _interopRequireDefault(require(\"./routes\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst bodyParser = require('body-parser');\n\nconst cookieParser = require(\"cookie-parser\");\n\nconst {\n  checkUser,\n  requireAuth\n} = require('./middlewares/auth.middleware');\n\nconst cors = require(\"cors\");\n\nfunction launch({\n  host,\n  protocol,\n  port\n}) {\n  const application = (0, _express.default)();\n\n  require('dotenv').config({\n    path: './.env'\n  });\n\n  require('../database.js');\n\n  application.use(cors({\n    origin: process.env.CLIENT_URL,\n    methods: [\"GET\", \"POST\", \"HEAD\", \"PUT\", \"PATCH\", \"DELETE\"],\n    credentials: true\n  }));\n  application.use(cookieParser());\n  application.use(_express.default.json()); // notre middleware de sécurité\n\n  application.get('*', checkUser); //cest ce qui permet de loger un user lorsqu'il arrive sur le site\n\n  application.get('/jwtid', requireAuth, (req, res) => {\n    res.status(200).send(res.locals.user._id);\n  });\n  application.use(_routes.default);\n  application.use(_express.default.static('assets'));\n  application.listen(port, () => console.log(`Server started at ${protocol}://${host}:${port}`));\n}\n/* require('dotenv').config({path:'./config/.env'})\n */\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJib2R5UGFyc2VyIiwicmVxdWlyZSIsImNvb2tpZVBhcnNlciIsImNoZWNrVXNlciIsInJlcXVpcmVBdXRoIiwiY29ycyIsImxhdW5jaCIsImhvc3QiLCJwcm90b2NvbCIsInBvcnQiLCJhcHBsaWNhdGlvbiIsImNvbmZpZyIsInBhdGgiLCJ1c2UiLCJvcmlnaW4iLCJwcm9jZXNzIiwiZW52IiwiQ0xJRU5UX1VSTCIsIm1ldGhvZHMiLCJjcmVkZW50aWFscyIsImV4cHJlc3MiLCJqc29uIiwiZ2V0IiwicmVxIiwicmVzIiwic3RhdHVzIiwic2VuZCIsImxvY2FscyIsInVzZXIiLCJfaWQiLCJEZWZhdWx0Um91dGVyIiwic3RhdGljIiwibGlzdGVuIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7O0FBQ0EsTUFBTUEsVUFBVSxHQUFHQyxPQUFPLENBQUMsYUFBRCxDQUExQjs7QUFFQSxNQUFNQyxZQUFZLEdBQUdELE9BQU8sQ0FBQyxlQUFELENBQTVCOztBQUNBLE1BQU07QUFBRUUsRUFBQUEsU0FBRjtBQUFhQyxFQUFBQTtBQUFiLElBQTZCSCxPQUFPLENBQUMsK0JBQUQsQ0FBMUM7O0FBQ0EsTUFBTUksSUFBSSxHQUFHSixPQUFPLENBQUMsTUFBRCxDQUFwQjs7QUFHTyxTQUFTSyxNQUFULENBQWdCO0FBQUVDLEVBQUFBLElBQUY7QUFBUUMsRUFBQUEsUUFBUjtBQUFrQkMsRUFBQUE7QUFBbEIsQ0FBaEIsRUFBMEM7QUFDL0MsUUFBTUMsV0FBVyxHQUFHLHVCQUFwQjs7QUFDQVQsRUFBQUEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQlUsTUFBbEIsQ0FBeUI7QUFBRUMsSUFBQUEsSUFBSSxFQUFFO0FBQVIsR0FBekI7O0FBQ0FYLEVBQUFBLE9BQU8sQ0FBQyxnQkFBRCxDQUFQOztBQUVBUyxFQUFBQSxXQUFXLENBQUNHLEdBQVosQ0FDRVIsSUFBSSxDQUFDO0FBQ0hTLElBQUFBLE1BQU0sRUFBRUMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBRGpCO0FBRUhDLElBQUFBLE9BQU8sRUFBRSxDQUFDLEtBQUQsRUFBUSxNQUFSLEVBQWdCLE1BQWhCLEVBQXdCLEtBQXhCLEVBQStCLE9BQS9CLEVBQXdDLFFBQXhDLENBRk47QUFHSEMsSUFBQUEsV0FBVyxFQUFFO0FBSFYsR0FBRCxDQUROO0FBT0FULEVBQUFBLFdBQVcsQ0FBQ0csR0FBWixDQUFnQlgsWUFBWSxFQUE1QjtBQUVBUSxFQUFBQSxXQUFXLENBQUNHLEdBQVosQ0FBZ0JPLGlCQUFRQyxJQUFSLEVBQWhCLEVBZCtDLENBZ0IvQzs7QUFDQVgsRUFBQUEsV0FBVyxDQUFDWSxHQUFaLENBQWdCLEdBQWhCLEVBQXFCbkIsU0FBckIsRUFqQitDLENBa0IvQzs7QUFDQU8sRUFBQUEsV0FBVyxDQUFDWSxHQUFaLENBQWdCLFFBQWhCLEVBQTBCbEIsV0FBMUIsRUFBdUMsQ0FBQ21CLEdBQUQsRUFBTUMsR0FBTixLQUFjO0FBQ25EQSxJQUFBQSxHQUFHLENBQUNDLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQkYsR0FBRyxDQUFDRyxNQUFKLENBQVdDLElBQVgsQ0FBZ0JDLEdBQXJDO0FBQ0QsR0FGRDtBQUlBbkIsRUFBQUEsV0FBVyxDQUFDRyxHQUFaLENBQWdCaUIsZUFBaEI7QUFDQXBCLEVBQUFBLFdBQVcsQ0FBQ0csR0FBWixDQUFnQk8saUJBQVFXLE1BQVIsQ0FBZSxRQUFmLENBQWhCO0FBRUFyQixFQUFBQSxXQUFXLENBQUNzQixNQUFaLENBQ0V2QixJQURGLEVBRUUsTUFBTXdCLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLHFCQUFvQjFCLFFBQVMsTUFBS0QsSUFBSyxJQUFHRSxJQUFLLEVBQTVELENBRlI7QUFJRDtBQUlEO0FBQ0EiLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NlcnZlci9zcmMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgcmVzIGZyb20gJ2V4cHJlc3MvbGliL3Jlc3BvbnNlJztcbmltcG9ydCBEZWZhdWx0Um91dGVyIGZyb20gJy4vcm91dGVzJztcbmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpO1xuXG5jb25zdCBjb29raWVQYXJzZXIgPSByZXF1aXJlKFwiY29va2llLXBhcnNlclwiKVxuY29uc3QgeyBjaGVja1VzZXIsIHJlcXVpcmVBdXRoIH0gPSByZXF1aXJlKCcuL21pZGRsZXdhcmVzL2F1dGgubWlkZGxld2FyZScpXG5jb25zdCBjb3JzID0gcmVxdWlyZShcImNvcnNcIilcblxuXG5leHBvcnQgZnVuY3Rpb24gbGF1bmNoKHsgaG9zdCwgcHJvdG9jb2wsIHBvcnQgfSkge1xuICBjb25zdCBhcHBsaWNhdGlvbiA9IGV4cHJlc3MoKTtcbiAgcmVxdWlyZSgnZG90ZW52JykuY29uZmlnKHsgcGF0aDogJy4vLmVudicgfSlcbiAgcmVxdWlyZSgnLi4vZGF0YWJhc2UuanMnKVxuXG4gIGFwcGxpY2F0aW9uLnVzZShcbiAgICBjb3JzKHtcbiAgICAgIG9yaWdpbjogcHJvY2Vzcy5lbnYuQ0xJRU5UX1VSTCxcbiAgICAgIG1ldGhvZHM6IFtcIkdFVFwiLCBcIlBPU1RcIiwgXCJIRUFEXCIsIFwiUFVUXCIsIFwiUEFUQ0hcIiwgXCJERUxFVEVcIl0sXG4gICAgICBjcmVkZW50aWFsczogdHJ1ZSxcbiAgICB9KVxuICApO1xuICBhcHBsaWNhdGlvbi51c2UoY29va2llUGFyc2VyKCkpO1xuXG4gIGFwcGxpY2F0aW9uLnVzZShleHByZXNzLmpzb24oKSk7XG5cbiAgLy8gbm90cmUgbWlkZGxld2FyZSBkZSBzw6ljdXJpdMOpXG4gIGFwcGxpY2F0aW9uLmdldCgnKicsIGNoZWNrVXNlcilcbiAgLy9jZXN0IGNlIHF1aSBwZXJtZXQgZGUgbG9nZXIgdW4gdXNlciBsb3JzcXUnaWwgYXJyaXZlIHN1ciBsZSBzaXRlXG4gIGFwcGxpY2F0aW9uLmdldCgnL2p3dGlkJywgcmVxdWlyZUF1dGgsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHJlcy5sb2NhbHMudXNlci5faWQpXG4gIH0pXG5cbiAgYXBwbGljYXRpb24udXNlKERlZmF1bHRSb3V0ZXIpO1xuICBhcHBsaWNhdGlvbi51c2UoZXhwcmVzcy5zdGF0aWMoJ2Fzc2V0cycpKTtcblxuICBhcHBsaWNhdGlvbi5saXN0ZW4oXG4gICAgcG9ydCxcbiAgICAoKSA9PiBjb25zb2xlLmxvZyhgU2VydmVyIHN0YXJ0ZWQgYXQgJHtwcm90b2NvbH06Ly8ke2hvc3R9OiR7cG9ydH1gKSxcbiAgKTtcbn1cblxuXG5cbi8qIHJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZyh7cGF0aDonLi9jb25maWcvLmVudid9KVxuICovXG5cblxuXG4iXX0=","map":{"version":3,"sources":["server.js"],"names":["bodyParser","require","cookieParser","checkUser","requireAuth","cors","launch","host","protocol","port","application","config","path","use","origin","process","env","CLIENT_URL","methods","credentials","express","json","get","req","res","status","send","locals","user","_id","DefaultRouter","static","listen","console","log"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,UAAU,GAAGC,OAAO,CAAC,aAAD,CAA1B;;AAEA,MAAMC,YAAY,GAAGD,OAAO,CAAC,eAAD,CAA5B;;AACA,MAAM;AAAEE,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAA6BH,OAAO,CAAC,+BAAD,CAA1C;;AACA,MAAMI,IAAI,GAAGJ,OAAO,CAAC,MAAD,CAApB;;AAGO,SAASK,MAAT,CAAgB;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,QAAR;AAAkBC,EAAAA;AAAlB,CAAhB,EAA0C;AAC/C,QAAMC,WAAW,GAAG,uBAApB;;AACAT,EAAAA,OAAO,CAAC,QAAD,CAAP,CAAkBU,MAAlB,CAAyB;AAAEC,IAAAA,IAAI,EAAE;AAAR,GAAzB;;AACAX,EAAAA,OAAO,CAAC,gBAAD,CAAP;;AAEAS,EAAAA,WAAW,CAACG,GAAZ,CACER,IAAI,CAAC;AACHS,IAAAA,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC,UADjB;AAEHC,IAAAA,OAAO,EAAE,CAAC,KAAD,EAAQ,MAAR,EAAgB,MAAhB,EAAwB,KAAxB,EAA+B,OAA/B,EAAwC,QAAxC,CAFN;AAGHC,IAAAA,WAAW,EAAE;AAHV,GAAD,CADN;AAOAT,EAAAA,WAAW,CAACG,GAAZ,CAAgBX,YAAY,EAA5B;AAEAQ,EAAAA,WAAW,CAACG,GAAZ,CAAgBO,iBAAQC,IAAR,EAAhB,EAd+C,CAgB/C;;AACAX,EAAAA,WAAW,CAACY,GAAZ,CAAgB,GAAhB,EAAqBnB,SAArB,EAjB+C,CAkB/C;;AACAO,EAAAA,WAAW,CAACY,GAAZ,CAAgB,QAAhB,EAA0BlB,WAA1B,EAAuC,CAACmB,GAAD,EAAMC,GAAN,KAAc;AACnDA,IAAAA,GAAG,CAACC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,GAAG,CAACG,MAAJ,CAAWC,IAAX,CAAgBC,GAArC;AACD,GAFD;AAIAnB,EAAAA,WAAW,CAACG,GAAZ,CAAgBiB,eAAhB;AACApB,EAAAA,WAAW,CAACG,GAAZ,CAAgBO,iBAAQW,MAAR,CAAe,QAAf,CAAhB;AAEArB,EAAAA,WAAW,CAACsB,MAAZ,CACEvB,IADF,EAEE,MAAMwB,OAAO,CAACC,GAAR,CAAa,qBAAoB1B,QAAS,MAAKD,IAAK,IAAGE,IAAK,EAA5D,CAFR;AAID;AAID;AACA","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/","sourcesContent":["import express from 'express';\nimport res from 'express/lib/response';\nimport DefaultRouter from './routes';\nconst bodyParser = require('body-parser');\n\nconst cookieParser = require(\"cookie-parser\")\nconst { checkUser, requireAuth } = require('./middlewares/auth.middleware')\nconst cors = require(\"cors\")\n\n\nexport function launch({ host, protocol, port }) {\n  const application = express();\n  require('dotenv').config({ path: './.env' })\n  require('../database.js')\n\n  application.use(\n    cors({\n      origin: process.env.CLIENT_URL,\n      methods: [\"GET\", \"POST\", \"HEAD\", \"PUT\", \"PATCH\", \"DELETE\"],\n      credentials: true,\n    })\n  );\n  application.use(cookieParser());\n\n  application.use(express.json());\n\n  // notre middleware de sécurité\n  application.get('*', checkUser)\n  //cest ce qui permet de loger un user lorsqu'il arrive sur le site\n  application.get('/jwtid', requireAuth, (req, res) => {\n    res.status(200).send(res.locals.user._id)\n  })\n\n  application.use(DefaultRouter);\n  application.use(express.static('assets'));\n\n  application.listen(\n    port,\n    () => console.log(`Server started at ${protocol}://${host}:${port}`),\n  );\n}\n\n\n\n/* require('dotenv').config({path:'./config/.env'})\n */\n\n\n\n"]}},"mtime":1653046631486},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar _user = _interopRequireDefault(require(\"./api/user.route\"));\n\nvar _post = _interopRequireDefault(require(\"./api/post.route\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst router = (0, _express.Router)();\nrouter.use('/api/user', _user.default);\nrouter.use('/api/post', _post.default);\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJvdXRlciIsInVzZSIsIlVzZXJSb3V0ZXIiLCJQb3N0Um91dGVyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7Ozs7QUFDQSxNQUFNQSxNQUFNLEdBQUcsc0JBQWY7QUFFQUEsTUFBTSxDQUFDQyxHQUFQLENBQVcsV0FBWCxFQUF3QkMsYUFBeEI7QUFDQUYsTUFBTSxDQUFDQyxHQUFQLENBQVcsV0FBWCxFQUF5QkUsYUFBekI7ZUFFZUgsTSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc2VydmVyL3NyYy9yb3V0ZXMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgVXNlclJvdXRlciBmcm9tICcuL2FwaS91c2VyLnJvdXRlJztcbmltcG9ydCBQb3N0Um91dGVyIGZyb20gJy4vYXBpL3Bvc3Qucm91dGUnO1xuY29uc3Qgcm91dGVyID0gUm91dGVyKCk7XG5cbnJvdXRlci51c2UoJy9hcGkvdXNlcicsIFVzZXJSb3V0ZXIpO1xucm91dGVyLnVzZSgnL2FwaS9wb3N0JywgIFBvc3RSb3V0ZXIpO1xuXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XG4iXX0=","map":{"version":3,"sources":["index.js"],"names":["router","use","UserRouter","PostRouter"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,MAAM,GAAG,sBAAf;AAEAA,MAAM,CAACC,GAAP,CAAW,WAAX,EAAwBC,aAAxB;AACAF,MAAM,CAACC,GAAP,CAAW,WAAX,EAAyBE,aAAzB;eAEeH,M","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/routes/","sourcesContent":["import { Router } from 'express';\nimport UserRouter from './api/user.route';\nimport PostRouter from './api/post.route';\nconst router = Router();\n\nrouter.use('/api/user', UserRouter);\nrouter.use('/api/post',  PostRouter);\n\nexport default router;\n"]}},"mtime":1651607818943},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/routes/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/routes/api/user.route.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar AuthController = _interopRequireWildcard(require(\"../../controllers/auth.controller\"));\n\nvar UserController = _interopRequireWildcard(require(\"../../controllers/user.controller\"));\n\nvar UploadController = _interopRequireWildcard(require(\"../../controllers/upload.controller\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst multer = require('multer');\n\nconst fileStorageEngine = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, `${__dirname}/../../../assets/uploads/profils`);\n  },\n  filename: function (req, file, cb) {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    let originalNameFile = file.originalname;\n    let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1);\n    cb(null, file.fieldname + '-' + uniqueSuffix + \".\" + extension);\n  }\n});\nconst upload = multer({\n  storage: fileStorageEngine\n});\nconst api = (0, _express.Router)(); //auth\n\napi.post('/register', AuthController.signUp);\napi.post('/login', AuthController.signIn);\napi.get('/logout', AuthController.logout); //user\n\napi.get('/', UserController.getAllUsers);\napi.get('/:id', UserController.getUserInfo);\napi.put('/:id', UserController.updateUser);\napi.delete('/:id', UserController.deleteUser);\napi.patch('/follow/:id', UserController.follow);\napi.patch('/unfollow/:id', UserController.unfollow); //upload\n//avant de passer à notre controlleur il va check notre file\n\napi.post('/upload', upload.single(\"file\"), UploadController.uploadProfil);\nvar _default = api;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIucm91dGUuanMiXSwibmFtZXMiOlsibXVsdGVyIiwicmVxdWlyZSIsImZpbGVTdG9yYWdlRW5naW5lIiwiZGlza1N0b3JhZ2UiLCJkZXN0aW5hdGlvbiIsInJlcSIsImZpbGUiLCJjYiIsIl9fZGlybmFtZSIsImZpbGVuYW1lIiwidW5pcXVlU3VmZml4IiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm9yaWdpbmFsTmFtZUZpbGUiLCJvcmlnaW5hbG5hbWUiLCJleHRlbnNpb24iLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsImZpZWxkbmFtZSIsInVwbG9hZCIsInN0b3JhZ2UiLCJhcGkiLCJwb3N0IiwiQXV0aENvbnRyb2xsZXIiLCJzaWduVXAiLCJzaWduSW4iLCJnZXQiLCJsb2dvdXQiLCJVc2VyQ29udHJvbGxlciIsImdldEFsbFVzZXJzIiwiZ2V0VXNlckluZm8iLCJwdXQiLCJ1cGRhdGVVc2VyIiwiZGVsZXRlIiwiZGVsZXRlVXNlciIsInBhdGNoIiwiZm9sbG93IiwidW5mb2xsb3ciLCJzaW5nbGUiLCJVcGxvYWRDb250cm9sbGVyIiwidXBsb2FkUHJvZmlsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7OztBQUNBLE1BQU1BLE1BQU0sR0FBSUMsT0FBTyxDQUFDLFFBQUQsQ0FBdkI7O0FBRUEsTUFBTUMsaUJBQWlCLEdBQUdGLE1BQU0sQ0FBQ0csV0FBUCxDQUFtQjtBQUN6Q0MsRUFBQUEsV0FBVyxFQUFDLENBQUNDLEdBQUQsRUFBTUMsSUFBTixFQUFZQyxFQUFaLEtBQW1CO0FBQzNCQSxJQUFBQSxFQUFFLENBQUMsSUFBRCxFQUFRLEdBQUVDLFNBQVUsa0NBQXBCLENBQUY7QUFDSCxHQUh3QztBQUl6Q0MsRUFBQUEsUUFBUSxFQUFFLFVBQVVKLEdBQVYsRUFBZUMsSUFBZixFQUFxQkMsRUFBckIsRUFBeUI7QUFDL0IsVUFBTUcsWUFBWSxHQUFHQyxJQUFJLENBQUNDLEdBQUwsS0FBYSxHQUFiLEdBQW1CQyxJQUFJLENBQUNDLEtBQUwsQ0FBV0QsSUFBSSxDQUFDRSxNQUFMLEtBQWdCLEdBQTNCLENBQXhDO0FBQ0EsUUFBSUMsZ0JBQWdCLEdBQUdWLElBQUksQ0FBQ1csWUFBNUI7QUFDQSxRQUFJQyxTQUFTLEdBQUdGLGdCQUFnQixDQUFDRyxTQUFqQixDQUEyQkgsZ0JBQWdCLENBQUNJLFdBQWpCLENBQTZCLEdBQTdCLElBQW9DLENBQS9ELENBQWhCO0FBQ0FiLElBQUFBLEVBQUUsQ0FBQyxJQUFELEVBQU9ELElBQUksQ0FBQ2UsU0FBTCxHQUFpQixHQUFqQixHQUF1QlgsWUFBdkIsR0FBc0MsR0FBdEMsR0FBMkNRLFNBQWxELENBQUY7QUFDRDtBQVRzQyxDQUFuQixDQUExQjtBQVlBLE1BQU1JLE1BQU0sR0FBR3RCLE1BQU0sQ0FBQztBQUFDdUIsRUFBQUEsT0FBTyxFQUFDckI7QUFBVCxDQUFELENBQXJCO0FBRUEsTUFBTXNCLEdBQUcsR0FBRyxzQkFBWixDLENBRUE7O0FBQ0FBLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLFdBQVQsRUFBc0JDLGNBQWMsQ0FBQ0MsTUFBckM7QUFDQUgsR0FBRyxDQUFDQyxJQUFKLENBQVMsUUFBVCxFQUFtQkMsY0FBYyxDQUFDRSxNQUFsQztBQUNBSixHQUFHLENBQUNLLEdBQUosQ0FBUSxTQUFSLEVBQW1CSCxjQUFjLENBQUNJLE1BQWxDLEUsQ0FFQTs7QUFDQU4sR0FBRyxDQUFDSyxHQUFKLENBQVEsR0FBUixFQUFhRSxjQUFjLENBQUNDLFdBQTVCO0FBQ0FSLEdBQUcsQ0FBQ0ssR0FBSixDQUFRLE1BQVIsRUFBZ0JFLGNBQWMsQ0FBQ0UsV0FBL0I7QUFDQVQsR0FBRyxDQUFDVSxHQUFKLENBQVEsTUFBUixFQUFnQkgsY0FBYyxDQUFDSSxVQUEvQjtBQUNBWCxHQUFHLENBQUNZLE1BQUosQ0FBVyxNQUFYLEVBQW1CTCxjQUFjLENBQUNNLFVBQWxDO0FBQ0FiLEdBQUcsQ0FBQ2MsS0FBSixDQUFVLGFBQVYsRUFBeUJQLGNBQWMsQ0FBQ1EsTUFBeEM7QUFDQWYsR0FBRyxDQUFDYyxLQUFKLENBQVUsZUFBVixFQUEyQlAsY0FBYyxDQUFDUyxRQUExQyxFLENBR0E7QUFDQTs7QUFDQWhCLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLFNBQVQsRUFBb0JILE1BQU0sQ0FBQ21CLE1BQVAsQ0FBYyxNQUFkLENBQXBCLEVBQTRDQyxnQkFBZ0IsQ0FBQ0MsWUFBN0Q7ZUFFZW5CLEciLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NlcnZlci9zcmMvcm91dGVzL2FwaS8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdleHByZXNzJztcbmltcG9ydCAqIGFzIEF1dGhDb250cm9sbGVyIGZyb20gJy4uLy4uL2NvbnRyb2xsZXJzL2F1dGguY29udHJvbGxlcic7XG5pbXBvcnQgKiBhcyBVc2VyQ29udHJvbGxlciBmcm9tICcuLi8uLi9jb250cm9sbGVycy91c2VyLmNvbnRyb2xsZXInO1xuaW1wb3J0ICogYXMgVXBsb2FkQ29udHJvbGxlciBmcm9tICcuLi8uLi9jb250cm9sbGVycy91cGxvYWQuY29udHJvbGxlcic7XG5jb25zdCBtdWx0ZXIgID0gcmVxdWlyZSgnbXVsdGVyJylcblxuY29uc3QgZmlsZVN0b3JhZ2VFbmdpbmUgPSBtdWx0ZXIuZGlza1N0b3JhZ2Uoe1xuICAgIGRlc3RpbmF0aW9uOihyZXEsIGZpbGUsIGNiKSA9PiB7XG4gICAgICAgIGNiKG51bGwsIGAke19fZGlybmFtZX0vLi4vLi4vLi4vYXNzZXRzL3VwbG9hZHMvcHJvZmlsc2ApXG4gICAgfSxcbiAgICBmaWxlbmFtZTogZnVuY3Rpb24gKHJlcSwgZmlsZSwgY2IpIHtcbiAgICAgICAgY29uc3QgdW5pcXVlU3VmZml4ID0gRGF0ZS5ub3coKSArICctJyArIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDFFOSlcbiAgICAgICAgbGV0IG9yaWdpbmFsTmFtZUZpbGUgPSBmaWxlLm9yaWdpbmFsbmFtZTtcbiAgICAgICAgbGV0IGV4dGVuc2lvbiA9IG9yaWdpbmFsTmFtZUZpbGUuc3Vic3RyaW5nKG9yaWdpbmFsTmFtZUZpbGUubGFzdEluZGV4T2YoJy4nKSArIDEpOyBcbiAgICAgICAgY2IobnVsbCwgZmlsZS5maWVsZG5hbWUgKyAnLScgKyB1bmlxdWVTdWZmaXggKyBcIi5cIisgZXh0ZW5zaW9uIClcbiAgICAgIH1cbn0pO1xuXG5jb25zdCB1cGxvYWQgPSBtdWx0ZXIoe3N0b3JhZ2U6ZmlsZVN0b3JhZ2VFbmdpbmV9KVxuXG5jb25zdCBhcGkgPSBSb3V0ZXIoKTtcblxuLy9hdXRoXG5hcGkucG9zdCgnL3JlZ2lzdGVyJywgQXV0aENvbnRyb2xsZXIuc2lnblVwKTtcbmFwaS5wb3N0KCcvbG9naW4nLCBBdXRoQ29udHJvbGxlci5zaWduSW4pO1xuYXBpLmdldCgnL2xvZ291dCcsIEF1dGhDb250cm9sbGVyLmxvZ291dCk7XG5cbi8vdXNlclxuYXBpLmdldCgnLycsIFVzZXJDb250cm9sbGVyLmdldEFsbFVzZXJzKTtcbmFwaS5nZXQoJy86aWQnLCBVc2VyQ29udHJvbGxlci5nZXRVc2VySW5mbyk7XG5hcGkucHV0KCcvOmlkJywgVXNlckNvbnRyb2xsZXIudXBkYXRlVXNlcik7XG5hcGkuZGVsZXRlKCcvOmlkJywgVXNlckNvbnRyb2xsZXIuZGVsZXRlVXNlcik7XG5hcGkucGF0Y2goJy9mb2xsb3cvOmlkJywgVXNlckNvbnRyb2xsZXIuZm9sbG93KTtcbmFwaS5wYXRjaCgnL3VuZm9sbG93LzppZCcsIFVzZXJDb250cm9sbGVyLnVuZm9sbG93KTtcblxuXG4vL3VwbG9hZFxuLy9hdmFudCBkZSBwYXNzZXIgw6Agbm90cmUgY29udHJvbGxldXIgaWwgdmEgY2hlY2sgbm90cmUgZmlsZVxuYXBpLnBvc3QoJy91cGxvYWQnLCB1cGxvYWQuc2luZ2xlKFwiZmlsZVwiKSwgIFVwbG9hZENvbnRyb2xsZXIudXBsb2FkUHJvZmlsKVxuXG5leHBvcnQgZGVmYXVsdCBhcGk7Il19","map":{"version":3,"sources":["user.route.js"],"names":["multer","require","fileStorageEngine","diskStorage","destination","req","file","cb","__dirname","filename","uniqueSuffix","Date","now","Math","round","random","originalNameFile","originalname","extension","substring","lastIndexOf","fieldname","upload","storage","api","post","AuthController","signUp","signIn","get","logout","UserController","getAllUsers","getUserInfo","put","updateUser","delete","deleteUser","patch","follow","unfollow","single","UploadController","uploadProfil"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;AACA,MAAMA,MAAM,GAAIC,OAAO,CAAC,QAAD,CAAvB;;AAEA,MAAMC,iBAAiB,GAAGF,MAAM,CAACG,WAAP,CAAmB;AACzCC,EAAAA,WAAW,EAAC,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,KAAmB;AAC3BA,IAAAA,EAAE,CAAC,IAAD,EAAQ,GAAEC,SAAU,kCAApB,CAAF;AACH,GAHwC;AAIzCC,EAAAA,QAAQ,EAAE,UAAUJ,GAAV,EAAeC,IAAf,EAAqBC,EAArB,EAAyB;AAC/B,UAAMG,YAAY,GAAGC,IAAI,CAACC,GAAL,KAAa,GAAb,GAAmBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAAxC;AACA,QAAIC,gBAAgB,GAAGV,IAAI,CAACW,YAA5B;AACA,QAAIC,SAAS,GAAGF,gBAAgB,CAACG,SAAjB,CAA2BH,gBAAgB,CAACI,WAAjB,CAA6B,GAA7B,IAAoC,CAA/D,CAAhB;AACAb,IAAAA,EAAE,CAAC,IAAD,EAAOD,IAAI,CAACe,SAAL,GAAiB,GAAjB,GAAuBX,YAAvB,GAAsC,GAAtC,GAA2CQ,SAAlD,CAAF;AACD;AATsC,CAAnB,CAA1B;AAYA,MAAMI,MAAM,GAAGtB,MAAM,CAAC;AAACuB,EAAAA,OAAO,EAACrB;AAAT,CAAD,CAArB;AAEA,MAAMsB,GAAG,GAAG,sBAAZ,C,CAEA;;AACAA,GAAG,CAACC,IAAJ,CAAS,WAAT,EAAsBC,cAAc,CAACC,MAArC;AACAH,GAAG,CAACC,IAAJ,CAAS,QAAT,EAAmBC,cAAc,CAACE,MAAlC;AACAJ,GAAG,CAACK,GAAJ,CAAQ,SAAR,EAAmBH,cAAc,CAACI,MAAlC,E,CAEA;;AACAN,GAAG,CAACK,GAAJ,CAAQ,GAAR,EAAaE,cAAc,CAACC,WAA5B;AACAR,GAAG,CAACK,GAAJ,CAAQ,MAAR,EAAgBE,cAAc,CAACE,WAA/B;AACAT,GAAG,CAACU,GAAJ,CAAQ,MAAR,EAAgBH,cAAc,CAACI,UAA/B;AACAX,GAAG,CAACY,MAAJ,CAAW,MAAX,EAAmBL,cAAc,CAACM,UAAlC;AACAb,GAAG,CAACc,KAAJ,CAAU,aAAV,EAAyBP,cAAc,CAACQ,MAAxC;AACAf,GAAG,CAACc,KAAJ,CAAU,eAAV,EAA2BP,cAAc,CAACS,QAA1C,E,CAGA;AACA;;AACAhB,GAAG,CAACC,IAAJ,CAAS,SAAT,EAAoBH,MAAM,CAACmB,MAAP,CAAc,MAAd,CAApB,EAA4CC,gBAAgB,CAACC,YAA7D;eAEenB,G","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/routes/api/","sourcesContent":["import { Router } from 'express';\nimport * as AuthController from '../../controllers/auth.controller';\nimport * as UserController from '../../controllers/user.controller';\nimport * as UploadController from '../../controllers/upload.controller';\nconst multer  = require('multer')\n\nconst fileStorageEngine = multer.diskStorage({\n    destination:(req, file, cb) => {\n        cb(null, `${__dirname}/../../../assets/uploads/profils`)\n    },\n    filename: function (req, file, cb) {\n        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)\n        let originalNameFile = file.originalname;\n        let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1); \n        cb(null, file.fieldname + '-' + uniqueSuffix + \".\"+ extension )\n      }\n});\n\nconst upload = multer({storage:fileStorageEngine})\n\nconst api = Router();\n\n//auth\napi.post('/register', AuthController.signUp);\napi.post('/login', AuthController.signIn);\napi.get('/logout', AuthController.logout);\n\n//user\napi.get('/', UserController.getAllUsers);\napi.get('/:id', UserController.getUserInfo);\napi.put('/:id', UserController.updateUser);\napi.delete('/:id', UserController.deleteUser);\napi.patch('/follow/:id', UserController.follow);\napi.patch('/unfollow/:id', UserController.unfollow);\n\n\n//upload\n//avant de passer à notre controlleur il va check notre file\napi.post('/upload', upload.single(\"file\"),  UploadController.uploadProfil)\n\nexport default api;"]}},"mtime":1653046975386},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/controllers/auth.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.signUp = exports.signIn = exports.logout = void 0;\n\nvar _express = require(\"express\");\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst User = require('../models/user.model');\n\nconst jwt = require('jsonwebtoken'); //equivalent de 3 jours\n\n\nconst maxAge = 3 * 24 * 60 * 60 * 1000; //function qui créer le token en fonction d'une clé de cryptage qu'on aura mis dans variable d'environnemment\n\nconst createToken = id => {\n  return jwt.sign({\n    id\n  }, process.env.TOKEN_SECRET, {\n    expiresIn: maxAge\n  });\n};\n\nconst signUp = async (req, res) => {\n  const {\n    pseudo,\n    email,\n    password\n  } = req.body;\n\n  try {\n    const user = await User.create({\n      pseudo,\n      email,\n      password\n    });\n    res.status(201).send({\n      user: user._id\n    });\n  } catch (err) {\n    const errors = (0, _errors.signUpErrors)(err);\n    return res.status(200).send({\n      errors\n    });\n  }\n};\n\nexports.signUp = signUp;\n\nconst signIn = async (req, res) => {\n  const {\n    email,\n    password\n  } = req.body;\n\n  try {\n    //check user exist and compare email with password\n    const user = await User.login(email, password); //create token\n\n    const token = createToken(user._id); //on retourne le token dans les cookies accessible seulement par le serveur\n\n    res.cookie(\"jwt\", token, {\n      withCredentials: true,\n      httpOnly: true,\n      maxAge: maxAge\n    });\n    res.status(200).json({\n      user: user._id\n    });\n  } catch (err) {\n    console.log(err);\n    const errors = (0, _errors.signInErrors)(err);\n    return res.status(200).send({\n      errors\n    });\n  }\n};\n\nexports.signIn = signIn;\n\nconst logout = async (req, res) => {\n  res.cookie('jwt', '', {\n    maxAge: 1\n  });\n  res.status(200).json({\n    message: \"disconect\"\n  });\n};\n\nexports.logout = logout;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImp3dCIsIm1heEFnZSIsImNyZWF0ZVRva2VuIiwiaWQiLCJzaWduIiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsImV4cGlyZXNJbiIsInNpZ25VcCIsInJlcSIsInJlcyIsInBzZXVkbyIsImVtYWlsIiwicGFzc3dvcmQiLCJib2R5IiwidXNlciIsImNyZWF0ZSIsInN0YXR1cyIsInNlbmQiLCJfaWQiLCJlcnIiLCJlcnJvcnMiLCJzaWduSW4iLCJsb2dpbiIsInRva2VuIiwiY29va2llIiwid2l0aENyZWRlbnRpYWxzIiwiaHR0cE9ubHkiLCJqc29uIiwiY29uc29sZSIsImxvZyIsImxvZ291dCIsIm1lc3NhZ2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFDQSxNQUFNQyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxjQUFELENBQW5CLEMsQ0FFQTs7O0FBQ0EsTUFBTUUsTUFBTSxHQUFHLElBQUksRUFBSixHQUFTLEVBQVQsR0FBYyxFQUFkLEdBQW1CLElBQWxDLEMsQ0FDQTs7QUFDQSxNQUFNQyxXQUFXLEdBQUlDLEVBQUQsSUFBUTtBQUN4QixTQUFPSCxHQUFHLENBQUNJLElBQUosQ0FBUztBQUFFRCxJQUFBQTtBQUFGLEdBQVQsRUFBaUJFLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUE3QixFQUEyQztBQUM5Q0MsSUFBQUEsU0FBUyxFQUFFUDtBQURtQyxHQUEzQyxDQUFQO0FBR0gsQ0FKRDs7QUFPTyxNQUFNUSxNQUFNLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEtBQW9CO0FBQ3RDLFFBQU07QUFBRUMsSUFBQUEsTUFBRjtBQUFVQyxJQUFBQSxLQUFWO0FBQWlCQyxJQUFBQTtBQUFqQixNQUE4QkosR0FBRyxDQUFDSyxJQUF4Qzs7QUFDQSxNQUFJO0FBQ0EsVUFBTUMsSUFBSSxHQUFHLE1BQU1sQixJQUFJLENBQUNtQixNQUFMLENBQVk7QUFBRUwsTUFBQUEsTUFBRjtBQUFVQyxNQUFBQSxLQUFWO0FBQWlCQyxNQUFBQTtBQUFqQixLQUFaLENBQW5CO0FBQ0FILElBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVILE1BQUFBLElBQUksRUFBRUEsSUFBSSxDQUFDSTtBQUFiLEtBQXJCO0FBQ0gsR0FIRCxDQUlBLE9BQU9DLEdBQVAsRUFBWTtBQUNSLFVBQU1DLE1BQU0sR0FBRywwQkFBYUQsR0FBYixDQUFmO0FBQ0EsV0FBT1YsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBRUcsTUFBQUE7QUFBRixLQUFyQixDQUFQO0FBQ0g7QUFDSixDQVZNOzs7O0FBWUEsTUFBTUMsTUFBTSxHQUFHLE9BQU9iLEdBQVAsRUFBWUMsR0FBWixLQUFvQjtBQUN0QyxRQUFNO0FBQUVFLElBQUFBLEtBQUY7QUFBU0MsSUFBQUE7QUFBVCxNQUFzQkosR0FBRyxDQUFDSyxJQUFoQzs7QUFDQSxNQUFJO0FBQ0E7QUFDQSxVQUFNQyxJQUFJLEdBQUcsTUFBTWxCLElBQUksQ0FBQzBCLEtBQUwsQ0FBV1gsS0FBWCxFQUFrQkMsUUFBbEIsQ0FBbkIsQ0FGQSxDQUdBOztBQUNBLFVBQU1XLEtBQUssR0FBR3ZCLFdBQVcsQ0FBQ2MsSUFBSSxDQUFDSSxHQUFOLENBQXpCLENBSkEsQ0FLQTs7QUFDQVQsSUFBQUEsR0FBRyxDQUFDZSxNQUFKLENBQVcsS0FBWCxFQUFrQkQsS0FBbEIsRUFBeUI7QUFDckJFLE1BQUFBLGVBQWUsRUFBRSxJQURJO0FBRXJCQyxNQUFBQSxRQUFRLEVBQUUsSUFGVztBQUdyQjNCLE1BQUFBLE1BQU0sRUFBRUE7QUFIYSxLQUF6QjtBQUtBVSxJQUFBQSxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCVyxJQUFoQixDQUFxQjtBQUFFYixNQUFBQSxJQUFJLEVBQUVBLElBQUksQ0FBQ0k7QUFBYixLQUFyQjtBQUNILEdBWkQsQ0FhQSxPQUFPQyxHQUFQLEVBQVk7QUFDUlMsSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlWLEdBQVo7QUFDQSxVQUFNQyxNQUFNLEdBQUcsMEJBQWFELEdBQWIsQ0FBZjtBQUNBLFdBQU9WLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVHLE1BQUFBO0FBQUYsS0FBckIsQ0FBUDtBQUNIO0FBQ0osQ0FwQk07Ozs7QUFzQkEsTUFBTVUsTUFBTSxHQUFHLE9BQU90QixHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFDdENBLEVBQUFBLEdBQUcsQ0FBQ2UsTUFBSixDQUFXLEtBQVgsRUFBa0IsRUFBbEIsRUFBc0I7QUFBRXpCLElBQUFBLE1BQU0sRUFBRTtBQUFWLEdBQXRCO0FBQ0FVLEVBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JXLElBQWhCLENBQXFCO0FBQUVJLElBQUFBLE9BQU8sRUFBRTtBQUFYLEdBQXJCO0FBQ0gsQ0FITSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc2VydmVyL3NyYy9jb250cm9sbGVycy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZXNwb25zZSB9IGZyb20gJ2V4cHJlc3MnXG5pbXBvcnQgeyBzaWduVXBFcnJvcnMsIHNpZ25JbkVycm9ycyB9IGZyb20gJy4uL3V0aWxzL2Vycm9ycy51dGlscydcblxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy91c2VyLm1vZGVsJylcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpXG5cbi8vZXF1aXZhbGVudCBkZSAzIGpvdXJzXG5jb25zdCBtYXhBZ2UgPSAzICogMjQgKiA2MCAqIDYwICogMTAwMFxuLy9mdW5jdGlvbiBxdWkgY3LDqWVyIGxlIHRva2VuIGVuIGZvbmN0aW9uIGQndW5lIGNsw6kgZGUgY3J5cHRhZ2UgcXUnb24gYXVyYSBtaXMgZGFucyB2YXJpYWJsZSBkJ2Vudmlyb25uZW1tZW50XG5jb25zdCBjcmVhdGVUb2tlbiA9IChpZCkgPT4ge1xuICAgIHJldHVybiBqd3Quc2lnbih7IGlkIH0sIHByb2Nlc3MuZW52LlRPS0VOX1NFQ1JFVCwge1xuICAgICAgICBleHBpcmVzSW46IG1heEFnZVxuICAgIH0pXG59XG5cblxuZXhwb3J0IGNvbnN0IHNpZ25VcCA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgcHNldWRvLCBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuY3JlYXRlKHsgcHNldWRvLCBlbWFpbCwgcGFzc3dvcmQgfSlcbiAgICAgICAgcmVzLnN0YXR1cygyMDEpLnNlbmQoeyB1c2VyOiB1c2VyLl9pZCB9KVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnN0IGVycm9ycyA9IHNpZ25VcEVycm9ycyhlcnIpXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IGVycm9ycyB9KVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IHNpZ25JbiA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keVxuICAgIHRyeSB7XG4gICAgICAgIC8vY2hlY2sgdXNlciBleGlzdCBhbmQgY29tcGFyZSBlbWFpbCB3aXRoIHBhc3N3b3JkXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmxvZ2luKGVtYWlsLCBwYXNzd29yZClcbiAgICAgICAgLy9jcmVhdGUgdG9rZW5cbiAgICAgICAgY29uc3QgdG9rZW4gPSBjcmVhdGVUb2tlbih1c2VyLl9pZClcbiAgICAgICAgLy9vbiByZXRvdXJuZSBsZSB0b2tlbiBkYW5zIGxlcyBjb29raWVzIGFjY2Vzc2libGUgc2V1bGVtZW50IHBhciBsZSBzZXJ2ZXVyXG4gICAgICAgIHJlcy5jb29raWUoXCJqd3RcIiwgdG9rZW4sIHtcbiAgICAgICAgICAgIHdpdGhDcmVkZW50aWFsczogdHJ1ZSxcbiAgICAgICAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgICAgICAgbWF4QWdlOiBtYXhBZ2UsXG4gICAgICAgIH0pO1xuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHVzZXI6IHVzZXIuX2lkIH0pXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICBjb25zdCBlcnJvcnMgPSBzaWduSW5FcnJvcnMoZXJyKVxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoeyBlcnJvcnMgfSlcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBsb2dvdXQgPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuY29va2llKCdqd3QnLCAnJywgeyBtYXhBZ2U6IDEgfSk7XG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiBcImRpc2NvbmVjdFwiIH0pXG59XG5cbiJdfQ==","map":{"version":3,"sources":["auth.controller.js"],"names":["User","require","jwt","maxAge","createToken","id","sign","process","env","TOKEN_SECRET","expiresIn","signUp","req","res","pseudo","email","password","body","user","create","status","send","_id","err","errors","signIn","login","token","cookie","withCredentials","httpOnly","json","console","log","logout","message"],"mappings":";;;;;;;AAAA;;AACA;;AAEA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AACA,MAAMC,GAAG,GAAGD,OAAO,CAAC,cAAD,CAAnB,C,CAEA;;;AACA,MAAME,MAAM,GAAG,IAAI,EAAJ,GAAS,EAAT,GAAc,EAAd,GAAmB,IAAlC,C,CACA;;AACA,MAAMC,WAAW,GAAIC,EAAD,IAAQ;AACxB,SAAOH,GAAG,CAACI,IAAJ,CAAS;AAAED,IAAAA;AAAF,GAAT,EAAiBE,OAAO,CAACC,GAAR,CAAYC,YAA7B,EAA2C;AAC9CC,IAAAA,SAAS,EAAEP;AADmC,GAA3C,CAAP;AAGH,CAJD;;AAOO,MAAMQ,MAAM,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACtC,QAAM;AAAEC,IAAAA,MAAF;AAAUC,IAAAA,KAAV;AAAiBC,IAAAA;AAAjB,MAA8BJ,GAAG,CAACK,IAAxC;;AACA,MAAI;AACA,UAAMC,IAAI,GAAG,MAAMlB,IAAI,CAACmB,MAAL,CAAY;AAAEL,MAAAA,MAAF;AAAUC,MAAAA,KAAV;AAAiBC,MAAAA;AAAjB,KAAZ,CAAnB;AACAH,IAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEH,MAAAA,IAAI,EAAEA,IAAI,CAACI;AAAb,KAArB;AACH,GAHD,CAIA,OAAOC,GAAP,EAAY;AACR,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOV,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEG,MAAAA;AAAF,KAArB,CAAP;AACH;AACJ,CAVM;;;;AAYA,MAAMC,MAAM,GAAG,OAAOb,GAAP,EAAYC,GAAZ,KAAoB;AACtC,QAAM;AAAEE,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAsBJ,GAAG,CAACK,IAAhC;;AACA,MAAI;AACA;AACA,UAAMC,IAAI,GAAG,MAAMlB,IAAI,CAAC0B,KAAL,CAAWX,KAAX,EAAkBC,QAAlB,CAAnB,CAFA,CAGA;;AACA,UAAMW,KAAK,GAAGvB,WAAW,CAACc,IAAI,CAACI,GAAN,CAAzB,CAJA,CAKA;;AACAT,IAAAA,GAAG,CAACe,MAAJ,CAAW,KAAX,EAAkBD,KAAlB,EAAyB;AACrBE,MAAAA,eAAe,EAAE,IADI;AAErBC,MAAAA,QAAQ,EAAE,IAFW;AAGrB3B,MAAAA,MAAM,EAAEA;AAHa,KAAzB;AAKAU,IAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB;AAAEb,MAAAA,IAAI,EAAEA,IAAI,CAACI;AAAb,KAArB;AACH,GAZD,CAaA,OAAOC,GAAP,EAAY;AACRS,IAAAA,OAAO,CAACC,GAAR,CAAYV,GAAZ;AACA,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOV,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEG,MAAAA;AAAF,KAArB,CAAP;AACH;AACJ,CApBM;;;;AAsBA,MAAMU,MAAM,GAAG,OAAOtB,GAAP,EAAYC,GAAZ,KAAoB;AACtCA,EAAAA,GAAG,CAACe,MAAJ,CAAW,KAAX,EAAkB,EAAlB,EAAsB;AAAEzB,IAAAA,MAAM,EAAE;AAAV,GAAtB;AACAU,EAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB;AAAEI,IAAAA,OAAO,EAAE;AAAX,GAArB;AACH,CAHM","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/controllers/","sourcesContent":["import { response } from 'express'\nimport { signUpErrors, signInErrors } from '../utils/errors.utils'\n\nconst User = require('../models/user.model')\nconst jwt = require('jsonwebtoken')\n\n//equivalent de 3 jours\nconst maxAge = 3 * 24 * 60 * 60 * 1000\n//function qui créer le token en fonction d'une clé de cryptage qu'on aura mis dans variable d'environnemment\nconst createToken = (id) => {\n    return jwt.sign({ id }, process.env.TOKEN_SECRET, {\n        expiresIn: maxAge\n    })\n}\n\n\nexport const signUp = async (req, res) => {\n    const { pseudo, email, password } = req.body\n    try {\n        const user = await User.create({ pseudo, email, password })\n        res.status(201).send({ user: user._id })\n    }\n    catch (err) {\n        const errors = signUpErrors(err)\n        return res.status(200).send({ errors })\n    }\n}\n\nexport const signIn = async (req, res) => {\n    const { email, password } = req.body\n    try {\n        //check user exist and compare email with password\n        const user = await User.login(email, password)\n        //create token\n        const token = createToken(user._id)\n        //on retourne le token dans les cookies accessible seulement par le serveur\n        res.cookie(\"jwt\", token, {\n            withCredentials: true,\n            httpOnly: true,\n            maxAge: maxAge,\n        });\n        res.status(200).json({ user: user._id })\n    }\n    catch (err) {\n        console.log(err)\n        const errors = signInErrors(err)\n        return res.status(200).send({ errors })\n    }\n}\n\nexport const logout = async (req, res) => {\n    res.cookie('jwt', '', { maxAge: 1 });\n    res.status(200).json({ message: \"disconect\" })\n}\n\n"]}},"mtime":1651349889429},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/utils/errors.utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.uploadErrors = exports.signUpErrors = exports.signInErrors = void 0;\n\nconst signUpErrors = err => {\n  let errors = {\n    pseudo: '',\n    email: '',\n    password: ''\n  };\n\n  if (err.message.includes('pseudo')) {\n    errors.pseudo = \"Pseudo incorrect\";\n  }\n\n  if (err.message.includes('email')) {\n    errors.email = \"Email incorrect\";\n  }\n\n  if (err.message.includes('password')) {\n    errors.password = \"Password incorrect ! Password must be at least 6 characters\";\n  }\n\n  if (err.code === 11000 && Object.keys(err.keyValue)[0].includes('pseudo')) {\n    errors.pseudo = \"Pseudo already use\";\n  }\n\n  if (err.code === 11000 && Object.keys(err.keyValue)[0].includes('email')) {\n    errors.email = \"Email already use\";\n  }\n\n  return errors;\n};\n\nexports.signUpErrors = signUpErrors;\n\nconst signInErrors = err => {\n  let errors = {\n    email: '',\n    password: ''\n  };\n\n  if (err.message.includes('email')) {\n    errors.email = \"Email inconnu\";\n  }\n\n  if (err.message.includes('password')) {\n    errors.password = \"Vos identifiants sont incorrects !\";\n  }\n\n  return errors;\n};\n\nexports.signInErrors = signInErrors;\n\nconst uploadErrors = err => {\n  let errors = {\n    format: '',\n    maxSize: ''\n  };\n\n  if (err.message.includes('invalid file')) {\n    errors.format = \"format incompatible\";\n  }\n\n  if (err.message.includes('max size')) {\n    errors.maxSize = \"Le fichier dépasse 500ko\";\n  }\n\n  return errors;\n};\n\nexports.uploadErrors = uploadErrors;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9ycy51dGlscy5qcyJdLCJuYW1lcyI6WyJzaWduVXBFcnJvcnMiLCJlcnIiLCJlcnJvcnMiLCJwc2V1ZG8iLCJlbWFpbCIsInBhc3N3b3JkIiwibWVzc2FnZSIsImluY2x1ZGVzIiwiY29kZSIsIk9iamVjdCIsImtleXMiLCJrZXlWYWx1ZSIsInNpZ25JbkVycm9ycyIsInVwbG9hZEVycm9ycyIsImZvcm1hdCIsIm1heFNpemUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBTyxNQUFNQSxZQUFZLEdBQUlDLEdBQUQsSUFBUztBQUNqQyxNQUFJQyxNQUFNLEdBQUc7QUFBQ0MsSUFBQUEsTUFBTSxFQUFFLEVBQVQ7QUFBYUMsSUFBQUEsS0FBSyxFQUFFLEVBQXBCO0FBQXdCQyxJQUFBQSxRQUFRLEVBQUU7QUFBbEMsR0FBYjs7QUFFQSxNQUFHSixHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixRQUFyQixDQUFILEVBQWtDO0FBQzlCTCxJQUFBQSxNQUFNLENBQUNDLE1BQVAsR0FBZ0Isa0JBQWhCO0FBQ0g7O0FBQ0QsTUFBR0YsR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsT0FBckIsQ0FBSCxFQUFpQztBQUM3QkwsSUFBQUEsTUFBTSxDQUFDRSxLQUFQLEdBQWUsaUJBQWY7QUFDSDs7QUFDRCxNQUFHSCxHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixVQUFyQixDQUFILEVBQW9DO0FBQ2hDTCxJQUFBQSxNQUFNLENBQUNHLFFBQVAsR0FBa0IsNkRBQWxCO0FBQ0g7O0FBQ0QsTUFBR0osR0FBRyxDQUFDTyxJQUFKLEtBQWEsS0FBYixJQUFzQkMsTUFBTSxDQUFDQyxJQUFQLENBQVlULEdBQUcsQ0FBQ1UsUUFBaEIsRUFBMEIsQ0FBMUIsRUFBNkJKLFFBQTdCLENBQXNDLFFBQXRDLENBQXpCLEVBQXlFO0FBQ3JFTCxJQUFBQSxNQUFNLENBQUNDLE1BQVAsR0FBZ0Isb0JBQWhCO0FBQ0g7O0FBQ0QsTUFBR0YsR0FBRyxDQUFDTyxJQUFKLEtBQWEsS0FBYixJQUFzQkMsTUFBTSxDQUFDQyxJQUFQLENBQVlULEdBQUcsQ0FBQ1UsUUFBaEIsRUFBMEIsQ0FBMUIsRUFBNkJKLFFBQTdCLENBQXNDLE9BQXRDLENBQXpCLEVBQXdFO0FBQ3BFTCxJQUFBQSxNQUFNLENBQUNFLEtBQVAsR0FBZSxtQkFBZjtBQUNIOztBQUVELFNBQU9GLE1BQVA7QUFDSCxDQXBCTTs7OztBQXNCQSxNQUFNVSxZQUFZLEdBQUlYLEdBQUQsSUFBUztBQUNqQyxNQUFJQyxNQUFNLEdBQUc7QUFBRUUsSUFBQUEsS0FBSyxFQUFFLEVBQVQ7QUFBYUMsSUFBQUEsUUFBUSxFQUFFO0FBQXZCLEdBQWI7O0FBQ0EsTUFBR0osR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsT0FBckIsQ0FBSCxFQUFpQztBQUM3QkwsSUFBQUEsTUFBTSxDQUFDRSxLQUFQLEdBQWUsZUFBZjtBQUNIOztBQUNELE1BQUdILEdBQUcsQ0FBQ0ssT0FBSixDQUFZQyxRQUFaLENBQXFCLFVBQXJCLENBQUgsRUFBb0M7QUFDaENMLElBQUFBLE1BQU0sQ0FBQ0csUUFBUCxHQUFrQixvQ0FBbEI7QUFDSDs7QUFDRCxTQUFPSCxNQUFQO0FBQ0gsQ0FUTTs7OztBQVdBLE1BQU1XLFlBQVksR0FBSVosR0FBRCxJQUFTO0FBQ2pDLE1BQUlDLE1BQU0sR0FBRztBQUFDWSxJQUFBQSxNQUFNLEVBQUUsRUFBVDtBQUFhQyxJQUFBQSxPQUFPLEVBQUM7QUFBckIsR0FBYjs7QUFFQSxNQUFHZCxHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixjQUFyQixDQUFILEVBQXdDO0FBQ3BDTCxJQUFBQSxNQUFNLENBQUNZLE1BQVAsR0FBZ0IscUJBQWhCO0FBQ0g7O0FBRUQsTUFBR2IsR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsVUFBckIsQ0FBSCxFQUFvQztBQUNoQ0wsSUFBQUEsTUFBTSxDQUFDYSxPQUFQLEdBQWlCLDBCQUFqQjtBQUNIOztBQUNELFNBQU9iLE1BQVA7QUFDSCxDQVhNIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zZXJ2ZXIvc3JjL3V0aWxzLyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBzaWduVXBFcnJvcnMgPSAoZXJyKSA9PiB7XG4gICAgbGV0IGVycm9ycyA9IHtwc2V1ZG86ICcnLCBlbWFpbDogJycsIHBhc3N3b3JkOiAnJ31cbiAgICBcbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygncHNldWRvJykpe1xuICAgICAgICBlcnJvcnMucHNldWRvID0gXCJQc2V1ZG8gaW5jb3JyZWN0XCJcbiAgICB9XG4gICAgaWYoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ2VtYWlsJykpe1xuICAgICAgICBlcnJvcnMuZW1haWwgPSBcIkVtYWlsIGluY29ycmVjdFwiXG4gICAgfVxuICAgIGlmKGVyci5tZXNzYWdlLmluY2x1ZGVzKCdwYXNzd29yZCcpKXtcbiAgICAgICAgZXJyb3JzLnBhc3N3b3JkID0gXCJQYXNzd29yZCBpbmNvcnJlY3QgISBQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDYgY2hhcmFjdGVyc1wiXG4gICAgfVxuICAgIGlmKGVyci5jb2RlID09PSAxMTAwMCAmJiBPYmplY3Qua2V5cyhlcnIua2V5VmFsdWUpWzBdLmluY2x1ZGVzKCdwc2V1ZG8nKSl7XG4gICAgICAgIGVycm9ycy5wc2V1ZG8gPSBcIlBzZXVkbyBhbHJlYWR5IHVzZVwiXG4gICAgfVxuICAgIGlmKGVyci5jb2RlID09PSAxMTAwMCAmJiBPYmplY3Qua2V5cyhlcnIua2V5VmFsdWUpWzBdLmluY2x1ZGVzKCdlbWFpbCcpKXtcbiAgICAgICAgZXJyb3JzLmVtYWlsID0gXCJFbWFpbCBhbHJlYWR5IHVzZVwiXG4gICAgfVxuXG4gICAgcmV0dXJuIGVycm9yc1xufVxuXG5leHBvcnQgY29uc3Qgc2lnbkluRXJyb3JzID0gKGVycikgPT4ge1xuICAgIGxldCBlcnJvcnMgPSB7IGVtYWlsOiAnJywgcGFzc3dvcmQ6ICcnfVxuICAgIGlmKGVyci5tZXNzYWdlLmluY2x1ZGVzKCdlbWFpbCcpKXtcbiAgICAgICAgZXJyb3JzLmVtYWlsID0gXCJFbWFpbCBpbmNvbm51XCJcbiAgICB9XG4gICAgaWYoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ3Bhc3N3b3JkJykpe1xuICAgICAgICBlcnJvcnMucGFzc3dvcmQgPSBcIlZvcyBpZGVudGlmaWFudHMgc29udCBpbmNvcnJlY3RzICFcIlxuICAgIH1cbiAgICByZXR1cm4gZXJyb3JzXG59XG5cbmV4cG9ydCBjb25zdCB1cGxvYWRFcnJvcnMgPSAoZXJyKSA9PiB7XG4gICAgbGV0IGVycm9ycyA9IHtmb3JtYXQ6ICcnLCBtYXhTaXplOicnfVxuXG4gICAgaWYoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ2ludmFsaWQgZmlsZScpKXtcbiAgICAgICAgZXJyb3JzLmZvcm1hdCA9IFwiZm9ybWF0IGluY29tcGF0aWJsZVwiXG4gICAgfVxuXG4gICAgaWYoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ21heCBzaXplJykpe1xuICAgICAgICBlcnJvcnMubWF4U2l6ZSA9IFwiTGUgZmljaGllciBkw6lwYXNzZSA1MDBrb1wiXG4gICAgfVxuICAgIHJldHVybiBlcnJvcnM7XG59Il19","map":{"version":3,"sources":["errors.utils.js"],"names":["signUpErrors","err","errors","pseudo","email","password","message","includes","code","Object","keys","keyValue","signInErrors","uploadErrors","format","maxSize"],"mappings":";;;;;;;AAAO,MAAMA,YAAY,GAAIC,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAACC,IAAAA,MAAM,EAAE,EAAT;AAAaC,IAAAA,KAAK,EAAE,EAApB;AAAwBC,IAAAA,QAAQ,EAAE;AAAlC,GAAb;;AAEA,MAAGJ,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,QAArB,CAAH,EAAkC;AAC9BL,IAAAA,MAAM,CAACC,MAAP,GAAgB,kBAAhB;AACH;;AACD,MAAGF,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,OAArB,CAAH,EAAiC;AAC7BL,IAAAA,MAAM,CAACE,KAAP,GAAe,iBAAf;AACH;;AACD,MAAGH,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACG,QAAP,GAAkB,6DAAlB;AACH;;AACD,MAAGJ,GAAG,CAACO,IAAJ,KAAa,KAAb,IAAsBC,MAAM,CAACC,IAAP,CAAYT,GAAG,CAACU,QAAhB,EAA0B,CAA1B,EAA6BJ,QAA7B,CAAsC,QAAtC,CAAzB,EAAyE;AACrEL,IAAAA,MAAM,CAACC,MAAP,GAAgB,oBAAhB;AACH;;AACD,MAAGF,GAAG,CAACO,IAAJ,KAAa,KAAb,IAAsBC,MAAM,CAACC,IAAP,CAAYT,GAAG,CAACU,QAAhB,EAA0B,CAA1B,EAA6BJ,QAA7B,CAAsC,OAAtC,CAAzB,EAAwE;AACpEL,IAAAA,MAAM,CAACE,KAAP,GAAe,mBAAf;AACH;;AAED,SAAOF,MAAP;AACH,CApBM;;;;AAsBA,MAAMU,YAAY,GAAIX,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAAEE,IAAAA,KAAK,EAAE,EAAT;AAAaC,IAAAA,QAAQ,EAAE;AAAvB,GAAb;;AACA,MAAGJ,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,OAArB,CAAH,EAAiC;AAC7BL,IAAAA,MAAM,CAACE,KAAP,GAAe,eAAf;AACH;;AACD,MAAGH,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACG,QAAP,GAAkB,oCAAlB;AACH;;AACD,SAAOH,MAAP;AACH,CATM;;;;AAWA,MAAMW,YAAY,GAAIZ,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAACY,IAAAA,MAAM,EAAE,EAAT;AAAaC,IAAAA,OAAO,EAAC;AAArB,GAAb;;AAEA,MAAGd,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,cAArB,CAAH,EAAwC;AACpCL,IAAAA,MAAM,CAACY,MAAP,GAAgB,qBAAhB;AACH;;AAED,MAAGb,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACa,OAAP,GAAiB,0BAAjB;AACH;;AACD,SAAOb,MAAP;AACH,CAXM","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/utils/","sourcesContent":["export const signUpErrors = (err) => {\n    let errors = {pseudo: '', email: '', password: ''}\n    \n    if(err.message.includes('pseudo')){\n        errors.pseudo = \"Pseudo incorrect\"\n    }\n    if(err.message.includes('email')){\n        errors.email = \"Email incorrect\"\n    }\n    if(err.message.includes('password')){\n        errors.password = \"Password incorrect ! Password must be at least 6 characters\"\n    }\n    if(err.code === 11000 && Object.keys(err.keyValue)[0].includes('pseudo')){\n        errors.pseudo = \"Pseudo already use\"\n    }\n    if(err.code === 11000 && Object.keys(err.keyValue)[0].includes('email')){\n        errors.email = \"Email already use\"\n    }\n\n    return errors\n}\n\nexport const signInErrors = (err) => {\n    let errors = { email: '', password: ''}\n    if(err.message.includes('email')){\n        errors.email = \"Email inconnu\"\n    }\n    if(err.message.includes('password')){\n        errors.password = \"Vos identifiants sont incorrects !\"\n    }\n    return errors\n}\n\nexport const uploadErrors = (err) => {\n    let errors = {format: '', maxSize:''}\n\n    if(err.message.includes('invalid file')){\n        errors.format = \"format incompatible\"\n    }\n\n    if(err.message.includes('max size')){\n        errors.maxSize = \"Le fichier dépasse 500ko\"\n    }\n    return errors;\n}"]}},"mtime":1651327729166},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/models/user.model.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nconst {\n  isEmail\n} = require('validator');\n\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  pseudo: {\n    type: String,\n    required: true,\n    minlength: 3,\n    maxlength: 55,\n    unique: true,\n    trim: true\n  },\n  email: {\n    type: String,\n    required: true,\n    validate: [isEmail],\n    lowercase: true,\n    unique: true,\n    trim: true\n  },\n  password: {\n    type: String,\n    required: true,\n    max: 1024,\n    minlength: 6\n  },\n  picture: {\n    type: String,\n    default: \"./uploads/profil/random-user.png\"\n  },\n  bio: {\n    type: String,\n    max: 1024\n  },\n  followers: {\n    type: [String]\n  },\n  following: {\n    type: [String]\n  },\n  likes: {\n    type: [String]\n  }\n}, {\n  timestamps: true\n}); //play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\n\nUserSchema.pre('save', async function (next) {\n  const salt = await bcrypt.genSalt();\n  this.password = await bcrypt.hash(this.password, salt);\n  next();\n}); //c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\n\nUserSchema.statics.login = async function (email, password) {\n  const user = await this.findOne({\n    email: email\n  });\n\n  if (user) {\n    const auth = await bcrypt.compare(password, user.password);\n\n    if (auth) {\n      return user;\n    } else {\n      throw Error('Incorrect password');\n    }\n  }\n\n  throw Error('Incorrect password');\n};\n\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIubW9kZWwuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiaXNFbWFpbCIsImJjcnlwdCIsIlNjaGVtYSIsIlVzZXJTY2hlbWEiLCJwc2V1ZG8iLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJtaW5sZW5ndGgiLCJtYXhsZW5ndGgiLCJ1bmlxdWUiLCJ0cmltIiwiZW1haWwiLCJ2YWxpZGF0ZSIsImxvd2VyY2FzZSIsInBhc3N3b3JkIiwibWF4IiwicGljdHVyZSIsImRlZmF1bHQiLCJiaW8iLCJmb2xsb3dlcnMiLCJmb2xsb3dpbmciLCJsaWtlcyIsInRpbWVzdGFtcHMiLCJwcmUiLCJuZXh0Iiwic2FsdCIsImdlblNhbHQiLCJoYXNoIiwic3RhdGljcyIsImxvZ2luIiwidXNlciIsImZpbmRPbmUiLCJhdXRoIiwiY29tcGFyZSIsIkVycm9yIiwiVXNlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUNBLE1BQU07QUFBQ0MsRUFBQUE7QUFBRCxJQUFZRCxPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFDQSxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxRQUFELENBQXRCOztBQUVBLE1BQU1HLE1BQU0sR0FBR0osUUFBUSxDQUFDSSxNQUF4QjtBQUNBLE1BQU1DLFVBQVUsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDMUJFLEVBQUFBLE1BQU0sRUFBRTtBQUNKQyxJQUFBQSxJQUFJLEVBQUVDLE1BREY7QUFFSkMsSUFBQUEsUUFBUSxFQUFDLElBRkw7QUFHSkMsSUFBQUEsU0FBUyxFQUFFLENBSFA7QUFJSkMsSUFBQUEsU0FBUyxFQUFDLEVBSk47QUFLSkMsSUFBQUEsTUFBTSxFQUFDLElBTEg7QUFNSkMsSUFBQUEsSUFBSSxFQUFDO0FBTkQsR0FEa0I7QUFTMUJDLEVBQUFBLEtBQUssRUFBQztBQUNGUCxJQUFBQSxJQUFJLEVBQUNDLE1BREg7QUFFRkMsSUFBQUEsUUFBUSxFQUFDLElBRlA7QUFHRk0sSUFBQUEsUUFBUSxFQUFDLENBQUNiLE9BQUQsQ0FIUDtBQUlGYyxJQUFBQSxTQUFTLEVBQUMsSUFKUjtBQUtGSixJQUFBQSxNQUFNLEVBQUMsSUFMTDtBQU1GQyxJQUFBQSxJQUFJLEVBQUM7QUFOSCxHQVRvQjtBQWlCMUJJLEVBQUFBLFFBQVEsRUFBQztBQUNMVixJQUFBQSxJQUFJLEVBQUNDLE1BREE7QUFFTEMsSUFBQUEsUUFBUSxFQUFDLElBRko7QUFHTFMsSUFBQUEsR0FBRyxFQUFDLElBSEM7QUFJTFIsSUFBQUEsU0FBUyxFQUFDO0FBSkwsR0FqQmlCO0FBdUIxQlMsRUFBQUEsT0FBTyxFQUFDO0FBQ0paLElBQUFBLElBQUksRUFBQ0MsTUFERDtBQUVKWSxJQUFBQSxPQUFPLEVBQUM7QUFGSixHQXZCa0I7QUEyQjFCQyxFQUFBQSxHQUFHLEVBQUM7QUFDQWQsSUFBQUEsSUFBSSxFQUFDQyxNQURMO0FBRUFVLElBQUFBLEdBQUcsRUFBQztBQUZKLEdBM0JzQjtBQStCMUJJLEVBQUFBLFNBQVMsRUFBRTtBQUNQZixJQUFBQSxJQUFJLEVBQUMsQ0FBQ0MsTUFBRDtBQURFLEdBL0JlO0FBa0MxQmUsRUFBQUEsU0FBUyxFQUFDO0FBQ05oQixJQUFBQSxJQUFJLEVBQUMsQ0FBQ0MsTUFBRDtBQURDLEdBbENnQjtBQXFDMUJnQixFQUFBQSxLQUFLLEVBQUU7QUFDSGpCLElBQUFBLElBQUksRUFBQyxDQUFDQyxNQUFEO0FBREY7QUFyQ21CLENBQVgsRUF3Q2hCO0FBQ0NpQixFQUFBQSxVQUFVLEVBQUM7QUFEWixDQXhDZ0IsQ0FBbkIsQyxDQTZDQTtBQUNBOztBQUNBcEIsVUFBVSxDQUFDcUIsR0FBWCxDQUFlLE1BQWYsRUFBdUIsZ0JBQWdCQyxJQUFoQixFQUFxQjtBQUN4QyxRQUFNQyxJQUFJLEdBQUcsTUFBTXpCLE1BQU0sQ0FBQzBCLE9BQVAsRUFBbkI7QUFDQSxPQUFLWixRQUFMLEdBQWdCLE1BQU1kLE1BQU0sQ0FBQzJCLElBQVAsQ0FBWSxLQUFLYixRQUFqQixFQUEyQlcsSUFBM0IsQ0FBdEI7QUFDQUQsRUFBQUEsSUFBSTtBQUNQLENBSkQsRSxDQU1BOztBQUNBdEIsVUFBVSxDQUFDMEIsT0FBWCxDQUFtQkMsS0FBbkIsR0FBMkIsZ0JBQWVsQixLQUFmLEVBQXNCRyxRQUF0QixFQUErQjtBQUN0RCxRQUFNZ0IsSUFBSSxHQUFHLE1BQU0sS0FBS0MsT0FBTCxDQUFhO0FBQUNwQixJQUFBQSxLQUFLLEVBQUVBO0FBQVIsR0FBYixDQUFuQjs7QUFDQSxNQUFHbUIsSUFBSCxFQUFRO0FBQ0osVUFBTUUsSUFBSSxHQUFHLE1BQU1oQyxNQUFNLENBQUNpQyxPQUFQLENBQWVuQixRQUFmLEVBQXlCZ0IsSUFBSSxDQUFDaEIsUUFBOUIsQ0FBbkI7O0FBQ0EsUUFBR2tCLElBQUgsRUFBUTtBQUNKLGFBQU9GLElBQVA7QUFDSCxLQUZELE1BR0k7QUFDQSxZQUFNSSxLQUFLLENBQUMsb0JBQUQsQ0FBWDtBQUNIO0FBQ0o7O0FBQ0QsUUFBTUEsS0FBSyxDQUFDLG9CQUFELENBQVg7QUFDSCxDQVpEOztBQWFBLElBQUlDLElBQUksR0FBR3RDLFFBQVEsQ0FBQ3VDLEtBQVQsQ0FBZSxNQUFmLEVBQXVCbEMsVUFBdkIsQ0FBWDtBQUNBbUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCSCxJQUFqQiIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc2VydmVyL3NyYy9tb2RlbHMvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuY29uc3Qge2lzRW1haWx9ID0gcmVxdWlyZSgndmFsaWRhdG9yJyk7XG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKTtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgVXNlclNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHBzZXVkbzoge1xuICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXG4gICAgICAgIG1pbmxlbmd0aDogMywgXG4gICAgICAgIG1heGxlbmd0aDo1NSwgXG4gICAgICAgIHVuaXF1ZTp0cnVlLFxuICAgICAgICB0cmltOnRydWVcbiAgICB9LFxuICAgIGVtYWlsOntcbiAgICAgICAgdHlwZTpTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXG4gICAgICAgIHZhbGlkYXRlOltpc0VtYWlsXSxcbiAgICAgICAgbG93ZXJjYXNlOnRydWUsICAgICAgICBcbiAgICAgICAgdW5pcXVlOnRydWUsXG4gICAgICAgIHRyaW06dHJ1ZSxcbiAgICB9LFxuICAgIHBhc3N3b3JkOntcbiAgICAgICAgdHlwZTpTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOnRydWUsXG4gICAgICAgIG1heDoxMDI0LFxuICAgICAgICBtaW5sZW5ndGg6NlxuICAgIH0sXG4gICAgcGljdHVyZTp7XG4gICAgICAgIHR5cGU6U3RyaW5nLFxuICAgICAgICBkZWZhdWx0OlwiLi91cGxvYWRzL3Byb2ZpbC9yYW5kb20tdXNlci5wbmdcIlxuICAgIH0sXG4gICAgYmlvOntcbiAgICAgICAgdHlwZTpTdHJpbmcsXG4gICAgICAgIG1heDoxMDI0XG4gICAgfSxcbiAgICBmb2xsb3dlcnM6IHtcbiAgICAgICAgdHlwZTpbU3RyaW5nXSxcbiAgICB9LFxuICAgIGZvbGxvd2luZzp7XG4gICAgICAgIHR5cGU6W1N0cmluZ10sXG4gICAgfSxcbiAgICBsaWtlczoge1xuICAgICAgICB0eXBlOltTdHJpbmddLFxuICAgIH1cbn0sIHtcbiAgICB0aW1lc3RhbXBzOnRydWVcbn1cbik7XG5cbi8vcGxheSBmdW5jdGlvbiBiZWZvcmUgc2F2ZSBpbnRvIGRiIHRvIGFsbG93IGNyeXB0IHBhc3N3b3JkXG4vLyBsZSBuZXh0IHZldXQgZGlyZSBxdWFuZCB0J2EgZmluaSBwYXNzZSDDoCBsYSBzdWl0ZVxuVXNlclNjaGVtYS5wcmUoJ3NhdmUnLCBhc3luYyBmdW5jdGlvbiAobmV4dCl7XG4gICAgY29uc3Qgc2FsdCA9IGF3YWl0IGJjcnlwdC5nZW5TYWx0KCk7XG4gICAgdGhpcy5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHRoaXMucGFzc3dvcmQsIHNhbHQpO1xuICAgIG5leHQoKTtcbn0pXG5cbi8vYydlc3QgY2UgcXVpIHZhIG5vdXMgcGVybWV0dHJlIGRlIGNvbXBhcmVyIGxlIHBhc3N3b3JkIGNyeXB0w6kgZGUgbm90cmUgdXNlciBlbiBiYXNlIGRlIGRvbm7DqWVzIGF2ZWMgY2VsdWkgdXRpbGlzZSBwZHQgbGUgbG9naW4gZCd1biB1c2VyXG5Vc2VyU2NoZW1hLnN0YXRpY3MubG9naW4gPSBhc3luYyBmdW5jdGlvbihlbWFpbCwgcGFzc3dvcmQpe1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB0aGlzLmZpbmRPbmUoe2VtYWlsOiBlbWFpbH0pO1xuICAgIGlmKHVzZXIpe1xuICAgICAgICBjb25zdCBhdXRoID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpXG4gICAgICAgIGlmKGF1dGgpe1xuICAgICAgICAgICAgcmV0dXJuIHVzZXJcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ0luY29ycmVjdCBwYXNzd29yZCcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRocm93IEVycm9yKCdJbmNvcnJlY3QgcGFzc3dvcmQnKTtcbn1cbmxldCBVc2VyID0gbW9uZ29vc2UubW9kZWwoJ1VzZXInLCBVc2VyU2NoZW1hKTtcbm1vZHVsZS5leHBvcnRzID0gVXNlcjsiXX0=","map":{"version":3,"sources":["user.model.js"],"names":["mongoose","require","isEmail","bcrypt","Schema","UserSchema","pseudo","type","String","required","minlength","maxlength","unique","trim","email","validate","lowercase","password","max","picture","default","bio","followers","following","likes","timestamps","pre","next","salt","genSalt","hash","statics","login","user","findOne","auth","compare","Error","User","model","module","exports"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAM;AAACC,EAAAA;AAAD,IAAYD,OAAO,CAAC,WAAD,CAAzB;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,QAAD,CAAtB;;AAEA,MAAMG,MAAM,GAAGJ,QAAQ,CAACI,MAAxB;AACA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CAAW;AAC1BE,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAEC,MADF;AAEJC,IAAAA,QAAQ,EAAC,IAFL;AAGJC,IAAAA,SAAS,EAAE,CAHP;AAIJC,IAAAA,SAAS,EAAC,EAJN;AAKJC,IAAAA,MAAM,EAAC,IALH;AAMJC,IAAAA,IAAI,EAAC;AAND,GADkB;AAS1BC,EAAAA,KAAK,EAAC;AACFP,IAAAA,IAAI,EAACC,MADH;AAEFC,IAAAA,QAAQ,EAAC,IAFP;AAGFM,IAAAA,QAAQ,EAAC,CAACb,OAAD,CAHP;AAIFc,IAAAA,SAAS,EAAC,IAJR;AAKFJ,IAAAA,MAAM,EAAC,IALL;AAMFC,IAAAA,IAAI,EAAC;AANH,GAToB;AAiB1BI,EAAAA,QAAQ,EAAC;AACLV,IAAAA,IAAI,EAACC,MADA;AAELC,IAAAA,QAAQ,EAAC,IAFJ;AAGLS,IAAAA,GAAG,EAAC,IAHC;AAILR,IAAAA,SAAS,EAAC;AAJL,GAjBiB;AAuB1BS,EAAAA,OAAO,EAAC;AACJZ,IAAAA,IAAI,EAACC,MADD;AAEJY,IAAAA,OAAO,EAAC;AAFJ,GAvBkB;AA2B1BC,EAAAA,GAAG,EAAC;AACAd,IAAAA,IAAI,EAACC,MADL;AAEAU,IAAAA,GAAG,EAAC;AAFJ,GA3BsB;AA+B1BI,EAAAA,SAAS,EAAE;AACPf,IAAAA,IAAI,EAAC,CAACC,MAAD;AADE,GA/Be;AAkC1Be,EAAAA,SAAS,EAAC;AACNhB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADC,GAlCgB;AAqC1BgB,EAAAA,KAAK,EAAE;AACHjB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADF;AArCmB,CAAX,EAwChB;AACCiB,EAAAA,UAAU,EAAC;AADZ,CAxCgB,CAAnB,C,CA6CA;AACA;;AACApB,UAAU,CAACqB,GAAX,CAAe,MAAf,EAAuB,gBAAgBC,IAAhB,EAAqB;AACxC,QAAMC,IAAI,GAAG,MAAMzB,MAAM,CAAC0B,OAAP,EAAnB;AACA,OAAKZ,QAAL,GAAgB,MAAMd,MAAM,CAAC2B,IAAP,CAAY,KAAKb,QAAjB,EAA2BW,IAA3B,CAAtB;AACAD,EAAAA,IAAI;AACP,CAJD,E,CAMA;;AACAtB,UAAU,CAAC0B,OAAX,CAAmBC,KAAnB,GAA2B,gBAAelB,KAAf,EAAsBG,QAAtB,EAA+B;AACtD,QAAMgB,IAAI,GAAG,MAAM,KAAKC,OAAL,CAAa;AAACpB,IAAAA,KAAK,EAAEA;AAAR,GAAb,CAAnB;;AACA,MAAGmB,IAAH,EAAQ;AACJ,UAAME,IAAI,GAAG,MAAMhC,MAAM,CAACiC,OAAP,CAAenB,QAAf,EAAyBgB,IAAI,CAAChB,QAA9B,CAAnB;;AACA,QAAGkB,IAAH,EAAQ;AACJ,aAAOF,IAAP;AACH,KAFD,MAGI;AACA,YAAMI,KAAK,CAAC,oBAAD,CAAX;AACH;AACJ;;AACD,QAAMA,KAAK,CAAC,oBAAD,CAAX;AACH,CAZD;;AAaA,IAAIC,IAAI,GAAGtC,QAAQ,CAACuC,KAAT,CAAe,MAAf,EAAuBlC,UAAvB,CAAX;AACAmC,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/models/","sourcesContent":["const mongoose = require('mongoose');\nconst {isEmail} = require('validator');\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n    pseudo: {\n        type: String,\n        required:true,\n        minlength: 3, \n        maxlength:55, \n        unique:true,\n        trim:true\n    },\n    email:{\n        type:String,\n        required:true,\n        validate:[isEmail],\n        lowercase:true,        \n        unique:true,\n        trim:true,\n    },\n    password:{\n        type:String,\n        required:true,\n        max:1024,\n        minlength:6\n    },\n    picture:{\n        type:String,\n        default:\"./uploads/profil/random-user.png\"\n    },\n    bio:{\n        type:String,\n        max:1024\n    },\n    followers: {\n        type:[String],\n    },\n    following:{\n        type:[String],\n    },\n    likes: {\n        type:[String],\n    }\n}, {\n    timestamps:true\n}\n);\n\n//play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\nUserSchema.pre('save', async function (next){\n    const salt = await bcrypt.genSalt();\n    this.password = await bcrypt.hash(this.password, salt);\n    next();\n})\n\n//c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\nUserSchema.statics.login = async function(email, password){\n    const user = await this.findOne({email: email});\n    if(user){\n        const auth = await bcrypt.compare(password, user.password)\n        if(auth){\n            return user\n        }\n        else{\n            throw Error('Incorrect password');\n        }\n    }\n    throw Error('Incorrect password');\n}\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;"]}},"mtime":1651374997096},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/controllers/user.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updateUser = exports.unfollow = exports.getUserInfo = exports.getAllUsers = exports.follow = exports.deleteUser = void 0;\n\nconst User = require('../models/user.model');\n\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\nconst getAllUsers = async (req, res) => {\n  //allow to receive all users without password\n  const users = await User.find().select('-password');\n  res.status(200).json(users);\n};\n\nexports.getAllUsers = getAllUsers;\n\nconst getUserInfo = async (req, res) => {\n  //if id exist in databse\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.findById(req.params.id).select('-password').then(user => {\n    res.status(200).json(user);\n  }).catch(err => {\n    console.log(err);\n  });\n};\n\nexports.getUserInfo = getUserInfo;\n\nconst updateUser = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.findOneAndUpdate({\n    _id: req.params.id\n  }, {\n    $set: {\n      bio: req.body.bio\n    }\n  }, {\n    new: true,\n    upsert: true,\n    setDefaultsOnInsert: true\n  }).select('-password').then(user => {\n    res.status(200).json(user);\n  }).catch(err => {\n    res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.updateUser = updateUser;\n\nconst deleteUser = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.remove({\n    _id: req.params.id\n  }).exec().then(() => {\n    res.status(200).json({\n      message: 'Successfully deleted !'\n    });\n  }).catch(err => {\n    res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.deleteUser = deleteUser;\n\nconst follow = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  if (!ObjectID.isValid(req.body.idToFollow)) {\n    return res.status(400).send(`Id unknown : ${req.body.idToFollow}`);\n  } //add to the follower list\n\n\n  await User.findByIdAndUpdate(req.params.id, {\n    $addToSet: {\n      following: req.body.idToFollow\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {\n    res.status(201).json(user);\n  }).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  }); //add to the following list\n\n  await User.findByIdAndUpdate(req.body.idToFollow, {\n    $addToSet: {\n      followers: req.params.id\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {}).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.follow = follow;\n\nconst unfollow = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  if (!ObjectID.isValid(req.body.idToUnFollow)) {\n    return res.status(400).send(`Id unknown : ${req.body.idToUnFollow}`);\n  } //delete to the follower list\n\n\n  await User.findByIdAndUpdate(req.params.id, {\n    $pull: {\n      following: req.body.idToUnFollow\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {\n    res.status(201).json(user);\n  }).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  }); //delete to the following list\n\n  await User.findByIdAndUpdate(req.body.idToUnFollow, {\n    $pull: {\n      followers: req.params.id\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {}).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.unfollow = unfollow;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsIk9iamVjdElEIiwiVHlwZXMiLCJPYmplY3RJZCIsImdldEFsbFVzZXJzIiwicmVxIiwicmVzIiwidXNlcnMiLCJmaW5kIiwic2VsZWN0Iiwic3RhdHVzIiwianNvbiIsImdldFVzZXJJbmZvIiwiaXNWYWxpZCIsInBhcmFtcyIsImlkIiwic2VuZCIsImZpbmRCeUlkIiwidGhlbiIsInVzZXIiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVVc2VyIiwiZmluZE9uZUFuZFVwZGF0ZSIsIl9pZCIsIiRzZXQiLCJiaW8iLCJib2R5IiwibmV3IiwidXBzZXJ0Iiwic2V0RGVmYXVsdHNPbkluc2VydCIsIm1lc3NhZ2UiLCJkZWxldGVVc2VyIiwicmVtb3ZlIiwiZXhlYyIsImZvbGxvdyIsImlkVG9Gb2xsb3ciLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIiRhZGRUb1NldCIsImZvbGxvd2luZyIsImZvbGxvd2VycyIsInVuZm9sbG93IiwiaWRUb1VuRm9sbG93IiwiJHB1bGwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFDQSxNQUFNQyxRQUFRLEdBQUdELE9BQU8sQ0FBQyxVQUFELENBQVAsQ0FBb0JFLEtBQXBCLENBQTBCQyxRQUEzQzs7QUFHTyxNQUFNQyxXQUFXLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEtBQW9CO0FBQzNDO0FBQ0EsUUFBTUMsS0FBSyxHQUFHLE1BQU1SLElBQUksQ0FBQ1MsSUFBTCxHQUFZQyxNQUFaLENBQW1CLFdBQW5CLENBQXBCO0FBQ0FILEVBQUFBLEdBQUcsQ0FDRUksTUFETCxDQUNZLEdBRFosRUFFS0MsSUFGTCxDQUVVSixLQUZWO0FBR0gsQ0FOTTs7OztBQVFBLE1BQU1LLFdBQVcsR0FBRyxPQUFPUCxHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFD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QyxDQUFOO0FBVUgsQ0E1Qk0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NlcnZlci9zcmMvY29udHJvbGxlcnMvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy91c2VyLm1vZGVsJylcbmNvbnN0IE9iamVjdElEID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpLlR5cGVzLk9iamVjdElkO1xuXG5cbmV4cG9ydCBjb25zdCBnZXRBbGxVc2VycyA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIC8vYWxsb3cgdG8gcmVjZWl2ZSBhbGwgdXNlcnMgd2l0aG91dCBwYXNzd29yZFxuICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgVXNlci5maW5kKCkuc2VsZWN0KCctcGFzc3dvcmQnKTtcbiAgICByZXNcbiAgICAgICAgLnN0YXR1cygyMDApXG4gICAgICAgIC5qc29uKHVzZXJzKVxufVxuXG5leHBvcnQgY29uc3QgZ2V0VXNlckluZm8gPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAvL2lmIGlkIGV4aXN0IGluIGRhdGFic2VcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEucGFyYW1zLmlkfWApXG4gICAgfVxuICAgIGF3YWl0IFVzZXIuZmluZEJ5SWQocmVxLnBhcmFtcy5pZCkuc2VsZWN0KCctcGFzc3dvcmQnKVxuICAgICAgICAudGhlbigodXNlcikgPT4ge1xuICAgICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24odXNlcilcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICAgfSlcbn1cblxuZXhwb3J0IGNvbnN0IHVwZGF0ZVVzZXIgPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEucGFyYW1zLmlkfWApXG4gICAgfVxuICAgIGF3YWl0IFVzZXIuZmluZE9uZUFuZFVwZGF0ZShcbiAgICAgICAgeyBfaWQ6IHJlcS5wYXJhbXMuaWQgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgJHNldDoge1xuICAgICAgICAgICAgICAgIGJpbzogcmVxLmJvZHkuYmlvXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5ldzogdHJ1ZSxcbiAgICAgICAgICAgIHVwc2VydDogdHJ1ZSxcbiAgICAgICAgICAgIHNldERlZmF1bHRzT25JbnNlcnQ6IHRydWVcbiAgICAgICAgfSkuc2VsZWN0KCctcGFzc3dvcmQnKS50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih1c2VyKVxuICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IGVyciB9KVxuICAgICAgICB9KVxufVxuXG5leHBvcnQgY29uc3QgZGVsZXRlVXNlciA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgYXdhaXQgVXNlci5yZW1vdmUoe1xuICAgICAgICBfaWQ6IHJlcS5wYXJhbXMuaWRcbiAgICB9KS5leGVjKClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHttZXNzYWdlOiAnU3VjY2Vzc2Z1bGx5IGRlbGV0ZWQgISd9KVxuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe21lc3NhZ2U6ZXJyfSlcbiAgICB9KVxufVxuZXhwb3J0IGNvbnN0IGZvbGxvdyA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSApIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEucGFyYW1zLmlkfWApXG4gICAgfVxuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEuYm9keS5pZFRvRm9sbG93KSApIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEuYm9keS5pZFRvRm9sbG93fWApXG4gICAgfVxuICAgIC8vYWRkIHRvIHRoZSBmb2xsb3dlciBsaXN0XG4gICAgYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShyZXEucGFyYW1zLmlkLCBcbiAgICAgICAgeyAkYWRkVG9TZXQgOiB7IGZvbGxvd2luZzogcmVxLmJvZHkuaWRUb0ZvbGxvd319LFxuICAgICAgICB7bmV3IDogdHJ1ZSwgdXBzZXJ0OnRydWV9KVxuICAgICAgICAudGhlbigodXNlcikgPT4ge1xuICAgICAgICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24odXNlcilcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7bWVzc2FnZTplcnJ9KVxuICAgICAgICB9KVxuICAgIC8vYWRkIHRvIHRoZSBmb2xsb3dpbmcgbGlzdFxuICAgIGF3YWl0IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUocmVxLmJvZHkuaWRUb0ZvbGxvdyxcbiAgICAgICAgeyAkYWRkVG9TZXQgOiB7IGZvbGxvd2VyczogcmVxLnBhcmFtcy5pZH19LFxuICAgICAgICB7bmV3IDogdHJ1ZSwgdXBzZXJ0OnRydWV9KVxuICAgICAgICAudGhlbigodXNlcikgPT4ge1xuXG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe21lc3NhZ2U6ZXJyfSlcbiAgICAgICAgfSlcblxufVxuZXhwb3J0IGNvbnN0IHVuZm9sbG93ID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpICkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5ib2R5LmlkVG9VbkZvbGxvdykgKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLmJvZHkuaWRUb1VuRm9sbG93fWApXG4gICAgfVxuICAgICAvL2RlbGV0ZSB0byB0aGUgZm9sbG93ZXIgbGlzdFxuICAgICBhd2FpdCBVc2VyLmZpbmRCeUlkQW5kVXBkYXRlKHJlcS5wYXJhbXMuaWQsIFxuICAgICAgICB7ICRwdWxsIDogeyBmb2xsb3dpbmc6IHJlcS5ib2R5LmlkVG9VbkZvbGxvd319LFxuICAgICAgICB7bmV3IDogdHJ1ZSwgdXBzZXJ0OnRydWV9KVxuICAgICAgICAudGhlbigodXNlcikgPT4ge1xuICAgICAgICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24odXNlcilcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7bWVzc2FnZTplcnJ9KVxuICAgICAgICB9KVxuICAgIC8vZGVsZXRlIHRvIHRoZSBmb2xsb3dpbmcgbGlzdFxuICAgIGF3YWl0IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUocmVxLmJvZHkuaWRUb1VuRm9sbG93LFxuICAgICAgICB7ICRwdWxsIDogeyBmb2xsb3dlcnM6IHJlcS5wYXJhbXMuaWR9fSxcbiAgICAgICAge25ldyA6IHRydWUsIHVwc2VydDp0cnVlfSlcbiAgICAgICAgLnRoZW4oKHVzZXIpID0+IHtcblxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHttZXNzYWdlOmVycn0pXG4gICAgICAgIH0pXG5cbn0iXX0=","map":{"version":3,"sources":["user.controller.js"],"names":["User","require","ObjectID","Types","ObjectId","getAllUsers","req","res","users","find","select","status","json","getUserInfo","isValid","params","id","send","findById","then","user","catch","err","console","log","updateUser","findOneAndUpdate","_id","$set","bio","body","new","upsert","setDefaultsOnInsert","message","deleteUser","remove","exec","follow","idToFollow","findByIdAndUpdate","$addToSet","following","followers","unfollow","idToUnFollow","$pull"],"mappings":"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","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/controllers/","sourcesContent":["const User = require('../models/user.model')\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\n\nexport const getAllUsers = async (req, res) => {\n    //allow to receive all users without password\n    const users = await User.find().select('-password');\n    res\n        .status(200)\n        .json(users)\n}\n\nexport const getUserInfo = async (req, res) => {\n    //if id exist in databse\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.findById(req.params.id).select('-password')\n        .then((user) => {\n            res.status(200).json(user)\n        })\n        .catch((err) => {\n            console.log(err)\n        })\n}\n\nexport const updateUser = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.findOneAndUpdate(\n        { _id: req.params.id },\n        {\n            $set: {\n                bio: req.body.bio\n            }\n        },\n        {\n            new: true,\n            upsert: true,\n            setDefaultsOnInsert: true\n        }).select('-password').then((user) => {\n            res.status(200).json(user)\n        }).catch((err) => {\n            res.status(500).json({ message: err })\n        })\n}\n\nexport const deleteUser = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.remove({\n        _id: req.params.id\n    }).exec()\n    .then(() => {\n        res.status(200).json({message: 'Successfully deleted !'})\n    })\n    .catch((err) => {\n        res.status(500).json({message:err})\n    })\n}\nexport const follow = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id) ) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    if (!ObjectID.isValid(req.body.idToFollow) ) {\n        return res.status(400).send(`Id unknown : ${req.body.idToFollow}`)\n    }\n    //add to the follower list\n    await User.findByIdAndUpdate(req.params.id, \n        { $addToSet : { following: req.body.idToFollow}},\n        {new : true, upsert:true})\n        .then((user) => {\n            res.status(201).json(user)\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n    //add to the following list\n    await User.findByIdAndUpdate(req.body.idToFollow,\n        { $addToSet : { followers: req.params.id}},\n        {new : true, upsert:true})\n        .then((user) => {\n\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n\n}\nexport const unfollow = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id) ) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    if (!ObjectID.isValid(req.body.idToUnFollow) ) {\n        return res.status(400).send(`Id unknown : ${req.body.idToUnFollow}`)\n    }\n     //delete to the follower list\n     await User.findByIdAndUpdate(req.params.id, \n        { $pull : { following: req.body.idToUnFollow}},\n        {new : true, upsert:true})\n        .then((user) => {\n            res.status(201).json(user)\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n    //delete to the following list\n    await User.findByIdAndUpdate(req.body.idToUnFollow,\n        { $pull : { followers: req.params.id}},\n        {new : true, upsert:true})\n        .then((user) => {\n\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n\n}"]}},"mtime":1651585436195},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/controllers/upload.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.uploadProfil = void 0;\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst User = require('../models/user.model');\n\nconst uploadProfil = async (req, res) => {\n  try {\n    if (req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\") {\n      throw new Error('invalid file');\n    }\n\n    if (req.file.size > 5000000) {\n      throw new Error('max size');\n    }\n  } catch (err) {\n    const errors = (0, _errors.uploadErrors)(err);\n    return res.status(201).json({\n      errors\n    });\n  }\n\n  try {\n    await User.findByIdAndUpdate(req.body.userId, {\n      $set: {\n        picture: `http://localhost:8080/uploads/profils/${req.file.filename}`\n      }\n    }, {\n      new: true,\n      upsert: true,\n      setDefaultsOnInsert: true\n    }).then(user => {\n      return res.send(user);\n    }).catch(err => {\n      return res.status(500).send(err);\n    });\n  } catch (err) {\n    return res.status(500).send(err);\n  }\n};\n\nexports.uploadProfil = uploadProfil;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwbG9hZC5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlVzZXIiLCJyZXF1aXJlIiwidXBsb2FkUHJvZmlsIiwicmVxIiwicmVzIiwiZmlsZSIsIm1pbWV0eXBlIiwiRXJyb3IiLCJzaXplIiwiZXJyIiwiZXJyb3JzIiwic3RhdHVzIiwianNvbiIsImZpbmRCeUlkQW5kVXBkYXRlIiwiYm9keSIsInVzZXJJZCIsIiRzZXQiLCJwaWN0dXJlIiwiZmlsZW5hbWUiLCJuZXciLCJ1cHNlcnQiLCJzZXREZWZhdWx0c09uSW5zZXJ0IiwidGhlbiIsInVzZXIiLCJzZW5kIiwiY2F0Y2giXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7QUFEQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFHTyxNQUFNQyxZQUFZLEdBQUcsT0FBTUMsR0FBTixFQUFXQyxHQUFYLEtBQW1CO0FBQzNDLE1BQUc7QUFDQyxRQUFHRCxHQUFHLENBQUNFLElBQUosQ0FBU0MsUUFBVCxJQUFxQixXQUFyQixJQUFvQ0gsR0FBRyxDQUFDRSxJQUFKLENBQVNDLFFBQVQsSUFBcUIsV0FBekQsSUFBd0VILEdBQUcsQ0FBQ0UsSUFBSixDQUFTQyxRQUFULElBQXFCLFlBQWhHLEVBQTZHO0FBQ3pHLFlBQU0sSUFBSUMsS0FBSixDQUFVLGNBQVYsQ0FBTjtBQUNIOztBQUNELFFBQUdKLEdBQUcsQ0FBQ0UsSUFBSixDQUFTRyxJQUFULEdBQWdCLE9BQW5CLEVBQTJCO0FBQ3ZCLFlBQU0sSUFBSUQsS0FBSixDQUFVLFVBQVYsQ0FBTjtBQUNIO0FBQ0osR0FQRCxDQVFBLE9BQU1FLEdBQU4sRUFBVTtBQUNOLFVBQU1DLE1BQU0sR0FBRywwQkFBYUQsR0FBYixDQUFmO0FBQ0EsV0FBT0wsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBQ0YsTUFBQUE7QUFBRCxLQUFyQixDQUFQO0FBQ0g7O0FBQ0QsTUFBRztBQUNNLFVBQU1WLElBQUksQ0FBQ2EsaUJBQUwsQ0FDUFYsR0FBRyxDQUFDVyxJQUFKLENBQVNDLE1BREYsRUFFUDtBQUNJQyxNQUFBQSxJQUFJLEVBQUc7QUFBRUMsUUFBQUEsT0FBTyxFQUFHLHlDQUF3Q2QsR0FBRyxDQUFDRSxJQUFKLENBQVNhLFFBQVM7QUFBdEU7QUFEWCxLQUZPLEVBS1A7QUFBQ0MsTUFBQUEsR0FBRyxFQUFDLElBQUw7QUFBV0MsTUFBQUEsTUFBTSxFQUFDLElBQWxCO0FBQXdCQyxNQUFBQSxtQkFBbUIsRUFBQztBQUE1QyxLQUxPLEVBTUxDLElBTkssQ0FNQ0MsSUFBRCxJQUFVO0FBQ2IsYUFBT25CLEdBQUcsQ0FBQ29CLElBQUosQ0FBU0QsSUFBVCxDQUFQO0FBQ0gsS0FSTSxFQVFKRSxLQVJJLENBUUdoQixHQUFELElBQVM7QUFDZCxhQUFPTCxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCYSxJQUFoQixDQUFxQmYsR0FBckIsQ0FBUDtBQUNILEtBVk0sQ0FBTjtBQVdSLEdBWkQsQ0FhQSxPQUFNQSxHQUFOLEVBQVU7QUFDTixXQUFPTCxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCYSxJQUFoQixDQUFxQmYsR0FBckIsQ0FBUDtBQUNIO0FBRUosQ0E5Qk0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NlcnZlci9zcmMvY29udHJvbGxlcnMvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy91c2VyLm1vZGVsJylcbmltcG9ydCB7IHVwbG9hZEVycm9yc30gZnJvbSAnLi4vdXRpbHMvZXJyb3JzLnV0aWxzJ1xuXG5leHBvcnQgY29uc3QgdXBsb2FkUHJvZmlsID0gYXN5bmMocmVxLCByZXMpID0+IHtcbiAgICB0cnl7XG4gICAgICAgIGlmKHJlcS5maWxlLm1pbWV0eXBlICE9IFwiaW1hZ2UvanBnXCIgJiYgcmVxLmZpbGUubWltZXR5cGUgIT0gXCJpbWFnZS9wbmdcIiAmJiByZXEuZmlsZS5taW1ldHlwZSAhPSBcImltYWdlL2pwZWdcIil7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgZmlsZScpXG4gICAgICAgIH1cbiAgICAgICAgaWYocmVxLmZpbGUuc2l6ZSA+IDUwMDAwMDApe1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdtYXggc2l6ZScpXG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2goZXJyKXtcbiAgICAgICAgY29uc3QgZXJyb3JzID0gdXBsb2FkRXJyb3JzKGVycik7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMSkuanNvbih7ZXJyb3JzfSlcbiAgICB9XG4gICAgdHJ5e1xuICAgICAgICAgICAgIGF3YWl0IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICByZXEuYm9keS51c2VySWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJHNldCA6IHsgcGljdHVyZTogYGh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC91cGxvYWRzL3Byb2ZpbHMvJHtyZXEuZmlsZS5maWxlbmFtZX1gIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7bmV3OnRydWUsIHVwc2VydDp0cnVlLCBzZXREZWZhdWx0c09uSW5zZXJ0OnRydWV9XG4gICAgICAgICAgICApLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnNlbmQodXNlcilcbiAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoZXJyKVxuICAgICAgICAgICAgfSlcbiAgICB9XG4gICAgY2F0Y2goZXJyKXtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKGVycilcbiAgICB9XG4gICAgXG59XG5cbiJdfQ==","map":{"version":3,"sources":["upload.controller.js"],"names":["User","require","uploadProfil","req","res","file","mimetype","Error","size","err","errors","status","json","findByIdAndUpdate","body","userId","$set","picture","filename","new","upsert","setDefaultsOnInsert","then","user","send","catch"],"mappings":";;;;;;;AACA;;AADA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AAGO,MAAMC,YAAY,GAAG,OAAMC,GAAN,EAAWC,GAAX,KAAmB;AAC3C,MAAG;AACC,QAAGD,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,WAArB,IAAoCH,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,WAAzD,IAAwEH,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,YAAhG,EAA6G;AACzG,YAAM,IAAIC,KAAJ,CAAU,cAAV,CAAN;AACH;;AACD,QAAGJ,GAAG,CAACE,IAAJ,CAASG,IAAT,GAAgB,OAAnB,EAA2B;AACvB,YAAM,IAAID,KAAJ,CAAU,UAAV,CAAN;AACH;AACJ,GAPD,CAQA,OAAME,GAAN,EAAU;AACN,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACF,MAAAA;AAAD,KAArB,CAAP;AACH;;AACD,MAAG;AACM,UAAMV,IAAI,CAACa,iBAAL,CACPV,GAAG,CAACW,IAAJ,CAASC,MADF,EAEP;AACIC,MAAAA,IAAI,EAAG;AAAEC,QAAAA,OAAO,EAAG,yCAAwCd,GAAG,CAACE,IAAJ,CAASa,QAAS;AAAtE;AADX,KAFO,EAKP;AAACC,MAAAA,GAAG,EAAC,IAAL;AAAWC,MAAAA,MAAM,EAAC,IAAlB;AAAwBC,MAAAA,mBAAmB,EAAC;AAA5C,KALO,EAMLC,IANK,CAMCC,IAAD,IAAU;AACb,aAAOnB,GAAG,CAACoB,IAAJ,CAASD,IAAT,CAAP;AACH,KARM,EAQJE,KARI,CAQGhB,GAAD,IAAS;AACd,aAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBa,IAAhB,CAAqBf,GAArB,CAAP;AACH,KAVM,CAAN;AAWR,GAZD,CAaA,OAAMA,GAAN,EAAU;AACN,WAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBa,IAAhB,CAAqBf,GAArB,CAAP;AACH;AAEJ,CA9BM","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/controllers/","sourcesContent":["const User = require('../models/user.model')\nimport { uploadErrors} from '../utils/errors.utils'\n\nexport const uploadProfil = async(req, res) => {\n    try{\n        if(req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\"){\n            throw new Error('invalid file')\n        }\n        if(req.file.size > 5000000){\n            throw new Error('max size')\n        }\n    }\n    catch(err){\n        const errors = uploadErrors(err);\n        return res.status(201).json({errors})\n    }\n    try{\n             await User.findByIdAndUpdate(\n            req.body.userId,\n            {\n                $set : { picture: `http://localhost:8080/uploads/profils/${req.file.filename}` }\n            },\n            {new:true, upsert:true, setDefaultsOnInsert:true}\n            ).then((user) => {\n                return res.send(user)\n            }).catch((err) => {\n                return res.status(500).send(err)\n            })\n    }\n    catch(err){\n        return res.status(500).send(err)\n    }\n    \n}\n\n"]}},"mtime":1653058542236},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/routes/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/routes/api/post.route.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar PostController = _interopRequireWildcard(require(\"../../controllers/post.controller\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst multer = require('multer');\n\nconst fileStorageEngine = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, `${__dirname}/../../../assets/uploads/posts`);\n  },\n  filename: function (req, file, cb) {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    let originalNameFile = file.originalname;\n    let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1);\n    cb(null, file.fieldname + '-' + uniqueSuffix + \".\" + extension);\n  }\n});\nconst upload = multer({\n  storage: fileStorageEngine\n});\nconst api = (0, _express.Router)();\napi.get('/', PostController.readPost);\napi.post('/', upload.single('file'), PostController.createPost);\napi.put('/:id', PostController.updatePost);\napi.delete('/:id', PostController.deletePost);\napi.patch('/like-post/:id', PostController.likePost);\napi.patch('/unlike-post/:id', PostController.unlikePost); //comments\n\napi.patch('/comment-post/:id', PostController.commentPost);\napi.patch('/edit-comment-post/:id', PostController.editCommentPost);\napi.patch('/delete-comment-post/:id', PostController.deleteCommentPost);\nvar _default = api;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3Qucm91dGUuanMiXSwibmFtZXMiOlsibXVsdGVyIiwicmVxdWlyZSIsImZpbGVTdG9yYWdlRW5naW5lIiwiZGlza1N0b3JhZ2UiLCJkZXN0aW5hdGlvbiIsInJlcSIsImZpbGUiLCJjYiIsIl9fZGlybmFtZSIsImZpbGVuYW1lIiwidW5pcXVlU3VmZml4IiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm9yaWdpbmFsTmFtZUZpbGUiLCJvcmlnaW5hbG5hbWUiLCJleHRlbnNpb24iLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsImZpZWxkbmFtZSIsInVwbG9hZCIsInN0b3JhZ2UiLCJhcGkiLCJnZXQiLCJQb3N0Q29udHJvbGxlciIsInJlYWRQb3N0IiwicG9zdCIsInNpbmdsZSIsImNyZWF0ZVBvc3QiLCJwdXQiLCJ1cGRhdGVQb3N0IiwiZGVsZXRlIiwiZGVsZXRlUG9zdCIsInBhdGNoIiwibGlrZVBvc3QiLCJ1bmxpa2VQb3N0IiwiY29tbWVudFBvc3QiLCJlZGl0Q29tbWVudFBvc3QiLCJkZWxldGVDb21tZW50UG9zdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOzs7Ozs7QUFDQSxNQUFNQSxNQUFNLEdBQUlDLE9BQU8sQ0FBQyxRQUFELENBQXZCOztBQUVBLE1BQU1DLGlCQUFpQixHQUFHRixNQUFNLENBQUNHLFdBQVAsQ0FBbUI7QUFDekNDLEVBQUFBLFdBQVcsRUFBQyxDQUFDQyxHQUFELEVBQU1DLElBQU4sRUFBWUMsRUFBWixLQUFtQjtBQUMzQkEsSUFBQUEsRUFBRSxDQUFDLElBQUQsRUFBUSxHQUFFQyxTQUFVLGdDQUFwQixDQUFGO0FBQ0gsR0FId0M7QUFJekNDLEVBQUFBLFFBQVEsRUFBRSxVQUFVSixHQUFWLEVBQWVDLElBQWYsRUFBcUJDLEVBQXJCLEVBQXlCO0FBQy9CLFVBQU1HLFlBQVksR0FBR0MsSUFBSSxDQUFDQyxHQUFMLEtBQWEsR0FBYixHQUFtQkMsSUFBSSxDQUFDQyxLQUFMLENBQVdELElBQUksQ0FBQ0UsTUFBTCxLQUFnQixHQUEzQixDQUF4QztBQUNBLFFBQUlDLGdCQUFnQixHQUFHVixJQUFJLENBQUNXLFlBQTVCO0FBQ0EsUUFBSUMsU0FBUyxHQUFHRixnQkFBZ0IsQ0FBQ0csU0FBakIsQ0FBMkJILGdCQUFnQixDQUFDSSxXQUFqQixDQUE2QixHQUE3QixJQUFvQyxDQUEvRCxDQUFoQjtBQUNBYixJQUFBQSxFQUFFLENBQUMsSUFBRCxFQUFPRCxJQUFJLENBQUNlLFNBQUwsR0FBaUIsR0FBakIsR0FBdUJYLFlBQXZCLEdBQXNDLEdBQXRDLEdBQTJDUSxTQUFsRCxDQUFGO0FBQ0Q7QUFUc0MsQ0FBbkIsQ0FBMUI7QUFZQSxNQUFNSSxNQUFNLEdBQUd0QixNQUFNLENBQUM7QUFBQ3VCLEVBQUFBLE9BQU8sRUFBQ3JCO0FBQVQsQ0FBRCxDQUFyQjtBQUVBLE1BQU1zQixHQUFHLEdBQUcsc0JBQVo7QUFHQUEsR0FBRyxDQUFDQyxHQUFKLENBQVEsR0FBUixFQUFhQyxjQUFjLENBQUNDLFFBQTVCO0FBQ0FILEdBQUcsQ0FBQ0ksSUFBSixDQUFTLEdBQVQsRUFBYU4sTUFBTSxDQUFDTyxNQUFQLENBQWMsTUFBZCxDQUFiLEVBQXFDSCxjQUFjLENBQUNJLFVBQXBEO0FBQ0FOLEdBQUcsQ0FBQ08sR0FBSixDQUFRLE1BQVIsRUFBZ0JMLGNBQWMsQ0FBQ00sVUFBL0I7QUFDQVIsR0FBRyxDQUFDUyxNQUFKLENBQVcsTUFBWCxFQUFtQlAsY0FBYyxDQUFDUSxVQUFsQztBQUNBVixHQUFHLENBQUNXLEtBQUosQ0FBVSxnQkFBVixFQUE0QlQsY0FBYyxDQUFDVSxRQUEzQztBQUNBWixHQUFHLENBQUNXLEtBQUosQ0FBVSxrQkFBVixFQUE4QlQsY0FBYyxDQUFDVyxVQUE3QyxFLENBRUE7O0FBQ0FiLEdBQUcsQ0FBQ1csS0FBSixDQUFVLG1CQUFWLEVBQStCVCxjQUFjLENBQUNZLFdBQTlDO0FBQ0FkLEdBQUcsQ0FBQ1csS0FBSixDQUFVLHdCQUFWLEVBQW9DVCxjQUFjLENBQUNhLGVBQW5EO0FBQ0FmLEdBQUcsQ0FBQ1csS0FBSixDQUFVLDBCQUFWLEVBQXNDVCxjQUFjLENBQUNjLGlCQUFyRDtlQUllaEIsRyIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc2VydmVyL3NyYy9yb3V0ZXMvYXBpLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJvdXRlciB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0ICogYXMgUG9zdENvbnRyb2xsZXIgZnJvbSAnLi4vLi4vY29udHJvbGxlcnMvcG9zdC5jb250cm9sbGVyJztcbmNvbnN0IG11bHRlciAgPSByZXF1aXJlKCdtdWx0ZXInKVxuXG5jb25zdCBmaWxlU3RvcmFnZUVuZ2luZSA9IG11bHRlci5kaXNrU3RvcmFnZSh7XG4gICAgZGVzdGluYXRpb246KHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAgICAgY2IobnVsbCwgYCR7X19kaXJuYW1lfS8uLi8uLi8uLi9hc3NldHMvdXBsb2Fkcy9wb3N0c2ApXG4gICAgfSxcbiAgICBmaWxlbmFtZTogZnVuY3Rpb24gKHJlcSwgZmlsZSwgY2IpIHtcbiAgICAgICAgY29uc3QgdW5pcXVlU3VmZml4ID0gRGF0ZS5ub3coKSArICctJyArIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDFFOSlcbiAgICAgICAgbGV0IG9yaWdpbmFsTmFtZUZpbGUgPSBmaWxlLm9yaWdpbmFsbmFtZTtcbiAgICAgICAgbGV0IGV4dGVuc2lvbiA9IG9yaWdpbmFsTmFtZUZpbGUuc3Vic3RyaW5nKG9yaWdpbmFsTmFtZUZpbGUubGFzdEluZGV4T2YoJy4nKSArIDEpOyBcbiAgICAgICAgY2IobnVsbCwgZmlsZS5maWVsZG5hbWUgKyAnLScgKyB1bmlxdWVTdWZmaXggKyBcIi5cIisgZXh0ZW5zaW9uIClcbiAgICAgIH1cbn0pO1xuXG5jb25zdCB1cGxvYWQgPSBtdWx0ZXIoe3N0b3JhZ2U6ZmlsZVN0b3JhZ2VFbmdpbmV9KVxuXG5jb25zdCBhcGkgPSBSb3V0ZXIoKTtcblxuXG5hcGkuZ2V0KCcvJywgUG9zdENvbnRyb2xsZXIucmVhZFBvc3QpO1xuYXBpLnBvc3QoJy8nLHVwbG9hZC5zaW5nbGUoJ2ZpbGUnKSwgIFBvc3RDb250cm9sbGVyLmNyZWF0ZVBvc3QpO1xuYXBpLnB1dCgnLzppZCcsIFBvc3RDb250cm9sbGVyLnVwZGF0ZVBvc3QpO1xuYXBpLmRlbGV0ZSgnLzppZCcsIFBvc3RDb250cm9sbGVyLmRlbGV0ZVBvc3QpO1xuYXBpLnBhdGNoKCcvbGlrZS1wb3N0LzppZCcsIFBvc3RDb250cm9sbGVyLmxpa2VQb3N0KTtcbmFwaS5wYXRjaCgnL3VubGlrZS1wb3N0LzppZCcsIFBvc3RDb250cm9sbGVyLnVubGlrZVBvc3QpO1xuXG4vL2NvbW1lbnRzXG5hcGkucGF0Y2goJy9jb21tZW50LXBvc3QvOmlkJywgUG9zdENvbnRyb2xsZXIuY29tbWVudFBvc3QpXG5hcGkucGF0Y2goJy9lZGl0LWNvbW1lbnQtcG9zdC86aWQnLCBQb3N0Q29udHJvbGxlci5lZGl0Q29tbWVudFBvc3QpXG5hcGkucGF0Y2goJy9kZWxldGUtY29tbWVudC1wb3N0LzppZCcsIFBvc3RDb250cm9sbGVyLmRlbGV0ZUNvbW1lbnRQb3N0KVxuXG5cblxuZXhwb3J0IGRlZmF1bHQgYXBpOyJdfQ==","map":{"version":3,"sources":["post.route.js"],"names":["multer","require","fileStorageEngine","diskStorage","destination","req","file","cb","__dirname","filename","uniqueSuffix","Date","now","Math","round","random","originalNameFile","originalname","extension","substring","lastIndexOf","fieldname","upload","storage","api","get","PostController","readPost","post","single","createPost","put","updatePost","delete","deletePost","patch","likePost","unlikePost","commentPost","editCommentPost","deleteCommentPost"],"mappings":";;;;;;;AAAA;;AACA;;;;;;AACA,MAAMA,MAAM,GAAIC,OAAO,CAAC,QAAD,CAAvB;;AAEA,MAAMC,iBAAiB,GAAGF,MAAM,CAACG,WAAP,CAAmB;AACzCC,EAAAA,WAAW,EAAC,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,KAAmB;AAC3BA,IAAAA,EAAE,CAAC,IAAD,EAAQ,GAAEC,SAAU,gCAApB,CAAF;AACH,GAHwC;AAIzCC,EAAAA,QAAQ,EAAE,UAAUJ,GAAV,EAAeC,IAAf,EAAqBC,EAArB,EAAyB;AAC/B,UAAMG,YAAY,GAAGC,IAAI,CAACC,GAAL,KAAa,GAAb,GAAmBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAAxC;AACA,QAAIC,gBAAgB,GAAGV,IAAI,CAACW,YAA5B;AACA,QAAIC,SAAS,GAAGF,gBAAgB,CAACG,SAAjB,CAA2BH,gBAAgB,CAACI,WAAjB,CAA6B,GAA7B,IAAoC,CAA/D,CAAhB;AACAb,IAAAA,EAAE,CAAC,IAAD,EAAOD,IAAI,CAACe,SAAL,GAAiB,GAAjB,GAAuBX,YAAvB,GAAsC,GAAtC,GAA2CQ,SAAlD,CAAF;AACD;AATsC,CAAnB,CAA1B;AAYA,MAAMI,MAAM,GAAGtB,MAAM,CAAC;AAACuB,EAAAA,OAAO,EAACrB;AAAT,CAAD,CAArB;AAEA,MAAMsB,GAAG,GAAG,sBAAZ;AAGAA,GAAG,CAACC,GAAJ,CAAQ,GAAR,EAAaC,cAAc,CAACC,QAA5B;AACAH,GAAG,CAACI,IAAJ,CAAS,GAAT,EAAaN,MAAM,CAACO,MAAP,CAAc,MAAd,CAAb,EAAqCH,cAAc,CAACI,UAApD;AACAN,GAAG,CAACO,GAAJ,CAAQ,MAAR,EAAgBL,cAAc,CAACM,UAA/B;AACAR,GAAG,CAACS,MAAJ,CAAW,MAAX,EAAmBP,cAAc,CAACQ,UAAlC;AACAV,GAAG,CAACW,KAAJ,CAAU,gBAAV,EAA4BT,cAAc,CAACU,QAA3C;AACAZ,GAAG,CAACW,KAAJ,CAAU,kBAAV,EAA8BT,cAAc,CAACW,UAA7C,E,CAEA;;AACAb,GAAG,CAACW,KAAJ,CAAU,mBAAV,EAA+BT,cAAc,CAACY,WAA9C;AACAd,GAAG,CAACW,KAAJ,CAAU,wBAAV,EAAoCT,cAAc,CAACa,eAAnD;AACAf,GAAG,CAACW,KAAJ,CAAU,0BAAV,EAAsCT,cAAc,CAACc,iBAArD;eAIehB,G","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/routes/api/","sourcesContent":["import { Router } from 'express';\nimport * as PostController from '../../controllers/post.controller';\nconst multer  = require('multer')\n\nconst fileStorageEngine = multer.diskStorage({\n    destination:(req, file, cb) => {\n        cb(null, `${__dirname}/../../../assets/uploads/posts`)\n    },\n    filename: function (req, file, cb) {\n        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)\n        let originalNameFile = file.originalname;\n        let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1); \n        cb(null, file.fieldname + '-' + uniqueSuffix + \".\"+ extension )\n      }\n});\n\nconst upload = multer({storage:fileStorageEngine})\n\nconst api = Router();\n\n\napi.get('/', PostController.readPost);\napi.post('/',upload.single('file'),  PostController.createPost);\napi.put('/:id', PostController.updatePost);\napi.delete('/:id', PostController.deletePost);\napi.patch('/like-post/:id', PostController.likePost);\napi.patch('/unlike-post/:id', PostController.unlikePost);\n\n//comments\napi.patch('/comment-post/:id', PostController.commentPost)\napi.patch('/edit-comment-post/:id', PostController.editCommentPost)\napi.patch('/delete-comment-post/:id', PostController.deleteCommentPost)\n\n\n\nexport default api;"]}},"mtime":1653046946274},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/controllers/post.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updatePost = exports.unlikePost = exports.readPost = exports.likePost = exports.editCommentPost = exports.deletePost = exports.deleteCommentPost = exports.createPost = exports.commentPost = void 0;\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst Post = require('../models/post.model');\n\nconst User = require('../models/user.model');\n\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\nconst readPost = async (req, res, next) => {\n  try {\n    const posts = await Post.find().sort({\n      createdAt: -1\n    });\n    res.status(200).json(posts);\n  } catch (err) {\n    res.status(200).json(err);\n  }\n};\n\nexports.readPost = readPost;\n\nconst createPost = async (req, res, next) => {\n  if (req.file != null) {\n    console.log(req.file);\n\n    try {\n      if (req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\") {\n        throw new Error('invalid file');\n      }\n\n      if (req.file.size > 500000) {\n        throw new Error('max size');\n      }\n    } catch (err) {\n      const errors = (0, _errors.uploadErrors)(err);\n      return res.status(201).json({\n        errors\n      });\n    }\n  }\n\n  const newPost = new Post({\n    posterId: req.body.posterId,\n    message: req.body.message,\n    picture: req.file != null ? `http://localhost:8080/uploads/posts/${req.file.filename}` : \"\",\n    video: req.body.video,\n    likers: [],\n    comments: []\n  });\n\n  try {\n    const post = await newPost.save();\n    return res.status(201).json(post);\n  } catch (err) {\n    return res.status(400).json(err);\n  }\n};\n\nexports.createPost = createPost;\n\nconst updatePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const updatedRecord = {\n      message: req.body.message\n    };\n    const newPost = await Post.findByIdAndUpdate(req.params.id, {\n      $set: updatedRecord\n    }, {\n      new: true\n    });\n    res.status(200).send(newPost);\n  } catch (err) {\n    res.status(400).json(err);\n  }\n};\n\nexports.updatePost = updatePost;\n\nconst deletePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    await Post.remove({\n      _id: req.params.id\n    }).exec();\n    res.status(200).json({\n      message: 'Successfully deleted !'\n    });\n  } catch (err) {\n    res.status(500).json({\n      message: err\n    });\n  }\n};\n\nexports.deletePost = deletePost;\n\nconst likePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $addToSet: {\n        likers: req.body.id\n      }\n    }, {\n      new: true\n    });\n    const user = await User.findByIdAndUpdate(req.body.id, {\n      $addToSet: {\n        likes: req.params.id\n      }\n    }, {\n      new: true\n    });\n    res.status(200).send(post);\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.likePost = likePost;\n\nconst unlikePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $pull: {\n        likers: req.body.id\n      }\n    }, {\n      new: true\n    });\n    const user = await User.findByIdAndUpdate(req.body.id, {\n      $pull: {\n        likes: req.params.id\n      }\n    }, {\n      new: true\n    });\n    res.status(200).send(user);\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.unlikePost = unlikePost;\n\nconst commentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $push: {\n        comments: {\n          commenterId: req.body.commenterId,\n          commenterPseudo: req.body.commenterPseudo,\n          text: req.body.text,\n          timestamp: new Date().getTime()\n        }\n      }\n    }, {\n      new: true\n    }).then(data => res.send(data)).catch(err => res.status(500).send({\n      message: err\n    }));\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.commentPost = commentPost;\n\nconst editCommentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    //on récupère le post concerné\n    const post = await Post.findById(req.params.id); //on récupère le commentaire concerné\n\n    const theComment = await post.comments.find(comment => {\n      return comment._id.equals(req.body.commentId);\n    });\n    console.log(theComment); //on change le text\n\n    theComment.text = req.body.text; // on save les changements\n\n    await post.save(); //on send le post concerné\n\n    return res.send(post);\n  } catch (err) {\n    return res.status(400).send(err);\n  }\n};\n\nexports.editCommentPost = editCommentPost;\n\nconst deleteCommentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $pull: {\n        comments: {\n          _id: req.body.commentId\n        }\n      }\n    }, {\n      new: true\n    }).then(newPost => {\n      res.send(newPost);\n    }).catch(err => {\n      return res.status(400).send(err);\n    });\n  } catch (err) {\n    return res.status(400).send(err);\n  }\n};\n\nexports.deleteCommentPost = deleteCommentPost;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJQb3N0IiwicmVxdWlyZSIsIlVzZXIiLCJPYmplY3RJRCIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWFkUG9zdCIsInJlcSIsInJlcyIsIm5leHQiLCJwb3N0cyIsImZpbmQiLCJzb3J0IiwiY3JlYXRlZEF0Iiwic3RhdHVzIiwianNvbiIsImVyciIsImNyZWF0ZVBvc3QiLCJmaWxlIiwiY29uc29sZSIsImxvZyIsIm1pbWV0eXBlIiwiRXJyb3IiLCJzaXplIiwiZXJyb3JzIiwibmV3UG9zdCIsInBvc3RlcklkIiwiYm9keSIsIm1lc3NhZ2UiLCJwaWN0dXJlIiwiZmlsZW5hbWUiLCJ2aWRlbyIsImxpa2VycyIsImNvbW1lbnRzIiwicG9zdCIsInNhdmUiLCJ1cGRhdGVQb3N0IiwiaXNWYWxpZCIsInBhcmFtcyIsImlkIiwic2VuZCIsInVwZGF0ZWRSZWNvcmQiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIiRzZXQiLCJuZXciLCJkZWxldGVQb3N0IiwicmVtb3ZlIiwiX2lkIiwiZXhlYyIsImxpa2VQb3N0IiwiJGFkZFRvU2V0IiwidXNlciIsImxpa2VzIiwidW5saWtlUG9zdCIsIiRwdWxsIiwiY29tbWVudFBvc3QiLCIkcHVzaCIsImNvbW1lbnRlcklkIiwiY29tbWVudGVyUHNldWRvIiwidGV4dCIsInRpbWVzdGFtcCIsIkRhdGUiLCJnZXRUaW1lIiwidGhlbiIsImRhdGEiLCJjYXRjaCIsImVkaXRDb21tZW50UG9zdCIsImZpbmRCeUlkIiwidGhlQ29tbWVudCIsImNvbW1lbnQiLCJlcXVhbHMiLCJjb21tZW50SWQiLCJkZWxldGVDb21tZW50UG9zdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUdBOztBQUhBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLHNCQUFELENBQXBCOztBQUNBLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLHNCQUFELENBQXBCOztBQUNBLE1BQU1FLFFBQVEsR0FBR0YsT0FB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QUFDSCxLQVprQixFQVloQndDLEtBWmdCLENBWVRqRCxHQUFELElBQVM7QUFDZCxhQUFPUixHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCMEIsSUFBaEIsQ0FBcUJ4QixHQUFyQixDQUFQO0FBQ0gsS0Fka0IsQ0FBbkI7QUFlSCxHQWhCRCxDQWlCQSxPQUFPQSxHQUFQLEVBQVk7QUFDUixXQUFPUixHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCMEIsSUFBaEIsQ0FBcUJ4QixHQUFyQixDQUFQO0FBQ0g7QUFDSixDQXhCTSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc2VydmVyL3NyYy9jb250cm9sbGVycy8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBQb3N0ID0gcmVxdWlyZSgnLi4vbW9kZWxzL3Bvc3QubW9kZWwnKVxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy91c2VyLm1vZGVsJylcbmNvbnN0IE9iamVjdElEID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpLlR5cGVzLk9iamVjdElkO1xuaW1wb3J0IHsgdXBsb2FkRXJyb3JzfSBmcm9tICcuLi91dGlscy9lcnJvcnMudXRpbHMnXG5cblxuZXhwb3J0IGNvbnN0IHJlYWRQb3N0ID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcG9zdHMgPSBhd2FpdCBQb3N0LmZpbmQoKS5zb3J0KHsgY3JlYXRlZEF0OiAtMSB9KVxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihwb3N0cylcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihlcnIpXG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IGNyZWF0ZVBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBpZihyZXEuZmlsZSAhPSBudWxsKXtcbiAgICAgICAgY29uc29sZS5sb2cocmVxLmZpbGUgKVxuICAgICAgICB0cnl7XG4gICAgICAgICAgICBpZihyZXEuZmlsZS5taW1ldHlwZSAhPSBcImltYWdlL2pwZ1wiICYmIHJlcS5maWxlLm1pbWV0eXBlICE9IFwiaW1hZ2UvcG5nXCIgJiYgcmVxLmZpbGUubWltZXR5cGUgIT0gXCJpbWFnZS9qcGVnXCIpe1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBmaWxlJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHJlcS5maWxlLnNpemUgPiA1MDAwMDApe1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignbWF4IHNpemUnKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoKGVycil7XG4gICAgICAgICAgICBjb25zdCBlcnJvcnMgPSB1cGxvYWRFcnJvcnMoZXJyKTtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMSkuanNvbih7ZXJyb3JzfSlcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBuZXdQb3N0ID0gbmV3IFBvc3Qoe1xuICAgICAgICBwb3N0ZXJJZDogcmVxLmJvZHkucG9zdGVySWQsXG4gICAgICAgIG1lc3NhZ2U6IHJlcS5ib2R5Lm1lc3NhZ2UsXG4gICAgICAgIHBpY3R1cmU6IHJlcS5maWxlICE9IG51bGwgPyBgaHR0cDovL2xvY2FsaG9zdDo4MDgwL3VwbG9hZHMvcG9zdHMvJHtyZXEuZmlsZS5maWxlbmFtZX1gIDogXCJcIixcbiAgICAgICAgdmlkZW86IHJlcS5ib2R5LnZpZGVvLFxuICAgICAgICBsaWtlcnM6IFtdLFxuICAgICAgICBjb21tZW50czogW10sXG4gICAgfSk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IG5ld1Bvc3Quc2F2ZSgpO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24ocG9zdClcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oZXJyKVxuICAgIH1cbn1cbmV4cG9ydCBjb25zdCB1cGRhdGVQb3N0ID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG5cbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEucGFyYW1zLmlkfWApXG4gICAgfVxuICAgIFxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRSZWNvcmQgPSB7XG4gICAgICAgICAgICBtZXNzYWdlOiByZXEuYm9keS5tZXNzYWdlXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmV3UG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICByZXEucGFyYW1zLmlkLFxuICAgICAgICAgICAgeyAkc2V0OiB1cGRhdGVkUmVjb3JkIH0sXG4gICAgICAgICAgICB7IG5ldzogdHJ1ZSB9XG4gICAgICAgIClcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQobmV3UG9zdClcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICByZXMuc3RhdHVzKDQwMCkuanNvbihlcnIpXG4gICAgfVxuXG5cblxufVxuZXhwb3J0IGNvbnN0IGRlbGV0ZVBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEucGFyYW1zLmlkfWApXG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IFBvc3QucmVtb3ZlKHtcbiAgICAgICAgICAgIF9pZDogcmVxLnBhcmFtcy5pZFxuICAgICAgICB9KS5leGVjKClcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnU3VjY2Vzc2Z1bGx5IGRlbGV0ZWQgIScgfSlcblxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyIH0pXG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IGxpa2VQb3N0ID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3N0ID0gYXdhaXQgUG9zdC5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5wYXJhbXMuaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJGFkZFRvU2V0OiB7IGxpa2VyczogcmVxLmJvZHkuaWQgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuZXc6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5ib2R5LmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRhZGRUb1NldDogeyBsaWtlczogcmVxLnBhcmFtcy5pZCB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5ldzogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChwb3N0KVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgZXJyIH0pXG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IHVubGlrZVBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEucGFyYW1zLmlkfWApXG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBvc3QgPSBhd2FpdCBQb3N0LmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgICAgICAgcmVxLnBhcmFtcy5pZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkcHVsbDogeyBsaWtlcnM6IHJlcS5ib2R5LmlkIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmV3OiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICByZXEuYm9keS5pZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkcHVsbDogeyBsaWtlczogcmVxLnBhcmFtcy5pZCB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5ldzogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZCh1c2VyKVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgZXJyIH0pXG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgY29tbWVudFBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEucGFyYW1zLmlkfWApXG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBvc3QgPSBhd2FpdCBQb3N0LmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgICAgICAgcmVxLnBhcmFtcy5pZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkcHVzaDoge1xuICAgICAgICAgICAgICAgICAgICBjb21tZW50czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudGVySWQ6IHJlcS5ib2R5LmNvbW1lbnRlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudGVyUHNldWRvOiByZXEuYm9keS5jb21tZW50ZXJQc2V1ZG8sXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiByZXEuYm9keS50ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHsgbmV3OiB0cnVlIH1cbiAgICAgICAgKS50aGVuKChkYXRhKSA9PiByZXMuc2VuZChkYXRhKSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgbWVzc2FnZTogZXJyIH0pKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IGVyciB9KVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGVkaXRDb21tZW50UG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICAvL29uIHLDqWN1cMOocmUgbGUgcG9zdCBjb25jZXJuw6lcbiAgICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5SWQocmVxLnBhcmFtcy5pZClcbiAgICAgXG4gICAgICAgIC8vb24gcsOpY3Vww6hyZSBsZSBjb21tZW50YWlyZSBjb25jZXJuw6lcbiAgICAgICAgY29uc3QgdGhlQ29tbWVudCA9IGF3YWl0IHBvc3QuY29tbWVudHMuZmluZCgoY29tbWVudCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGNvbW1lbnQuX2lkLmVxdWFscyhyZXEuYm9keS5jb21tZW50SWQpXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnNvbGUubG9nKHRoZUNvbW1lbnQpXG4gICAgICAgIC8vb24gY2hhbmdlIGxlIHRleHRcbiAgICAgICAgdGhlQ29tbWVudC50ZXh0ID0gcmVxLmJvZHkudGV4dFxuICAgICAgICAvLyBvbiBzYXZlIGxlcyBjaGFuZ2VtZW50c1xuICAgICAgICBhd2FpdCBwb3N0LnNhdmUoKTtcbiAgICAgICAgLy9vbiBzZW5kIGxlIHBvc3QgY29uY2VybsOpXG4gICAgICAgIHJldHVybiByZXMuc2VuZChwb3N0KVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnIpXG4gICAgfVxufVxuXG5cbmV4cG9ydCBjb25zdCBkZWxldGVDb21tZW50UG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICByZXEucGFyYW1zLmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRwdWxsOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IHJlcS5ib2R5LmNvbW1lbnRJZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHsgbmV3OiB0cnVlIH1cbiAgICAgICAgKS50aGVuKChuZXdQb3N0KSA9PiB7XG4gICAgICAgICAgICByZXMuc2VuZChuZXdQb3N0KVxuICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyKVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyKVxuICAgIH1cbn0iXX0=","map":{"version":3,"sources":["post.controller.js"],"names":["Post","require","User","ObjectID","Types","ObjectId","readPost","req","res","next","posts","find","sort","createdAt","status","json","err","createPost","file","console","log","mimetype","Error","size","errors","newPost","posterId","body","message","picture","filename","video","likers","comments","post","save","updatePost","isValid","params","id","send","updatedRecord","findByIdAndUpdate","$set","new","deletePost","remove","_id","exec","likePost","$addToSet","user","likes","unlikePost","$pull","commentPost","$push","commenterId","commenterPseudo","text","timestamp","Date","getTime","then","data","catch","editCommentPost","findById","theComment","comment","equals","commentId","deleteCommentPost"],"mappings":"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","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/controllers/","sourcesContent":["const Post = require('../models/post.model')\nconst User = require('../models/user.model')\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\nimport { uploadErrors} from '../utils/errors.utils'\n\n\nexport const readPost = async (req, res, next) => {\n    try {\n        const posts = await Post.find().sort({ createdAt: -1 })\n        res.status(200).json(posts)\n    }\n    catch (err) {\n        res.status(200).json(err)\n    }\n}\nexport const createPost = async (req, res, next) => {\n    if(req.file != null){\n        console.log(req.file )\n        try{\n            if(req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\"){\n                throw new Error('invalid file')\n            }\n            if(req.file.size > 500000){\n                throw new Error('max size')\n            }\n        }\n        catch(err){\n            const errors = uploadErrors(err);\n            return res.status(201).json({errors})\n        }\n    }\n    const newPost = new Post({\n        posterId: req.body.posterId,\n        message: req.body.message,\n        picture: req.file != null ? `http://localhost:8080/uploads/posts/${req.file.filename}` : \"\",\n        video: req.body.video,\n        likers: [],\n        comments: [],\n    });\n    try {\n        const post = await newPost.save();\n        return res.status(201).json(post)\n    }\n    catch (err) {\n        return res.status(400).json(err)\n    }\n}\nexport const updatePost = async (req, res, next) => {\n\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    \n    try {\n        const updatedRecord = {\n            message: req.body.message\n        }\n        const newPost = await Post.findByIdAndUpdate(\n            req.params.id,\n            { $set: updatedRecord },\n            { new: true }\n        )\n        res.status(200).send(newPost)\n    }\n    catch (err) {\n        res.status(400).json(err)\n    }\n\n\n\n}\nexport const deletePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        await Post.remove({\n            _id: req.params.id\n        }).exec()\n        res.status(200).json({ message: 'Successfully deleted !' })\n\n    }\n    catch (err) {\n        res.status(500).json({ message: err })\n    }\n}\nexport const likePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $addToSet: { likers: req.body.id }\n            },\n            {\n                new: true\n            }\n        )\n        const user = await User.findByIdAndUpdate(\n            req.body.id,\n            {\n                $addToSet: { likes: req.params.id }\n            },\n            {\n                new: true\n            }\n        );\n        res.status(200).send(post)\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\nexport const unlikePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $pull: { likers: req.body.id }\n            },\n            {\n                new: true\n            }\n        )\n        const user = await User.findByIdAndUpdate(\n            req.body.id,\n            {\n                $pull: { likes: req.params.id }\n            },\n            {\n                new: true\n            }\n        );\n        res.status(200).send(user)\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\n\nexport const commentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $push: {\n                    comments: {\n                        commenterId: req.body.commenterId,\n                        commenterPseudo: req.body.commenterPseudo,\n                        text: req.body.text,\n                        timestamp: new Date().getTime()\n                    }\n                }\n            },\n            { new: true }\n        ).then((data) => res.send(data))\n        .catch((err) => res.status(500).send({ message: err }));\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\n\nexport const editCommentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n\n    try {\n        //on récupère le post concerné\n        const post = await Post.findById(req.params.id)\n     \n        //on récupère le commentaire concerné\n        const theComment = await post.comments.find((comment) => {\n            return comment._id.equals(req.body.commentId)\n        })\n        console.log(theComment)\n        //on change le text\n        theComment.text = req.body.text\n        // on save les changements\n        await post.save();\n        //on send le post concerné\n        return res.send(post)\n    }\n    catch (err) {\n        return res.status(400).send(err)\n    }\n}\n\n\nexport const deleteCommentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $pull: {\n                    comments: {\n                        _id: req.body.commentId\n                    }\n                }\n            },\n            { new: true }\n        ).then((newPost) => {\n            res.send(newPost)\n        }).catch((err) => {\n            return res.status(400).send(err)\n        });\n    }\n    catch (err) {\n        return res.status(400).send(err)\n    }\n}"]}},"mtime":1653047124737},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/models/post.model.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nconst PostSchema = new mongoose.Schema({\n  posterId: {\n    type: String,\n    required: true\n  },\n  message: {\n    type: String,\n    trim: true,\n    maxlength: 500\n  },\n  picture: {\n    type: String\n  },\n  video: {\n    type: String\n  },\n  likers: {\n    type: [String],\n    required: true\n  },\n  //la partie commentaire est une sous base de données\n  comments: {\n    type: [{\n      commenterId: String,\n      commenterPseudo: String,\n      text: String,\n      timestamp: Number\n    }],\n    required: true\n  }\n}, {\n  timestamps: true\n});\nlet Post = mongoose.model('post', PostSchema);\nmodule.exports = Post;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QubW9kZWwuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiUG9zdFNjaGVtYSIsIlNjaGVtYSIsInBvc3RlcklkIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwibWVzc2FnZSIsInRyaW0iLCJtYXhsZW5ndGgiLCJwaWN0dXJlIiwidmlkZW8iLCJsaWtlcnMiLCJjb21tZW50cyIsImNvbW1lbnRlcklkIiwiY29tbWVudGVyUHNldWRvIiwidGV4dCIsInRpbWVzdGFtcCIsIk51bWJlciIsInRpbWVzdGFtcHMiLCJQb3N0IiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBRUEsTUFBTUMsVUFBVSxHQUFHLElBQUlGLFFBQVEsQ0FBQ0csTUFBYixDQUNmO0FBQ0lDLEVBQUFBLFFBQVEsRUFBRTtBQUNOQyxJQUFBQSxJQUFJLEVBQUVDLE1BREE7QUFFTkMsSUFBQUEsUUFBUSxFQUFFO0FBRkosR0FEZDtBQUtJQyxFQUFBQSxPQUFPLEVBQUU7QUFDTEgsSUFBQUEsSUFBSSxFQUFFQyxNQUREO0FBRUxHLElBQUFBLElBQUksRUFBRSxJQUZEO0FBR0xDLElBQUFBLFNBQVMsRUFBRTtBQUhOLEdBTGI7QUFVSUMsRUFBQUEsT0FBTyxFQUFFO0FBQ0xOLElBQUFBLElBQUksRUFBRUM7QUFERCxHQVZiO0FBYUlNLEVBQUFBLEtBQUssRUFBRTtBQUNIUCxJQUFBQSxJQUFJLEVBQUVDO0FBREgsR0FiWDtBQWdCSU8sRUFBQUEsTUFBTSxFQUFFO0FBQ0pSLElBQUFBLElBQUksRUFBRSxDQUFDQyxNQUFELENBREY7QUFFSkMsSUFBQUEsUUFBUSxFQUFFO0FBRk4sR0FoQlo7QUFvQkk7QUFDQU8sRUFBQUEsUUFBUSxFQUFFO0FBQ05ULElBQUFBLElBQUksRUFBRSxDQUNGO0FBQ0lVLE1BQUFBLFdBQVcsRUFBRVQsTUFEakI7QUFFSVUsTUFBQUEsZUFBZSxFQUFFVixNQUZyQjtBQUdJVyxNQUFBQSxJQUFJLEVBQUVYLE1BSFY7QUFJSVksTUFBQUEsU0FBUyxFQUFFQztBQUpmLEtBREUsQ0FEQTtBQVNOWixJQUFBQSxRQUFRLEVBQUU7QUFUSjtBQXJCZCxDQURlLEVBa0NmO0FBQ0lhLEVBQUFBLFVBQVUsRUFBRTtBQURoQixDQWxDZSxDQUFuQjtBQXVDQSxJQUFJQyxJQUFJLEdBQUdyQixRQUFRLENBQUNzQixLQUFULENBQWUsTUFBZixFQUF1QnBCLFVBQXZCLENBQVg7QUFDQXFCLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsSUFBakIiLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NlcnZlci9zcmMvbW9kZWxzLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcblxuY29uc3QgUG9zdFNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoXG4gICAge1xuICAgICAgICBwb3N0ZXJJZDoge1xuICAgICAgICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgICAgIHRyaW06IHRydWUsXG4gICAgICAgICAgICBtYXhsZW5ndGg6IDUwMFxuICAgICAgICB9LFxuICAgICAgICBwaWN0dXJlOiB7XG4gICAgICAgICAgICB0eXBlOiBTdHJpbmdcbiAgICAgICAgfSxcbiAgICAgICAgdmlkZW86IHtcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZ1xuICAgICAgICB9LFxuICAgICAgICBsaWtlcnM6IHtcbiAgICAgICAgICAgIHR5cGU6IFtTdHJpbmddLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIC8vbGEgcGFydGllIGNvbW1lbnRhaXJlIGVzdCB1bmUgc291cyBiYXNlIGRlIGRvbm7DqWVzXG4gICAgICAgIGNvbW1lbnRzOiB7XG4gICAgICAgICAgICB0eXBlOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb21tZW50ZXJJZDogU3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICBjb21tZW50ZXJQc2V1ZG86IFN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogU3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IE51bWJlclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgICB0aW1lc3RhbXBzOiB0cnVlXG4gICAgfVxuKTtcblxubGV0IFBvc3QgPSBtb25nb29zZS5tb2RlbCgncG9zdCcsIFBvc3RTY2hlbWEpXG5tb2R1bGUuZXhwb3J0cyA9IFBvc3Q7Il19","map":{"version":3,"sources":["post.model.js"],"names":["mongoose","require","PostSchema","Schema","posterId","type","String","required","message","trim","maxlength","picture","video","likers","comments","commenterId","commenterPseudo","text","timestamp","Number","timestamps","Post","model","module","exports"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,MAAMC,UAAU,GAAG,IAAIF,QAAQ,CAACG,MAAb,CACf;AACIC,EAAAA,QAAQ,EAAE;AACNC,IAAAA,IAAI,EAAEC,MADA;AAENC,IAAAA,QAAQ,EAAE;AAFJ,GADd;AAKIC,EAAAA,OAAO,EAAE;AACLH,IAAAA,IAAI,EAAEC,MADD;AAELG,IAAAA,IAAI,EAAE,IAFD;AAGLC,IAAAA,SAAS,EAAE;AAHN,GALb;AAUIC,EAAAA,OAAO,EAAE;AACLN,IAAAA,IAAI,EAAEC;AADD,GAVb;AAaIM,EAAAA,KAAK,EAAE;AACHP,IAAAA,IAAI,EAAEC;AADH,GAbX;AAgBIO,EAAAA,MAAM,EAAE;AACJR,IAAAA,IAAI,EAAE,CAACC,MAAD,CADF;AAEJC,IAAAA,QAAQ,EAAE;AAFN,GAhBZ;AAoBI;AACAO,EAAAA,QAAQ,EAAE;AACNT,IAAAA,IAAI,EAAE,CACF;AACIU,MAAAA,WAAW,EAAET,MADjB;AAEIU,MAAAA,eAAe,EAAEV,MAFrB;AAGIW,MAAAA,IAAI,EAAEX,MAHV;AAIIY,MAAAA,SAAS,EAAEC;AAJf,KADE,CADA;AASNZ,IAAAA,QAAQ,EAAE;AATJ;AArBd,CADe,EAkCf;AACIa,EAAAA,UAAU,EAAE;AADhB,CAlCe,CAAnB;AAuCA,IAAIC,IAAI,GAAGrB,QAAQ,CAACsB,KAAT,CAAe,MAAf,EAAuBpB,UAAvB,CAAX;AACAqB,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/models/","sourcesContent":["const mongoose = require('mongoose');\n\nconst PostSchema = new mongoose.Schema(\n    {\n        posterId: {\n            type: String,\n            required: true,\n        },\n        message: {\n            type: String,\n            trim: true,\n            maxlength: 500\n        },\n        picture: {\n            type: String\n        },\n        video: {\n            type: String\n        },\n        likers: {\n            type: [String],\n            required: true,\n        },\n        //la partie commentaire est une sous base de données\n        comments: {\n            type: [\n                {\n                    commenterId: String,\n                    commenterPseudo: String,\n                    text: String,\n                    timestamp: Number\n                }\n            ],\n            required: true,\n        }\n    },\n    {\n        timestamps: true\n    }\n);\n\nlet Post = mongoose.model('post', PostSchema)\nmodule.exports = Post;"]}},"mtime":1651276586978},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/middlewares/auth.middleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.requireAuth = exports.checkUser = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _HttpException = require(\"../errors/HttpException.error\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst User = require('../models/user.model');\n\nconst checkUser = (req, res, next) => {\n  const token = req.cookies.jwt;\n\n  if (token) {\n    _jsonwebtoken.default.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        res.locals.user = null; // res.cookie(\"jwt\", '', { maxAge: 1 })\n\n        next();\n      } else {\n        let user = await User.findById(decodedToken.id);\n\n        if (!user) {\n          return next(new _HttpException.HttpException('Unauthorized', _HttpException.HttpStatus.UNAUTHORIZED));\n        }\n\n        res.locals.user = user;\n        next();\n      }\n    });\n  } else {\n    res.locals.user = null;\n    next();\n  }\n};\n\nexports.checkUser = checkUser;\n\nconst requireAuth = (req, res, next) => {\n  const token = req.cookies.jwt;\n\n  if (token) {\n    _jsonwebtoken.default.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        console.log(err);\n      } else {\n        console.log(decodedToken.id);\n        next();\n      }\n    });\n  } else {\n    console.log('no token');\n  }\n};\n\nexports.requireAuth = requireAuth;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgubWlkZGxld2FyZS5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImNoZWNrVXNlciIsInJlcSIsInJlcyIsIm5leHQiLCJ0b2tlbiIsImNvb2tpZXMiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiVE9LRU5fU0VDUkVUIiwiZXJyIiwiZGVjb2RlZFRva2VuIiwibG9jYWxzIiwidXNlciIsImZpbmRCeUlkIiwiaWQiLCJIdHRwRXhjZXB0aW9uIiwiSHR0cFN0YXR1cyIsIlVOQVVUSE9SSVpFRCIsInJlcXVpcmVBdXRoIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUVBOzs7O0FBREEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsc0JBQUQsQ0FBcEI7O0FBSU8sTUFBTUMsU0FBUyxHQUFHLENBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFXQyxJQUFYLEtBQW9CO0FBQzNDLFFBQU1DLEtBQUssR0FBR0gsR0FBRyxDQUFDSSxPQUFKLENBQVlDLEdBQTFCOztBQUNBLE1BQUlGLEtBQUosRUFBVztBQUVURSwwQkFBSUMsTUFBSixDQUFXSCxLQUFYLEVBQWtCSSxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsWUFBOUIsRUFBNEMsT0FBT0MsR0FBUCxFQUFZQyxZQUFaLEtBQTZCO0FBQ3ZFLFVBQUlELEdBQUosRUFBUztBQUNQVCxRQUFBQSxHQUFHLENBQUNXLE1BQUosQ0FBV0MsSUFBWCxHQUFrQixJQUFsQixDQURPLENBRVI7O0FBQ0NYLFFBQUFBLElBQUk7QUFDTCxPQUpELE1BSU87QUFDTCxZQUFJVyxJQUFJLEdBQUcsTUFBTWhCLElBQUksQ0FBQ2lCLFFBQUwsQ0FBY0gsWUFBWSxDQUFDSSxFQUEzQixDQUFqQjs7QUFDQSxZQUFJLENBQUNGLElBQUwsRUFBVztBQUNULGlCQUFPWCxJQUFJLENBQUMsSUFBSWMsNEJBQUosQ0FBa0IsY0FBbEIsRUFBa0NDLDBCQUFXQyxZQUE3QyxDQUFELENBQVg7QUFDRDs7QUFDRGpCLFFBQUFBLEdBQUcsQ0FBQ1csTUFBSixDQUFXQyxJQUFYLEdBQWtCQSxJQUFsQjtBQUNBWCxRQUFBQSxJQUFJO0FBQ0w7QUFDRixLQWJEO0FBY0QsR0FoQkQsTUFpQks7QUFDSEQsSUFBQUEsR0FBRyxDQUFDVyxNQUFKLENBQVdDLElBQVgsR0FBa0IsSUFBbEI7QUFDQVgsSUFBQUEsSUFBSTtBQUNMO0FBQ0YsQ0F2Qk07Ozs7QUF5QkEsTUFBTWlCLFdBQVcsR0FBRyxDQUFDbkIsR0FBRCxFQUFNQyxHQUFOLEVBQVdDLElBQVgsS0FBb0I7QUFDN0MsUUFBTUMsS0FBSyxHQUFHSCxHQUFHLENBQUNJLE9BQUosQ0FBWUMsR0FBMUI7O0FBQ0EsTUFBSUYsS0FBSixFQUFXO0FBQ1RFLDBCQUFJQyxNQUFKLENBQVdILEtBQVgsRUFBa0JJLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUE5QixFQUE0QyxPQUFPQyxHQUFQLEVBQVlDLFlBQVosS0FBNkI7QUFDdkUsVUFBR0QsR0FBSCxFQUFPO0FBQ0xVLFFBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZWCxHQUFaO0FBQ0QsT0FGRCxNQUVLO0FBQ0hVLFFBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZVixZQUFZLENBQUNJLEVBQXpCO0FBQ0FiLFFBQUFBLElBQUk7QUFDTDtBQUNGLEtBUEQ7QUFRRCxHQVRELE1BU0s7QUFDSGtCLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLFVBQVo7QUFDRDtBQUNGLENBZE0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NlcnZlci9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy91c2VyLm1vZGVsJylcbmltcG9ydCB7IEh0dHBFeGNlcHRpb24sIEh0dHBTdGF0dXMgfSBmcm9tICcuLi9lcnJvcnMvSHR0cEV4Y2VwdGlvbi5lcnJvcic7XG5cblxuZXhwb3J0IGNvbnN0IGNoZWNrVXNlciA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICBjb25zdCB0b2tlbiA9IHJlcS5jb29raWVzLmp3dDtcbiAgaWYgKHRva2VuKSB7XG4gXG4gICAgand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVULCBhc3luYyAoZXJyLCBkZWNvZGVkVG9rZW4pID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVzLmxvY2Fscy51c2VyID0gbnVsbDtcbiAgICAgICAvLyByZXMuY29va2llKFwiand0XCIsICcnLCB7IG1heEFnZTogMSB9KVxuICAgICAgICBuZXh0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQoZGVjb2RlZFRva2VuLmlkKTtcbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgcmV0dXJuIG5leHQobmV3IEh0dHBFeGNlcHRpb24oJ1VuYXV0aG9yaXplZCcsIEh0dHBTdGF0dXMuVU5BVVRIT1JJWkVEKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzLmxvY2Fscy51c2VyID0gdXNlcjtcbiAgICAgICAgbmV4dCgpO1xuICAgICAgfVxuICAgIH0pXG4gIH1cbiAgZWxzZSB7XG4gICAgcmVzLmxvY2Fscy51c2VyID0gbnVsbDtcbiAgICBuZXh0KCk7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHJlcXVpcmVBdXRoID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHRva2VuID0gcmVxLmNvb2tpZXMuand0XG4gIGlmICh0b2tlbikge1xuICAgIGp3dC52ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LlRPS0VOX1NFQ1JFVCwgYXN5bmMgKGVyciwgZGVjb2RlZFRva2VuKSA9PiB7XG4gICAgICBpZihlcnIpe1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfWVsc2V7XG4gICAgICAgIGNvbnNvbGUubG9nKGRlY29kZWRUb2tlbi5pZClcbiAgICAgICAgbmV4dCgpO1xuICAgICAgfVxuICAgIH0pXG4gIH1lbHNle1xuICAgIGNvbnNvbGUubG9nKCdubyB0b2tlbicpXG4gIH1cbn1cbiJdfQ==","map":{"version":3,"sources":["auth.middleware.js"],"names":["User","require","checkUser","req","res","next","token","cookies","jwt","verify","process","env","TOKEN_SECRET","err","decodedToken","locals","user","findById","id","HttpException","HttpStatus","UNAUTHORIZED","requireAuth","console","log"],"mappings":";;;;;;;AAAA;;AAEA;;;;AADA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AAIO,MAAMC,SAAS,GAAG,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC3C,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,GAA1B;;AACA,MAAIF,KAAJ,EAAW;AAETE,0BAAIC,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,EAA4C,OAAOC,GAAP,EAAYC,YAAZ,KAA6B;AACvE,UAAID,GAAJ,EAAS;AACPT,QAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkB,IAAlB,CADO,CAER;;AACCX,QAAAA,IAAI;AACL,OAJD,MAIO;AACL,YAAIW,IAAI,GAAG,MAAMhB,IAAI,CAACiB,QAAL,CAAcH,YAAY,CAACI,EAA3B,CAAjB;;AACA,YAAI,CAACF,IAAL,EAAW;AACT,iBAAOX,IAAI,CAAC,IAAIc,4BAAJ,CAAkB,cAAlB,EAAkCC,0BAAWC,YAA7C,CAAD,CAAX;AACD;;AACDjB,QAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkBA,IAAlB;AACAX,QAAAA,IAAI;AACL;AACF,KAbD;AAcD,GAhBD,MAiBK;AACHD,IAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkB,IAAlB;AACAX,IAAAA,IAAI;AACL;AACF,CAvBM;;;;AAyBA,MAAMiB,WAAW,GAAG,CAACnB,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC7C,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,GAA1B;;AACA,MAAIF,KAAJ,EAAW;AACTE,0BAAIC,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,EAA4C,OAAOC,GAAP,EAAYC,YAAZ,KAA6B;AACvE,UAAGD,GAAH,EAAO;AACLU,QAAAA,OAAO,CAACC,GAAR,CAAYX,GAAZ;AACD,OAFD,MAEK;AACHU,QAAAA,OAAO,CAACC,GAAR,CAAYV,YAAY,CAACI,EAAzB;AACAb,QAAAA,IAAI;AACL;AACF,KAPD;AAQD,GATD,MASK;AACHkB,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACD;AACF,CAdM","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/middlewares/","sourcesContent":["import jwt from 'jsonwebtoken';\nconst User = require('../models/user.model')\nimport { HttpException, HttpStatus } from '../errors/HttpException.error';\n\n\nexport const checkUser = (req, res, next) => {\n  const token = req.cookies.jwt;\n  if (token) {\n \n    jwt.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        res.locals.user = null;\n       // res.cookie(\"jwt\", '', { maxAge: 1 })\n        next();\n      } else {\n        let user = await User.findById(decodedToken.id);\n        if (!user) {\n          return next(new HttpException('Unauthorized', HttpStatus.UNAUTHORIZED));\n        }\n        res.locals.user = user;\n        next();\n      }\n    })\n  }\n  else {\n    res.locals.user = null;\n    next();\n  }\n}\n\nexport const requireAuth = (req, res, next) => {\n  const token = req.cookies.jwt\n  if (token) {\n    jwt.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if(err){\n        console.log(err);\n      }else{\n        console.log(decodedToken.id)\n        next();\n      }\n    })\n  }else{\n    console.log('no token')\n  }\n}\n"]}},"mtime":1651607963929},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/errors/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/errors/HttpException.error.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HttpStatus = exports.HttpException = void 0;\nconst HttpStatus = {\n  UNAUTHORIZED: 401,\n  NOT_FOUND: 404\n};\nexports.HttpStatus = HttpStatus;\n\nclass HttpException extends Error {\n  constructor(message, statusCode) {\n    super(message);\n    this.statusCode = statusCode;\n  }\n\n}\n\nexports.HttpException = HttpException;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkh0dHBFeGNlcHRpb24uZXJyb3IuanMiXSwibmFtZXMiOlsiSHR0cFN0YXR1cyIsIlVOQVVUSE9SSVpFRCIsIk5PVF9GT1VORCIsIkh0dHBFeGNlcHRpb24iLCJFcnJvciIsImNvbnN0cnVjdG9yIiwibWVzc2FnZSIsInN0YXR1c0NvZGUiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFPLE1BQU1BLFVBQVUsR0FBRztBQUN4QkMsRUFBQUEsWUFBWSxFQUFFLEdBRFU7QUFFeEJDLEVBQUFBLFNBQVMsRUFBRTtBQUZhLENBQW5COzs7QUFLQSxNQUFNQyxhQUFOLFNBQTRCQyxLQUE1QixDQUFrQztBQUN2Q0MsRUFBQUEsV0FBVyxDQUFDQyxPQUFELEVBQVVDLFVBQVYsRUFBc0I7QUFDL0IsVUFBTUQsT0FBTjtBQUVBLFNBQUtDLFVBQUwsR0FBa0JBLFVBQWxCO0FBQ0Q7O0FBTHNDIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9tZXJuX3Byb2plY3RfYXBwMi9zZXJ2ZXIvc3JjL2Vycm9ycy8iLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgSHR0cFN0YXR1cyA9IHtcbiAgVU5BVVRIT1JJWkVEOiA0MDEsXG4gIE5PVF9GT1VORDogNDA0LFxufVxuXG5leHBvcnQgY2xhc3MgSHR0cEV4Y2VwdGlvbiBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgc3RhdHVzQ29kZSkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuXG4gICAgdGhpcy5zdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcbiAgfVxufVxuIl19","map":{"version":3,"sources":["HttpException.error.js"],"names":["HttpStatus","UNAUTHORIZED","NOT_FOUND","HttpException","Error","constructor","message","statusCode"],"mappings":";;;;;;AAAO,MAAMA,UAAU,GAAG;AACxBC,EAAAA,YAAY,EAAE,GADU;AAExBC,EAAAA,SAAS,EAAE;AAFa,CAAnB;;;AAKA,MAAMC,aAAN,SAA4BC,KAA5B,CAAkC;AACvCC,EAAAA,WAAW,CAACC,OAAD,EAAUC,UAAV,EAAsB;AAC/B,UAAMD,OAAN;AAEA,SAAKC,UAAL,GAAkBA,UAAlB;AACD;;AALsC","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/errors/","sourcesContent":["export const HttpStatus = {\n  UNAUTHORIZED: 401,\n  NOT_FOUND: 404,\n}\n\nexport class HttpException extends Error {\n  constructor(message, statusCode) {\n    super(message);\n\n    this.statusCode = statusCode;\n  }\n}\n"]}},"mtime":1651253219660},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/database.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nmongoose.connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`).then(() => console.log('Connected to MongoDB')).catch(error => console.log(\"Failed to connect MongoDB\", error));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhdGFiYXNlLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiREJfVVNFUk5BTUUiLCJEQl9QQVNTV09SRCIsInRoZW4iLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnJvciJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUVBRCxRQUFRLENBQ0hFLE9BREwsQ0FDYyxpQkFBZ0JDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxXQUFZLElBQUdGLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRSxXQUFZLDBDQURqRixFQUVLQyxJQUZMLENBRVUsTUFBTUMsT0FBTyxDQUFDQyxHQUFSLENBQVksc0JBQVosQ0FGaEIsRUFHS0MsS0FITCxDQUdZQyxLQUFELElBQVdILE9BQU8sQ0FBQ0MsR0FBUixDQUFZLDJCQUFaLEVBQXlDRSxLQUF6QyxDQUh0QiIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbWVybl9wcm9qZWN0X2FwcDIvc2VydmVyLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKVxuXG5tb25nb29zZVxuICAgIC5jb25uZWN0KGBtb25nb2RiK3NydjovLyR7cHJvY2Vzcy5lbnYuREJfVVNFUk5BTUV9OiR7cHJvY2Vzcy5lbnYuREJfUEFTU1dPUkR9QGNsdXN0ZXIwLmdidnhnLm1vbmdvZGIubmV0L21lcm5fcHJvamVjdGApXG4gICAgLnRoZW4oKCkgPT4gY29uc29sZS5sb2coJ0Nvbm5lY3RlZCB0byBNb25nb0RCJykpXG4gICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5sb2coXCJGYWlsZWQgdG8gY29ubmVjdCBNb25nb0RCXCIsIGVycm9yKSkiXX0=","map":{"version":3,"sources":["database.js"],"names":["mongoose","require","connect","process","env","DB_USERNAME","DB_PASSWORD","then","console","log","catch","error"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEAD,QAAQ,CACHE,OADL,CACc,iBAAgBC,OAAO,CAACC,GAAR,CAAYC,WAAY,IAAGF,OAAO,CAACC,GAAR,CAAYE,WAAY,0CADjF,EAEKC,IAFL,CAEU,MAAMC,OAAO,CAACC,GAAR,CAAY,sBAAZ,CAFhB,EAGKC,KAHL,CAGYC,KAAD,IAAWH,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCE,KAAzC,CAHtB","sourceRoot":"/Applications/dossier/mern_project_app2/server/","sourcesContent":["const mongoose = require('mongoose')\n\nmongoose\n    .connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`)\n    .then(() => console.log('Connected to MongoDB'))\n    .catch((error) => console.log(\"Failed to connect MongoDB\", error))"]}},"mtime":1651231241527},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/mern_project_app2/server/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/mern_project_app2/server\",\"filename\":\"/Applications/dossier/mern_project_app2/server/src/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/mern_project_app2/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.launch = launch;\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _response = _interopRequireDefault(require(\"express/lib/response\"));\n\nvar _routes = _interopRequireDefault(require(\"./routes\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst bodyParser = require('body-parser');\n\nconst cookieParser = require(\"cookie-parser\");\n\nconst {\n  checkUser,\n  requireAuth\n} = require('./middlewares/auth.middleware');\n\nconst cors = require(\"cors\");\n\nfunction launch({\n  host,\n  protocol,\n  port\n}) {\n  const application = (0, _express.default)();\n\n  require('dotenv').config({\n    path: './.env'\n  });\n\n  require('../database.js');\n\n  application.use(cors({\n    origin: process.env.CLIENT_URL,\n    methods: [\"GET\", \"POST\", \"HEAD\", \"PUT\", \"PATCH\", \"DELETE\"],\n    credentials: true\n  }));\n  application.use(cookieParser());\n  application.use(_express.default.json()); // notre middleware de sécurité\n\n  application.get('*', checkUser); //cest ce qui permet de loger un user lorsqu'il arrive sur le site\n\n  application.get('/jwtid', requireAuth, (req, res) => {\n    res.status(200).send(res.locals.user._id);\n  });\n  application.use(_routes.default);\n  application.use(_express.default.static('assets'));\n  application.listen(port, () => console.log(`Server started at ${protocol}://${host}:${port}`));\n}\n/* require('dotenv').config({path:'./config/.env'})\n */\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJib2R5UGFyc2VyIiwicmVxdWlyZSIsImNvb2tpZVBhcnNlciIsImNoZWNrVXNlciIsInJlcXVpcmVBdXRoIiwiY29ycyIsImxhdW5jaCIsImhvc3QiLCJwcm90b2NvbCIsInBvcnQiLCJhcHBsaWNhdGlvbiIsImNvbmZpZyIsInBhdGgiLCJ1c2UiLCJvcmlnaW4iLCJwcm9jZXNzIiwiZW52IiwiQ0xJRU5UX1VSTCIsIm1ldGhvZHMiLCJjcmVkZW50aWFscyIsImV4cHJlc3MiLCJqc29uIiwiZ2V0IiwicmVxIiwicmVzIiwic3RhdHVzIiwic2VuZCIsImxvY2FscyIsInVzZXIiLCJfaWQiLCJEZWZhdWx0Um91dGVyIiwic3RhdGljIiwibGlzdGVuIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7O0FBQ0EsTUFBTUEsVUFBVSxHQUFHQyxPQUFPLENBQUMsYUFBRCxDQUExQjs7QUFFQSxNQUFNQyxZQUFZLEdBQUdELE9BQU8sQ0FBQyxlQUFELENBQTVCOztBQUNBLE1BQU07QUFBRUUsRUFBQUEsU0FBRjtBQUFhQyxFQUFBQTtBQUFiLElBQTZCSCxPQUFPLENBQUMsK0JBQUQsQ0FBMUM7O0FBQ0EsTUFBTUksSUFBSSxHQUFHSixPQUFPLENBQUMsTUFBRCxDQUFwQjs7QUFHTyxTQUFTSyxNQUFULENBQWdCO0FBQUVDLEVBQUFBLElBQUY7QUFBUUMsRUFBQUEsUUFBUjtBQUFrQkMsRUFBQUE7QUFBbEIsQ0FBaEIsRUFBMEM7QUFDL0MsUUFBTUMsV0FBVyxHQUFHLHVCQUFwQjs7QUFDQVQsRUFBQUEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQlUsTUFBbEIsQ0FBeUI7QUFBRUMsSUFBQUEsSUFBSSxFQUFFO0FBQVIsR0FBekI7O0FBQ0FYLEVBQUFBLE9BQU8sQ0FBQyxnQkFBRCxDQUFQOztBQUVBUyxFQUFBQSxXQUFXLENBQUNHLEdBQVosQ0FDRVIsSUFBSSxDQUFDO0FBQ0hTLElBQUFBLE1BQU0sRUFBRUMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBRGpCO0FBRUhDLElBQUFBLE9BQU8sRUFBRSxDQUFDLEtBQUQsRUFBUSxNQUFSLEVBQWdCLE1BQWhCLEVBQXdCLEtBQXhCLEVBQStCLE9BQS9CLEVBQXdDLFFBQXhDLENBRk47QUFHSEMsSUFBQUEsV0FBVyxFQUFFO0FBSFYsR0FBRCxDQUROO0FBT0FULEVBQUFBLFdBQVcsQ0FBQ0csR0FBWixDQUFnQlgsWUFBWSxFQUE1QjtBQUVBUSxFQUFBQSxXQUFXLENBQUNHLEdBQVosQ0FBZ0JPLGlCQUFRQyxJQUFSLEVBQWhCLEVBZCtDLENBZ0IvQzs7QUFDQVgsRUFBQUEsV0FBVyxDQUFDWSxHQUFaLENBQWdCLEdBQWhCLEVBQXFCbkIsU0FBckIsRUFqQitDLENBa0IvQzs7QUFDQU8sRUFBQUEsV0FBVyxDQUFDWSxHQUFaLENBQWdCLFFBQWhCLEVBQTBCbEIsV0FBMUIsRUFBdUMsQ0FBQ21CLEdBQUQsRUFBTUMsR0FBTixLQUFjO0FBQ25EQSxJQUFBQSxHQUFHLENBQUNDLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQkYsR0FBRyxDQUFDRyxNQUFKLENBQVdDLElBQVgsQ0FBZ0JDLEdBQXJDO0FBQ0QsR0FGRDtBQUlBbkIsRUFBQUEsV0FBVyxDQUFDRyxHQUFaLENBQWdCaUIsZUFBaEI7QUFDQXBCLEVBQUFBLFdBQVcsQ0FBQ0csR0FBWixDQUFnQk8saUJBQVFXLE1BQVIsQ0FBZSxRQUFmLENBQWhCO0FBRUFyQixFQUFBQSxXQUFXLENBQUNzQixNQUFaLENBQ0V2QixJQURGLEVBRUUsTUFBTXdCLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLHFCQUFvQjFCLFFBQVMsTUFBS0QsSUFBSyxJQUFHRSxJQUFLLEVBQTVELENBRlI7QUFJRDtBQUlEO0FBQ0EiLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL21lcm5fcHJvamVjdF9hcHAyL3NlcnZlci9zcmMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgcmVzIGZyb20gJ2V4cHJlc3MvbGliL3Jlc3BvbnNlJztcbmltcG9ydCBEZWZhdWx0Um91dGVyIGZyb20gJy4vcm91dGVzJztcbmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpO1xuXG5jb25zdCBjb29raWVQYXJzZXIgPSByZXF1aXJlKFwiY29va2llLXBhcnNlclwiKVxuY29uc3QgeyBjaGVja1VzZXIsIHJlcXVpcmVBdXRoIH0gPSByZXF1aXJlKCcuL21pZGRsZXdhcmVzL2F1dGgubWlkZGxld2FyZScpXG5jb25zdCBjb3JzID0gcmVxdWlyZShcImNvcnNcIilcblxuXG5leHBvcnQgZnVuY3Rpb24gbGF1bmNoKHsgaG9zdCwgcHJvdG9jb2wsIHBvcnQgfSkge1xuICBjb25zdCBhcHBsaWNhdGlvbiA9IGV4cHJlc3MoKTtcbiAgcmVxdWlyZSgnZG90ZW52JykuY29uZmlnKHsgcGF0aDogJy4vLmVudicgfSlcbiAgcmVxdWlyZSgnLi4vZGF0YWJhc2UuanMnKVxuXG4gIGFwcGxpY2F0aW9uLnVzZShcbiAgICBjb3JzKHtcbiAgICAgIG9yaWdpbjogcHJvY2Vzcy5lbnYuQ0xJRU5UX1VSTCxcbiAgICAgIG1ldGhvZHM6IFtcIkdFVFwiLCBcIlBPU1RcIiwgXCJIRUFEXCIsIFwiUFVUXCIsIFwiUEFUQ0hcIiwgXCJERUxFVEVcIl0sXG4gICAgICBjcmVkZW50aWFsczogdHJ1ZSxcbiAgICB9KVxuICApO1xuICBhcHBsaWNhdGlvbi51c2UoY29va2llUGFyc2VyKCkpO1xuXG4gIGFwcGxpY2F0aW9uLnVzZShleHByZXNzLmpzb24oKSk7XG5cbiAgLy8gbm90cmUgbWlkZGxld2FyZSBkZSBzw6ljdXJpdMOpXG4gIGFwcGxpY2F0aW9uLmdldCgnKicsIGNoZWNrVXNlcilcbiAgLy9jZXN0IGNlIHF1aSBwZXJtZXQgZGUgbG9nZXIgdW4gdXNlciBsb3JzcXUnaWwgYXJyaXZlIHN1ciBsZSBzaXRlXG4gIGFwcGxpY2F0aW9uLmdldCgnL2p3dGlkJywgcmVxdWlyZUF1dGgsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHJlcy5sb2NhbHMudXNlci5faWQpXG4gIH0pXG5cbiAgYXBwbGljYXRpb24udXNlKERlZmF1bHRSb3V0ZXIpO1xuICBhcHBsaWNhdGlvbi51c2UoZXhwcmVzcy5zdGF0aWMoJ2Fzc2V0cycpKTtcblxuICBhcHBsaWNhdGlvbi5saXN0ZW4oXG4gICAgcG9ydCxcbiAgICAoKSA9PiBjb25zb2xlLmxvZyhgU2VydmVyIHN0YXJ0ZWQgYXQgJHtwcm90b2NvbH06Ly8ke2hvc3R9OiR7cG9ydH1gKSxcbiAgKTtcbn1cblxuXG5cbi8qIHJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZyh7cGF0aDonLi9jb25maWcvLmVudid9KVxuICovXG5cblxuXG4iXX0=","map":{"version":3,"sources":["server.js"],"names":["bodyParser","require","cookieParser","checkUser","requireAuth","cors","launch","host","protocol","port","application","config","path","use","origin","process","env","CLIENT_URL","methods","credentials","express","json","get","req","res","status","send","locals","user","_id","DefaultRouter","static","listen","console","log"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,UAAU,GAAGC,OAAO,CAAC,aAAD,CAA1B;;AAEA,MAAMC,YAAY,GAAGD,OAAO,CAAC,eAAD,CAA5B;;AACA,MAAM;AAAEE,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAA6BH,OAAO,CAAC,+BAAD,CAA1C;;AACA,MAAMI,IAAI,GAAGJ,OAAO,CAAC,MAAD,CAApB;;AAGO,SAASK,MAAT,CAAgB;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,QAAR;AAAkBC,EAAAA;AAAlB,CAAhB,EAA0C;AAC/C,QAAMC,WAAW,GAAG,uBAApB;;AACAT,EAAAA,OAAO,CAAC,QAAD,CAAP,CAAkBU,MAAlB,CAAyB;AAAEC,IAAAA,IAAI,EAAE;AAAR,GAAzB;;AACAX,EAAAA,OAAO,CAAC,gBAAD,CAAP;;AAEAS,EAAAA,WAAW,CAACG,GAAZ,CACER,IAAI,CAAC;AACHS,IAAAA,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC,UADjB;AAEHC,IAAAA,OAAO,EAAE,CAAC,KAAD,EAAQ,MAAR,EAAgB,MAAhB,EAAwB,KAAxB,EAA+B,OAA/B,EAAwC,QAAxC,CAFN;AAGHC,IAAAA,WAAW,EAAE;AAHV,GAAD,CADN;AAOAT,EAAAA,WAAW,CAACG,GAAZ,CAAgBX,YAAY,EAA5B;AAEAQ,EAAAA,WAAW,CAACG,GAAZ,CAAgBO,iBAAQC,IAAR,EAAhB,EAd+C,CAgB/C;;AACAX,EAAAA,WAAW,CAACY,GAAZ,CAAgB,GAAhB,EAAqBnB,SAArB,EAjB+C,CAkB/C;;AACAO,EAAAA,WAAW,CAACY,GAAZ,CAAgB,QAAhB,EAA0BlB,WAA1B,EAAuC,CAACmB,GAAD,EAAMC,GAAN,KAAc;AACnDA,IAAAA,GAAG,CAACC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,GAAG,CAACG,MAAJ,CAAWC,IAAX,CAAgBC,GAArC;AACD,GAFD;AAIAnB,EAAAA,WAAW,CAACG,GAAZ,CAAgBiB,eAAhB;AACApB,EAAAA,WAAW,CAACG,GAAZ,CAAgBO,iBAAQW,MAAR,CAAe,QAAf,CAAhB;AAEArB,EAAAA,WAAW,CAACsB,MAAZ,CACEvB,IADF,EAEE,MAAMwB,OAAO,CAACC,GAAR,CAAa,qBAAoB1B,QAAS,MAAKD,IAAK,IAAGE,IAAK,EAA5D,CAFR;AAID;AAID;AACA","sourceRoot":"/Applications/dossier/mern_project_app2/server/src/","sourcesContent":["import express from 'express';\nimport res from 'express/lib/response';\nimport DefaultRouter from './routes';\nconst bodyParser = require('body-parser');\n\nconst cookieParser = require(\"cookie-parser\")\nconst { checkUser, requireAuth } = require('./middlewares/auth.middleware')\nconst cors = require(\"cors\")\n\n\nexport function launch({ host, protocol, port }) {\n  const application = express();\n  require('dotenv').config({ path: './.env' })\n  require('../database.js')\n\n  application.use(\n    cors({\n      origin: process.env.CLIENT_URL,\n      methods: [\"GET\", \"POST\", \"HEAD\", \"PUT\", \"PATCH\", \"DELETE\"],\n      credentials: true,\n    })\n  );\n  application.use(cookieParser());\n\n  application.use(express.json());\n\n  // notre middleware de sécurité\n  application.get('*', checkUser)\n  //cest ce qui permet de loger un user lorsqu'il arrive sur le site\n  application.get('/jwtid', requireAuth, (req, res) => {\n    res.status(200).send(res.locals.user._id)\n  })\n\n  application.use(DefaultRouter);\n  application.use(express.static('assets'));\n\n  application.listen(\n    port,\n    () => console.log(`Server started at ${protocol}://${host}:${port}`),\n  );\n}\n\n\n\n/* require('dotenv').config({path:'./config/.env'})\n */\n\n\n\n"]}},"mtime":1653046631486},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/main.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nvar _server = require(\"./server\");\n\n(0, _server.launch)({\n  host: 'localhost',\n  protocol: 'http',\n  port: 8080\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiaG9zdCIsInByb3RvY29sIiwicG9ydCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFFQSxvQkFBTztBQUNMQSxFQUFBQSxJQUFJLEVBQUUsV0FERDtBQUVMQyxFQUFBQSxRQUFRLEVBQUUsTUFGTDtBQUdMQyxFQUFBQSxJQUFJLEVBQUU7QUFIRCxDQUFQIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9saW5ldXAtc29jaWFsL3NlcnZlci9zcmMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbGF1bmNoIH0gZnJvbSAnLi9zZXJ2ZXInO1xuXG5sYXVuY2goe1xuICBob3N0OiAnbG9jYWxob3N0JyxcbiAgcHJvdG9jb2w6ICdodHRwJyxcbiAgcG9ydDogODA4MCxcbn0pO1xuIl19","map":{"version":3,"sources":["main.js"],"names":["host","protocol","port"],"mappings":";;AAAA;;AAEA,oBAAO;AACLA,EAAAA,IAAI,EAAE,WADD;AAELC,EAAAA,QAAQ,EAAE,MAFL;AAGLC,EAAAA,IAAI,EAAE;AAHD,CAAP","sourceRoot":"/Applications/dossier/lineup-social/server/src/","sourcesContent":["import { launch } from './server';\n\nlaunch({\n  host: 'localhost',\n  protocol: 'http',\n  port: 8080,\n});\n"]}},"mtime":1651230875437},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.launch = launch;\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _response = _interopRequireDefault(require(\"express/lib/response\"));\n\nvar _routes = _interopRequireDefault(require(\"./routes\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst bodyParser = require('body-parser');\n\nconst cookieParser = require(\"cookie-parser\");\n\nconst {\n  checkUser,\n  requireAuth\n} = require('./middlewares/auth.middleware');\n\nconst cors = require(\"cors\");\n\nfunction launch({\n  host,\n  protocol,\n  port\n}) {\n  const application = (0, _express.default)();\n\n  require('dotenv').config({\n    path: './.env'\n  });\n\n  require('../database.js');\n\n  application.use(cors({\n    origin: process.env.CLIENT_URL,\n    methods: [\"GET\", \"POST\", \"HEAD\", \"PUT\", \"PATCH\", \"DELETE\"],\n    credentials: true\n  }));\n  application.use(cookieParser());\n  application.use(_express.default.json()); // notre middleware de sécurité\n\n  application.get('*', checkUser); //cest ce qui permet de loger un user lorsqu'il arrive sur le site\n\n  application.get('/jwtid', requireAuth, (req, res) => {\n    res.status(200).send(res.locals.user._id);\n  });\n  application.use(_routes.default);\n  application.use(_express.default.static('assets'));\n  application.listen(process.env.PORT || port, () => console.log(`Server started at ${protocol}://${host}:${port}`));\n}\n/* require('dotenv').config({path:'./config/.env'})\n */\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJib2R5UGFyc2VyIiwicmVxdWlyZSIsImNvb2tpZVBhcnNlciIsImNoZWNrVXNlciIsInJlcXVpcmVBdXRoIiwiY29ycyIsImxhdW5jaCIsImhvc3QiLCJwcm90b2NvbCIsInBvcnQiLCJhcHBsaWNhdGlvbiIsImNvbmZpZyIsInBhdGgiLCJ1c2UiLCJvcmlnaW4iLCJwcm9jZXNzIiwiZW52IiwiQ0xJRU5UX1VSTCIsIm1ldGhvZHMiLCJjcmVkZW50aWFscyIsImV4cHJlc3MiLCJqc29uIiwiZ2V0IiwicmVxIiwicmVzIiwic3RhdHVzIiwic2VuZCIsImxvY2FscyIsInVzZXIiLCJfaWQiLCJEZWZhdWx0Um91dGVyIiwic3RhdGljIiwibGlzdGVuIiwiUE9SVCIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7OztBQUNBLE1BQU1BLFVBQVUsR0FBR0MsT0FBTyxDQUFDLGFBQUQsQ0FBMUI7O0FBRUEsTUFBTUMsWUFBWSxHQUFHRCxPQUFPLENBQUMsZUFBRCxDQUE1Qjs7QUFDQSxNQUFNO0FBQUVFLEVBQUFBLFNBQUY7QUFBYUMsRUFBQUE7QUFBYixJQUE2QkgsT0FBTyxDQUFDLCtCQUFELENBQTFDOztBQUNBLE1BQU1JLElBQUksR0FBR0osT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBR08sU0FBU0ssTUFBVCxDQUFnQjtBQUFFQyxFQUFBQSxJQUFGO0FBQVFDLEVBQUFBLFFBQVI7QUFBa0JDLEVBQUFBO0FBQWxCLENBQWhCLEVBQTBDO0FBQy9DLFFBQU1DLFdBQVcsR0FBRyx1QkFBcEI7O0FBQ0FULEVBQUFBLE9BQU8sQ0FBQyxRQUFELENBQVAsQ0FBa0JVLE1BQWxCLENBQXlCO0FBQUVDLElBQUFBLElBQUksRUFBRTtBQUFSLEdBQXpCOztBQUNBWCxFQUFBQSxPQUFPLENBQUMsZ0JBQUQsQ0FBUDs7QUFFQVMsRUFBQUEsV0FBVyxDQUFDRyxHQUFaLENBQ0VSLElBQUksQ0FBQztBQUNIUyxJQUFBQSxNQUFNLEVBQUVDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxVQURqQjtBQUVIQyxJQUFBQSxPQUFPLEVBQUUsQ0FBQyxLQUFELEVBQVEsTUFBUixFQUFnQixNQUFoQixFQUF3QixLQUF4QixFQUErQixPQUEvQixFQUF3QyxRQUF4QyxDQUZOO0FBR0hDLElBQUFBLFdBQVcsRUFBRTtBQUhWLEdBQUQsQ0FETjtBQU9BVCxFQUFBQSxXQUFXLENBQUNHLEdBQVosQ0FBZ0JYLFlBQVksRUFBNUI7QUFFQVEsRUFBQUEsV0FBVyxDQUFDRyxHQUFaLENBQWdCTyxpQkFBUUMsSUFBUixFQUFoQixFQWQrQyxDQWdCL0M7O0FBQ0FYLEVBQUFBLFdBQVcsQ0FBQ1ksR0FBWixDQUFnQixHQUFoQixFQUFxQm5CLFNBQXJCLEVBakIrQyxDQWtCL0M7O0FBQ0FPLEVBQUFBLFdBQVcsQ0FBQ1ksR0FBWixDQUFnQixRQUFoQixFQUEwQmxCLFdBQTFCLEVBQXVDLENBQUNtQixHQUFELEVBQU1DLEdBQU4sS0FBYztBQUNuREEsSUFBQUEsR0FBRyxDQUFDQyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJGLEdBQUcsQ0FBQ0csTUFBSixDQUFXQyxJQUFYLENBQWdCQyxHQUFyQztBQUNELEdBRkQ7QUFJQW5CLEVBQUFBLFdBQVcsQ0FBQ0csR0FBWixDQUFnQmlCLGVBQWhCO0FBQ0FwQixFQUFBQSxXQUFXLENBQUNHLEdBQVosQ0FBZ0JPLGlCQUFRVyxNQUFSLENBQWUsUUFBZixDQUFoQjtBQUVBckIsRUFBQUEsV0FBVyxDQUFDc0IsTUFBWixDQUNFakIsT0FBTyxDQUFDQyxHQUFSLENBQVlpQixJQUFaLElBQW9CeEIsSUFEdEIsRUFFRSxNQUFNeUIsT0FBTyxDQUFDQyxHQUFSLENBQWEscUJBQW9CM0IsUUFBUyxNQUFLRCxJQUFLLElBQUdFLElBQUssRUFBNUQsQ0FGUjtBQUlEO0FBSUQ7QUFDQSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbGluZXVwLXNvY2lhbC9zZXJ2ZXIvc3JjLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHJlcyBmcm9tICdleHByZXNzL2xpYi9yZXNwb25zZSc7XG5pbXBvcnQgRGVmYXVsdFJvdXRlciBmcm9tICcuL3JvdXRlcyc7XG5jb25zdCBib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTtcblxuY29uc3QgY29va2llUGFyc2VyID0gcmVxdWlyZShcImNvb2tpZS1wYXJzZXJcIilcbmNvbnN0IHsgY2hlY2tVc2VyLCByZXF1aXJlQXV0aCB9ID0gcmVxdWlyZSgnLi9taWRkbGV3YXJlcy9hdXRoLm1pZGRsZXdhcmUnKVxuY29uc3QgY29ycyA9IHJlcXVpcmUoXCJjb3JzXCIpXG5cblxuZXhwb3J0IGZ1bmN0aW9uIGxhdW5jaCh7IGhvc3QsIHByb3RvY29sLCBwb3J0IH0pIHtcbiAgY29uc3QgYXBwbGljYXRpb24gPSBleHByZXNzKCk7XG4gIHJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZyh7IHBhdGg6ICcuLy5lbnYnIH0pXG4gIHJlcXVpcmUoJy4uL2RhdGFiYXNlLmpzJylcblxuICBhcHBsaWNhdGlvbi51c2UoXG4gICAgY29ycyh7XG4gICAgICBvcmlnaW46IHByb2Nlc3MuZW52LkNMSUVOVF9VUkwsXG4gICAgICBtZXRob2RzOiBbXCJHRVRcIiwgXCJQT1NUXCIsIFwiSEVBRFwiLCBcIlBVVFwiLCBcIlBBVENIXCIsIFwiREVMRVRFXCJdLFxuICAgICAgY3JlZGVudGlhbHM6IHRydWUsXG4gICAgfSlcbiAgKTtcbiAgYXBwbGljYXRpb24udXNlKGNvb2tpZVBhcnNlcigpKTtcblxuICBhcHBsaWNhdGlvbi51c2UoZXhwcmVzcy5qc29uKCkpO1xuXG4gIC8vIG5vdHJlIG1pZGRsZXdhcmUgZGUgc8OpY3VyaXTDqVxuICBhcHBsaWNhdGlvbi5nZXQoJyonLCBjaGVja1VzZXIpXG4gIC8vY2VzdCBjZSBxdWkgcGVybWV0IGRlIGxvZ2VyIHVuIHVzZXIgbG9yc3F1J2lsIGFycml2ZSBzdXIgbGUgc2l0ZVxuICBhcHBsaWNhdGlvbi5nZXQoJy9qd3RpZCcsIHJlcXVpcmVBdXRoLCAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChyZXMubG9jYWxzLnVzZXIuX2lkKVxuICB9KVxuXG4gIGFwcGxpY2F0aW9uLnVzZShEZWZhdWx0Um91dGVyKTtcbiAgYXBwbGljYXRpb24udXNlKGV4cHJlc3Muc3RhdGljKCdhc3NldHMnKSk7XG5cbiAgYXBwbGljYXRpb24ubGlzdGVuKFxuICAgIHByb2Nlc3MuZW52LlBPUlQgfHzCoHBvcnQsXG4gICAgKCkgPT4gY29uc29sZS5sb2coYFNlcnZlciBzdGFydGVkIGF0ICR7cHJvdG9jb2x9Oi8vJHtob3N0fToke3BvcnR9YCksXG4gICk7XG59XG5cblxuXG4vKiByZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoe3BhdGg6Jy4vY29uZmlnLy5lbnYnfSlcbiAqL1xuXG5cblxuIl19","map":{"version":3,"sources":["server.js"],"names":["bodyParser","require","cookieParser","checkUser","requireAuth","cors","launch","host","protocol","port","application","config","path","use","origin","process","env","CLIENT_URL","methods","credentials","express","json","get","req","res","status","send","locals","user","_id","DefaultRouter","static","listen","PORT","console","log"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,UAAU,GAAGC,OAAO,CAAC,aAAD,CAA1B;;AAEA,MAAMC,YAAY,GAAGD,OAAO,CAAC,eAAD,CAA5B;;AACA,MAAM;AAAEE,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAA6BH,OAAO,CAAC,+BAAD,CAA1C;;AACA,MAAMI,IAAI,GAAGJ,OAAO,CAAC,MAAD,CAApB;;AAGO,SAASK,MAAT,CAAgB;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,QAAR;AAAkBC,EAAAA;AAAlB,CAAhB,EAA0C;AAC/C,QAAMC,WAAW,GAAG,uBAApB;;AACAT,EAAAA,OAAO,CAAC,QAAD,CAAP,CAAkBU,MAAlB,CAAyB;AAAEC,IAAAA,IAAI,EAAE;AAAR,GAAzB;;AACAX,EAAAA,OAAO,CAAC,gBAAD,CAAP;;AAEAS,EAAAA,WAAW,CAACG,GAAZ,CACER,IAAI,CAAC;AACHS,IAAAA,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC,UADjB;AAEHC,IAAAA,OAAO,EAAE,CAAC,KAAD,EAAQ,MAAR,EAAgB,MAAhB,EAAwB,KAAxB,EAA+B,OAA/B,EAAwC,QAAxC,CAFN;AAGHC,IAAAA,WAAW,EAAE;AAHV,GAAD,CADN;AAOAT,EAAAA,WAAW,CAACG,GAAZ,CAAgBX,YAAY,EAA5B;AAEAQ,EAAAA,WAAW,CAACG,GAAZ,CAAgBO,iBAAQC,IAAR,EAAhB,EAd+C,CAgB/C;;AACAX,EAAAA,WAAW,CAACY,GAAZ,CAAgB,GAAhB,EAAqBnB,SAArB,EAjB+C,CAkB/C;;AACAO,EAAAA,WAAW,CAACY,GAAZ,CAAgB,QAAhB,EAA0BlB,WAA1B,EAAuC,CAACmB,GAAD,EAAMC,GAAN,KAAc;AACnDA,IAAAA,GAAG,CAACC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,GAAG,CAACG,MAAJ,CAAWC,IAAX,CAAgBC,GAArC;AACD,GAFD;AAIAnB,EAAAA,WAAW,CAACG,GAAZ,CAAgBiB,eAAhB;AACApB,EAAAA,WAAW,CAACG,GAAZ,CAAgBO,iBAAQW,MAAR,CAAe,QAAf,CAAhB;AAEArB,EAAAA,WAAW,CAACsB,MAAZ,CACEjB,OAAO,CAACC,GAAR,CAAYiB,IAAZ,IAAoBxB,IADtB,EAEE,MAAMyB,OAAO,CAACC,GAAR,CAAa,qBAAoB3B,QAAS,MAAKD,IAAK,IAAGE,IAAK,EAA5D,CAFR;AAID;AAID;AACA","sourceRoot":"/Applications/dossier/lineup-social/server/src/","sourcesContent":["import express from 'express';\nimport res from 'express/lib/response';\nimport DefaultRouter from './routes';\nconst bodyParser = require('body-parser');\n\nconst cookieParser = require(\"cookie-parser\")\nconst { checkUser, requireAuth } = require('./middlewares/auth.middleware')\nconst cors = require(\"cors\")\n\n\nexport function launch({ host, protocol, port }) {\n  const application = express();\n  require('dotenv').config({ path: './.env' })\n  require('../database.js')\n\n  application.use(\n    cors({\n      origin: process.env.CLIENT_URL,\n      methods: [\"GET\", \"POST\", \"HEAD\", \"PUT\", \"PATCH\", \"DELETE\"],\n      credentials: true,\n    })\n  );\n  application.use(cookieParser());\n\n  application.use(express.json());\n\n  // notre middleware de sécurité\n  application.get('*', checkUser)\n  //cest ce qui permet de loger un user lorsqu'il arrive sur le site\n  application.get('/jwtid', requireAuth, (req, res) => {\n    res.status(200).send(res.locals.user._id)\n  })\n\n  application.use(DefaultRouter);\n  application.use(express.static('assets'));\n\n  application.listen(\n    process.env.PORT || port,\n    () => console.log(`Server started at ${protocol}://${host}:${port}`),\n  );\n}\n\n\n\n/* require('dotenv').config({path:'./config/.env'})\n */\n\n\n\n"]}},"mtime":1653071356601},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar _user = _interopRequireDefault(require(\"./api/user.route\"));\n\nvar _post = _interopRequireDefault(require(\"./api/post.route\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst router = (0, _express.Router)();\nrouter.use('/api/user', _user.default);\nrouter.use('/api/post', _post.default);\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJvdXRlciIsInVzZSIsIlVzZXJSb3V0ZXIiLCJQb3N0Um91dGVyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7Ozs7QUFDQSxNQUFNQSxNQUFNLEdBQUcsc0JBQWY7QUFFQUEsTUFBTSxDQUFDQyxHQUFQLENBQVcsV0FBWCxFQUF3QkMsYUFBeEI7QUFDQUYsTUFBTSxDQUFDQyxHQUFQLENBQVcsV0FBWCxFQUF5QkUsYUFBekI7ZUFFZUgsTSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbGluZXVwLXNvY2lhbC9zZXJ2ZXIvc3JjL3JvdXRlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdleHByZXNzJztcbmltcG9ydCBVc2VyUm91dGVyIGZyb20gJy4vYXBpL3VzZXIucm91dGUnO1xuaW1wb3J0IFBvc3RSb3V0ZXIgZnJvbSAnLi9hcGkvcG9zdC5yb3V0ZSc7XG5jb25zdCByb3V0ZXIgPSBSb3V0ZXIoKTtcblxucm91dGVyLnVzZSgnL2FwaS91c2VyJywgVXNlclJvdXRlcik7XG5yb3V0ZXIudXNlKCcvYXBpL3Bvc3QnLCAgUG9zdFJvdXRlcik7XG5cbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjtcbiJdfQ==","map":{"version":3,"sources":["index.js"],"names":["router","use","UserRouter","PostRouter"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,MAAM,GAAG,sBAAf;AAEAA,MAAM,CAACC,GAAP,CAAW,WAAX,EAAwBC,aAAxB;AACAF,MAAM,CAACC,GAAP,CAAW,WAAX,EAAyBE,aAAzB;eAEeH,M","sourceRoot":"/Applications/dossier/lineup-social/server/src/routes/","sourcesContent":["import { Router } from 'express';\nimport UserRouter from './api/user.route';\nimport PostRouter from './api/post.route';\nconst router = Router();\n\nrouter.use('/api/user', UserRouter);\nrouter.use('/api/post',  PostRouter);\n\nexport default router;\n"]}},"mtime":1651607818943},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/routes/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/routes/api/user.route.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar AuthController = _interopRequireWildcard(require(\"../../controllers/auth.controller\"));\n\nvar UserController = _interopRequireWildcard(require(\"../../controllers/user.controller\"));\n\nvar UploadController = _interopRequireWildcard(require(\"../../controllers/upload.controller\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst multer = require('multer');\n\nconst fileStorageEngine = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, `${__dirname}/../../../assets/uploads/profils`);\n  },\n  filename: function (req, file, cb) {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    let originalNameFile = file.originalname;\n    let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1);\n    cb(null, file.fieldname + '-' + uniqueSuffix + \".\" + extension);\n  }\n});\nconst upload = multer({\n  storage: fileStorageEngine\n});\nconst api = (0, _express.Router)(); //auth\n\napi.post('/register', AuthController.signUp);\napi.post('/login', AuthController.signIn);\napi.get('/logout', AuthController.logout); //user\n\napi.get('/', UserController.getAllUsers);\napi.get('/:id', UserController.getUserInfo);\napi.put('/:id', UserController.updateUser);\napi.delete('/:id', UserController.deleteUser);\napi.patch('/follow/:id', UserController.follow);\napi.patch('/unfollow/:id', UserController.unfollow); //upload\n//avant de passer à notre controlleur il va check notre file\n\napi.post('/upload', upload.single(\"file\"), UploadController.uploadProfil);\nvar _default = api;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIucm91dGUuanMiXSwibmFtZXMiOlsibXVsdGVyIiwicmVxdWlyZSIsImZpbGVTdG9yYWdlRW5naW5lIiwiZGlza1N0b3JhZ2UiLCJkZXN0aW5hdGlvbiIsInJlcSIsImZpbGUiLCJjYiIsIl9fZGlybmFtZSIsImZpbGVuYW1lIiwidW5pcXVlU3VmZml4IiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm9yaWdpbmFsTmFtZUZpbGUiLCJvcmlnaW5hbG5hbWUiLCJleHRlbnNpb24iLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsImZpZWxkbmFtZSIsInVwbG9hZCIsInN0b3JhZ2UiLCJhcGkiLCJwb3N0IiwiQXV0aENvbnRyb2xsZXIiLCJzaWduVXAiLCJzaWduSW4iLCJnZXQiLCJsb2dvdXQiLCJVc2VyQ29udHJvbGxlciIsImdldEFsbFVzZXJzIiwiZ2V0VXNlckluZm8iLCJwdXQiLCJ1cGRhdGVVc2VyIiwiZGVsZXRlIiwiZGVsZXRlVXNlciIsInBhdGNoIiwiZm9sbG93IiwidW5mb2xsb3ciLCJzaW5nbGUiLCJVcGxvYWRDb250cm9sbGVyIiwidXBsb2FkUHJvZmlsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7OztBQUNBLE1BQU1BLE1BQU0sR0FBSUMsT0FBTyxDQUFDLFFBQUQsQ0FBdkI7O0FBRUEsTUFBTUMsaUJBQWlCLEdBQUdGLE1BQU0sQ0FBQ0csV0FBUCxDQUFtQjtBQUN6Q0MsRUFBQUEsV0FBVyxFQUFDLENBQUNDLEdBQUQsRUFBTUMsSUFBTixFQUFZQyxFQUFaLEtBQW1CO0FBQzNCQSxJQUFBQSxFQUFFLENBQUMsSUFBRCxFQUFRLEdBQUVDLFNBQVUsa0NBQXBCLENBQUY7QUFDSCxHQUh3QztBQUl6Q0MsRUFBQUEsUUFBUSxFQUFFLFVBQVVKLEdBQVYsRUFBZUMsSUFBZixFQUFxQkMsRUFBckIsRUFBeUI7QUFDL0IsVUFBTUcsWUFBWSxHQUFHQyxJQUFJLENBQUNDLEdBQUwsS0FBYSxHQUFiLEdBQW1CQyxJQUFJLENBQUNDLEtBQUwsQ0FBV0QsSUFBSSxDQUFDRSxNQUFMLEtBQWdCLEdBQTNCLENBQXhDO0FBQ0EsUUFBSUMsZ0JBQWdCLEdBQUdWLElBQUksQ0FBQ1csWUFBNUI7QUFDQSxRQUFJQyxTQUFTLEdBQUdGLGdCQUFnQixDQUFDRyxTQUFqQixDQUEyQkgsZ0JBQWdCLENBQUNJLFdBQWpCLENBQTZCLEdBQTdCLElBQW9DLENBQS9ELENBQWhCO0FBQ0FiLElBQUFBLEVBQUUsQ0FBQyxJQUFELEVBQU9ELElBQUksQ0FBQ2UsU0FBTCxHQUFpQixHQUFqQixHQUF1QlgsWUFBdkIsR0FBc0MsR0FBdEMsR0FBMkNRLFNBQWxELENBQUY7QUFDRDtBQVRzQyxDQUFuQixDQUExQjtBQVlBLE1BQU1JLE1BQU0sR0FBR3RCLE1BQU0sQ0FBQztBQUFDdUIsRUFBQUEsT0FBTyxFQUFDckI7QUFBVCxDQUFELENBQXJCO0FBRUEsTUFBTXNCLEdBQUcsR0FBRyxzQkFBWixDLENBRUE7O0FBQ0FBLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLFdBQVQsRUFBc0JDLGNBQWMsQ0FBQ0MsTUFBckM7QUFDQUgsR0FBRyxDQUFDQyxJQUFKLENBQVMsUUFBVCxFQUFtQkMsY0FBYyxDQUFDRSxNQUFsQztBQUNBSixHQUFHLENBQUNLLEdBQUosQ0FBUSxTQUFSLEVBQW1CSCxjQUFjLENBQUNJLE1BQWxDLEUsQ0FFQTs7QUFDQU4sR0FBRyxDQUFDSyxHQUFKLENBQVEsR0FBUixFQUFhRSxjQUFjLENBQUNDLFdBQTVCO0FBQ0FSLEdBQUcsQ0FBQ0ssR0FBSixDQUFRLE1BQVIsRUFBZ0JFLGNBQWMsQ0FBQ0UsV0FBL0I7QUFDQVQsR0FBRyxDQUFDVSxHQUFKLENBQVEsTUFBUixFQUFnQkgsY0FBYyxDQUFDSSxVQUEvQjtBQUNBWCxHQUFHLENBQUNZLE1BQUosQ0FBVyxNQUFYLEVBQW1CTCxjQUFjLENBQUNNLFVBQWxDO0FBQ0FiLEdBQUcsQ0FBQ2MsS0FBSixDQUFVLGFBQVYsRUFBeUJQLGNBQWMsQ0FBQ1EsTUFBeEM7QUFDQWYsR0FBRyxDQUFDYyxLQUFKLENBQVUsZUFBVixFQUEyQlAsY0FBYyxDQUFDUyxRQUExQyxFLENBR0E7QUFDQTs7QUFDQWhCLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLFNBQVQsRUFBb0JILE1BQU0sQ0FBQ21CLE1BQVAsQ0FBYyxNQUFkLENBQXBCLEVBQTRDQyxnQkFBZ0IsQ0FBQ0MsWUFBN0Q7ZUFFZW5CLEciLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL2xpbmV1cC1zb2NpYWwvc2VydmVyL3NyYy9yb3V0ZXMvYXBpLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJvdXRlciB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0ICogYXMgQXV0aENvbnRyb2xsZXIgZnJvbSAnLi4vLi4vY29udHJvbGxlcnMvYXV0aC5jb250cm9sbGVyJztcbmltcG9ydCAqIGFzIFVzZXJDb250cm9sbGVyIGZyb20gJy4uLy4uL2NvbnRyb2xsZXJzL3VzZXIuY29udHJvbGxlcic7XG5pbXBvcnQgKiBhcyBVcGxvYWRDb250cm9sbGVyIGZyb20gJy4uLy4uL2NvbnRyb2xsZXJzL3VwbG9hZC5jb250cm9sbGVyJztcbmNvbnN0IG11bHRlciAgPSByZXF1aXJlKCdtdWx0ZXInKVxuXG5jb25zdCBmaWxlU3RvcmFnZUVuZ2luZSA9IG11bHRlci5kaXNrU3RvcmFnZSh7XG4gICAgZGVzdGluYXRpb246KHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAgICAgY2IobnVsbCwgYCR7X19kaXJuYW1lfS8uLi8uLi8uLi9hc3NldHMvdXBsb2Fkcy9wcm9maWxzYClcbiAgICB9LFxuICAgIGZpbGVuYW1lOiBmdW5jdGlvbiAocmVxLCBmaWxlLCBjYikge1xuICAgICAgICBjb25zdCB1bmlxdWVTdWZmaXggPSBEYXRlLm5vdygpICsgJy0nICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMUU5KVxuICAgICAgICBsZXQgb3JpZ2luYWxOYW1lRmlsZSA9IGZpbGUub3JpZ2luYWxuYW1lO1xuICAgICAgICBsZXQgZXh0ZW5zaW9uID0gb3JpZ2luYWxOYW1lRmlsZS5zdWJzdHJpbmcob3JpZ2luYWxOYW1lRmlsZS5sYXN0SW5kZXhPZignLicpICsgMSk7IFxuICAgICAgICBjYihudWxsLCBmaWxlLmZpZWxkbmFtZSArICctJyArIHVuaXF1ZVN1ZmZpeCArIFwiLlwiKyBleHRlbnNpb24gKVxuICAgICAgfVxufSk7XG5cbmNvbnN0IHVwbG9hZCA9IG11bHRlcih7c3RvcmFnZTpmaWxlU3RvcmFnZUVuZ2luZX0pXG5cbmNvbnN0IGFwaSA9IFJvdXRlcigpO1xuXG4vL2F1dGhcbmFwaS5wb3N0KCcvcmVnaXN0ZXInLCBBdXRoQ29udHJvbGxlci5zaWduVXApO1xuYXBpLnBvc3QoJy9sb2dpbicsIEF1dGhDb250cm9sbGVyLnNpZ25Jbik7XG5hcGkuZ2V0KCcvbG9nb3V0JywgQXV0aENvbnRyb2xsZXIubG9nb3V0KTtcblxuLy91c2VyXG5hcGkuZ2V0KCcvJywgVXNlckNvbnRyb2xsZXIuZ2V0QWxsVXNlcnMpO1xuYXBpLmdldCgnLzppZCcsIFVzZXJDb250cm9sbGVyLmdldFVzZXJJbmZvKTtcbmFwaS5wdXQoJy86aWQnLCBVc2VyQ29udHJvbGxlci51cGRhdGVVc2VyKTtcbmFwaS5kZWxldGUoJy86aWQnLCBVc2VyQ29udHJvbGxlci5kZWxldGVVc2VyKTtcbmFwaS5wYXRjaCgnL2ZvbGxvdy86aWQnLCBVc2VyQ29udHJvbGxlci5mb2xsb3cpO1xuYXBpLnBhdGNoKCcvdW5mb2xsb3cvOmlkJywgVXNlckNvbnRyb2xsZXIudW5mb2xsb3cpO1xuXG5cbi8vdXBsb2FkXG4vL2F2YW50IGRlIHBhc3NlciDDoCBub3RyZSBjb250cm9sbGV1ciBpbCB2YSBjaGVjayBub3RyZSBmaWxlXG5hcGkucG9zdCgnL3VwbG9hZCcsIHVwbG9hZC5zaW5nbGUoXCJmaWxlXCIpLCAgVXBsb2FkQ29udHJvbGxlci51cGxvYWRQcm9maWwpXG5cbmV4cG9ydCBkZWZhdWx0IGFwaTsiXX0=","map":{"version":3,"sources":["user.route.js"],"names":["multer","require","fileStorageEngine","diskStorage","destination","req","file","cb","__dirname","filename","uniqueSuffix","Date","now","Math","round","random","originalNameFile","originalname","extension","substring","lastIndexOf","fieldname","upload","storage","api","post","AuthController","signUp","signIn","get","logout","UserController","getAllUsers","getUserInfo","put","updateUser","delete","deleteUser","patch","follow","unfollow","single","UploadController","uploadProfil"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;AACA,MAAMA,MAAM,GAAIC,OAAO,CAAC,QAAD,CAAvB;;AAEA,MAAMC,iBAAiB,GAAGF,MAAM,CAACG,WAAP,CAAmB;AACzCC,EAAAA,WAAW,EAAC,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,KAAmB;AAC3BA,IAAAA,EAAE,CAAC,IAAD,EAAQ,GAAEC,SAAU,kCAApB,CAAF;AACH,GAHwC;AAIzCC,EAAAA,QAAQ,EAAE,UAAUJ,GAAV,EAAeC,IAAf,EAAqBC,EAArB,EAAyB;AAC/B,UAAMG,YAAY,GAAGC,IAAI,CAACC,GAAL,KAAa,GAAb,GAAmBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAAxC;AACA,QAAIC,gBAAgB,GAAGV,IAAI,CAACW,YAA5B;AACA,QAAIC,SAAS,GAAGF,gBAAgB,CAACG,SAAjB,CAA2BH,gBAAgB,CAACI,WAAjB,CAA6B,GAA7B,IAAoC,CAA/D,CAAhB;AACAb,IAAAA,EAAE,CAAC,IAAD,EAAOD,IAAI,CAACe,SAAL,GAAiB,GAAjB,GAAuBX,YAAvB,GAAsC,GAAtC,GAA2CQ,SAAlD,CAAF;AACD;AATsC,CAAnB,CAA1B;AAYA,MAAMI,MAAM,GAAGtB,MAAM,CAAC;AAACuB,EAAAA,OAAO,EAACrB;AAAT,CAAD,CAArB;AAEA,MAAMsB,GAAG,GAAG,sBAAZ,C,CAEA;;AACAA,GAAG,CAACC,IAAJ,CAAS,WAAT,EAAsBC,cAAc,CAACC,MAArC;AACAH,GAAG,CAACC,IAAJ,CAAS,QAAT,EAAmBC,cAAc,CAACE,MAAlC;AACAJ,GAAG,CAACK,GAAJ,CAAQ,SAAR,EAAmBH,cAAc,CAACI,MAAlC,E,CAEA;;AACAN,GAAG,CAACK,GAAJ,CAAQ,GAAR,EAAaE,cAAc,CAACC,WAA5B;AACAR,GAAG,CAACK,GAAJ,CAAQ,MAAR,EAAgBE,cAAc,CAACE,WAA/B;AACAT,GAAG,CAACU,GAAJ,CAAQ,MAAR,EAAgBH,cAAc,CAACI,UAA/B;AACAX,GAAG,CAACY,MAAJ,CAAW,MAAX,EAAmBL,cAAc,CAACM,UAAlC;AACAb,GAAG,CAACc,KAAJ,CAAU,aAAV,EAAyBP,cAAc,CAACQ,MAAxC;AACAf,GAAG,CAACc,KAAJ,CAAU,eAAV,EAA2BP,cAAc,CAACS,QAA1C,E,CAGA;AACA;;AACAhB,GAAG,CAACC,IAAJ,CAAS,SAAT,EAAoBH,MAAM,CAACmB,MAAP,CAAc,MAAd,CAApB,EAA4CC,gBAAgB,CAACC,YAA7D;eAEenB,G","sourceRoot":"/Applications/dossier/lineup-social/server/src/routes/api/","sourcesContent":["import { Router } from 'express';\nimport * as AuthController from '../../controllers/auth.controller';\nimport * as UserController from '../../controllers/user.controller';\nimport * as UploadController from '../../controllers/upload.controller';\nconst multer  = require('multer')\n\nconst fileStorageEngine = multer.diskStorage({\n    destination:(req, file, cb) => {\n        cb(null, `${__dirname}/../../../assets/uploads/profils`)\n    },\n    filename: function (req, file, cb) {\n        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)\n        let originalNameFile = file.originalname;\n        let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1); \n        cb(null, file.fieldname + '-' + uniqueSuffix + \".\"+ extension )\n      }\n});\n\nconst upload = multer({storage:fileStorageEngine})\n\nconst api = Router();\n\n//auth\napi.post('/register', AuthController.signUp);\napi.post('/login', AuthController.signIn);\napi.get('/logout', AuthController.logout);\n\n//user\napi.get('/', UserController.getAllUsers);\napi.get('/:id', UserController.getUserInfo);\napi.put('/:id', UserController.updateUser);\napi.delete('/:id', UserController.deleteUser);\napi.patch('/follow/:id', UserController.follow);\napi.patch('/unfollow/:id', UserController.unfollow);\n\n\n//upload\n//avant de passer à notre controlleur il va check notre file\napi.post('/upload', upload.single(\"file\"),  UploadController.uploadProfil)\n\nexport default api;"]}},"mtime":1653046975386},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/controllers/auth.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.signUp = exports.signIn = exports.logout = void 0;\n\nvar _express = require(\"express\");\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst User = require('../models/user.model');\n\nconst jwt = require('jsonwebtoken'); //equivalent de 3 jours\n\n\nconst maxAge = 3 * 24 * 60 * 60 * 1000; //function qui créer le token en fonction d'une clé de cryptage qu'on aura mis dans variable d'environnemment\n\nconst createToken = id => {\n  return jwt.sign({\n    id\n  }, process.env.TOKEN_SECRET, {\n    expiresIn: maxAge\n  });\n};\n\nconst signUp = async (req, res) => {\n  const {\n    pseudo,\n    email,\n    password\n  } = req.body;\n\n  try {\n    const user = await User.create({\n      pseudo,\n      email,\n      password\n    });\n    res.status(201).send({\n      user: user._id\n    });\n  } catch (err) {\n    const errors = (0, _errors.signUpErrors)(err);\n    return res.status(200).send({\n      errors\n    });\n  }\n};\n\nexports.signUp = signUp;\n\nconst signIn = async (req, res) => {\n  const {\n    email,\n    password\n  } = req.body;\n\n  try {\n    //check user exist and compare email with password\n    const user = await User.login(email, password); //create token\n\n    const token = createToken(user._id); //on retourne le token dans les cookies accessible seulement par le serveur\n\n    res.cookie(\"jwt\", token, {\n      withCredentials: true,\n      httpOnly: true,\n      maxAge: maxAge\n    });\n    res.status(200).json({\n      user: user._id\n    });\n  } catch (err) {\n    console.log(err);\n    const errors = (0, _errors.signInErrors)(err);\n    return res.status(200).send({\n      errors\n    });\n  }\n};\n\nexports.signIn = signIn;\n\nconst logout = async (req, res) => {\n  res.cookie('jwt', '', {\n    maxAge: 1\n  });\n  res.status(200).json({\n    message: \"disconect\"\n  });\n};\n\nexports.logout = logout;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImp3dCIsIm1heEFnZSIsImNyZWF0ZVRva2VuIiwiaWQiLCJzaWduIiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsImV4cGlyZXNJbiIsInNpZ25VcCIsInJlcSIsInJlcyIsInBzZXVkbyIsImVtYWlsIiwicGFzc3dvcmQiLCJib2R5IiwidXNlciIsImNyZWF0ZSIsInN0YXR1cyIsInNlbmQiLCJfaWQiLCJlcnIiLCJlcnJvcnMiLCJzaWduSW4iLCJsb2dpbiIsInRva2VuIiwiY29va2llIiwid2l0aENyZWRlbnRpYWxzIiwiaHR0cE9ubHkiLCJqc29uIiwiY29uc29sZSIsImxvZyIsImxvZ291dCIsIm1lc3NhZ2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFDQSxNQUFNQyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxjQUFELENBQW5CLEMsQ0FFQTs7O0FBQ0EsTUFBTUUsTUFBTSxHQUFHLElBQUksRUFBSixHQUFTLEVBQVQsR0FBYyxFQUFkLEdBQW1CLElBQWxDLEMsQ0FDQTs7QUFDQSxNQUFNQyxXQUFXLEdBQUlDLEVBQUQsSUFBUTtBQUN4QixTQUFPSCxHQUFHLENBQUNJLElBQUosQ0FBUztBQUFFRCxJQUFBQTtBQUFGLEdBQVQsRUFBaUJFLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUE3QixFQUEyQztBQUM5Q0MsSUFBQUEsU0FBUyxFQUFFUDtBQURtQyxHQUEzQyxDQUFQO0FBR0gsQ0FKRDs7QUFPTyxNQUFNUSxNQUFNLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEtBQW9CO0FBQ3RDLFFBQU07QUFBRUMsSUFBQUEsTUFBRjtBQUFVQyxJQUFBQSxLQUFWO0FBQWlCQyxJQUFBQTtBQUFqQixNQUE4QkosR0FBRyxDQUFDSyxJQUF4Qzs7QUFDQSxNQUFJO0FBQ0EsVUFBTUMsSUFBSSxHQUFHLE1BQU1sQixJQUFJLENBQUNtQixNQUFMLENBQVk7QUFBRUwsTUFBQUEsTUFBRjtBQUFVQyxNQUFBQSxLQUFWO0FBQWlCQyxNQUFBQTtBQUFqQixLQUFaLENBQW5CO0FBQ0FILElBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVILE1BQUFBLElBQUksRUFBRUEsSUFBSSxDQUFDSTtBQUFiLEtBQXJCO0FBQ0gsR0FIRCxDQUlBLE9BQU9DLEdBQVAsRUFBWTtBQUNSLFVBQU1DLE1BQU0sR0FBRywwQkFBYUQsR0FBYixDQUFmO0FBQ0EsV0FBT1YsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBRUcsTUFBQUE7QUFBRixLQUFyQixDQUFQO0FBQ0g7QUFDSixDQVZNOzs7O0FBWUEsTUFBTUMsTUFBTSxHQUFHLE9BQU9iLEdBQVAsRUFBWUMsR0FBWixLQUFvQjtBQUN0QyxRQUFNO0FBQUVFLElBQUFBLEtBQUY7QUFBU0MsSUFBQUE7QUFBVCxNQUFzQkosR0FBRyxDQUFDSyxJQUFoQzs7QUFDQSxNQUFJO0FBQ0E7QUFDQSxVQUFNQyxJQUFJLEdBQUcsTUFBTWxCLElBQUksQ0FBQzBCLEtBQUwsQ0FBV1gsS0FBWCxFQUFrQkMsUUFBbEIsQ0FBbkIsQ0FGQSxDQUdBOztBQUNBLFVBQU1XLEtBQUssR0FBR3ZCLFdBQVcsQ0FBQ2MsSUFBSSxDQUFDSSxHQUFOLENBQXpCLENBSkEsQ0FLQTs7QUFDQVQsSUFBQUEsR0FBRyxDQUFDZSxNQUFKLENBQVcsS0FBWCxFQUFrQkQsS0FBbEIsRUFBeUI7QUFDckJFLE1BQUFBLGVBQWUsRUFBRSxJQURJO0FBRXJCQyxNQUFBQSxRQUFRLEVBQUUsSUFGVztBQUdyQjNCLE1BQUFBLE1BQU0sRUFBRUE7QUFIYSxLQUF6QjtBQUtBVSxJQUFBQSxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCVyxJQUFoQixDQUFxQjtBQUFFYixNQUFBQSxJQUFJLEVBQUVBLElBQUksQ0FBQ0k7QUFBYixLQUFyQjtBQUNILEdBWkQsQ0FhQSxPQUFPQyxHQUFQLEVBQVk7QUFDUlMsSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlWLEdBQVo7QUFDQSxVQUFNQyxNQUFNLEdBQUcsMEJBQWFELEdBQWIsQ0FBZjtBQUNBLFdBQU9WLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVHLE1BQUFBO0FBQUYsS0FBckIsQ0FBUDtBQUNIO0FBQ0osQ0FwQk07Ozs7QUFzQkEsTUFBTVUsTUFBTSxHQUFHLE9BQU90QixHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFDdENBLEVBQUFBLEdBQUcsQ0FBQ2UsTUFBSixDQUFXLEtBQVgsRUFBa0IsRUFBbEIsRUFBc0I7QUFBRXpCLElBQUFBLE1BQU0sRUFBRTtBQUFWLEdBQXRCO0FBQ0FVLEVBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JXLElBQWhCLENBQXFCO0FBQUVJLElBQUFBLE9BQU8sRUFBRTtBQUFYLEdBQXJCO0FBQ0gsQ0FITSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbGluZXVwLXNvY2lhbC9zZXJ2ZXIvc3JjL2NvbnRyb2xsZXJzLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlc3BvbnNlIH0gZnJvbSAnZXhwcmVzcydcbmltcG9ydCB7IHNpZ25VcEVycm9ycywgc2lnbkluRXJyb3JzIH0gZnJvbSAnLi4vdXRpbHMvZXJyb3JzLnV0aWxzJ1xuXG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJylcblxuLy9lcXVpdmFsZW50IGRlIDMgam91cnNcbmNvbnN0IG1heEFnZSA9IDMgKiAyNCAqIDYwICogNjAgKiAxMDAwXG4vL2Z1bmN0aW9uIHF1aSBjcsOpZXIgbGUgdG9rZW4gZW4gZm9uY3Rpb24gZCd1bmUgY2zDqSBkZSBjcnlwdGFnZSBxdSdvbiBhdXJhIG1pcyBkYW5zIHZhcmlhYmxlIGQnZW52aXJvbm5lbW1lbnRcbmNvbnN0IGNyZWF0ZVRva2VuID0gKGlkKSA9PiB7XG4gICAgcmV0dXJuIGp3dC5zaWduKHsgaWQgfSwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVULCB7XG4gICAgICAgIGV4cGlyZXNJbjogbWF4QWdlXG4gICAgfSlcbn1cblxuXG5leHBvcnQgY29uc3Qgc2lnblVwID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBwc2V1ZG8sIGVtYWlsLCBwYXNzd29yZCB9ID0gcmVxLmJvZHlcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5jcmVhdGUoeyBwc2V1ZG8sIGVtYWlsLCBwYXNzd29yZCB9KVxuICAgICAgICByZXMuc3RhdHVzKDIwMSkuc2VuZCh7IHVzZXI6IHVzZXIuX2lkIH0pXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc3QgZXJyb3JzID0gc2lnblVwRXJyb3JzKGVycilcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHsgZXJyb3JzIH0pXG4gICAgfVxufVxuXG5leHBvcnQgY29uc3Qgc2lnbkluID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5XG4gICAgdHJ5IHtcbiAgICAgICAgLy9jaGVjayB1c2VyIGV4aXN0IGFuZCBjb21wYXJlIGVtYWlsIHdpdGggcGFzc3dvcmRcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIubG9naW4oZW1haWwsIHBhc3N3b3JkKVxuICAgICAgICAvL2NyZWF0ZSB0b2tlblxuICAgICAgICBjb25zdCB0b2tlbiA9IGNyZWF0ZVRva2VuKHVzZXIuX2lkKVxuICAgICAgICAvL29uIHJldG91cm5lIGxlIHRva2VuIGRhbnMgbGVzIGNvb2tpZXMgYWNjZXNzaWJsZSBzZXVsZW1lbnQgcGFyIGxlIHNlcnZldXJcbiAgICAgICAgcmVzLmNvb2tpZShcImp3dFwiLCB0b2tlbiwge1xuICAgICAgICAgICAgd2l0aENyZWRlbnRpYWxzOiB0cnVlLFxuICAgICAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgICAgICBtYXhBZ2U6IG1heEFnZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgdXNlcjogdXNlci5faWQgfSlcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIGNvbnN0IGVycm9ycyA9IHNpZ25JbkVycm9ycyhlcnIpXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IGVycm9ycyB9KVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGxvZ291dCA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5jb29raWUoJ2p3dCcsICcnLCB7IG1heEFnZTogMSB9KTtcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6IFwiZGlzY29uZWN0XCIgfSlcbn1cblxuIl19","map":{"version":3,"sources":["auth.controller.js"],"names":["User","require","jwt","maxAge","createToken","id","sign","process","env","TOKEN_SECRET","expiresIn","signUp","req","res","pseudo","email","password","body","user","create","status","send","_id","err","errors","signIn","login","token","cookie","withCredentials","httpOnly","json","console","log","logout","message"],"mappings":";;;;;;;AAAA;;AACA;;AAEA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AACA,MAAMC,GAAG,GAAGD,OAAO,CAAC,cAAD,CAAnB,C,CAEA;;;AACA,MAAME,MAAM,GAAG,IAAI,EAAJ,GAAS,EAAT,GAAc,EAAd,GAAmB,IAAlC,C,CACA;;AACA,MAAMC,WAAW,GAAIC,EAAD,IAAQ;AACxB,SAAOH,GAAG,CAACI,IAAJ,CAAS;AAAED,IAAAA;AAAF,GAAT,EAAiBE,OAAO,CAACC,GAAR,CAAYC,YAA7B,EAA2C;AAC9CC,IAAAA,SAAS,EAAEP;AADmC,GAA3C,CAAP;AAGH,CAJD;;AAOO,MAAMQ,MAAM,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACtC,QAAM;AAAEC,IAAAA,MAAF;AAAUC,IAAAA,KAAV;AAAiBC,IAAAA;AAAjB,MAA8BJ,GAAG,CAACK,IAAxC;;AACA,MAAI;AACA,UAAMC,IAAI,GAAG,MAAMlB,IAAI,CAACmB,MAAL,CAAY;AAAEL,MAAAA,MAAF;AAAUC,MAAAA,KAAV;AAAiBC,MAAAA;AAAjB,KAAZ,CAAnB;AACAH,IAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEH,MAAAA,IAAI,EAAEA,IAAI,CAACI;AAAb,KAArB;AACH,GAHD,CAIA,OAAOC,GAAP,EAAY;AACR,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOV,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEG,MAAAA;AAAF,KAArB,CAAP;AACH;AACJ,CAVM;;;;AAYA,MAAMC,MAAM,GAAG,OAAOb,GAAP,EAAYC,GAAZ,KAAoB;AACtC,QAAM;AAAEE,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAsBJ,GAAG,CAACK,IAAhC;;AACA,MAAI;AACA;AACA,UAAMC,IAAI,GAAG,MAAMlB,IAAI,CAAC0B,KAAL,CAAWX,KAAX,EAAkBC,QAAlB,CAAnB,CAFA,CAGA;;AACA,UAAMW,KAAK,GAAGvB,WAAW,CAACc,IAAI,CAACI,GAAN,CAAzB,CAJA,CAKA;;AACAT,IAAAA,GAAG,CAACe,MAAJ,CAAW,KAAX,EAAkBD,KAAlB,EAAyB;AACrBE,MAAAA,eAAe,EAAE,IADI;AAErBC,MAAAA,QAAQ,EAAE,IAFW;AAGrB3B,MAAAA,MAAM,EAAEA;AAHa,KAAzB;AAKAU,IAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB;AAAEb,MAAAA,IAAI,EAAEA,IAAI,CAACI;AAAb,KAArB;AACH,GAZD,CAaA,OAAOC,GAAP,EAAY;AACRS,IAAAA,OAAO,CAACC,GAAR,CAAYV,GAAZ;AACA,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOV,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEG,MAAAA;AAAF,KAArB,CAAP;AACH;AACJ,CApBM;;;;AAsBA,MAAMU,MAAM,GAAG,OAAOtB,GAAP,EAAYC,GAAZ,KAAoB;AACtCA,EAAAA,GAAG,CAACe,MAAJ,CAAW,KAAX,EAAkB,EAAlB,EAAsB;AAAEzB,IAAAA,MAAM,EAAE;AAAV,GAAtB;AACAU,EAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB;AAAEI,IAAAA,OAAO,EAAE;AAAX,GAArB;AACH,CAHM","sourceRoot":"/Applications/dossier/lineup-social/server/src/controllers/","sourcesContent":["import { response } from 'express'\nimport { signUpErrors, signInErrors } from '../utils/errors.utils'\n\nconst User = require('../models/user.model')\nconst jwt = require('jsonwebtoken')\n\n//equivalent de 3 jours\nconst maxAge = 3 * 24 * 60 * 60 * 1000\n//function qui créer le token en fonction d'une clé de cryptage qu'on aura mis dans variable d'environnemment\nconst createToken = (id) => {\n    return jwt.sign({ id }, process.env.TOKEN_SECRET, {\n        expiresIn: maxAge\n    })\n}\n\n\nexport const signUp = async (req, res) => {\n    const { pseudo, email, password } = req.body\n    try {\n        const user = await User.create({ pseudo, email, password })\n        res.status(201).send({ user: user._id })\n    }\n    catch (err) {\n        const errors = signUpErrors(err)\n        return res.status(200).send({ errors })\n    }\n}\n\nexport const signIn = async (req, res) => {\n    const { email, password } = req.body\n    try {\n        //check user exist and compare email with password\n        const user = await User.login(email, password)\n        //create token\n        const token = createToken(user._id)\n        //on retourne le token dans les cookies accessible seulement par le serveur\n        res.cookie(\"jwt\", token, {\n            withCredentials: true,\n            httpOnly: true,\n            maxAge: maxAge,\n        });\n        res.status(200).json({ user: user._id })\n    }\n    catch (err) {\n        console.log(err)\n        const errors = signInErrors(err)\n        return res.status(200).send({ errors })\n    }\n}\n\nexport const logout = async (req, res) => {\n    res.cookie('jwt', '', { maxAge: 1 });\n    res.status(200).json({ message: \"disconect\" })\n}\n\n"]}},"mtime":1651349889429},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/utils/errors.utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.uploadErrors = exports.signUpErrors = exports.signInErrors = void 0;\n\nconst signUpErrors = err => {\n  let errors = {\n    pseudo: '',\n    email: '',\n    password: ''\n  };\n\n  if (err.message.includes('pseudo')) {\n    errors.pseudo = \"Pseudo incorrect\";\n  }\n\n  if (err.message.includes('email')) {\n    errors.email = \"Email incorrect\";\n  }\n\n  if (err.message.includes('password')) {\n    errors.password = \"Password incorrect ! Password must be at least 6 characters\";\n  }\n\n  if (err.code === 11000 && Object.keys(err.keyValue)[0].includes('pseudo')) {\n    errors.pseudo = \"Pseudo already use\";\n  }\n\n  if (err.code === 11000 && Object.keys(err.keyValue)[0].includes('email')) {\n    errors.email = \"Email already use\";\n  }\n\n  return errors;\n};\n\nexports.signUpErrors = signUpErrors;\n\nconst signInErrors = err => {\n  let errors = {\n    email: '',\n    password: ''\n  };\n\n  if (err.message.includes('email')) {\n    errors.email = \"Email inconnu\";\n  }\n\n  if (err.message.includes('password')) {\n    errors.password = \"Vos identifiants sont incorrects !\";\n  }\n\n  return errors;\n};\n\nexports.signInErrors = signInErrors;\n\nconst uploadErrors = err => {\n  let errors = {\n    format: '',\n    maxSize: ''\n  };\n\n  if (err.message.includes('invalid file')) {\n    errors.format = \"format incompatible\";\n  }\n\n  if (err.message.includes('max size')) {\n    errors.maxSize = \"Le fichier dépasse 500ko\";\n  }\n\n  return errors;\n};\n\nexports.uploadErrors = uploadErrors;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9ycy51dGlscy5qcyJdLCJuYW1lcyI6WyJzaWduVXBFcnJvcnMiLCJlcnIiLCJlcnJvcnMiLCJwc2V1ZG8iLCJlbWFpbCIsInBhc3N3b3JkIiwibWVzc2FnZSIsImluY2x1ZGVzIiwiY29kZSIsIk9iamVjdCIsImtleXMiLCJrZXlWYWx1ZSIsInNpZ25JbkVycm9ycyIsInVwbG9hZEVycm9ycyIsImZvcm1hdCIsIm1heFNpemUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBTyxNQUFNQSxZQUFZLEdBQUlDLEdBQUQsSUFBUztBQUNqQyxNQUFJQyxNQUFNLEdBQUc7QUFBQ0MsSUFBQUEsTUFBTSxFQUFFLEVBQVQ7QUFBYUMsSUFBQUEsS0FBSyxFQUFFLEVBQXBCO0FBQXdCQyxJQUFBQSxRQUFRLEVBQUU7QUFBbEMsR0FBYjs7QUFFQSxNQUFHSixHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixRQUFyQixDQUFILEVBQWtDO0FBQzlCTCxJQUFBQSxNQUFNLENBQUNDLE1BQVAsR0FBZ0Isa0JBQWhCO0FBQ0g7O0FBQ0QsTUFBR0YsR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsT0FBckIsQ0FBSCxFQUFpQztBQUM3QkwsSUFBQUEsTUFBTSxDQUFDRSxLQUFQLEdBQWUsaUJBQWY7QUFDSDs7QUFDRCxNQUFHSCxHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixVQUFyQixDQUFILEVBQW9DO0FBQ2hDTCxJQUFBQSxNQUFNLENBQUNHLFFBQVAsR0FBa0IsNkRBQWxCO0FBQ0g7O0FBQ0QsTUFBR0osR0FBRyxDQUFDTyxJQUFKLEtBQWEsS0FBYixJQUFzQkMsTUFBTSxDQUFDQyxJQUFQLENBQVlULEdBQUcsQ0FBQ1UsUUFBaEIsRUFBMEIsQ0FBMUIsRUFBNkJKLFFBQTdCLENBQXNDLFFBQXRDLENBQXpCLEVBQXlFO0FBQ3JFTCxJQUFBQSxNQUFNLENBQUNDLE1BQVAsR0FBZ0Isb0JBQWhCO0FBQ0g7O0FBQ0QsTUFBR0YsR0FBRyxDQUFDTyxJQUFKLEtBQWEsS0FBYixJQUFzQkMsTUFBTSxDQUFDQyxJQUFQLENBQVlULEdBQUcsQ0FBQ1UsUUFBaEIsRUFBMEIsQ0FBMUIsRUFBNkJKLFFBQTdCLENBQXNDLE9BQXRDLENBQXpCLEVBQXdFO0FBQ3BFTCxJQUFBQSxNQUFNLENBQUNFLEtBQVAsR0FBZSxtQkFBZjtBQUNIOztBQUVELFNBQU9GLE1BQVA7QUFDSCxDQXBCTTs7OztBQXNCQSxNQUFNVSxZQUFZLEdBQUlYLEdBQUQsSUFBUztBQUNqQyxNQUFJQyxNQUFNLEdBQUc7QUFBRUUsSUFBQUEsS0FBSyxFQUFFLEVBQVQ7QUFBYUMsSUFBQUEsUUFBUSxFQUFFO0FBQXZCLEdBQWI7O0FBQ0EsTUFBR0osR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsT0FBckIsQ0FBSCxFQUFpQztBQUM3QkwsSUFBQUEsTUFBTSxDQUFDRSxLQUFQLEdBQWUsZUFBZjtBQUNIOztBQUNELE1BQUdILEdBQUcsQ0FBQ0ssT0FBSixDQUFZQyxRQUFaLENBQXFCLFVBQXJCLENBQUgsRUFBb0M7QUFDaENMLElBQUFBLE1BQU0sQ0FBQ0csUUFBUCxHQUFrQixvQ0FBbEI7QUFDSDs7QUFDRCxTQUFPSCxNQUFQO0FBQ0gsQ0FUTTs7OztBQVdBLE1BQU1XLFlBQVksR0FBSVosR0FBRCxJQUFTO0FBQ2pDLE1BQUlDLE1BQU0sR0FBRztBQUFDWSxJQUFBQSxNQUFNLEVBQUUsRUFBVDtBQUFhQyxJQUFBQSxPQUFPLEVBQUM7QUFBckIsR0FBYjs7QUFFQSxNQUFHZCxHQUFHLENBQUNLLE9BQUosQ0FBWUMsUUFBWixDQUFxQixjQUFyQixDQUFILEVBQXdDO0FBQ3BDTCxJQUFBQSxNQUFNLENBQUNZLE1BQVAsR0FBZ0IscUJBQWhCO0FBQ0g7O0FBRUQsTUFBR2IsR0FBRyxDQUFDSyxPQUFKLENBQVlDLFFBQVosQ0FBcUIsVUFBckIsQ0FBSCxFQUFvQztBQUNoQ0wsSUFBQUEsTUFBTSxDQUFDYSxPQUFQLEdBQWlCLDBCQUFqQjtBQUNIOztBQUNELFNBQU9iLE1BQVA7QUFDSCxDQVhNIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9saW5ldXAtc29jaWFsL3NlcnZlci9zcmMvdXRpbHMvIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNpZ25VcEVycm9ycyA9IChlcnIpID0+IHtcbiAgICBsZXQgZXJyb3JzID0ge3BzZXVkbzogJycsIGVtYWlsOiAnJywgcGFzc3dvcmQ6ICcnfVxuICAgIFxuICAgIGlmKGVyci5tZXNzYWdlLmluY2x1ZGVzKCdwc2V1ZG8nKSl7XG4gICAgICAgIGVycm9ycy5wc2V1ZG8gPSBcIlBzZXVkbyBpbmNvcnJlY3RcIlxuICAgIH1cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygnZW1haWwnKSl7XG4gICAgICAgIGVycm9ycy5lbWFpbCA9IFwiRW1haWwgaW5jb3JyZWN0XCJcbiAgICB9XG4gICAgaWYoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ3Bhc3N3b3JkJykpe1xuICAgICAgICBlcnJvcnMucGFzc3dvcmQgPSBcIlBhc3N3b3JkIGluY29ycmVjdCAhIFBhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgNiBjaGFyYWN0ZXJzXCJcbiAgICB9XG4gICAgaWYoZXJyLmNvZGUgPT09IDExMDAwICYmIE9iamVjdC5rZXlzKGVyci5rZXlWYWx1ZSlbMF0uaW5jbHVkZXMoJ3BzZXVkbycpKXtcbiAgICAgICAgZXJyb3JzLnBzZXVkbyA9IFwiUHNldWRvIGFscmVhZHkgdXNlXCJcbiAgICB9XG4gICAgaWYoZXJyLmNvZGUgPT09IDExMDAwICYmIE9iamVjdC5rZXlzKGVyci5rZXlWYWx1ZSlbMF0uaW5jbHVkZXMoJ2VtYWlsJykpe1xuICAgICAgICBlcnJvcnMuZW1haWwgPSBcIkVtYWlsIGFscmVhZHkgdXNlXCJcbiAgICB9XG5cbiAgICByZXR1cm4gZXJyb3JzXG59XG5cbmV4cG9ydCBjb25zdCBzaWduSW5FcnJvcnMgPSAoZXJyKSA9PiB7XG4gICAgbGV0IGVycm9ycyA9IHsgZW1haWw6ICcnLCBwYXNzd29yZDogJyd9XG4gICAgaWYoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ2VtYWlsJykpe1xuICAgICAgICBlcnJvcnMuZW1haWwgPSBcIkVtYWlsIGluY29ubnVcIlxuICAgIH1cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygncGFzc3dvcmQnKSl7XG4gICAgICAgIGVycm9ycy5wYXNzd29yZCA9IFwiVm9zIGlkZW50aWZpYW50cyBzb250IGluY29ycmVjdHMgIVwiXG4gICAgfVxuICAgIHJldHVybiBlcnJvcnNcbn1cblxuZXhwb3J0IGNvbnN0IHVwbG9hZEVycm9ycyA9IChlcnIpID0+IHtcbiAgICBsZXQgZXJyb3JzID0ge2Zvcm1hdDogJycsIG1heFNpemU6Jyd9XG5cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygnaW52YWxpZCBmaWxlJykpe1xuICAgICAgICBlcnJvcnMuZm9ybWF0ID0gXCJmb3JtYXQgaW5jb21wYXRpYmxlXCJcbiAgICB9XG5cbiAgICBpZihlcnIubWVzc2FnZS5pbmNsdWRlcygnbWF4IHNpemUnKSl7XG4gICAgICAgIGVycm9ycy5tYXhTaXplID0gXCJMZSBmaWNoaWVyIGTDqXBhc3NlIDUwMGtvXCJcbiAgICB9XG4gICAgcmV0dXJuIGVycm9ycztcbn0iXX0=","map":{"version":3,"sources":["errors.utils.js"],"names":["signUpErrors","err","errors","pseudo","email","password","message","includes","code","Object","keys","keyValue","signInErrors","uploadErrors","format","maxSize"],"mappings":";;;;;;;AAAO,MAAMA,YAAY,GAAIC,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAACC,IAAAA,MAAM,EAAE,EAAT;AAAaC,IAAAA,KAAK,EAAE,EAApB;AAAwBC,IAAAA,QAAQ,EAAE;AAAlC,GAAb;;AAEA,MAAGJ,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,QAArB,CAAH,EAAkC;AAC9BL,IAAAA,MAAM,CAACC,MAAP,GAAgB,kBAAhB;AACH;;AACD,MAAGF,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,OAArB,CAAH,EAAiC;AAC7BL,IAAAA,MAAM,CAACE,KAAP,GAAe,iBAAf;AACH;;AACD,MAAGH,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACG,QAAP,GAAkB,6DAAlB;AACH;;AACD,MAAGJ,GAAG,CAACO,IAAJ,KAAa,KAAb,IAAsBC,MAAM,CAACC,IAAP,CAAYT,GAAG,CAACU,QAAhB,EAA0B,CAA1B,EAA6BJ,QAA7B,CAAsC,QAAtC,CAAzB,EAAyE;AACrEL,IAAAA,MAAM,CAACC,MAAP,GAAgB,oBAAhB;AACH;;AACD,MAAGF,GAAG,CAACO,IAAJ,KAAa,KAAb,IAAsBC,MAAM,CAACC,IAAP,CAAYT,GAAG,CAACU,QAAhB,EAA0B,CAA1B,EAA6BJ,QAA7B,CAAsC,OAAtC,CAAzB,EAAwE;AACpEL,IAAAA,MAAM,CAACE,KAAP,GAAe,mBAAf;AACH;;AAED,SAAOF,MAAP;AACH,CApBM;;;;AAsBA,MAAMU,YAAY,GAAIX,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAAEE,IAAAA,KAAK,EAAE,EAAT;AAAaC,IAAAA,QAAQ,EAAE;AAAvB,GAAb;;AACA,MAAGJ,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,OAArB,CAAH,EAAiC;AAC7BL,IAAAA,MAAM,CAACE,KAAP,GAAe,eAAf;AACH;;AACD,MAAGH,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACG,QAAP,GAAkB,oCAAlB;AACH;;AACD,SAAOH,MAAP;AACH,CATM;;;;AAWA,MAAMW,YAAY,GAAIZ,GAAD,IAAS;AACjC,MAAIC,MAAM,GAAG;AAACY,IAAAA,MAAM,EAAE,EAAT;AAAaC,IAAAA,OAAO,EAAC;AAArB,GAAb;;AAEA,MAAGd,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,cAArB,CAAH,EAAwC;AACpCL,IAAAA,MAAM,CAACY,MAAP,GAAgB,qBAAhB;AACH;;AAED,MAAGb,GAAG,CAACK,OAAJ,CAAYC,QAAZ,CAAqB,UAArB,CAAH,EAAoC;AAChCL,IAAAA,MAAM,CAACa,OAAP,GAAiB,0BAAjB;AACH;;AACD,SAAOb,MAAP;AACH,CAXM","sourceRoot":"/Applications/dossier/lineup-social/server/src/utils/","sourcesContent":["export const signUpErrors = (err) => {\n    let errors = {pseudo: '', email: '', password: ''}\n    \n    if(err.message.includes('pseudo')){\n        errors.pseudo = \"Pseudo incorrect\"\n    }\n    if(err.message.includes('email')){\n        errors.email = \"Email incorrect\"\n    }\n    if(err.message.includes('password')){\n        errors.password = \"Password incorrect ! Password must be at least 6 characters\"\n    }\n    if(err.code === 11000 && Object.keys(err.keyValue)[0].includes('pseudo')){\n        errors.pseudo = \"Pseudo already use\"\n    }\n    if(err.code === 11000 && Object.keys(err.keyValue)[0].includes('email')){\n        errors.email = \"Email already use\"\n    }\n\n    return errors\n}\n\nexport const signInErrors = (err) => {\n    let errors = { email: '', password: ''}\n    if(err.message.includes('email')){\n        errors.email = \"Email inconnu\"\n    }\n    if(err.message.includes('password')){\n        errors.password = \"Vos identifiants sont incorrects !\"\n    }\n    return errors\n}\n\nexport const uploadErrors = (err) => {\n    let errors = {format: '', maxSize:''}\n\n    if(err.message.includes('invalid file')){\n        errors.format = \"format incompatible\"\n    }\n\n    if(err.message.includes('max size')){\n        errors.maxSize = \"Le fichier dépasse 500ko\"\n    }\n    return errors;\n}"]}},"mtime":1651327729166},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/models/user.model.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nconst {\n  isEmail\n} = require('validator');\n\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  pseudo: {\n    type: String,\n    required: true,\n    minlength: 3,\n    maxlength: 55,\n    unique: true,\n    trim: true\n  },\n  email: {\n    type: String,\n    required: true,\n    validate: [isEmail],\n    lowercase: true,\n    unique: true,\n    trim: true\n  },\n  password: {\n    type: String,\n    required: true,\n    max: 1024,\n    minlength: 6\n  },\n  picture: {\n    type: String,\n    default: \"./uploads/profil/random-user.png\"\n  },\n  bio: {\n    type: String,\n    max: 1024\n  },\n  followers: {\n    type: [String]\n  },\n  following: {\n    type: [String]\n  },\n  likes: {\n    type: [String]\n  }\n}, {\n  timestamps: true\n}); //play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\n\nUserSchema.pre('save', async function (next) {\n  const salt = await bcrypt.genSalt();\n  this.password = await bcrypt.hash(this.password, salt);\n  next();\n}); //c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\n\nUserSchema.statics.login = async function (email, password) {\n  const user = await this.findOne({\n    email: email\n  });\n\n  if (user) {\n    const auth = await bcrypt.compare(password, user.password);\n\n    if (auth) {\n      return user;\n    } else {\n      throw Error('Incorrect password');\n    }\n  }\n\n  throw Error('Incorrect password');\n};\n\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIubW9kZWwuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiaXNFbWFpbCIsImJjcnlwdCIsIlNjaGVtYSIsIlVzZXJTY2hlbWEiLCJwc2V1ZG8iLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJtaW5sZW5ndGgiLCJtYXhsZW5ndGgiLCJ1bmlxdWUiLCJ0cmltIiwiZW1haWwiLCJ2YWxpZGF0ZSIsImxvd2VyY2FzZSIsInBhc3N3b3JkIiwibWF4IiwicGljdHVyZSIsImRlZmF1bHQiLCJiaW8iLCJmb2xsb3dlcnMiLCJmb2xsb3dpbmciLCJsaWtlcyIsInRpbWVzdGFtcHMiLCJwcmUiLCJuZXh0Iiwic2FsdCIsImdlblNhbHQiLCJoYXNoIiwic3RhdGljcyIsImxvZ2luIiwidXNlciIsImZpbmRPbmUiLCJhdXRoIiwiY29tcGFyZSIsIkVycm9yIiwiVXNlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUNBLE1BQU07QUFBQ0MsRUFBQUE7QUFBRCxJQUFZRCxPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFDQSxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxRQUFELENBQXRCOztBQUVBLE1BQU1HLE1BQU0sR0FBR0osUUFBUSxDQUFDSSxNQUF4QjtBQUNBLE1BQU1DLFVBQVUsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDMUJFLEVBQUFBLE1BQU0sRUFBRTtBQUNKQyxJQUFBQSxJQUFJLEVBQUVDLE1BREY7QUFFSkMsSUFBQUEsUUFBUSxFQUFDLElBRkw7QUFHSkMsSUFBQUEsU0FBUyxFQUFFLENBSFA7QUFJSkMsSUFBQUEsU0FBUyxFQUFDLEVBSk47QUFLSkMsSUFBQUEsTUFBTSxFQUFDLElBTEg7QUFNSkMsSUFBQUEsSUFBSSxFQUFDO0FBTkQsR0FEa0I7QUFTMUJDLEVBQUFBLEtBQUssRUFBQztBQUNGUCxJQUFBQSxJQUFJLEVBQUNDLE1BREg7QUFFRkMsSUFBQUEsUUFBUSxFQUFDLElBRlA7QUFHRk0sSUFBQUEsUUFBUSxFQUFDLENBQUNiLE9BQUQsQ0FIUDtBQUlGYyxJQUFBQSxTQUFTLEVBQUMsSUFKUjtBQUtGSixJQUFBQSxNQUFNLEVBQUMsSUFMTDtBQU1GQyxJQUFBQSxJQUFJLEVBQUM7QUFOSCxHQVRvQjtBQWlCMUJJLEVBQUFBLFFBQVEsRUFBQztBQUNMVixJQUFBQSxJQUFJLEVBQUNDLE1BREE7QUFFTEMsSUFBQUEsUUFBUSxFQUFDLElBRko7QUFHTFMsSUFBQUEsR0FBRyxFQUFDLElBSEM7QUFJTFIsSUFBQUEsU0FBUyxFQUFDO0FBSkwsR0FqQmlCO0FBdUIxQlMsRUFBQUEsT0FBTyxFQUFDO0FBQ0paLElBQUFBLElBQUksRUFBQ0MsTUFERDtBQUVKWSxJQUFBQSxPQUFPLEVBQUM7QUFGSixHQXZCa0I7QUEyQjFCQyxFQUFBQSxHQUFHLEVBQUM7QUFDQWQsSUFBQUEsSUFBSSxFQUFDQyxNQURMO0FBRUFVLElBQUFBLEdBQUcsRUFBQztBQUZKLEdBM0JzQjtBQStCMUJJLEVBQUFBLFNBQVMsRUFBRTtBQUNQZixJQUFBQSxJQUFJLEVBQUMsQ0FBQ0MsTUFBRDtBQURFLEdBL0JlO0FBa0MxQmUsRUFBQUEsU0FBUyxFQUFDO0FBQ05oQixJQUFBQSxJQUFJLEVBQUMsQ0FBQ0MsTUFBRDtBQURDLEdBbENnQjtBQXFDMUJnQixFQUFBQSxLQUFLLEVBQUU7QUFDSGpCLElBQUFBLElBQUksRUFBQyxDQUFDQyxNQUFEO0FBREY7QUFyQ21CLENBQVgsRUF3Q2hCO0FBQ0NpQixFQUFBQSxVQUFVLEVBQUM7QUFEWixDQXhDZ0IsQ0FBbkIsQyxDQTZDQTtBQUNBOztBQUNBcEIsVUFBVSxDQUFDcUIsR0FBWCxDQUFlLE1BQWYsRUFBdUIsZ0JBQWdCQyxJQUFoQixFQUFxQjtBQUN4QyxRQUFNQyxJQUFJLEdBQUcsTUFBTXpCLE1BQU0sQ0FBQzBCLE9BQVAsRUFBbkI7QUFDQSxPQUFLWixRQUFMLEdBQWdCLE1BQU1kLE1BQU0sQ0FBQzJCLElBQVAsQ0FBWSxLQUFLYixRQUFqQixFQUEyQlcsSUFBM0IsQ0FBdEI7QUFDQUQsRUFBQUEsSUFBSTtBQUNQLENBSkQsRSxDQU1BOztBQUNBdEIsVUFBVSxDQUFDMEIsT0FBWCxDQUFtQkMsS0FBbkIsR0FBMkIsZ0JBQWVsQixLQUFmLEVBQXNCRyxRQUF0QixFQUErQjtBQUN0RCxRQUFNZ0IsSUFBSSxHQUFHLE1BQU0sS0FBS0MsT0FBTCxDQUFhO0FBQUNwQixJQUFBQSxLQUFLLEVBQUVBO0FBQVIsR0FBYixDQUFuQjs7QUFDQSxNQUFHbUIsSUFBSCxFQUFRO0FBQ0osVUFBTUUsSUFBSSxHQUFHLE1BQU1oQyxNQUFNLENBQUNpQyxPQUFQLENBQWVuQixRQUFmLEVBQXlCZ0IsSUFBSSxDQUFDaEIsUUFBOUIsQ0FBbkI7O0FBQ0EsUUFBR2tCLElBQUgsRUFBUTtBQUNKLGFBQU9GLElBQVA7QUFDSCxLQUZELE1BR0k7QUFDQSxZQUFNSSxLQUFLLENBQUMsb0JBQUQsQ0FBWDtBQUNIO0FBQ0o7O0FBQ0QsUUFBTUEsS0FBSyxDQUFDLG9CQUFELENBQVg7QUFDSCxDQVpEOztBQWFBLElBQUlDLElBQUksR0FBR3RDLFFBQVEsQ0FBQ3VDLEtBQVQsQ0FBZSxNQUFmLEVBQXVCbEMsVUFBdkIsQ0FBWDtBQUNBbUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCSCxJQUFqQiIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbGluZXVwLXNvY2lhbC9zZXJ2ZXIvc3JjL21vZGVscy8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XG5jb25zdCB7aXNFbWFpbH0gPSByZXF1aXJlKCd2YWxpZGF0b3InKTtcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gICAgcHNldWRvOiB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgcmVxdWlyZWQ6dHJ1ZSxcbiAgICAgICAgbWlubGVuZ3RoOiAzLCBcbiAgICAgICAgbWF4bGVuZ3RoOjU1LCBcbiAgICAgICAgdW5pcXVlOnRydWUsXG4gICAgICAgIHRyaW06dHJ1ZVxuICAgIH0sXG4gICAgZW1haWw6e1xuICAgICAgICB0eXBlOlN0cmluZyxcbiAgICAgICAgcmVxdWlyZWQ6dHJ1ZSxcbiAgICAgICAgdmFsaWRhdGU6W2lzRW1haWxdLFxuICAgICAgICBsb3dlcmNhc2U6dHJ1ZSwgICAgICAgIFxuICAgICAgICB1bmlxdWU6dHJ1ZSxcbiAgICAgICAgdHJpbTp0cnVlLFxuICAgIH0sXG4gICAgcGFzc3dvcmQ6e1xuICAgICAgICB0eXBlOlN0cmluZyxcbiAgICAgICAgcmVxdWlyZWQ6dHJ1ZSxcbiAgICAgICAgbWF4OjEwMjQsXG4gICAgICAgIG1pbmxlbmd0aDo2XG4gICAgfSxcbiAgICBwaWN0dXJlOntcbiAgICAgICAgdHlwZTpTdHJpbmcsXG4gICAgICAgIGRlZmF1bHQ6XCIuL3VwbG9hZHMvcHJvZmlsL3JhbmRvbS11c2VyLnBuZ1wiXG4gICAgfSxcbiAgICBiaW86e1xuICAgICAgICB0eXBlOlN0cmluZyxcbiAgICAgICAgbWF4OjEwMjRcbiAgICB9LFxuICAgIGZvbGxvd2Vyczoge1xuICAgICAgICB0eXBlOltTdHJpbmddLFxuICAgIH0sXG4gICAgZm9sbG93aW5nOntcbiAgICAgICAgdHlwZTpbU3RyaW5nXSxcbiAgICB9LFxuICAgIGxpa2VzOiB7XG4gICAgICAgIHR5cGU6W1N0cmluZ10sXG4gICAgfVxufSwge1xuICAgIHRpbWVzdGFtcHM6dHJ1ZVxufVxuKTtcblxuLy9wbGF5IGZ1bmN0aW9uIGJlZm9yZSBzYXZlIGludG8gZGIgdG8gYWxsb3cgY3J5cHQgcGFzc3dvcmRcbi8vIGxlIG5leHQgdmV1dCBkaXJlIHF1YW5kIHQnYSBmaW5pIHBhc3NlIMOgIGxhIHN1aXRlXG5Vc2VyU2NoZW1hLnByZSgnc2F2ZScsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KXtcbiAgICBjb25zdCBzYWx0ID0gYXdhaXQgYmNyeXB0LmdlblNhbHQoKTtcbiAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgc2FsdCk7XG4gICAgbmV4dCgpO1xufSlcblxuLy9jJ2VzdCBjZSBxdWkgdmEgbm91cyBwZXJtZXR0cmUgZGUgY29tcGFyZXIgbGUgcGFzc3dvcmQgY3J5cHTDqSBkZSBub3RyZSB1c2VyIGVuIGJhc2UgZGUgZG9ubsOpZXMgYXZlYyBjZWx1aSB1dGlsaXNlIHBkdCBsZSBsb2dpbiBkJ3VuIHVzZXJcblVzZXJTY2hlbWEuc3RhdGljcy5sb2dpbiA9IGFzeW5jIGZ1bmN0aW9uKGVtYWlsLCBwYXNzd29yZCl7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXMuZmluZE9uZSh7ZW1haWw6IGVtYWlsfSk7XG4gICAgaWYodXNlcil7XG4gICAgICAgIGNvbnN0IGF1dGggPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgdXNlci5wYXNzd29yZClcbiAgICAgICAgaWYoYXV0aCl7XG4gICAgICAgICAgICByZXR1cm4gdXNlclxuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignSW5jb3JyZWN0IHBhc3N3b3JkJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGhyb3cgRXJyb3IoJ0luY29ycmVjdCBwYXNzd29yZCcpO1xufVxubGV0IFVzZXIgPSBtb25nb29zZS5tb2RlbCgnVXNlcicsIFVzZXJTY2hlbWEpO1xubW9kdWxlLmV4cG9ydHMgPSBVc2VyOyJdfQ==","map":{"version":3,"sources":["user.model.js"],"names":["mongoose","require","isEmail","bcrypt","Schema","UserSchema","pseudo","type","String","required","minlength","maxlength","unique","trim","email","validate","lowercase","password","max","picture","default","bio","followers","following","likes","timestamps","pre","next","salt","genSalt","hash","statics","login","user","findOne","auth","compare","Error","User","model","module","exports"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAM;AAACC,EAAAA;AAAD,IAAYD,OAAO,CAAC,WAAD,CAAzB;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,QAAD,CAAtB;;AAEA,MAAMG,MAAM,GAAGJ,QAAQ,CAACI,MAAxB;AACA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CAAW;AAC1BE,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAEC,MADF;AAEJC,IAAAA,QAAQ,EAAC,IAFL;AAGJC,IAAAA,SAAS,EAAE,CAHP;AAIJC,IAAAA,SAAS,EAAC,EAJN;AAKJC,IAAAA,MAAM,EAAC,IALH;AAMJC,IAAAA,IAAI,EAAC;AAND,GADkB;AAS1BC,EAAAA,KAAK,EAAC;AACFP,IAAAA,IAAI,EAACC,MADH;AAEFC,IAAAA,QAAQ,EAAC,IAFP;AAGFM,IAAAA,QAAQ,EAAC,CAACb,OAAD,CAHP;AAIFc,IAAAA,SAAS,EAAC,IAJR;AAKFJ,IAAAA,MAAM,EAAC,IALL;AAMFC,IAAAA,IAAI,EAAC;AANH,GAToB;AAiB1BI,EAAAA,QAAQ,EAAC;AACLV,IAAAA,IAAI,EAACC,MADA;AAELC,IAAAA,QAAQ,EAAC,IAFJ;AAGLS,IAAAA,GAAG,EAAC,IAHC;AAILR,IAAAA,SAAS,EAAC;AAJL,GAjBiB;AAuB1BS,EAAAA,OAAO,EAAC;AACJZ,IAAAA,IAAI,EAACC,MADD;AAEJY,IAAAA,OAAO,EAAC;AAFJ,GAvBkB;AA2B1BC,EAAAA,GAAG,EAAC;AACAd,IAAAA,IAAI,EAACC,MADL;AAEAU,IAAAA,GAAG,EAAC;AAFJ,GA3BsB;AA+B1BI,EAAAA,SAAS,EAAE;AACPf,IAAAA,IAAI,EAAC,CAACC,MAAD;AADE,GA/Be;AAkC1Be,EAAAA,SAAS,EAAC;AACNhB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADC,GAlCgB;AAqC1BgB,EAAAA,KAAK,EAAE;AACHjB,IAAAA,IAAI,EAAC,CAACC,MAAD;AADF;AArCmB,CAAX,EAwChB;AACCiB,EAAAA,UAAU,EAAC;AADZ,CAxCgB,CAAnB,C,CA6CA;AACA;;AACApB,UAAU,CAACqB,GAAX,CAAe,MAAf,EAAuB,gBAAgBC,IAAhB,EAAqB;AACxC,QAAMC,IAAI,GAAG,MAAMzB,MAAM,CAAC0B,OAAP,EAAnB;AACA,OAAKZ,QAAL,GAAgB,MAAMd,MAAM,CAAC2B,IAAP,CAAY,KAAKb,QAAjB,EAA2BW,IAA3B,CAAtB;AACAD,EAAAA,IAAI;AACP,CAJD,E,CAMA;;AACAtB,UAAU,CAAC0B,OAAX,CAAmBC,KAAnB,GAA2B,gBAAelB,KAAf,EAAsBG,QAAtB,EAA+B;AACtD,QAAMgB,IAAI,GAAG,MAAM,KAAKC,OAAL,CAAa;AAACpB,IAAAA,KAAK,EAAEA;AAAR,GAAb,CAAnB;;AACA,MAAGmB,IAAH,EAAQ;AACJ,UAAME,IAAI,GAAG,MAAMhC,MAAM,CAACiC,OAAP,CAAenB,QAAf,EAAyBgB,IAAI,CAAChB,QAA9B,CAAnB;;AACA,QAAGkB,IAAH,EAAQ;AACJ,aAAOF,IAAP;AACH,KAFD,MAGI;AACA,YAAMI,KAAK,CAAC,oBAAD,CAAX;AACH;AACJ;;AACD,QAAMA,KAAK,CAAC,oBAAD,CAAX;AACH,CAZD;;AAaA,IAAIC,IAAI,GAAGtC,QAAQ,CAACuC,KAAT,CAAe,MAAf,EAAuBlC,UAAvB,CAAX;AACAmC,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourceRoot":"/Applications/dossier/lineup-social/server/src/models/","sourcesContent":["const mongoose = require('mongoose');\nconst {isEmail} = require('validator');\nconst bcrypt = require('bcrypt');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n    pseudo: {\n        type: String,\n        required:true,\n        minlength: 3, \n        maxlength:55, \n        unique:true,\n        trim:true\n    },\n    email:{\n        type:String,\n        required:true,\n        validate:[isEmail],\n        lowercase:true,        \n        unique:true,\n        trim:true,\n    },\n    password:{\n        type:String,\n        required:true,\n        max:1024,\n        minlength:6\n    },\n    picture:{\n        type:String,\n        default:\"./uploads/profil/random-user.png\"\n    },\n    bio:{\n        type:String,\n        max:1024\n    },\n    followers: {\n        type:[String],\n    },\n    following:{\n        type:[String],\n    },\n    likes: {\n        type:[String],\n    }\n}, {\n    timestamps:true\n}\n);\n\n//play function before save into db to allow crypt password\n// le next veut dire quand t'a fini passe à la suite\nUserSchema.pre('save', async function (next){\n    const salt = await bcrypt.genSalt();\n    this.password = await bcrypt.hash(this.password, salt);\n    next();\n})\n\n//c'est ce qui va nous permettre de comparer le password crypté de notre user en base de données avec celui utilise pdt le login d'un user\nUserSchema.statics.login = async function(email, password){\n    const user = await this.findOne({email: email});\n    if(user){\n        const auth = await bcrypt.compare(password, user.password)\n        if(auth){\n            return user\n        }\n        else{\n            throw Error('Incorrect password');\n        }\n    }\n    throw Error('Incorrect password');\n}\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;"]}},"mtime":1651374997096},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/controllers/user.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updateUser = exports.unfollow = exports.getUserInfo = exports.getAllUsers = exports.follow = exports.deleteUser = void 0;\n\nconst User = require('../models/user.model');\n\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\nconst getAllUsers = async (req, res) => {\n  //allow to receive all users without password\n  const users = await User.find().select('-password');\n  res.status(200).json(users);\n};\n\nexports.getAllUsers = getAllUsers;\n\nconst getUserInfo = async (req, res) => {\n  //if id exist in databse\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.findById(req.params.id).select('-password').then(user => {\n    res.status(200).json(user);\n  }).catch(err => {\n    console.log(err);\n  });\n};\n\nexports.getUserInfo = getUserInfo;\n\nconst updateUser = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.findOneAndUpdate({\n    _id: req.params.id\n  }, {\n    $set: {\n      bio: req.body.bio\n    }\n  }, {\n    new: true,\n    upsert: true,\n    setDefaultsOnInsert: true\n  }).select('-password').then(user => {\n    res.status(200).json(user);\n  }).catch(err => {\n    res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.updateUser = updateUser;\n\nconst deleteUser = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  await User.remove({\n    _id: req.params.id\n  }).exec().then(() => {\n    res.status(200).json({\n      message: 'Successfully deleted !'\n    });\n  }).catch(err => {\n    res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.deleteUser = deleteUser;\n\nconst follow = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  if (!ObjectID.isValid(req.body.idToFollow)) {\n    return res.status(400).send(`Id unknown : ${req.body.idToFollow}`);\n  } //add to the follower list\n\n\n  await User.findByIdAndUpdate(req.params.id, {\n    $addToSet: {\n      following: req.body.idToFollow\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {\n    res.status(201).json(user);\n  }).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  }); //add to the following list\n\n  await User.findByIdAndUpdate(req.body.idToFollow, {\n    $addToSet: {\n      followers: req.params.id\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {}).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.follow = follow;\n\nconst unfollow = async (req, res) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  if (!ObjectID.isValid(req.body.idToUnFollow)) {\n    return res.status(400).send(`Id unknown : ${req.body.idToUnFollow}`);\n  } //delete to the follower list\n\n\n  await User.findByIdAndUpdate(req.params.id, {\n    $pull: {\n      following: req.body.idToUnFollow\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {\n    res.status(201).json(user);\n  }).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  }); //delete to the following list\n\n  await User.findByIdAndUpdate(req.body.idToUnFollow, {\n    $pull: {\n      followers: req.params.id\n    }\n  }, {\n    new: true,\n    upsert: true\n  }).then(user => {}).catch(err => {\n    return res.status(500).json({\n      message: err\n    });\n  });\n};\n\nexports.unfollow = unfollow;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsIk9iamVjdElEIiwiVHlwZXMiLCJPYmplY3RJZCIsImdldEFsbFVzZXJzIiwicmVxIiwicmVzIiwidXNlcnMiLCJmaW5kIiwic2VsZWN0Iiwic3RhdHVzIiwianNvbiIsImdldFVzZXJJbmZvIiwiaXNWYWxpZCIsInBhcmFtcyIsImlkIiwic2VuZCIsImZpbmRCeUlkIiwidGhlbiIsInVzZXIiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVVc2VyIiwiZmluZE9uZUFuZFVwZGF0ZSIsIl9pZCIsIiRzZXQiLCJiaW8iLCJib2R5IiwibmV3IiwidXBzZXJ0Iiwic2V0RGVmYXVsdHNPbkluc2VydCIsIm1lc3NhZ2UiLCJkZWxldGVVc2VyIiwicmVtb3ZlIiwiZXhlYyIsImZvbGxvdyIsImlkVG9Gb2xsb3ciLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIiRhZGRUb1NldCIsImZvbGxvd2luZyIsImZvbGxvd2VycyIsInVuZm9sbG93IiwiaWRUb1VuRm9sbG93IiwiJHB1bGwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFDQSxNQUFNQyxRQUFRLEdBQUdELE9BQU8sQ0FBQyxVQUFELENBQVAsQ0FBb0JFLEtBQXBCLENBQTBCQyxRQUEzQzs7QUFHTyxNQUFNQyxXQUFXLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEtBQW9CO0FBQzNDO0FBQ0EsUUFBTUMsS0FBSyxHQUFHLE1BQU1SLElBQUksQ0FBQ1MsSUFBTCxHQUFZQyxNQUFaLENBQW1CLFdBQW5CLENBQXBCO0FBQ0FILEVBQUFBLEdBQUcsQ0FDRUksTUFETCxDQUNZLEdBRFosRUFFS0MsSUFGTCxDQUVVSixLQUZWO0FBR0gsQ0FOTTs7OztBQVFBLE1BQU1LLFdBQVcsR0FBRyxPQUFPUCxHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFD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QyxDQUFOO0FBVUgsQ0E1Qk0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL2xpbmV1cC1zb2NpYWwvc2VydmVyL3NyYy9jb250cm9sbGVycy8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuY29uc3QgT2JqZWN0SUQgPSByZXF1aXJlKFwibW9uZ29vc2VcIikuVHlwZXMuT2JqZWN0SWQ7XG5cblxuZXhwb3J0IGNvbnN0IGdldEFsbFVzZXJzID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgLy9hbGxvdyB0byByZWNlaXZlIGFsbCB1c2VycyB3aXRob3V0IHBhc3N3b3JkXG4gICAgY29uc3QgdXNlcnMgPSBhd2FpdCBVc2VyLmZpbmQoKS5zZWxlY3QoJy1wYXNzd29yZCcpO1xuICAgIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24odXNlcnMpXG59XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VySW5mbyA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIC8vaWYgaWQgZXhpc3QgaW4gZGF0YWJzZVxuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgYXdhaXQgVXNlci5maW5kQnlJZChyZXEucGFyYW1zLmlkKS5zZWxlY3QoJy1wYXNzd29yZCcpXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih1c2VyKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICB9KVxufVxuXG5leHBvcnQgY29uc3QgdXBkYXRlVXNlciA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgYXdhaXQgVXNlci5maW5kT25lQW5kVXBkYXRlKFxuICAgICAgICB7IF9pZDogcmVxLnBhcmFtcy5pZCB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAkc2V0OiB7XG4gICAgICAgICAgICAgICAgYmlvOiByZXEuYm9keS5iaW9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmV3OiB0cnVlLFxuICAgICAgICAgICAgdXBzZXJ0OiB0cnVlLFxuICAgICAgICAgICAgc2V0RGVmYXVsdHNPbkluc2VydDogdHJ1ZVxuICAgICAgICB9KS5zZWxlY3QoJy1wYXNzd29yZCcpLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHVzZXIpXG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyIH0pXG4gICAgICAgIH0pXG59XG5cbmV4cG9ydCBjb25zdCBkZWxldGVVc2VyID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cbiAgICBhd2FpdCBVc2VyLnJlbW92ZSh7XG4gICAgICAgIF9pZDogcmVxLnBhcmFtcy5pZFxuICAgIH0pLmV4ZWMoKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe21lc3NhZ2U6ICdTdWNjZXNzZnVsbHkgZGVsZXRlZCAhJ30pXG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7bWVzc2FnZTplcnJ9KVxuICAgIH0pXG59XG5leHBvcnQgY29uc3QgZm9sbG93ID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpICkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5ib2R5LmlkVG9Gb2xsb3cpICkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5ib2R5LmlkVG9Gb2xsb3d9YClcbiAgICB9XG4gICAgLy9hZGQgdG8gdGhlIGZvbGxvd2VyIGxpc3RcbiAgICBhd2FpdCBVc2VyLmZpbmRCeUlkQW5kVXBkYXRlKHJlcS5wYXJhbXMuaWQsIFxuICAgICAgICB7ICRhZGRUb1NldCA6IHsgZm9sbG93aW5nOiByZXEuYm9keS5pZFRvRm9sbG93fX0sXG4gICAgICAgIHtuZXcgOiB0cnVlLCB1cHNlcnQ6dHJ1ZX0pXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih1c2VyKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHttZXNzYWdlOmVycn0pXG4gICAgICAgIH0pXG4gICAgLy9hZGQgdG8gdGhlIGZvbGxvd2luZyBsaXN0XG4gICAgYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShyZXEuYm9keS5pZFRvRm9sbG93LFxuICAgICAgICB7ICRhZGRUb1NldCA6IHsgZm9sbG93ZXJzOiByZXEucGFyYW1zLmlkfX0sXG4gICAgICAgIHtuZXcgOiB0cnVlLCB1cHNlcnQ6dHJ1ZX0pXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG5cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7bWVzc2FnZTplcnJ9KVxuICAgICAgICB9KVxuXG59XG5leHBvcnQgY29uc3QgdW5mb2xsb3cgPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkgKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLmJvZHkuaWRUb1VuRm9sbG93KSApIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEuYm9keS5pZFRvVW5Gb2xsb3d9YClcbiAgICB9XG4gICAgIC8vZGVsZXRlIHRvIHRoZSBmb2xsb3dlciBsaXN0XG4gICAgIGF3YWl0IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUocmVxLnBhcmFtcy5pZCwgXG4gICAgICAgIHsgJHB1bGwgOiB7IGZvbGxvd2luZzogcmVxLmJvZHkuaWRUb1VuRm9sbG93fX0sXG4gICAgICAgIHtuZXcgOiB0cnVlLCB1cHNlcnQ6dHJ1ZX0pXG4gICAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih1c2VyKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHttZXNzYWdlOmVycn0pXG4gICAgICAgIH0pXG4gICAgLy9kZWxldGUgdG8gdGhlIGZvbGxvd2luZyBsaXN0XG4gICAgYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShyZXEuYm9keS5pZFRvVW5Gb2xsb3csXG4gICAgICAgIHsgJHB1bGwgOiB7IGZvbGxvd2VyczogcmVxLnBhcmFtcy5pZH19LFxuICAgICAgICB7bmV3IDogdHJ1ZSwgdXBzZXJ0OnRydWV9KVxuICAgICAgICAudGhlbigodXNlcikgPT4ge1xuXG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe21lc3NhZ2U6ZXJyfSlcbiAgICAgICAgfSlcblxufSJdfQ==","map":{"version":3,"sources":["user.controller.js"],"names":["User","require","ObjectID","Types","ObjectId","getAllUsers","req","res","users","find","select","status","json","getUserInfo","isValid","params","id","send","findById","then","user","catch","err","console","log","updateUser","findOneAndUpdate","_id","$set","bio","body","new","upsert","setDefaultsOnInsert","message","deleteUser","remove","exec","follow","idToFollow","findByIdAndUpdate","$addToSet","following","followers","unfollow","idToUnFollow","$pull"],"mappings":"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","sourceRoot":"/Applications/dossier/lineup-social/server/src/controllers/","sourcesContent":["const User = require('../models/user.model')\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\n\nexport const getAllUsers = async (req, res) => {\n    //allow to receive all users without password\n    const users = await User.find().select('-password');\n    res\n        .status(200)\n        .json(users)\n}\n\nexport const getUserInfo = async (req, res) => {\n    //if id exist in databse\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.findById(req.params.id).select('-password')\n        .then((user) => {\n            res.status(200).json(user)\n        })\n        .catch((err) => {\n            console.log(err)\n        })\n}\n\nexport const updateUser = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.findOneAndUpdate(\n        { _id: req.params.id },\n        {\n            $set: {\n                bio: req.body.bio\n            }\n        },\n        {\n            new: true,\n            upsert: true,\n            setDefaultsOnInsert: true\n        }).select('-password').then((user) => {\n            res.status(200).json(user)\n        }).catch((err) => {\n            res.status(500).json({ message: err })\n        })\n}\n\nexport const deleteUser = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    await User.remove({\n        _id: req.params.id\n    }).exec()\n    .then(() => {\n        res.status(200).json({message: 'Successfully deleted !'})\n    })\n    .catch((err) => {\n        res.status(500).json({message:err})\n    })\n}\nexport const follow = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id) ) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    if (!ObjectID.isValid(req.body.idToFollow) ) {\n        return res.status(400).send(`Id unknown : ${req.body.idToFollow}`)\n    }\n    //add to the follower list\n    await User.findByIdAndUpdate(req.params.id, \n        { $addToSet : { following: req.body.idToFollow}},\n        {new : true, upsert:true})\n        .then((user) => {\n            res.status(201).json(user)\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n    //add to the following list\n    await User.findByIdAndUpdate(req.body.idToFollow,\n        { $addToSet : { followers: req.params.id}},\n        {new : true, upsert:true})\n        .then((user) => {\n\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n\n}\nexport const unfollow = async (req, res) => {\n    if (!ObjectID.isValid(req.params.id) ) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    if (!ObjectID.isValid(req.body.idToUnFollow) ) {\n        return res.status(400).send(`Id unknown : ${req.body.idToUnFollow}`)\n    }\n     //delete to the follower list\n     await User.findByIdAndUpdate(req.params.id, \n        { $pull : { following: req.body.idToUnFollow}},\n        {new : true, upsert:true})\n        .then((user) => {\n            res.status(201).json(user)\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n    //delete to the following list\n    await User.findByIdAndUpdate(req.body.idToUnFollow,\n        { $pull : { followers: req.params.id}},\n        {new : true, upsert:true})\n        .then((user) => {\n\n        })\n        .catch((err) => {\n            return res.status(500).json({message:err})\n        })\n\n}"]}},"mtime":1651585436195},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/controllers/upload.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.uploadProfil = void 0;\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst User = require('../models/user.model');\n\nconst uploadProfil = async (req, res) => {\n  try {\n    if (req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\") {\n      throw new Error('invalid file');\n    }\n\n    if (req.file.size > 5000000) {\n      throw new Error('max size');\n    }\n  } catch (err) {\n    const errors = (0, _errors.uploadErrors)(err);\n    return res.status(201).json({\n      errors\n    });\n  }\n\n  try {\n    await User.findByIdAndUpdate(req.body.userId, {\n      $set: {\n        picture: `http://localhost:8080/uploads/profils/${req.file.filename}`\n      }\n    }, {\n      new: true,\n      upsert: true,\n      setDefaultsOnInsert: true\n    }).then(user => {\n      return res.send(user);\n    }).catch(err => {\n      return res.status(500).send(err);\n    });\n  } catch (err) {\n    return res.status(500).send(err);\n  }\n};\n\nexports.uploadProfil = uploadProfil;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwbG9hZC5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlVzZXIiLCJyZXF1aXJlIiwidXBsb2FkUHJvZmlsIiwicmVxIiwicmVzIiwiZmlsZSIsIm1pbWV0eXBlIiwiRXJyb3IiLCJzaXplIiwiZXJyIiwiZXJyb3JzIiwic3RhdHVzIiwianNvbiIsImZpbmRCeUlkQW5kVXBkYXRlIiwiYm9keSIsInVzZXJJZCIsIiRzZXQiLCJwaWN0dXJlIiwiZmlsZW5hbWUiLCJuZXciLCJ1cHNlcnQiLCJzZXREZWZhdWx0c09uSW5zZXJ0IiwidGhlbiIsInVzZXIiLCJzZW5kIiwiY2F0Y2giXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7QUFEQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxzQkFBRCxDQUFwQjs7QUFHTyxNQUFNQyxZQUFZLEdBQUcsT0FBTUMsR0FBTixFQUFXQyxHQUFYLEtBQW1CO0FBQzNDLE1BQUc7QUFDQyxRQUFHRCxHQUFHLENBQUNFLElBQUosQ0FBU0MsUUFBVCxJQUFxQixXQUFyQixJQUFvQ0gsR0FBRyxDQUFDRSxJQUFKLENBQVNDLFFBQVQsSUFBcUIsV0FBekQsSUFBd0VILEdBQUcsQ0FBQ0UsSUFBSixDQUFTQyxRQUFULElBQXFCLFlBQWhHLEVBQTZHO0FBQ3pHLFlBQU0sSUFBSUMsS0FBSixDQUFVLGNBQVYsQ0FBTjtBQUNIOztBQUNELFFBQUdKLEdBQUcsQ0FBQ0UsSUFBSixDQUFTRyxJQUFULEdBQWdCLE9BQW5CLEVBQTJCO0FBQ3ZCLFlBQU0sSUFBSUQsS0FBSixDQUFVLFVBQVYsQ0FBTjtBQUNIO0FBQ0osR0FQRCxDQVFBLE9BQU1FLEdBQU4sRUFBVTtBQUNOLFVBQU1DLE1BQU0sR0FBRywwQkFBYUQsR0FBYixDQUFmO0FBQ0EsV0FBT0wsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFBQ0YsTUFBQUE7QUFBRCxLQUFyQixDQUFQO0FBQ0g7O0FBQ0QsTUFBRztBQUNNLFVBQU1WLElBQUksQ0FBQ2EsaUJBQUwsQ0FDUFYsR0FBRyxDQUFDVyxJQUFKLENBQVNDLE1BREYsRUFFUDtBQUNJQyxNQUFBQSxJQUFJLEVBQUc7QUFBRUMsUUFBQUEsT0FBTyxFQUFHLHlDQUF3Q2QsR0FBRyxDQUFDRSxJQUFKLENBQVNhLFFBQVM7QUFBdEU7QUFEWCxLQUZPLEVBS1A7QUFBQ0MsTUFBQUEsR0FBRyxFQUFDLElBQUw7QUFBV0MsTUFBQUEsTUFBTSxFQUFDLElBQWxCO0FBQXdCQyxNQUFBQSxtQkFBbUIsRUFBQztBQUE1QyxLQUxPLEVBTUxDLElBTkssQ0FNQ0MsSUFBRCxJQUFVO0FBQ2IsYUFBT25CLEdBQUcsQ0FBQ29CLElBQUosQ0FBU0QsSUFBVCxDQUFQO0FBQ0gsS0FSTSxFQVFKRSxLQVJJLENBUUdoQixHQUFELElBQVM7QUFDZCxhQUFPTCxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCYSxJQUFoQixDQUFxQmYsR0FBckIsQ0FBUDtBQUNILEtBVk0sQ0FBTjtBQVdSLEdBWkQsQ0FhQSxPQUFNQSxHQUFOLEVBQVU7QUFDTixXQUFPTCxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCYSxJQUFoQixDQUFxQmYsR0FBckIsQ0FBUDtBQUNIO0FBRUosQ0E5Qk0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL2xpbmV1cC1zb2NpYWwvc2VydmVyL3NyYy9jb250cm9sbGVycy8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuaW1wb3J0IHsgdXBsb2FkRXJyb3JzfSBmcm9tICcuLi91dGlscy9lcnJvcnMudXRpbHMnXG5cbmV4cG9ydCBjb25zdCB1cGxvYWRQcm9maWwgPSBhc3luYyhyZXEsIHJlcykgPT4ge1xuICAgIHRyeXtcbiAgICAgICAgaWYocmVxLmZpbGUubWltZXR5cGUgIT0gXCJpbWFnZS9qcGdcIiAmJiByZXEuZmlsZS5taW1ldHlwZSAhPSBcImltYWdlL3BuZ1wiICYmIHJlcS5maWxlLm1pbWV0eXBlICE9IFwiaW1hZ2UvanBlZ1wiKXtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBmaWxlJylcbiAgICAgICAgfVxuICAgICAgICBpZihyZXEuZmlsZS5zaXplID4gNTAwMDAwMCl7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ21heCBzaXplJylcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaChlcnIpe1xuICAgICAgICBjb25zdCBlcnJvcnMgPSB1cGxvYWRFcnJvcnMoZXJyKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtlcnJvcnN9KVxuICAgIH1cbiAgICB0cnl7XG4gICAgICAgICAgICAgYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5ib2R5LnVzZXJJZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkc2V0IDogeyBwaWN0dXJlOiBgaHR0cDovL2xvY2FsaG9zdDo4MDgwL3VwbG9hZHMvcHJvZmlscy8ke3JlcS5maWxlLmZpbGVuYW1lfWAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtuZXc6dHJ1ZSwgdXBzZXJ0OnRydWUsIHNldERlZmF1bHRzT25JbnNlcnQ6dHJ1ZX1cbiAgICAgICAgICAgICkudGhlbigodXNlcikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZCh1c2VyKVxuICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZChlcnIpXG4gICAgICAgICAgICB9KVxuICAgIH1cbiAgICBjYXRjaChlcnIpe1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoZXJyKVxuICAgIH1cbiAgICBcbn1cblxuIl19","map":{"version":3,"sources":["upload.controller.js"],"names":["User","require","uploadProfil","req","res","file","mimetype","Error","size","err","errors","status","json","findByIdAndUpdate","body","userId","$set","picture","filename","new","upsert","setDefaultsOnInsert","then","user","send","catch"],"mappings":";;;;;;;AACA;;AADA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AAGO,MAAMC,YAAY,GAAG,OAAMC,GAAN,EAAWC,GAAX,KAAmB;AAC3C,MAAG;AACC,QAAGD,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,WAArB,IAAoCH,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,WAAzD,IAAwEH,GAAG,CAACE,IAAJ,CAASC,QAAT,IAAqB,YAAhG,EAA6G;AACzG,YAAM,IAAIC,KAAJ,CAAU,cAAV,CAAN;AACH;;AACD,QAAGJ,GAAG,CAACE,IAAJ,CAASG,IAAT,GAAgB,OAAnB,EAA2B;AACvB,YAAM,IAAID,KAAJ,CAAU,UAAV,CAAN;AACH;AACJ,GAPD,CAQA,OAAME,GAAN,EAAU;AACN,UAAMC,MAAM,GAAG,0BAAaD,GAAb,CAAf;AACA,WAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACF,MAAAA;AAAD,KAArB,CAAP;AACH;;AACD,MAAG;AACM,UAAMV,IAAI,CAACa,iBAAL,CACPV,GAAG,CAACW,IAAJ,CAASC,MADF,EAEP;AACIC,MAAAA,IAAI,EAAG;AAAEC,QAAAA,OAAO,EAAG,yCAAwCd,GAAG,CAACE,IAAJ,CAASa,QAAS;AAAtE;AADX,KAFO,EAKP;AAACC,MAAAA,GAAG,EAAC,IAAL;AAAWC,MAAAA,MAAM,EAAC,IAAlB;AAAwBC,MAAAA,mBAAmB,EAAC;AAA5C,KALO,EAMLC,IANK,CAMCC,IAAD,IAAU;AACb,aAAOnB,GAAG,CAACoB,IAAJ,CAASD,IAAT,CAAP;AACH,KARM,EAQJE,KARI,CAQGhB,GAAD,IAAS;AACd,aAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBa,IAAhB,CAAqBf,GAArB,CAAP;AACH,KAVM,CAAN;AAWR,GAZD,CAaA,OAAMA,GAAN,EAAU;AACN,WAAOL,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBa,IAAhB,CAAqBf,GAArB,CAAP;AACH;AAEJ,CA9BM","sourceRoot":"/Applications/dossier/lineup-social/server/src/controllers/","sourcesContent":["const User = require('../models/user.model')\nimport { uploadErrors} from '../utils/errors.utils'\n\nexport const uploadProfil = async(req, res) => {\n    try{\n        if(req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\"){\n            throw new Error('invalid file')\n        }\n        if(req.file.size > 5000000){\n            throw new Error('max size')\n        }\n    }\n    catch(err){\n        const errors = uploadErrors(err);\n        return res.status(201).json({errors})\n    }\n    try{\n             await User.findByIdAndUpdate(\n            req.body.userId,\n            {\n                $set : { picture: `http://localhost:8080/uploads/profils/${req.file.filename}` }\n            },\n            {new:true, upsert:true, setDefaultsOnInsert:true}\n            ).then((user) => {\n                return res.send(user)\n            }).catch((err) => {\n                return res.status(500).send(err)\n            })\n    }\n    catch(err){\n        return res.status(500).send(err)\n    }\n    \n}\n\n"]}},"mtime":1653058542236},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/routes/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/routes/api/post.route.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar PostController = _interopRequireWildcard(require(\"../../controllers/post.controller\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst multer = require('multer');\n\nconst fileStorageEngine = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, `${__dirname}/../../../assets/uploads/posts`);\n  },\n  filename: function (req, file, cb) {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    let originalNameFile = file.originalname;\n    let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1);\n    cb(null, file.fieldname + '-' + uniqueSuffix + \".\" + extension);\n  }\n});\nconst upload = multer({\n  storage: fileStorageEngine\n});\nconst api = (0, _express.Router)();\napi.get('/', PostController.readPost);\napi.post('/', upload.single('file'), PostController.createPost);\napi.put('/:id', PostController.updatePost);\napi.delete('/:id', PostController.deletePost);\napi.patch('/like-post/:id', PostController.likePost);\napi.patch('/unlike-post/:id', PostController.unlikePost); //comments\n\napi.patch('/comment-post/:id', PostController.commentPost);\napi.patch('/edit-comment-post/:id', PostController.editCommentPost);\napi.patch('/delete-comment-post/:id', PostController.deleteCommentPost);\nvar _default = api;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3Qucm91dGUuanMiXSwibmFtZXMiOlsibXVsdGVyIiwicmVxdWlyZSIsImZpbGVTdG9yYWdlRW5naW5lIiwiZGlza1N0b3JhZ2UiLCJkZXN0aW5hdGlvbiIsInJlcSIsImZpbGUiLCJjYiIsIl9fZGlybmFtZSIsImZpbGVuYW1lIiwidW5pcXVlU3VmZml4IiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsIm9yaWdpbmFsTmFtZUZpbGUiLCJvcmlnaW5hbG5hbWUiLCJleHRlbnNpb24iLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsImZpZWxkbmFtZSIsInVwbG9hZCIsInN0b3JhZ2UiLCJhcGkiLCJnZXQiLCJQb3N0Q29udHJvbGxlciIsInJlYWRQb3N0IiwicG9zdCIsInNpbmdsZSIsImNyZWF0ZVBvc3QiLCJwdXQiLCJ1cGRhdGVQb3N0IiwiZGVsZXRlIiwiZGVsZXRlUG9zdCIsInBhdGNoIiwibGlrZVBvc3QiLCJ1bmxpa2VQb3N0IiwiY29tbWVudFBvc3QiLCJlZGl0Q29tbWVudFBvc3QiLCJkZWxldGVDb21tZW50UG9zdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOzs7Ozs7QUFDQSxNQUFNQSxNQUFNLEdBQUlDLE9BQU8sQ0FBQyxRQUFELENBQXZCOztBQUVBLE1BQU1DLGlCQUFpQixHQUFHRixNQUFNLENBQUNHLFdBQVAsQ0FBbUI7QUFDekNDLEVBQUFBLFdBQVcsRUFBQyxDQUFDQyxHQUFELEVBQU1DLElBQU4sRUFBWUMsRUFBWixLQUFtQjtBQUMzQkEsSUFBQUEsRUFBRSxDQUFDLElBQUQsRUFBUSxHQUFFQyxTQUFVLGdDQUFwQixDQUFGO0FBQ0gsR0FId0M7QUFJekNDLEVBQUFBLFFBQVEsRUFBRSxVQUFVSixHQUFWLEVBQWVDLElBQWYsRUFBcUJDLEVBQXJCLEVBQXlCO0FBQy9CLFVBQU1HLFlBQVksR0FBR0MsSUFBSSxDQUFDQyxHQUFMLEtBQWEsR0FBYixHQUFtQkMsSUFBSSxDQUFDQyxLQUFMLENBQVdELElBQUksQ0FBQ0UsTUFBTCxLQUFnQixHQUEzQixDQUF4QztBQUNBLFFBQUlDLGdCQUFnQixHQUFHVixJQUFJLENBQUNXLFlBQTVCO0FBQ0EsUUFBSUMsU0FBUyxHQUFHRixnQkFBZ0IsQ0FBQ0csU0FBakIsQ0FBMkJILGdCQUFnQixDQUFDSSxXQUFqQixDQUE2QixHQUE3QixJQUFvQyxDQUEvRCxDQUFoQjtBQUNBYixJQUFBQSxFQUFFLENBQUMsSUFBRCxFQUFPRCxJQUFJLENBQUNlLFNBQUwsR0FBaUIsR0FBakIsR0FBdUJYLFlBQXZCLEdBQXNDLEdBQXRDLEdBQTJDUSxTQUFsRCxDQUFGO0FBQ0Q7QUFUc0MsQ0FBbkIsQ0FBMUI7QUFZQSxNQUFNSSxNQUFNLEdBQUd0QixNQUFNLENBQUM7QUFBQ3VCLEVBQUFBLE9BQU8sRUFBQ3JCO0FBQVQsQ0FBRCxDQUFyQjtBQUVBLE1BQU1zQixHQUFHLEdBQUcsc0JBQVo7QUFHQUEsR0FBRyxDQUFDQyxHQUFKLENBQVEsR0FBUixFQUFhQyxjQUFjLENBQUNDLFFBQTVCO0FBQ0FILEdBQUcsQ0FBQ0ksSUFBSixDQUFTLEdBQVQsRUFBYU4sTUFBTSxDQUFDTyxNQUFQLENBQWMsTUFBZCxDQUFiLEVBQXFDSCxjQUFjLENBQUNJLFVBQXBEO0FBQ0FOLEdBQUcsQ0FBQ08sR0FBSixDQUFRLE1BQVIsRUFBZ0JMLGNBQWMsQ0FBQ00sVUFBL0I7QUFDQVIsR0FBRyxDQUFDUyxNQUFKLENBQVcsTUFBWCxFQUFtQlAsY0FBYyxDQUFDUSxVQUFsQztBQUNBVixHQUFHLENBQUNXLEtBQUosQ0FBVSxnQkFBVixFQUE0QlQsY0FBYyxDQUFDVSxRQUEzQztBQUNBWixHQUFHLENBQUNXLEtBQUosQ0FBVSxrQkFBVixFQUE4QlQsY0FBYyxDQUFDVyxVQUE3QyxFLENBRUE7O0FBQ0FiLEdBQUcsQ0FBQ1csS0FBSixDQUFVLG1CQUFWLEVBQStCVCxjQUFjLENBQUNZLFdBQTlDO0FBQ0FkLEdBQUcsQ0FBQ1csS0FBSixDQUFVLHdCQUFWLEVBQW9DVCxjQUFjLENBQUNhLGVBQW5EO0FBQ0FmLEdBQUcsQ0FBQ1csS0FBSixDQUFVLDBCQUFWLEVBQXNDVCxjQUFjLENBQUNjLGlCQUFyRDtlQUllaEIsRyIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbGluZXVwLXNvY2lhbC9zZXJ2ZXIvc3JjL3JvdXRlcy9hcGkvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgKiBhcyBQb3N0Q29udHJvbGxlciBmcm9tICcuLi8uLi9jb250cm9sbGVycy9wb3N0LmNvbnRyb2xsZXInO1xuY29uc3QgbXVsdGVyICA9IHJlcXVpcmUoJ211bHRlcicpXG5cbmNvbnN0IGZpbGVTdG9yYWdlRW5naW5lID0gbXVsdGVyLmRpc2tTdG9yYWdlKHtcbiAgICBkZXN0aW5hdGlvbjoocmVxLCBmaWxlLCBjYikgPT4ge1xuICAgICAgICBjYihudWxsLCBgJHtfX2Rpcm5hbWV9Ly4uLy4uLy4uL2Fzc2V0cy91cGxvYWRzL3Bvc3RzYClcbiAgICB9LFxuICAgIGZpbGVuYW1lOiBmdW5jdGlvbiAocmVxLCBmaWxlLCBjYikge1xuICAgICAgICBjb25zdCB1bmlxdWVTdWZmaXggPSBEYXRlLm5vdygpICsgJy0nICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMUU5KVxuICAgICAgICBsZXQgb3JpZ2luYWxOYW1lRmlsZSA9IGZpbGUub3JpZ2luYWxuYW1lO1xuICAgICAgICBsZXQgZXh0ZW5zaW9uID0gb3JpZ2luYWxOYW1lRmlsZS5zdWJzdHJpbmcob3JpZ2luYWxOYW1lRmlsZS5sYXN0SW5kZXhPZignLicpICsgMSk7IFxuICAgICAgICBjYihudWxsLCBmaWxlLmZpZWxkbmFtZSArICctJyArIHVuaXF1ZVN1ZmZpeCArIFwiLlwiKyBleHRlbnNpb24gKVxuICAgICAgfVxufSk7XG5cbmNvbnN0IHVwbG9hZCA9IG11bHRlcih7c3RvcmFnZTpmaWxlU3RvcmFnZUVuZ2luZX0pXG5cbmNvbnN0IGFwaSA9IFJvdXRlcigpO1xuXG5cbmFwaS5nZXQoJy8nLCBQb3N0Q29udHJvbGxlci5yZWFkUG9zdCk7XG5hcGkucG9zdCgnLycsdXBsb2FkLnNpbmdsZSgnZmlsZScpLCAgUG9zdENvbnRyb2xsZXIuY3JlYXRlUG9zdCk7XG5hcGkucHV0KCcvOmlkJywgUG9zdENvbnRyb2xsZXIudXBkYXRlUG9zdCk7XG5hcGkuZGVsZXRlKCcvOmlkJywgUG9zdENvbnRyb2xsZXIuZGVsZXRlUG9zdCk7XG5hcGkucGF0Y2goJy9saWtlLXBvc3QvOmlkJywgUG9zdENvbnRyb2xsZXIubGlrZVBvc3QpO1xuYXBpLnBhdGNoKCcvdW5saWtlLXBvc3QvOmlkJywgUG9zdENvbnRyb2xsZXIudW5saWtlUG9zdCk7XG5cbi8vY29tbWVudHNcbmFwaS5wYXRjaCgnL2NvbW1lbnQtcG9zdC86aWQnLCBQb3N0Q29udHJvbGxlci5jb21tZW50UG9zdClcbmFwaS5wYXRjaCgnL2VkaXQtY29tbWVudC1wb3N0LzppZCcsIFBvc3RDb250cm9sbGVyLmVkaXRDb21tZW50UG9zdClcbmFwaS5wYXRjaCgnL2RlbGV0ZS1jb21tZW50LXBvc3QvOmlkJywgUG9zdENvbnRyb2xsZXIuZGVsZXRlQ29tbWVudFBvc3QpXG5cblxuXG5leHBvcnQgZGVmYXVsdCBhcGk7Il19","map":{"version":3,"sources":["post.route.js"],"names":["multer","require","fileStorageEngine","diskStorage","destination","req","file","cb","__dirname","filename","uniqueSuffix","Date","now","Math","round","random","originalNameFile","originalname","extension","substring","lastIndexOf","fieldname","upload","storage","api","get","PostController","readPost","post","single","createPost","put","updatePost","delete","deletePost","patch","likePost","unlikePost","commentPost","editCommentPost","deleteCommentPost"],"mappings":";;;;;;;AAAA;;AACA;;;;;;AACA,MAAMA,MAAM,GAAIC,OAAO,CAAC,QAAD,CAAvB;;AAEA,MAAMC,iBAAiB,GAAGF,MAAM,CAACG,WAAP,CAAmB;AACzCC,EAAAA,WAAW,EAAC,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,KAAmB;AAC3BA,IAAAA,EAAE,CAAC,IAAD,EAAQ,GAAEC,SAAU,gCAApB,CAAF;AACH,GAHwC;AAIzCC,EAAAA,QAAQ,EAAE,UAAUJ,GAAV,EAAeC,IAAf,EAAqBC,EAArB,EAAyB;AAC/B,UAAMG,YAAY,GAAGC,IAAI,CAACC,GAAL,KAAa,GAAb,GAAmBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAAxC;AACA,QAAIC,gBAAgB,GAAGV,IAAI,CAACW,YAA5B;AACA,QAAIC,SAAS,GAAGF,gBAAgB,CAACG,SAAjB,CAA2BH,gBAAgB,CAACI,WAAjB,CAA6B,GAA7B,IAAoC,CAA/D,CAAhB;AACAb,IAAAA,EAAE,CAAC,IAAD,EAAOD,IAAI,CAACe,SAAL,GAAiB,GAAjB,GAAuBX,YAAvB,GAAsC,GAAtC,GAA2CQ,SAAlD,CAAF;AACD;AATsC,CAAnB,CAA1B;AAYA,MAAMI,MAAM,GAAGtB,MAAM,CAAC;AAACuB,EAAAA,OAAO,EAACrB;AAAT,CAAD,CAArB;AAEA,MAAMsB,GAAG,GAAG,sBAAZ;AAGAA,GAAG,CAACC,GAAJ,CAAQ,GAAR,EAAaC,cAAc,CAACC,QAA5B;AACAH,GAAG,CAACI,IAAJ,CAAS,GAAT,EAAaN,MAAM,CAACO,MAAP,CAAc,MAAd,CAAb,EAAqCH,cAAc,CAACI,UAApD;AACAN,GAAG,CAACO,GAAJ,CAAQ,MAAR,EAAgBL,cAAc,CAACM,UAA/B;AACAR,GAAG,CAACS,MAAJ,CAAW,MAAX,EAAmBP,cAAc,CAACQ,UAAlC;AACAV,GAAG,CAACW,KAAJ,CAAU,gBAAV,EAA4BT,cAAc,CAACU,QAA3C;AACAZ,GAAG,CAACW,KAAJ,CAAU,kBAAV,EAA8BT,cAAc,CAACW,UAA7C,E,CAEA;;AACAb,GAAG,CAACW,KAAJ,CAAU,mBAAV,EAA+BT,cAAc,CAACY,WAA9C;AACAd,GAAG,CAACW,KAAJ,CAAU,wBAAV,EAAoCT,cAAc,CAACa,eAAnD;AACAf,GAAG,CAACW,KAAJ,CAAU,0BAAV,EAAsCT,cAAc,CAACc,iBAArD;eAIehB,G","sourceRoot":"/Applications/dossier/lineup-social/server/src/routes/api/","sourcesContent":["import { Router } from 'express';\nimport * as PostController from '../../controllers/post.controller';\nconst multer  = require('multer')\n\nconst fileStorageEngine = multer.diskStorage({\n    destination:(req, file, cb) => {\n        cb(null, `${__dirname}/../../../assets/uploads/posts`)\n    },\n    filename: function (req, file, cb) {\n        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)\n        let originalNameFile = file.originalname;\n        let extension = originalNameFile.substring(originalNameFile.lastIndexOf('.') + 1); \n        cb(null, file.fieldname + '-' + uniqueSuffix + \".\"+ extension )\n      }\n});\n\nconst upload = multer({storage:fileStorageEngine})\n\nconst api = Router();\n\n\napi.get('/', PostController.readPost);\napi.post('/',upload.single('file'),  PostController.createPost);\napi.put('/:id', PostController.updatePost);\napi.delete('/:id', PostController.deletePost);\napi.patch('/like-post/:id', PostController.likePost);\napi.patch('/unlike-post/:id', PostController.unlikePost);\n\n//comments\napi.patch('/comment-post/:id', PostController.commentPost)\napi.patch('/edit-comment-post/:id', PostController.editCommentPost)\napi.patch('/delete-comment-post/:id', PostController.deleteCommentPost)\n\n\n\nexport default api;"]}},"mtime":1653046946274},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/controllers/post.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updatePost = exports.unlikePost = exports.readPost = exports.likePost = exports.editCommentPost = exports.deletePost = exports.deleteCommentPost = exports.createPost = exports.commentPost = void 0;\n\nvar _errors = require(\"../utils/errors.utils\");\n\nconst Post = require('../models/post.model');\n\nconst User = require('../models/user.model');\n\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\n\nconst readPost = async (req, res, next) => {\n  try {\n    const posts = await Post.find().sort({\n      createdAt: -1\n    });\n    res.status(200).json(posts);\n  } catch (err) {\n    res.status(200).json(err);\n  }\n};\n\nexports.readPost = readPost;\n\nconst createPost = async (req, res, next) => {\n  if (req.file != null) {\n    console.log(req.file);\n\n    try {\n      if (req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\") {\n        throw new Error('invalid file');\n      }\n\n      if (req.file.size > 500000) {\n        throw new Error('max size');\n      }\n    } catch (err) {\n      const errors = (0, _errors.uploadErrors)(err);\n      return res.status(201).json({\n        errors\n      });\n    }\n  }\n\n  const newPost = new Post({\n    posterId: req.body.posterId,\n    message: req.body.message,\n    picture: req.file != null ? `http://localhost:8080/uploads/posts/${req.file.filename}` : \"\",\n    video: req.body.video,\n    likers: [],\n    comments: []\n  });\n\n  try {\n    const post = await newPost.save();\n    return res.status(201).json(post);\n  } catch (err) {\n    return res.status(400).json(err);\n  }\n};\n\nexports.createPost = createPost;\n\nconst updatePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const updatedRecord = {\n      message: req.body.message\n    };\n    const newPost = await Post.findByIdAndUpdate(req.params.id, {\n      $set: updatedRecord\n    }, {\n      new: true\n    });\n    res.status(200).send(newPost);\n  } catch (err) {\n    res.status(400).json(err);\n  }\n};\n\nexports.updatePost = updatePost;\n\nconst deletePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    await Post.remove({\n      _id: req.params.id\n    }).exec();\n    res.status(200).json({\n      message: 'Successfully deleted !'\n    });\n  } catch (err) {\n    res.status(500).json({\n      message: err\n    });\n  }\n};\n\nexports.deletePost = deletePost;\n\nconst likePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $addToSet: {\n        likers: req.body.id\n      }\n    }, {\n      new: true\n    });\n    const user = await User.findByIdAndUpdate(req.body.id, {\n      $addToSet: {\n        likes: req.params.id\n      }\n    }, {\n      new: true\n    });\n    res.status(200).send(post);\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.likePost = likePost;\n\nconst unlikePost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $pull: {\n        likers: req.body.id\n      }\n    }, {\n      new: true\n    });\n    const user = await User.findByIdAndUpdate(req.body.id, {\n      $pull: {\n        likes: req.params.id\n      }\n    }, {\n      new: true\n    });\n    res.status(200).send(user);\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.unlikePost = unlikePost;\n\nconst commentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $push: {\n        comments: {\n          commenterId: req.body.commenterId,\n          commenterPseudo: req.body.commenterPseudo,\n          text: req.body.text,\n          timestamp: new Date().getTime()\n        }\n      }\n    }, {\n      new: true\n    }).then(data => res.send(data)).catch(err => res.status(500).send({\n      message: err\n    }));\n  } catch (err) {\n    res.status(400).send({\n      err\n    });\n  }\n};\n\nexports.commentPost = commentPost;\n\nconst editCommentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    //on récupère le post concerné\n    const post = await Post.findById(req.params.id); //on récupère le commentaire concerné\n\n    const theComment = await post.comments.find(comment => {\n      return comment._id.equals(req.body.commentId);\n    });\n    console.log(theComment); //on change le text\n\n    theComment.text = req.body.text; // on save les changements\n\n    await post.save(); //on send le post concerné\n\n    return res.send(post);\n  } catch (err) {\n    return res.status(400).send(err);\n  }\n};\n\nexports.editCommentPost = editCommentPost;\n\nconst deleteCommentPost = async (req, res, next) => {\n  if (!ObjectID.isValid(req.params.id)) {\n    return res.status(400).send(`Id unknown : ${req.params.id}`);\n  }\n\n  try {\n    const post = await Post.findByIdAndUpdate(req.params.id, {\n      $pull: {\n        comments: {\n          _id: req.body.commentId\n        }\n      }\n    }, {\n      new: true\n    }).then(newPost => {\n      res.send(newPost);\n    }).catch(err => {\n      return res.status(400).send(err);\n    });\n  } catch (err) {\n    return res.status(400).send(err);\n  }\n};\n\nexports.deleteCommentPost = deleteCommentPost;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJQb3N0IiwicmVxdWlyZSIsIlVzZXIiLCJPYmplY3RJRCIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWFkUG9zdCIsInJlcSIsInJlcyIsIm5leHQiLCJwb3N0cyIsImZpbmQiLCJzb3J0IiwiY3JlYXRlZEF0Iiwic3RhdHVzIiwianNvbiIsImVyciIsImNyZWF0ZVBvc3QiLCJmaWxlIiwiY29uc29sZSIsImxvZyIsIm1pbWV0eXBlIiwiRXJyb3IiLCJzaXplIiwiZXJyb3JzIiwibmV3UG9zdCIsInBvc3RlcklkIiwiYm9keSIsIm1lc3NhZ2UiLCJwaWN0dXJlIiwiZmlsZW5hbWUiLCJ2aWRlbyIsImxpa2VycyIsImNvbW1lbnRzIiwicG9zdCIsInNhdmUiLCJ1cGRhdGVQb3N0IiwiaXNWYWxpZCIsInBhcmFtcyIsImlkIiwic2VuZCIsInVwZGF0ZWRSZWNvcmQiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIiRzZXQiLCJuZXciLCJkZWxldGVQb3N0IiwicmVtb3ZlIiwiX2lkIiwiZXhlYyIsImxpa2VQb3N0IiwiJGFkZFRvU2V0IiwidXNlciIsImxpa2VzIiwidW5saWtlUG9zdCIsIiRwdWxsIiwiY29tbWVudFBvc3QiLCIkcHVzaCIsImNvbW1lbnRlcklkIiwiY29tbWVudGVyUHNldWRvIiwidGV4dCIsInRpbWVzdGFtcCIsIkRhdGUiLCJnZXRUaW1lIiwidGhlbiIsImRhdGEiLCJjYXRjaCIsImVkaXRDb21tZW50UG9zdCIsImZpbmRCeUlkIiwidGhlQ29tbWVudCIsImNvbW1lbnQiLCJlcXVhbHMiLCJjb21tZW50SWQiLCJkZWxldGVDb21tZW50UG9zdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUdBOztBQUhBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLHNCQUFELENBQXBCOztBQUNBLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLHNCQUFELENBQXBCOztBQUNBLE1BQU1FLFFBQVEsR0FBR0YsT0FB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QUFDSCxLQVprQixFQVloQndDLEtBWmdCLENBWVRqRCxHQUFELElBQVM7QUFDZCxhQUFPUixHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCMEIsSUFBaEIsQ0FBcUJ4QixHQUFyQixDQUFQO0FBQ0gsS0Fka0IsQ0FBbkI7QUFlSCxHQWhCRCxDQWlCQSxPQUFPQSxHQUFQLEVBQVk7QUFDUixXQUFPUixHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCMEIsSUFBaEIsQ0FBcUJ4QixHQUFyQixDQUFQO0FBQ0g7QUFDSixDQXhCTSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbGluZXVwLXNvY2lhbC9zZXJ2ZXIvc3JjL2NvbnRyb2xsZXJzLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFBvc3QgPSByZXF1aXJlKCcuLi9tb2RlbHMvcG9zdC5tb2RlbCcpXG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuY29uc3QgT2JqZWN0SUQgPSByZXF1aXJlKFwibW9uZ29vc2VcIikuVHlwZXMuT2JqZWN0SWQ7XG5pbXBvcnQgeyB1cGxvYWRFcnJvcnN9IGZyb20gJy4uL3V0aWxzL2Vycm9ycy51dGlscydcblxuXG5leHBvcnQgY29uc3QgcmVhZFBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3N0cyA9IGF3YWl0IFBvc3QuZmluZCgpLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHBvc3RzKVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGVycilcbiAgICB9XG59XG5leHBvcnQgY29uc3QgY3JlYXRlUG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmKHJlcS5maWxlICE9IG51bGwpe1xuICAgICAgICBjb25zb2xlLmxvZyhyZXEuZmlsZSApXG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIGlmKHJlcS5maWxlLm1pbWV0eXBlICE9IFwiaW1hZ2UvanBnXCIgJiYgcmVxLmZpbGUubWltZXR5cGUgIT0gXCJpbWFnZS9wbmdcIiAmJiByZXEuZmlsZS5taW1ldHlwZSAhPSBcImltYWdlL2pwZWdcIil7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGZpbGUnKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYocmVxLmZpbGUuc2l6ZSA+IDUwMDAwMCl7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdtYXggc2l6ZScpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2goZXJyKXtcbiAgICAgICAgICAgIGNvbnN0IGVycm9ycyA9IHVwbG9hZEVycm9ycyhlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtlcnJvcnN9KVxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IG5ld1Bvc3QgPSBuZXcgUG9zdCh7XG4gICAgICAgIHBvc3RlcklkOiByZXEuYm9keS5wb3N0ZXJJZCxcbiAgICAgICAgbWVzc2FnZTogcmVxLmJvZHkubWVzc2FnZSxcbiAgICAgICAgcGljdHVyZTogcmVxLmZpbGUgIT0gbnVsbCA/IGBodHRwOi8vbG9jYWxob3N0OjgwODAvdXBsb2Fkcy9wb3N0cy8ke3JlcS5maWxlLmZpbGVuYW1lfWAgOiBcIlwiLFxuICAgICAgICB2aWRlbzogcmVxLmJvZHkudmlkZW8sXG4gICAgICAgIGxpa2VyczogW10sXG4gICAgICAgIGNvbW1lbnRzOiBbXSxcbiAgICB9KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3N0ID0gYXdhaXQgbmV3UG9zdC5zYXZlKCk7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMSkuanNvbihwb3N0KVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbihlcnIpXG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IHVwZGF0ZVBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcblxuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXBkYXRlZFJlY29yZCA9IHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IHJlcS5ib2R5Lm1lc3NhZ2VcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuZXdQb3N0ID0gYXdhaXQgUG9zdC5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5wYXJhbXMuaWQsXG4gICAgICAgICAgICB7ICRzZXQ6IHVwZGF0ZWRSZWNvcmQgfSxcbiAgICAgICAgICAgIHsgbmV3OiB0cnVlIH1cbiAgICAgICAgKVxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChuZXdQb3N0KVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKGVycilcbiAgICB9XG5cblxuXG59XG5leHBvcnQgY29uc3QgZGVsZXRlUG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgUG9zdC5yZW1vdmUoe1xuICAgICAgICAgICAgX2lkOiByZXEucGFyYW1zLmlkXG4gICAgICAgIH0pLmV4ZWMoKVxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6ICdTdWNjZXNzZnVsbHkgZGVsZXRlZCAhJyB9KVxuXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnIgfSlcbiAgICB9XG59XG5leHBvcnQgY29uc3QgbGlrZVBvc3QgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQocmVxLnBhcmFtcy5pZCkpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGBJZCB1bmtub3duIDogJHtyZXEucGFyYW1zLmlkfWApXG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBvc3QgPSBhd2FpdCBQb3N0LmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgICAgICAgcmVxLnBhcmFtcy5pZCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkYWRkVG9TZXQ6IHsgbGlrZXJzOiByZXEuYm9keS5pZCB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5ldzogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgICAgICAgcmVxLmJvZHkuaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJGFkZFRvU2V0OiB7IGxpa2VzOiByZXEucGFyYW1zLmlkIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmV3OiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHBvc3QpXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBlcnIgfSlcbiAgICB9XG59XG5leHBvcnQgY29uc3QgdW5saWtlUG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICByZXEucGFyYW1zLmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRwdWxsOiB7IGxpa2VyczogcmVxLmJvZHkuaWQgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuZXc6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5ib2R5LmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRwdWxsOiB7IGxpa2VzOiByZXEucGFyYW1zLmlkIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmV3OiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHVzZXIpXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBlcnIgfSlcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBjb21tZW50UG9zdCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChyZXEucGFyYW1zLmlkKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYElkIHVua25vd24gOiAke3JlcS5wYXJhbXMuaWR9YClcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICByZXEucGFyYW1zLmlkLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRwdXNoOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50ZXJJZDogcmVxLmJvZHkuY29tbWVudGVySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50ZXJQc2V1ZG86IHJlcS5ib2R5LmNvbW1lbnRlclBzZXVkbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHJlcS5ib2R5LnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyBuZXc6IHRydWUgfVxuICAgICAgICApLnRoZW4oKGRhdGEpID0+IHJlcy5zZW5kKGRhdGEpKVxuICAgICAgICAuY2F0Y2goKGVycikgPT4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBtZXNzYWdlOiBlcnIgfSkpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgZXJyIH0pXG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgZWRpdENvbW1lbnRQb3N0ID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAgIC8vb24gcsOpY3Vww6hyZSBsZSBwb3N0IGNvbmNlcm7DqVxuICAgICAgICBjb25zdCBwb3N0ID0gYXdhaXQgUG9zdC5maW5kQnlJZChyZXEucGFyYW1zLmlkKVxuICAgICBcbiAgICAgICAgLy9vbiByw6ljdXDDqHJlIGxlIGNvbW1lbnRhaXJlIGNvbmNlcm7DqVxuICAgICAgICBjb25zdCB0aGVDb21tZW50ID0gYXdhaXQgcG9zdC5jb21tZW50cy5maW5kKChjb21tZW50KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gY29tbWVudC5faWQuZXF1YWxzKHJlcS5ib2R5LmNvbW1lbnRJZClcbiAgICAgICAgfSlcbiAgICAgICAgY29uc29sZS5sb2codGhlQ29tbWVudClcbiAgICAgICAgLy9vbiBjaGFuZ2UgbGUgdGV4dFxuICAgICAgICB0aGVDb21tZW50LnRleHQgPSByZXEuYm9keS50ZXh0XG4gICAgICAgIC8vIG9uIHNhdmUgbGVzIGNoYW5nZW1lbnRzXG4gICAgICAgIGF3YWl0IHBvc3Quc2F2ZSgpO1xuICAgICAgICAvL29uIHNlbmQgbGUgcG9zdCBjb25jZXJuw6lcbiAgICAgICAgcmV0dXJuIHJlcy5zZW5kKHBvc3QpXG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGVycilcbiAgICB9XG59XG5cblxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNvbW1lbnRQb3N0ID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgaWYgKCFPYmplY3RJRC5pc1ZhbGlkKHJlcS5wYXJhbXMuaWQpKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgSWQgdW5rbm93biA6ICR7cmVxLnBhcmFtcy5pZH1gKVxuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3N0ID0gYXdhaXQgUG9zdC5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICAgIHJlcS5wYXJhbXMuaWQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJHB1bGw6IHtcbiAgICAgICAgICAgICAgICAgICAgY29tbWVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogcmVxLmJvZHkuY29tbWVudElkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyBuZXc6IHRydWUgfVxuICAgICAgICApLnRoZW4oKG5ld1Bvc3QpID0+IHtcbiAgICAgICAgICAgIHJlcy5zZW5kKG5ld1Bvc3QpXG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnIpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnIpXG4gICAgfVxufSJdfQ==","map":{"version":3,"sources":["post.controller.js"],"names":["Post","require","User","ObjectID","Types","ObjectId","readPost","req","res","next","posts","find","sort","createdAt","status","json","err","createPost","file","console","log","mimetype","Error","size","errors","newPost","posterId","body","message","picture","filename","video","likers","comments","post","save","updatePost","isValid","params","id","send","updatedRecord","findByIdAndUpdate","$set","new","deletePost","remove","_id","exec","likePost","$addToSet","user","likes","unlikePost","$pull","commentPost","$push","commenterId","commenterPseudo","text","timestamp","Date","getTime","then","data","catch","editCommentPost","findById","theComment","comment","equals","commentId","deleteCommentPost"],"mappings":"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","sourceRoot":"/Applications/dossier/lineup-social/server/src/controllers/","sourcesContent":["const Post = require('../models/post.model')\nconst User = require('../models/user.model')\nconst ObjectID = require(\"mongoose\").Types.ObjectId;\nimport { uploadErrors} from '../utils/errors.utils'\n\n\nexport const readPost = async (req, res, next) => {\n    try {\n        const posts = await Post.find().sort({ createdAt: -1 })\n        res.status(200).json(posts)\n    }\n    catch (err) {\n        res.status(200).json(err)\n    }\n}\nexport const createPost = async (req, res, next) => {\n    if(req.file != null){\n        console.log(req.file )\n        try{\n            if(req.file.mimetype != \"image/jpg\" && req.file.mimetype != \"image/png\" && req.file.mimetype != \"image/jpeg\"){\n                throw new Error('invalid file')\n            }\n            if(req.file.size > 500000){\n                throw new Error('max size')\n            }\n        }\n        catch(err){\n            const errors = uploadErrors(err);\n            return res.status(201).json({errors})\n        }\n    }\n    const newPost = new Post({\n        posterId: req.body.posterId,\n        message: req.body.message,\n        picture: req.file != null ? `http://localhost:8080/uploads/posts/${req.file.filename}` : \"\",\n        video: req.body.video,\n        likers: [],\n        comments: [],\n    });\n    try {\n        const post = await newPost.save();\n        return res.status(201).json(post)\n    }\n    catch (err) {\n        return res.status(400).json(err)\n    }\n}\nexport const updatePost = async (req, res, next) => {\n\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    \n    try {\n        const updatedRecord = {\n            message: req.body.message\n        }\n        const newPost = await Post.findByIdAndUpdate(\n            req.params.id,\n            { $set: updatedRecord },\n            { new: true }\n        )\n        res.status(200).send(newPost)\n    }\n    catch (err) {\n        res.status(400).json(err)\n    }\n\n\n\n}\nexport const deletePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        await Post.remove({\n            _id: req.params.id\n        }).exec()\n        res.status(200).json({ message: 'Successfully deleted !' })\n\n    }\n    catch (err) {\n        res.status(500).json({ message: err })\n    }\n}\nexport const likePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $addToSet: { likers: req.body.id }\n            },\n            {\n                new: true\n            }\n        )\n        const user = await User.findByIdAndUpdate(\n            req.body.id,\n            {\n                $addToSet: { likes: req.params.id }\n            },\n            {\n                new: true\n            }\n        );\n        res.status(200).send(post)\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\nexport const unlikePost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $pull: { likers: req.body.id }\n            },\n            {\n                new: true\n            }\n        )\n        const user = await User.findByIdAndUpdate(\n            req.body.id,\n            {\n                $pull: { likes: req.params.id }\n            },\n            {\n                new: true\n            }\n        );\n        res.status(200).send(user)\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\n\nexport const commentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $push: {\n                    comments: {\n                        commenterId: req.body.commenterId,\n                        commenterPseudo: req.body.commenterPseudo,\n                        text: req.body.text,\n                        timestamp: new Date().getTime()\n                    }\n                }\n            },\n            { new: true }\n        ).then((data) => res.send(data))\n        .catch((err) => res.status(500).send({ message: err }));\n    }\n    catch (err) {\n        res.status(400).send({ err })\n    }\n}\n\nexport const editCommentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n\n    try {\n        //on récupère le post concerné\n        const post = await Post.findById(req.params.id)\n     \n        //on récupère le commentaire concerné\n        const theComment = await post.comments.find((comment) => {\n            return comment._id.equals(req.body.commentId)\n        })\n        console.log(theComment)\n        //on change le text\n        theComment.text = req.body.text\n        // on save les changements\n        await post.save();\n        //on send le post concerné\n        return res.send(post)\n    }\n    catch (err) {\n        return res.status(400).send(err)\n    }\n}\n\n\nexport const deleteCommentPost = async (req, res, next) => {\n    if (!ObjectID.isValid(req.params.id)) {\n        return res.status(400).send(`Id unknown : ${req.params.id}`)\n    }\n    try {\n        const post = await Post.findByIdAndUpdate(\n            req.params.id,\n            {\n                $pull: {\n                    comments: {\n                        _id: req.body.commentId\n                    }\n                }\n            },\n            { new: true }\n        ).then((newPost) => {\n            res.send(newPost)\n        }).catch((err) => {\n            return res.status(400).send(err)\n        });\n    }\n    catch (err) {\n        return res.status(400).send(err)\n    }\n}"]}},"mtime":1653047124737},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/models/post.model.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nconst PostSchema = new mongoose.Schema({\n  posterId: {\n    type: String,\n    required: true\n  },\n  message: {\n    type: String,\n    trim: true,\n    maxlength: 500\n  },\n  picture: {\n    type: String\n  },\n  video: {\n    type: String\n  },\n  likers: {\n    type: [String],\n    required: true\n  },\n  //la partie commentaire est une sous base de données\n  comments: {\n    type: [{\n      commenterId: String,\n      commenterPseudo: String,\n      text: String,\n      timestamp: Number\n    }],\n    required: true\n  }\n}, {\n  timestamps: true\n});\nlet Post = mongoose.model('post', PostSchema);\nmodule.exports = Post;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QubW9kZWwuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiUG9zdFNjaGVtYSIsIlNjaGVtYSIsInBvc3RlcklkIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwibWVzc2FnZSIsInRyaW0iLCJtYXhsZW5ndGgiLCJwaWN0dXJlIiwidmlkZW8iLCJsaWtlcnMiLCJjb21tZW50cyIsImNvbW1lbnRlcklkIiwiY29tbWVudGVyUHNldWRvIiwidGV4dCIsInRpbWVzdGFtcCIsIk51bWJlciIsInRpbWVzdGFtcHMiLCJQb3N0IiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBRUEsTUFBTUMsVUFBVSxHQUFHLElBQUlGLFFBQVEsQ0FBQ0csTUFBYixDQUNmO0FBQ0lDLEVBQUFBLFFBQVEsRUFBRTtBQUNOQyxJQUFBQSxJQUFJLEVBQUVDLE1BREE7QUFFTkMsSUFBQUEsUUFBUSxFQUFFO0FBRkosR0FEZDtBQUtJQyxFQUFBQSxPQUFPLEVBQUU7QUFDTEgsSUFBQUEsSUFBSSxFQUFFQyxNQUREO0FBRUxHLElBQUFBLElBQUksRUFBRSxJQUZEO0FBR0xDLElBQUFBLFNBQVMsRUFBRTtBQUhOLEdBTGI7QUFVSUMsRUFBQUEsT0FBTyxFQUFFO0FBQ0xOLElBQUFBLElBQUksRUFBRUM7QUFERCxHQVZiO0FBYUlNLEVBQUFBLEtBQUssRUFBRTtBQUNIUCxJQUFBQSxJQUFJLEVBQUVDO0FBREgsR0FiWDtBQWdCSU8sRUFBQUEsTUFBTSxFQUFFO0FBQ0pSLElBQUFBLElBQUksRUFBRSxDQUFDQyxNQUFELENBREY7QUFFSkMsSUFBQUEsUUFBUSxFQUFFO0FBRk4sR0FoQlo7QUFvQkk7QUFDQU8sRUFBQUEsUUFBUSxFQUFFO0FBQ05ULElBQUFBLElBQUksRUFBRSxDQUNGO0FBQ0lVLE1BQUFBLFdBQVcsRUFBRVQsTUFEakI7QUFFSVUsTUFBQUEsZUFBZSxFQUFFVixNQUZyQjtBQUdJVyxNQUFBQSxJQUFJLEVBQUVYLE1BSFY7QUFJSVksTUFBQUEsU0FBUyxFQUFFQztBQUpmLEtBREUsQ0FEQTtBQVNOWixJQUFBQSxRQUFRLEVBQUU7QUFUSjtBQXJCZCxDQURlLEVBa0NmO0FBQ0lhLEVBQUFBLFVBQVUsRUFBRTtBQURoQixDQWxDZSxDQUFuQjtBQXVDQSxJQUFJQyxJQUFJLEdBQUdyQixRQUFRLENBQUNzQixLQUFULENBQWUsTUFBZixFQUF1QnBCLFVBQXZCLENBQVg7QUFDQXFCLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsSUFBakIiLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL2xpbmV1cC1zb2NpYWwvc2VydmVyL3NyYy9tb2RlbHMvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuXG5jb25zdCBQb3N0U2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYShcbiAgICB7XG4gICAgICAgIHBvc3RlcklkOiB7XG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgICAgICAgdHJpbTogdHJ1ZSxcbiAgICAgICAgICAgIG1heGxlbmd0aDogNTAwXG4gICAgICAgIH0sXG4gICAgICAgIHBpY3R1cmU6IHtcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZ1xuICAgICAgICB9LFxuICAgICAgICB2aWRlbzoge1xuICAgICAgICAgICAgdHlwZTogU3RyaW5nXG4gICAgICAgIH0sXG4gICAgICAgIGxpa2Vyczoge1xuICAgICAgICAgICAgdHlwZTogW1N0cmluZ10sXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgLy9sYSBwYXJ0aWUgY29tbWVudGFpcmUgZXN0IHVuZSBzb3VzIGJhc2UgZGUgZG9ubsOpZXNcbiAgICAgICAgY29tbWVudHM6IHtcbiAgICAgICAgICAgIHR5cGU6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRlcklkOiBTdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRlclBzZXVkbzogU3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBTdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogTnVtYmVyXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIHRpbWVzdGFtcHM6IHRydWVcbiAgICB9XG4pO1xuXG5sZXQgUG9zdCA9IG1vbmdvb3NlLm1vZGVsKCdwb3N0JywgUG9zdFNjaGVtYSlcbm1vZHVsZS5leHBvcnRzID0gUG9zdDsiXX0=","map":{"version":3,"sources":["post.model.js"],"names":["mongoose","require","PostSchema","Schema","posterId","type","String","required","message","trim","maxlength","picture","video","likers","comments","commenterId","commenterPseudo","text","timestamp","Number","timestamps","Post","model","module","exports"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,MAAMC,UAAU,GAAG,IAAIF,QAAQ,CAACG,MAAb,CACf;AACIC,EAAAA,QAAQ,EAAE;AACNC,IAAAA,IAAI,EAAEC,MADA;AAENC,IAAAA,QAAQ,EAAE;AAFJ,GADd;AAKIC,EAAAA,OAAO,EAAE;AACLH,IAAAA,IAAI,EAAEC,MADD;AAELG,IAAAA,IAAI,EAAE,IAFD;AAGLC,IAAAA,SAAS,EAAE;AAHN,GALb;AAUIC,EAAAA,OAAO,EAAE;AACLN,IAAAA,IAAI,EAAEC;AADD,GAVb;AAaIM,EAAAA,KAAK,EAAE;AACHP,IAAAA,IAAI,EAAEC;AADH,GAbX;AAgBIO,EAAAA,MAAM,EAAE;AACJR,IAAAA,IAAI,EAAE,CAACC,MAAD,CADF;AAEJC,IAAAA,QAAQ,EAAE;AAFN,GAhBZ;AAoBI;AACAO,EAAAA,QAAQ,EAAE;AACNT,IAAAA,IAAI,EAAE,CACF;AACIU,MAAAA,WAAW,EAAET,MADjB;AAEIU,MAAAA,eAAe,EAAEV,MAFrB;AAGIW,MAAAA,IAAI,EAAEX,MAHV;AAIIY,MAAAA,SAAS,EAAEC;AAJf,KADE,CADA;AASNZ,IAAAA,QAAQ,EAAE;AATJ;AArBd,CADe,EAkCf;AACIa,EAAAA,UAAU,EAAE;AADhB,CAlCe,CAAnB;AAuCA,IAAIC,IAAI,GAAGrB,QAAQ,CAACsB,KAAT,CAAe,MAAf,EAAuBpB,UAAvB,CAAX;AACAqB,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourceRoot":"/Applications/dossier/lineup-social/server/src/models/","sourcesContent":["const mongoose = require('mongoose');\n\nconst PostSchema = new mongoose.Schema(\n    {\n        posterId: {\n            type: String,\n            required: true,\n        },\n        message: {\n            type: String,\n            trim: true,\n            maxlength: 500\n        },\n        picture: {\n            type: String\n        },\n        video: {\n            type: String\n        },\n        likers: {\n            type: [String],\n            required: true,\n        },\n        //la partie commentaire est une sous base de données\n        comments: {\n            type: [\n                {\n                    commenterId: String,\n                    commenterPseudo: String,\n                    text: String,\n                    timestamp: Number\n                }\n            ],\n            required: true,\n        }\n    },\n    {\n        timestamps: true\n    }\n);\n\nlet Post = mongoose.model('post', PostSchema)\nmodule.exports = Post;"]}},"mtime":1651276586978},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/middlewares/auth.middleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.requireAuth = exports.checkUser = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _HttpException = require(\"../errors/HttpException.error\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst User = require('../models/user.model');\n\nconst checkUser = (req, res, next) => {\n  const token = req.cookies.jwt;\n\n  if (token) {\n    _jsonwebtoken.default.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        res.locals.user = null; // res.cookie(\"jwt\", '', { maxAge: 1 })\n\n        next();\n      } else {\n        let user = await User.findById(decodedToken.id);\n\n        if (!user) {\n          return next(new _HttpException.HttpException('Unauthorized', _HttpException.HttpStatus.UNAUTHORIZED));\n        }\n\n        res.locals.user = user;\n        next();\n      }\n    });\n  } else {\n    res.locals.user = null;\n    next();\n  }\n};\n\nexports.checkUser = checkUser;\n\nconst requireAuth = (req, res, next) => {\n  const token = req.cookies.jwt;\n\n  if (token) {\n    _jsonwebtoken.default.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        console.log(err);\n      } else {\n        console.log(decodedToken.id);\n        next();\n      }\n    });\n  } else {\n    console.log('no token');\n  }\n};\n\nexports.requireAuth = requireAuth;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgubWlkZGxld2FyZS5qcyJdLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImNoZWNrVXNlciIsInJlcSIsInJlcyIsIm5leHQiLCJ0b2tlbiIsImNvb2tpZXMiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiVE9LRU5fU0VDUkVUIiwiZXJyIiwiZGVjb2RlZFRva2VuIiwibG9jYWxzIiwidXNlciIsImZpbmRCeUlkIiwiaWQiLCJIdHRwRXhjZXB0aW9uIiwiSHR0cFN0YXR1cyIsIlVOQVVUSE9SSVpFRCIsInJlcXVpcmVBdXRoIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUVBOzs7O0FBREEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsc0JBQUQsQ0FBcEI7O0FBSU8sTUFBTUMsU0FBUyxHQUFHLENBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFXQyxJQUFYLEtBQW9CO0FBQzNDLFFBQU1DLEtBQUssR0FBR0gsR0FBRyxDQUFDSSxPQUFKLENBQVlDLEdBQTFCOztBQUNBLE1BQUlGLEtBQUosRUFBVztBQUVURSwwQkFBSUMsTUFBSixDQUFXSCxLQUFYLEVBQWtCSSxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsWUFBOUIsRUFBNEMsT0FBT0MsR0FBUCxFQUFZQyxZQUFaLEtBQTZCO0FBQ3ZFLFVBQUlELEdBQUosRUFBUztBQUNQVCxRQUFBQSxHQUFHLENBQUNXLE1BQUosQ0FBV0MsSUFBWCxHQUFrQixJQUFsQixDQURPLENBRVI7O0FBQ0NYLFFBQUFBLElBQUk7QUFDTCxPQUpELE1BSU87QUFDTCxZQUFJVyxJQUFJLEdBQUcsTUFBTWhCLElBQUksQ0FBQ2lCLFFBQUwsQ0FBY0gsWUFBWSxDQUFDSSxFQUEzQixDQUFqQjs7QUFDQSxZQUFJLENBQUNGLElBQUwsRUFBVztBQUNULGlCQUFPWCxJQUFJLENBQUMsSUFBSWMsNEJBQUosQ0FBa0IsY0FBbEIsRUFBa0NDLDBCQUFXQyxZQUE3QyxDQUFELENBQVg7QUFDRDs7QUFDRGpCLFFBQUFBLEdBQUcsQ0FBQ1csTUFBSixDQUFXQyxJQUFYLEdBQWtCQSxJQUFsQjtBQUNBWCxRQUFBQSxJQUFJO0FBQ0w7QUFDRixLQWJEO0FBY0QsR0FoQkQsTUFpQks7QUFDSEQsSUFBQUEsR0FBRyxDQUFDVyxNQUFKLENBQVdDLElBQVgsR0FBa0IsSUFBbEI7QUFDQVgsSUFBQUEsSUFBSTtBQUNMO0FBQ0YsQ0F2Qk07Ozs7QUF5QkEsTUFBTWlCLFdBQVcsR0FBRyxDQUFDbkIsR0FBRCxFQUFNQyxHQUFOLEVBQVdDLElBQVgsS0FBb0I7QUFDN0MsUUFBTUMsS0FBSyxHQUFHSCxHQUFHLENBQUNJLE9BQUosQ0FBWUMsR0FBMUI7O0FBQ0EsTUFBSUYsS0FBSixFQUFXO0FBQ1RFLDBCQUFJQyxNQUFKLENBQVdILEtBQVgsRUFBa0JJLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUE5QixFQUE0QyxPQUFPQyxHQUFQLEVBQVlDLFlBQVosS0FBNkI7QUFDdkUsVUFBR0QsR0FBSCxFQUFPO0FBQ0xVLFFBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZWCxHQUFaO0FBQ0QsT0FGRCxNQUVLO0FBQ0hVLFFBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZVixZQUFZLENBQUNJLEVBQXpCO0FBQ0FiLFFBQUFBLElBQUk7QUFDTDtBQUNGLEtBUEQ7QUFRRCxHQVRELE1BU0s7QUFDSGtCLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLFVBQVo7QUFDRDtBQUNGLENBZE0iLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL2xpbmV1cC1zb2NpYWwvc2VydmVyL3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbic7XG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXIubW9kZWwnKVxuaW1wb3J0IHsgSHR0cEV4Y2VwdGlvbiwgSHR0cFN0YXR1cyB9IGZyb20gJy4uL2Vycm9ycy9IdHRwRXhjZXB0aW9uLmVycm9yJztcblxuXG5leHBvcnQgY29uc3QgY2hlY2tVc2VyID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHRva2VuID0gcmVxLmNvb2tpZXMuand0O1xuICBpZiAodG9rZW4pIHtcbiBcbiAgICBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5UT0tFTl9TRUNSRVQsIGFzeW5jIChlcnIsIGRlY29kZWRUb2tlbikgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZXMubG9jYWxzLnVzZXIgPSBudWxsO1xuICAgICAgIC8vIHJlcy5jb29raWUoXCJqd3RcIiwgJycsIHsgbWF4QWdlOiAxIH0pXG4gICAgICAgIG5leHQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChkZWNvZGVkVG9rZW4uaWQpO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICByZXR1cm4gbmV4dChuZXcgSHR0cEV4Y2VwdGlvbignVW5hdXRob3JpemVkJywgSHR0cFN0YXR1cy5VTkFVVEhPUklaRUQpKTtcbiAgICAgICAgfVxuICAgICAgICByZXMubG9jYWxzLnVzZXIgPSB1c2VyO1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9XG4gICAgfSlcbiAgfVxuICBlbHNlIHtcbiAgICByZXMubG9jYWxzLnVzZXIgPSBudWxsO1xuICAgIG5leHQoKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcmVxdWlyZUF1dGggPSAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgY29uc3QgdG9rZW4gPSByZXEuY29va2llcy5qd3RcbiAgaWYgKHRva2VuKSB7XG4gICAgand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVULCBhc3luYyAoZXJyLCBkZWNvZGVkVG9rZW4pID0+IHtcbiAgICAgIGlmKGVycil7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgY29uc29sZS5sb2coZGVjb2RlZFRva2VuLmlkKVxuICAgICAgICBuZXh0KCk7XG4gICAgICB9XG4gICAgfSlcbiAgfWVsc2V7XG4gICAgY29uc29sZS5sb2coJ25vIHRva2VuJylcbiAgfVxufVxuIl19","map":{"version":3,"sources":["auth.middleware.js"],"names":["User","require","checkUser","req","res","next","token","cookies","jwt","verify","process","env","TOKEN_SECRET","err","decodedToken","locals","user","findById","id","HttpException","HttpStatus","UNAUTHORIZED","requireAuth","console","log"],"mappings":";;;;;;;AAAA;;AAEA;;;;AADA,MAAMA,IAAI,GAAGC,OAAO,CAAC,sBAAD,CAApB;;AAIO,MAAMC,SAAS,GAAG,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC3C,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,GAA1B;;AACA,MAAIF,KAAJ,EAAW;AAETE,0BAAIC,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,EAA4C,OAAOC,GAAP,EAAYC,YAAZ,KAA6B;AACvE,UAAID,GAAJ,EAAS;AACPT,QAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkB,IAAlB,CADO,CAER;;AACCX,QAAAA,IAAI;AACL,OAJD,MAIO;AACL,YAAIW,IAAI,GAAG,MAAMhB,IAAI,CAACiB,QAAL,CAAcH,YAAY,CAACI,EAA3B,CAAjB;;AACA,YAAI,CAACF,IAAL,EAAW;AACT,iBAAOX,IAAI,CAAC,IAAIc,4BAAJ,CAAkB,cAAlB,EAAkCC,0BAAWC,YAA7C,CAAD,CAAX;AACD;;AACDjB,QAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkBA,IAAlB;AACAX,QAAAA,IAAI;AACL;AACF,KAbD;AAcD,GAhBD,MAiBK;AACHD,IAAAA,GAAG,CAACW,MAAJ,CAAWC,IAAX,GAAkB,IAAlB;AACAX,IAAAA,IAAI;AACL;AACF,CAvBM;;;;AAyBA,MAAMiB,WAAW,GAAG,CAACnB,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC7C,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,GAA1B;;AACA,MAAIF,KAAJ,EAAW;AACTE,0BAAIC,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,EAA4C,OAAOC,GAAP,EAAYC,YAAZ,KAA6B;AACvE,UAAGD,GAAH,EAAO;AACLU,QAAAA,OAAO,CAACC,GAAR,CAAYX,GAAZ;AACD,OAFD,MAEK;AACHU,QAAAA,OAAO,CAACC,GAAR,CAAYV,YAAY,CAACI,EAAzB;AACAb,QAAAA,IAAI;AACL;AACF,KAPD;AAQD,GATD,MASK;AACHkB,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACD;AACF,CAdM","sourceRoot":"/Applications/dossier/lineup-social/server/src/middlewares/","sourcesContent":["import jwt from 'jsonwebtoken';\nconst User = require('../models/user.model')\nimport { HttpException, HttpStatus } from '../errors/HttpException.error';\n\n\nexport const checkUser = (req, res, next) => {\n  const token = req.cookies.jwt;\n  if (token) {\n \n    jwt.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if (err) {\n        res.locals.user = null;\n       // res.cookie(\"jwt\", '', { maxAge: 1 })\n        next();\n      } else {\n        let user = await User.findById(decodedToken.id);\n        if (!user) {\n          return next(new HttpException('Unauthorized', HttpStatus.UNAUTHORIZED));\n        }\n        res.locals.user = user;\n        next();\n      }\n    })\n  }\n  else {\n    res.locals.user = null;\n    next();\n  }\n}\n\nexport const requireAuth = (req, res, next) => {\n  const token = req.cookies.jwt\n  if (token) {\n    jwt.verify(token, process.env.TOKEN_SECRET, async (err, decodedToken) => {\n      if(err){\n        console.log(err);\n      }else{\n        console.log(decodedToken.id)\n        next();\n      }\n    })\n  }else{\n    console.log('no token')\n  }\n}\n"]}},"mtime":1651607963929},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/errors/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/errors/HttpException.error.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HttpStatus = exports.HttpException = void 0;\nconst HttpStatus = {\n  UNAUTHORIZED: 401,\n  NOT_FOUND: 404\n};\nexports.HttpStatus = HttpStatus;\n\nclass HttpException extends Error {\n  constructor(message, statusCode) {\n    super(message);\n    this.statusCode = statusCode;\n  }\n\n}\n\nexports.HttpException = HttpException;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkh0dHBFeGNlcHRpb24uZXJyb3IuanMiXSwibmFtZXMiOlsiSHR0cFN0YXR1cyIsIlVOQVVUSE9SSVpFRCIsIk5PVF9GT1VORCIsIkh0dHBFeGNlcHRpb24iLCJFcnJvciIsImNvbnN0cnVjdG9yIiwibWVzc2FnZSIsInN0YXR1c0NvZGUiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFPLE1BQU1BLFVBQVUsR0FBRztBQUN4QkMsRUFBQUEsWUFBWSxFQUFFLEdBRFU7QUFFeEJDLEVBQUFBLFNBQVMsRUFBRTtBQUZhLENBQW5COzs7QUFLQSxNQUFNQyxhQUFOLFNBQTRCQyxLQUE1QixDQUFrQztBQUN2Q0MsRUFBQUEsV0FBVyxDQUFDQyxPQUFELEVBQVVDLFVBQVYsRUFBc0I7QUFDL0IsVUFBTUQsT0FBTjtBQUVBLFNBQUtDLFVBQUwsR0FBa0JBLFVBQWxCO0FBQ0Q7O0FBTHNDIiwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9saW5ldXAtc29jaWFsL3NlcnZlci9zcmMvZXJyb3JzLyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBIdHRwU3RhdHVzID0ge1xuICBVTkFVVEhPUklaRUQ6IDQwMSxcbiAgTk9UX0ZPVU5EOiA0MDQsXG59XG5cbmV4cG9ydCBjbGFzcyBIdHRwRXhjZXB0aW9uIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlLCBzdGF0dXNDb2RlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG5cbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xuICB9XG59XG4iXX0=","map":{"version":3,"sources":["HttpException.error.js"],"names":["HttpStatus","UNAUTHORIZED","NOT_FOUND","HttpException","Error","constructor","message","statusCode"],"mappings":";;;;;;AAAO,MAAMA,UAAU,GAAG;AACxBC,EAAAA,YAAY,EAAE,GADU;AAExBC,EAAAA,SAAS,EAAE;AAFa,CAAnB;;;AAKA,MAAMC,aAAN,SAA4BC,KAA5B,CAAkC;AACvCC,EAAAA,WAAW,CAACC,OAAD,EAAUC,UAAV,EAAsB;AAC/B,UAAMD,OAAN;AAEA,SAAKC,UAAL,GAAkBA,UAAlB;AACD;;AALsC","sourceRoot":"/Applications/dossier/lineup-social/server/src/errors/","sourcesContent":["export const HttpStatus = {\n  UNAUTHORIZED: 401,\n  NOT_FOUND: 404,\n}\n\nexport class HttpException extends Error {\n  constructor(message, statusCode) {\n    super(message);\n\n    this.statusCode = statusCode;\n  }\n}\n"]}},"mtime":1651253219660},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/database.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nmongoose.connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`).then(() => console.log('Connected to MongoDB')).catch(error => console.log(\"Failed to connect MongoDB\", error));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhdGFiYXNlLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiREJfVVNFUk5BTUUiLCJEQl9QQVNTV09SRCIsInRoZW4iLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnJvciJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUVBRCxRQUFRLENBQ0hFLE9BREwsQ0FDYyxpQkFBZ0JDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxXQUFZLElBQUdGLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRSxXQUFZLDBDQURqRixFQUVLQyxJQUZMLENBRVUsTUFBTUMsT0FBTyxDQUFDQyxHQUFSLENBQVksc0JBQVosQ0FGaEIsRUFHS0MsS0FITCxDQUdZQyxLQUFELElBQVdILE9BQU8sQ0FBQ0MsR0FBUixDQUFZLDJCQUFaLEVBQXlDRSxLQUF6QyxDQUh0QiIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbGluZXVwLXNvY2lhbC9zZXJ2ZXIvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpXG5cbm1vbmdvb3NlXG4gICAgLmNvbm5lY3QoYG1vbmdvZGIrc3J2Oi8vJHtwcm9jZXNzLmVudi5EQl9VU0VSTkFNRX06JHtwcm9jZXNzLmVudi5EQl9QQVNTV09SRH1AY2x1c3RlcjAuZ2J2eGcubW9uZ29kYi5uZXQvbWVybl9wcm9qZWN0YClcbiAgICAudGhlbigoKSA9PiBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIE1vbmdvREInKSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBjb25uZWN0IE1vbmdvREJcIiwgZXJyb3IpKSJdfQ==","map":{"version":3,"sources":["database.js"],"names":["mongoose","require","connect","process","env","DB_USERNAME","DB_PASSWORD","then","console","log","catch","error"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEAD,QAAQ,CACHE,OADL,CACc,iBAAgBC,OAAO,CAACC,GAAR,CAAYC,WAAY,IAAGF,OAAO,CAACC,GAAR,CAAYE,WAAY,0CADjF,EAEKC,IAFL,CAEU,MAAMC,OAAO,CAACC,GAAR,CAAY,sBAAZ,CAFhB,EAGKC,KAHL,CAGYC,KAAD,IAAWH,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCE,KAAzC,CAHtB","sourceRoot":"/Applications/dossier/lineup-social/server/","sourcesContent":["const mongoose = require('mongoose')\n\nmongoose\n    .connect(`mongodb+srv://${process.env.DB_USERNAME}:${process.env.DB_PASSWORD}@cluster0.gbvxg.mongodb.net/mern_project`)\n    .then(() => console.log('Connected to MongoDB'))\n    .catch((error) => console.log(\"Failed to connect MongoDB\", error))"]}},"mtime":1651231241527},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/lineup-social/server/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/lineup-social/server\",\"filename\":\"/Applications/dossier/lineup-social/server/src/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/lineup-social/server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.launch = launch;\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _response = _interopRequireDefault(require(\"express/lib/response\"));\n\nvar _routes = _interopRequireDefault(require(\"./routes\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst bodyParser = require('body-parser');\n\nconst cookieParser = require(\"cookie-parser\");\n\nconst {\n  checkUser,\n  requireAuth\n} = require('./middlewares/auth.middleware');\n\nconst cors = require(\"cors\");\n\nfunction launch({\n  host,\n  protocol,\n  port\n}) {\n  const application = (0, _express.default)();\n\n  require('dotenv').config({\n    path: './.env'\n  });\n\n  require('../database.js');\n\n  application.use(cors({\n    origin: process.env.CLIENT_URL,\n    methods: [\"GET\", \"POST\", \"HEAD\", \"PUT\", \"PATCH\", \"DELETE\"],\n    credentials: true\n  }));\n  application.use(cookieParser());\n  application.use(_express.default.json()); // notre middleware de sécurité\n\n  application.get('*', checkUser); //cest ce qui permet de loger un user lorsqu'il arrive sur le site\n\n  application.get('/jwtid', requireAuth, (req, res) => {\n    res.status(200).send(res.locals.user._id);\n  });\n  application.use(_routes.default);\n  application.use(_express.default.static('assets'));\n  application.listen(process.env.PORT || port, () => console.log(`Server started at ${protocol}://${host}:${port}`));\n}\n/* require('dotenv').config({path:'./config/.env'})\n */\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJib2R5UGFyc2VyIiwicmVxdWlyZSIsImNvb2tpZVBhcnNlciIsImNoZWNrVXNlciIsInJlcXVpcmVBdXRoIiwiY29ycyIsImxhdW5jaCIsImhvc3QiLCJwcm90b2NvbCIsInBvcnQiLCJhcHBsaWNhdGlvbiIsImNvbmZpZyIsInBhdGgiLCJ1c2UiLCJvcmlnaW4iLCJwcm9jZXNzIiwiZW52IiwiQ0xJRU5UX1VSTCIsIm1ldGhvZHMiLCJjcmVkZW50aWFscyIsImV4cHJlc3MiLCJqc29uIiwiZ2V0IiwicmVxIiwicmVzIiwic3RhdHVzIiwic2VuZCIsImxvY2FscyIsInVzZXIiLCJfaWQiLCJEZWZhdWx0Um91dGVyIiwic3RhdGljIiwibGlzdGVuIiwiUE9SVCIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7OztBQUNBLE1BQU1BLFVBQVUsR0FBR0MsT0FBTyxDQUFDLGFBQUQsQ0FBMUI7O0FBRUEsTUFBTUMsWUFBWSxHQUFHRCxPQUFPLENBQUMsZUFBRCxDQUE1Qjs7QUFDQSxNQUFNO0FBQUVFLEVBQUFBLFNBQUY7QUFBYUMsRUFBQUE7QUFBYixJQUE2QkgsT0FBTyxDQUFDLCtCQUFELENBQTFDOztBQUNBLE1BQU1JLElBQUksR0FBR0osT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBR08sU0FBU0ssTUFBVCxDQUFnQjtBQUFFQyxFQUFBQSxJQUFGO0FBQVFDLEVBQUFBLFFBQVI7QUFBa0JDLEVBQUFBO0FBQWxCLENBQWhCLEVBQTBDO0FBQy9DLFFBQU1DLFdBQVcsR0FBRyx1QkFBcEI7O0FBQ0FULEVBQUFBLE9BQU8sQ0FBQyxRQUFELENBQVAsQ0FBa0JVLE1BQWxCLENBQXlCO0FBQUVDLElBQUFBLElBQUksRUFBRTtBQUFSLEdBQXpCOztBQUNBWCxFQUFBQSxPQUFPLENBQUMsZ0JBQUQsQ0FBUDs7QUFFQVMsRUFBQUEsV0FBVyxDQUFDRyxHQUFaLENBQ0VSLElBQUksQ0FBQztBQUNIUyxJQUFBQSxNQUFNLEVBQUVDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxVQURqQjtBQUVIQyxJQUFBQSxPQUFPLEVBQUUsQ0FBQyxLQUFELEVBQVEsTUFBUixFQUFnQixNQUFoQixFQUF3QixLQUF4QixFQUErQixPQUEvQixFQUF3QyxRQUF4QyxDQUZOO0FBR0hDLElBQUFBLFdBQVcsRUFBRTtBQUhWLEdBQUQsQ0FETjtBQU9BVCxFQUFBQSxXQUFXLENBQUNHLEdBQVosQ0FBZ0JYLFlBQVksRUFBNUI7QUFFQVEsRUFBQUEsV0FBVyxDQUFDRyxHQUFaLENBQWdCTyxpQkFBUUMsSUFBUixFQUFoQixFQWQrQyxDQWdCL0M7O0FBQ0FYLEVBQUFBLFdBQVcsQ0FBQ1ksR0FBWixDQUFnQixHQUFoQixFQUFxQm5CLFNBQXJCLEVBakIrQyxDQWtCL0M7O0FBQ0FPLEVBQUFBLFdBQVcsQ0FBQ1ksR0FBWixDQUFnQixRQUFoQixFQUEwQmxCLFdBQTFCLEVBQXVDLENBQUNtQixHQUFELEVBQU1DLEdBQU4sS0FBYztBQUNuREEsSUFBQUEsR0FBRyxDQUFDQyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJGLEdBQUcsQ0FBQ0csTUFBSixDQUFXQyxJQUFYLENBQWdCQyxHQUFyQztBQUNELEdBRkQ7QUFJQW5CLEVBQUFBLFdBQVcsQ0FBQ0csR0FBWixDQUFnQmlCLGVBQWhCO0FBQ0FwQixFQUFBQSxXQUFXLENBQUNHLEdBQVosQ0FBZ0JPLGlCQUFRVyxNQUFSLENBQWUsUUFBZixDQUFoQjtBQUVBckIsRUFBQUEsV0FBVyxDQUFDc0IsTUFBWixDQUNFakIsT0FBTyxDQUFDQyxHQUFSLENBQVlpQixJQUFaLElBQW9CeEIsSUFEdEIsRUFFRSxNQUFNeUIsT0FBTyxDQUFDQyxHQUFSLENBQWEscUJBQW9CM0IsUUFBUyxNQUFLRCxJQUFLLElBQUdFLElBQUssRUFBNUQsQ0FGUjtBQUlEO0FBSUQ7QUFDQSIsInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvbGluZXVwLXNvY2lhbC9zZXJ2ZXIvc3JjLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHJlcyBmcm9tICdleHByZXNzL2xpYi9yZXNwb25zZSc7XG5pbXBvcnQgRGVmYXVsdFJvdXRlciBmcm9tICcuL3JvdXRlcyc7XG5jb25zdCBib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTtcblxuY29uc3QgY29va2llUGFyc2VyID0gcmVxdWlyZShcImNvb2tpZS1wYXJzZXJcIilcbmNvbnN0IHsgY2hlY2tVc2VyLCByZXF1aXJlQXV0aCB9ID0gcmVxdWlyZSgnLi9taWRkbGV3YXJlcy9hdXRoLm1pZGRsZXdhcmUnKVxuY29uc3QgY29ycyA9IHJlcXVpcmUoXCJjb3JzXCIpXG5cblxuZXhwb3J0IGZ1bmN0aW9uIGxhdW5jaCh7IGhvc3QsIHByb3RvY29sLCBwb3J0IH0pIHtcbiAgY29uc3QgYXBwbGljYXRpb24gPSBleHByZXNzKCk7XG4gIHJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZyh7IHBhdGg6ICcuLy5lbnYnIH0pXG4gIHJlcXVpcmUoJy4uL2RhdGFiYXNlLmpzJylcblxuICBhcHBsaWNhdGlvbi51c2UoXG4gICAgY29ycyh7XG4gICAgICBvcmlnaW46IHByb2Nlc3MuZW52LkNMSUVOVF9VUkwsXG4gICAgICBtZXRob2RzOiBbXCJHRVRcIiwgXCJQT1NUXCIsIFwiSEVBRFwiLCBcIlBVVFwiLCBcIlBBVENIXCIsIFwiREVMRVRFXCJdLFxuICAgICAgY3JlZGVudGlhbHM6IHRydWUsXG4gICAgfSlcbiAgKTtcbiAgYXBwbGljYXRpb24udXNlKGNvb2tpZVBhcnNlcigpKTtcblxuICBhcHBsaWNhdGlvbi51c2UoZXhwcmVzcy5qc29uKCkpO1xuXG4gIC8vIG5vdHJlIG1pZGRsZXdhcmUgZGUgc8OpY3VyaXTDqVxuICBhcHBsaWNhdGlvbi5nZXQoJyonLCBjaGVja1VzZXIpXG4gIC8vY2VzdCBjZSBxdWkgcGVybWV0IGRlIGxvZ2VyIHVuIHVzZXIgbG9yc3F1J2lsIGFycml2ZSBzdXIgbGUgc2l0ZVxuICBhcHBsaWNhdGlvbi5nZXQoJy9qd3RpZCcsIHJlcXVpcmVBdXRoLCAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChyZXMubG9jYWxzLnVzZXIuX2lkKVxuICB9KVxuXG4gIGFwcGxpY2F0aW9uLnVzZShEZWZhdWx0Um91dGVyKTtcbiAgYXBwbGljYXRpb24udXNlKGV4cHJlc3Muc3RhdGljKCdhc3NldHMnKSk7XG5cbiAgYXBwbGljYXRpb24ubGlzdGVuKFxuICAgIHByb2Nlc3MuZW52LlBPUlQgfHwgcG9ydCxcbiAgICAoKSA9PiBjb25zb2xlLmxvZyhgU2VydmVyIHN0YXJ0ZWQgYXQgJHtwcm90b2NvbH06Ly8ke2hvc3R9OiR7cG9ydH1gKSxcbiAgKTtcbn1cblxuXG5cbi8qIHJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZyh7cGF0aDonLi9jb25maWcvLmVudid9KVxuICovXG5cblxuXG4iXX0=","map":{"version":3,"sources":["server.js"],"names":["bodyParser","require","cookieParser","checkUser","requireAuth","cors","launch","host","protocol","port","application","config","path","use","origin","process","env","CLIENT_URL","methods","credentials","express","json","get","req","res","status","send","locals","user","_id","DefaultRouter","static","listen","PORT","console","log"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA,MAAMA,UAAU,GAAGC,OAAO,CAAC,aAAD,CAA1B;;AAEA,MAAMC,YAAY,GAAGD,OAAO,CAAC,eAAD,CAA5B;;AACA,MAAM;AAAEE,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAA6BH,OAAO,CAAC,+BAAD,CAA1C;;AACA,MAAMI,IAAI,GAAGJ,OAAO,CAAC,MAAD,CAApB;;AAGO,SAASK,MAAT,CAAgB;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,QAAR;AAAkBC,EAAAA;AAAlB,CAAhB,EAA0C;AAC/C,QAAMC,WAAW,GAAG,uBAApB;;AACAT,EAAAA,OAAO,CAAC,QAAD,CAAP,CAAkBU,MAAlB,CAAyB;AAAEC,IAAAA,IAAI,EAAE;AAAR,GAAzB;;AACAX,EAAAA,OAAO,CAAC,gBAAD,CAAP;;AAEAS,EAAAA,WAAW,CAACG,GAAZ,CACER,IAAI,CAAC;AACHS,IAAAA,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC,UADjB;AAEHC,IAAAA,OAAO,EAAE,CAAC,KAAD,EAAQ,MAAR,EAAgB,MAAhB,EAAwB,KAAxB,EAA+B,OAA/B,EAAwC,QAAxC,CAFN;AAGHC,IAAAA,WAAW,EAAE;AAHV,GAAD,CADN;AAOAT,EAAAA,WAAW,CAACG,GAAZ,CAAgBX,YAAY,EAA5B;AAEAQ,EAAAA,WAAW,CAACG,GAAZ,CAAgBO,iBAAQC,IAAR,EAAhB,EAd+C,CAgB/C;;AACAX,EAAAA,WAAW,CAACY,GAAZ,CAAgB,GAAhB,EAAqBnB,SAArB,EAjB+C,CAkB/C;;AACAO,EAAAA,WAAW,CAACY,GAAZ,CAAgB,QAAhB,EAA0BlB,WAA1B,EAAuC,CAACmB,GAAD,EAAMC,GAAN,KAAc;AACnDA,IAAAA,GAAG,CAACC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,GAAG,CAACG,MAAJ,CAAWC,IAAX,CAAgBC,GAArC;AACD,GAFD;AAIAnB,EAAAA,WAAW,CAACG,GAAZ,CAAgBiB,eAAhB;AACApB,EAAAA,WAAW,CAACG,GAAZ,CAAgBO,iBAAQW,MAAR,CAAe,QAAf,CAAhB;AAEArB,EAAAA,WAAW,CAACsB,MAAZ,CACEjB,OAAO,CAACC,GAAR,CAAYiB,IAAZ,IAAoBxB,IADtB,EAEE,MAAMyB,OAAO,CAACC,GAAR,CAAa,qBAAoB3B,QAAS,MAAKD,IAAK,IAAGE,IAAK,EAA5D,CAFR;AAID;AAID;AACA","sourceRoot":"/Applications/dossier/lineup-social/server/src/","sourcesContent":["import express from 'express';\nimport res from 'express/lib/response';\nimport DefaultRouter from './routes';\nconst bodyParser = require('body-parser');\n\nconst cookieParser = require(\"cookie-parser\")\nconst { checkUser, requireAuth } = require('./middlewares/auth.middleware')\nconst cors = require(\"cors\")\n\n\nexport function launch({ host, protocol, port }) {\n  const application = express();\n  require('dotenv').config({ path: './.env' })\n  require('../database.js')\n\n  application.use(\n    cors({\n      origin: process.env.CLIENT_URL,\n      methods: [\"GET\", \"POST\", \"HEAD\", \"PUT\", \"PATCH\", \"DELETE\"],\n      credentials: true,\n    })\n  );\n  application.use(cookieParser());\n\n  application.use(express.json());\n\n  // notre middleware de sécurité\n  application.get('*', checkUser)\n  //cest ce qui permet de loger un user lorsqu'il arrive sur le site\n  application.get('/jwtid', requireAuth, (req, res) => {\n    res.status(200).send(res.locals.user._id)\n  })\n\n  application.use(DefaultRouter);\n  application.use(express.static('assets'));\n\n  application.listen(\n    process.env.PORT || port,\n    () => console.log(`Server started at ${protocol}://${host}:${port}`),\n  );\n}\n\n\n\n/* require('dotenv').config({path:'./config/.env'})\n */\n\n\n\n"]}},"mtime":1653071371087}}